{"version":3,"sources":["lib/headline_filter_parser.js","components/SyncServiceSignIn/dropbox.svg","components/SyncServiceSignIn/google_drive.png","actions/base.js","lib/timestamps.js","lib/export_org.js","lib/capture_template_substitution.js","lib/id_generator.js","lib/org_utils.js","lib/sample_capture_templates.js","actions/org.js","middleware/live_sync.js","middleware/sync_on_becoming_visible.js","actions/capture.js","util/settings_persister.js","reducers/base.js","reducers/sync_backend.js","lib/headline_filter.js","lib/parse_org.js","reducers/org.js","reducers/capture.js","reducers/index.js","store.js","migrations/index.js","migrations/migrate_access_token_to_dropbox_access_token.js","migrations/migrate_store_in_dropbox_to_store_in_sync_backend.js","util/parse_query_string.js","actions/sync_backend.js","sync_backend_clients/dropbox_sync_backend_client.js","sync_backend_clients/google_drive_sync_backend_client.js","components/PrivacyPolicy/index.js","components/HeaderBar/index.js","components/Landing/index.js","components/FileBrowser/index.js","components/LoadingIndicator/index.js","components/OrgFile/components/AttributedString/components/TablePart/TableActionDrawer/index.js","components/OrgFile/components/AttributedString/components/TablePart/index.js","lib/color.js","components/UI/Checkbox/index.js","components/OrgFile/components/AttributedString/components/ListPart/index.js","components/OrgFile/components/AttributedString/components/TimestampPart/index.js","components/OrgFile/components/AttributedString/index.js","components/OrgFile/components/TitleLine/index.js","components/OrgFile/components/HeaderContent/components/PlanningItems/index.js","components/OrgFile/components/HeaderContent/components/PropertyListItems/index.js","components/OrgFile/components/HeaderContent/components/LogBookEntries/index.js","components/OrgFile/components/HeaderContent/index.js","components/OrgFile/components/Header/components/HeaderActionDrawer/index.js","components/OrgFile/components/Header/index.js","components/OrgFile/components/HeaderList/index.js","components/OrgFile/components/ActionDrawer/components/ActionButton/index.js","components/OrgFile/components/ActionDrawer/index.js","lib/browser_utils.js","components/UI/Switch/index.js","components/UI/Drawer/index.js","components/OrgFile/components/CaptureModal/index.js","components/OrgFile/components/SyncConfirmationModal/index.js","components/OrgFile/components/TagsEditorModal/index.js","components/UI/TabButtons/index.js","components/OrgFile/components/TimestampEditorModal/components/TimestampEditor/index.js","components/OrgFile/components/TimestampEditorModal/index.js","components/OrgFile/components/PropertyListEditorModal/index.js","components/OrgFile/components/AgendaModal/components/AgendaDay/index.js","components/OrgFile/components/AgendaModal/index.js","components/OrgFile/components/TaskListModal/components/TaskListView/index.js","components/OrgFile/components/TaskListModal/index.js","components/OrgFile/components/SearchModal/components/HeaderListView/index.js","components/OrgFile/components/SearchModal/index.js","lib/keybindings.js","components/OrgFile/index.js","components/Settings/index.js","components/KeyboardShortcutsEditor/components/ShortcutRow/index.js","components/KeyboardShortcutsEditor/index.js","components/CaptureTemplatesEditor/components/CaptureTemplate/index.js","components/CaptureTemplatesEditor/index.js","components/SyncServiceSignIn/index.js","components/Entry/index.js","App.js","sync_backend_clients/webdav_sync_backend_client.js","registerServiceWorker.js","index.js","images/organice.svg"],"names":["peg$SyntaxError","message","expected","found","location","this","name","Error","captureStackTrace","child","parent","ctor","constructor","prototype","peg$subclass","buildMessage","DESCRIBE_EXPECTATION_FNS","literal","expectation","literalEscape","text","i","escapedParts","parts","length","Array","classEscape","inverted","any","end","other","description","hex","ch","charCodeAt","toString","toUpperCase","s","replace","j","descriptions","type","sort","slice","join","describeExpected","describeFound","module","exports","SyntaxError","parse","input","options","peg$result","peg$FAILED","peg$startRuleFunctions","Expression","peg$parseExpression","peg$startRuleFunction","peg$c0","peg$otherExpectation","peg$c4","peg$c6","peg$literalExpectation","peg$c9","peg$c11","peg$c13","peg$c15","peg$c17","peg$c19","peg$c20","head","tail","reduce","result","element","push","peg$c21","peg$c22","peg$c23","peg$c24","peg$classExpectation","peg$c25","peg$c27","peg$c28","peg$c29","peg$c30","a","peg$c32","peg$c33","peg$c34","peg$c35","peg$c36","peg$c37","peg$c38","peg$c39","peg$c40","peg$c41","peg$c42","peg$c43","peg$currPos","peg$savedPos","peg$posDetailsCache","line","column","peg$maxFailPos","peg$maxFailExpected","peg$silentFails","startRule","substring","peg$computeLocation","ignoreCase","peg$computePosDetails","pos","p","details","startPos","endPos","startPosDetails","endPosDetails","start","offset","peg$fail","peg$buildStructuredError","s0","s1","s2","s3","s4","s5","s6","peg$parse_","peg$parseLocationAnnotedTerm","peg$parsePlainTerm","exclude","peg$c8","peg$parseTerm","endOffset","peg$parseStringAlternatives","match","words","peg$c10","peg$parseTermText","test","charAt","peg$parsePropertyName","property","b","peg$parseTermProp","peg$parseTagName","peg$parseTagAlternatives","peg$parseTermTag","peg$parseString","setLoadingMessage","loadingMessage","hideLoadingMessage","setIsLoading","isLoading","setDisappearingLoadingMessage","delay","dispatch","setTimeout","setLastViewedFile","lastViewedPath","lastViewedContents","loadStaticFile","staticFile","getState","org","present","get","displayFile","changelog","sample","unloadStaticFile","stopDisplayingFile","base","setFontSize","newFontSize","setBulletStyle","newBulletStyle","setShouldTapTodoToAdvance","newShouldTapTodoToAdvance","setShouldDoubleTapToEdit","newShouldDoubleTapToEdit","setAgendaDefaultDeadlineDelayUnit","newAgendaDefaultDeadlineDelayUnit","setAgendaDefaultDeadlineDelayValue","newAgendaDefaultDeadlineDelayValue","setShouldLiveSync","shouldLiveSync","setShouldSyncOnBecomingVisibile","shouldSyncOnBecomingVisibile","setShouldShowTitleInOrgFile","shouldShowTitleInOrgFile","setShouldStoreSettingsInSyncBackend","newShouldStoreSettingsInSyncBackend","client","syncBackend","deleteFile","catch","doesFileNotExist","error","alert","deleteFileByNameAndParent","window","previousSettingsFileContents","setHasUnseenChangelog","newHasUnseenChangelog","setLastSeenChangelogHeader","newLastSeenChangelogHash","setCustomKeybinding","keybindingName","keybinding","restoreBaseSettings","newSettings","pushModalPage","modalPage","popModalPage","clearModalStack","activatePopup","popupType","data","closePopup","renderAsText","timestamp","toJS","isActive","year","month","day","dayName","startHour","startMinute","endHour","endMinute","repeaterType","repeaterValue","repeaterUnit","delayType","delayValue","delayUnit","timestampText","getCurrentTimestamp","withStartTime","time","Date","format","getCurrentTimestampAsText","dateForTimestamp","timestampString","padStart","addTimestampUnitToDate","date","numUnits","timestampUnit","h","addHours","d","addDays","w","addWeeks","m","addMonths","y","addYears","timestampDuration","startTimestamp","endTimestamp","map","pad","minDiff","differenceInMinutes","hours","Math","floor","minutes","minutesText","formattedAttributedStringText","part","getIn","attributedStringToRawText","prevPartTypes","unshift","zip","linkPart","prevPartType","tablePart","rowHeights","row","max","cell","_","countBy","numColumns","size","columnWidths","times","columnIndex","content","lineLengths","split","trim","dropRight","flatten","rowIndex","rowHeight","contentRows","lineIndex","formattedLineLengths","padCount","repeat","contentRow","separator","columnWidth","concat","tablePartToRawText","listPart","bulletCharacter","previousNumber","item","optionalLeadingSpace","titleText","contentText","indentedContentText","listItemText","number","forceNumber","stateCharacter","checked","unchecked","partial","listPartToRawText","timestampPartToRawText","console","includes","generateTitleLine","header","includeStars","contents","nestingLevel","titleLine","todoKeyword","rawTitle","tags","filter","tag","headers","todoKeywordSets","fileConfigLines","linesBeforeHeadings","configContent","todoKeywordSet","headerContent","indentation","planningItems","planningItemsContent","planningItem","fromJS","trimRight","propertyListItems","propertyListItemsContent","propertyListItem","value","logBookEntries","logBookEntriesContent","entry","undefined","raw","rawDescription","startsWith","endsWith","templateString","customVariables","Map","substitutions","entrySeq","forEach","key","substitutedString","entries","formatString","RegExp","cursorIndex","indexOf","nextId","changelogHash","Promise","resolve","reject","list","c","crypto","subtle","digest","Uint8Array","then","hashArray","values","hash","indexOfHeaderWithId","headerId","findIndex","headerWithId","subheadersOfHeaderWithId","headerIndex","afterHeaders","nextSiblingHeaderIndex","siblingHeader","numSubheadersOfHeaderWithId","parentIdOfHeaderWithId","parentHeader","reverse","find","previousHeader","isHeaderVisible","parentHeaderId","openDirectParent","state","directParentIdOfHeaderWithId","parentHeaderIndex","setIn","headerWithPath","headerPath","firstHeader","first","rest","tablePartContainsCellId","cellId","some","headerThatContainsTableCellId","doesAttributedStringContainTableCellId","pathAndPartOfTimestampItemWithIdInAttributedString","timestampId","partIndex","path","timestampPart","itemIndex","pathAndPart","cellIndex","pathAndPartOfTableContainingCellIdInHeaders","pathAndPartOfTableContainingCellIdInAttributedString","updateTableContainingCellId","updaterCallbackGenerator","rowIndexContainingCellId","columnIndexContainingCellId","updateIn","timestampWithIdInAttributedString","customFormatDistanceToNow","datetime","formatDistanceToNow","addSuffix","todoKeywordSetForKeyword","keyword","keywordSet","contains","extractAllOrgTags","flatMap","toSet","extractAllOrgProperties","prop","valParts","x","isEmpty","computeAllPropertyNames","allOrgProperties","computeAllPropertyValuesFor","propertyName","toLowerCase","createIsTodoKeywordInDoneState","headerPaths","iconName","id","generateId","isAvailableInAllOrgFiles","letter","orgFilesWhereAvailable","shouldPrepend","template","isSample","setLastSyncAt","lastSyncAt","ActionCreators","clearHistory","unfocusHeader","syncDebounced","debounce","args","doSync","leading","trailing","sync","forceAction","successMessage","shouldSuppressMessages","setOrgFileErrorMessage","getFileContentsAndMetadata","lastModifiedAt","isDirty","lastServerModifiedAt","parseISO","isAfter","updateFile","exportOrg","setDirty","addSeconds","err","applyOpennessState","openHeader","toggleHeaderOpened","selectHeader","setSelectedTableCellId","selectHeaderAndOpenParents","advanceTodoState","dirtying","enterEditMode","editModeType","exitEditMode","updateHeaderTitle","newRawTitle","updateHeaderDescription","newRawDescription","addHeader","selectNextSiblingHeader","addHeaderAndEdit","selectNextVisibleHeader","selectPreviousVisibleHeader","removeHeader","moveHeaderUp","moveHeaderDown","moveHeaderLeft","moveHeaderRight","moveSubtreeLeft","moveSubtreeRight","refileSubtree","sourceHeaderId","targetHeaderId","focusHeader","addNewTableRow","removeTableRow","addNewTableColumn","removeTableColumn","moveTableRowDown","moveTableRowUp","moveTableColumnLeft","moveTableColumnRight","updateTableCellValue","newValue","insertCapture","templateId","capture","sampleCaptureTemplates","clearPendingCapture","insertPendingCapture","pendingCapture","templateName","captureContent","customCaptureVariables","history","pushState","pathname","substituteTemplateVariables","substitutedTemplate","initialCursorIndex","advanceCheckboxState","listItemId","setHeaderTags","reorderTags","fromIndex","toIndex","reorderPropertyList","updateTimestampWithId","newTimestamp","updatePlanningItemTimestamp","planningItemIndex","addNewPlanningItem","planningType","removePlanningItem","updatePropertyListItems","newPropertyListItems","setLogEntryStop","entryId","createLogEntryStart","updateLogEntryTime","entryIndex","entryType","newTime","setSearchFilterInformation","searchFilter","cursorPosition","context","store","next","action","debouncedDispatchSync","visProp","prefixes","document","getHiddenProp","evtname","addEventListener","addNewEmptyCaptureTemplate","updateTemplateFieldPathValue","fieldPath","addNewTemplateOrgFileAvailability","removeTemplateOrgFileAvailability","orgFileAvailabilityIndex","addNewTemplateHeaderPath","removeTemplateHeaderPath","headerPathIndex","deleteTemplate","restoreCaptureSettings","reorderCaptureTemplate","isLocalStorageAvailable","localStorage","setItem","getItem","e","debouncedPushConfigToSyncBackend","syncBackendClient","createFile","maxWait","persistableFields","category","shouldStoreInConfig","default","List","getFieldsToPersist","fields","field","depreacted","JSON","stringify","getConfigFileContents","fieldsToPersist","fromPairs","readInitialState","initialState","past","search","searchFilterExpr","future","set","update","templates","opennessState","opennessStateJSONString","readOpennessState","subscribeToChanges","settingsFileContents","currentFilePath","openHeaderPaths","getOpenHeaderPaths","openedHeaders","title","subheaders","openSubheaderPaths","openedSubheaderPath","persistField","getPersistedField","nullable","config","applyCategorySettingsFromConfig","stack","pop","replaceState","signOut","setCurrentFileBrowserDirectoryListing","listing","directoryListing","hasMore","additionalSyncBackendState","setIsLoadingMoreDirectoryListing","currentFileBrowserDirectoryListing","isLoadingMore","computeCompletionsForDatalist","todoKeywords","tagNames","allProperties","filterExpr","filterString","curserPosition","tagAndPropNames","logicalCursorPosition","computeLogicalPosition","charBeforeCursor","charTwoBeforeCursor","SPACE_SURROUNDED","textBeforeCursor","filteredTodoKeywords","indexOfOtherColon","lastIndexOf","maybePropertyName","maybeTagName","computeCompletions","tup","elem","markupAndCookieRegex","timestampRegex","timestampFromRegexMatch","partIndices","typeBracket","timeStart","timeEnd","firstDelayRepeatType","firstDelayRepeatValue","firstDelayRepeatUnit","secondDelayRepeatType","secondDelayRepeatValue","secondDelayRepeatUnit","parseMarkupAndCookies","rawText","shouldAppendNewline","matches","excludeCookies","exec","uri","index","percentCookieMatch","percentage","fractionCookieMatch","fraction","markupType","markupPrefixLength","firstTimestamp","range","secondTimestamp","lineParts","startIndex","computeParseResults","trailingText","parseTable","tableLines","table","columnProperties","lastRow","last","lineCells","substr","cellContents","rawContents","maxNumColumns","parseRawText","excludeContentElements","lines","LIST_HEADER_REGEX","currentListHeaderNestingLevel","rawLineParts","numLeadingSpaces","processedLineParts","linePart","takeWhile","contentLines","isOrdered","checkboxState","isCheckbox","X","newListItem","lastIndex","items","numberTerminatorCharacter","parseDescriptionPrefixElements","planningItemsParse","singlePlanningItemRegex","concatRegexes","optionalSinglePlanningItemRegex","planningRegex","planningMatch","planningTypeIndex","strippedDescription","_parsePlanningItems","propertyListParse","propertiesLineIndex","endLineIndex","parsePropertyList","logBookParse","logbookLineIndex","logBookEntryStartRegex","logBookEntryFullRegex","lineFullMatch","lineStartMatch","trimLeft","parseLogbook","_updateHeaderFromDescription","defaultKeywordSets","keywords","completedKeywords","parseTitleLine","titleParts","possibleTags","newHeaderWithTitle","opened","regexes","prev","curr","parseOrg","fileContents","newKeywordSet","keywordTokens","pipeIndex","configLine","parseTodoKeywordConfig","parsedFile","isOpened","openParentsOfHeader","updateCookiesInAttributedStringWithChildCompletionStates","completionStates","doneCount","isDone","totalCount","updateCookiesOfHeaderWithId","directChildren","subheader","updateCookiesOfParentOfHeaderWithId","currentTodoState","currentTodoSet","newStateIndex","newTodoState","indexedPlanningItemsWithRepeaters","currentDate","newDate","isBefore","applyRepeater","startupOptNoLogRepeat","elt","loggingProp","inheritedValueOfProperty","headerProp","parentId","v","noLogRepeatEnabledP","lastRepeatTimestamp","newLastRepeatValue","updatePlanningItemsWithRepeaters","updateHeadlines","newTitleLine","newHeader","insert","nextSibling","nextVisibleHeader","nextVisibleHeaderAfterIndex","previousVisibleHeader","previousVisibleHeaderAfterIndex","numHeadersToRemove","delete","previousSiblingIndex","indexOfPreviousSibling","nextSiblingIndex","nextSiblingSubheaders","previousParentHeaderId","updateCookies","shiftTreeNestingLevel","moveItem","targetItem","targetIndex","sourceHeader","sourceHeaderIndex","targetHeaderIndex","subheadersOfSourceHeader","nestingLevelSource","nestingLevelTarget","fileOpennessState","openHeaderPath","openHeaderWithPath","maxNestingLevel","firstTitle","take","takeLast","updateDescriptionOfHeaderContainingTableCell","selectedTableCellId","rows","newEmptyTableRowLikeRows","containingHeader","_rowIndex","colIndex","newHeaderFromText","numSubheaders","newIndex","pathAndPartOfListItemWithIdInAttributedString","listItemPart","newCheckboxState","updateParentListCheckboxes","itemPath","parentListItemPath","parentListItem","has","childrenCheckedStates","checkboxItem","every","childCompletionStates","selectedHeaderId","splice","propertyListItemIndex","plistPathAndPart","newPlanningItem","removeIn","headerIdx","newEntry","asMutable","searchFilterValid","headline_filter_parser","filteredHeaders","headLine","headlineText","properties","filterFilter","wordsLowerCase","filterTags","filterCS","filterIC","filterProps","filterTagsExcl","filterCSExcl","filterICExcl","filterPropsExcl","orChain","source","xs","propertyFilter","ys","val","nameMatch","valueMatch","filterIds","searchFilterSuggestions","getTodoKeywordSetsAsFlattenedArray","asImmutable","direction","calculateNestingLevel","indexOfTemplateWithId","templateIndex","orgFiles","captureTemplates","applyCaptureSettingsFromConfig","undo","ActionTypes","UNDO","redo","REDO","combineReducers","undoable","includeAction","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","accessToken","removeItem","migrateAccessTokenToDropboxAccessToken","shouldStoreSettingsInDropbox","migrateStoreInDropboxToStoreInSyncBackend","parseQueryString","str","ret","Object","create","param","shift","decodeURIComponent","isArray","gapi","auth2","getAuthInstance","getDirectoryListing","loadMoreDirectoryListing","getMoreDirectoryListing","extendedListing","pushBackup","pathOrFileId","duplicateFile","fileName","downloadFile","getFileContents","dropboxClient","Dropbox","fetch","transformDirectoryListing","sortedListing","file","filterAndSortDirectoryListing","isDirectory","path_display","uploadFile","filesUpload","mode","autorename","filesDownload","response","reader","FileReader","server_modified","readAsText","fileBlob","objectContainsTagErrorP","isSignedIn","filesListFolder","has_more","cursor","filesListFolderContinue","filesDelete","getAPIClient","isInited","isIniting","afterInitCallbacks","load","initialHash","init","client_id","process","discoveryDocs","scope","callback","handleGoogleDriveClientLoad","mimeType","getFiles","directoryId","nextPageToken","fileListPromise","drive","files","pageSize","q","pageToken","currentDirectoryId","fileParentPromise","fileId","parents","rootFolderIdPromise","rootFolderId","all","directoryParentId","fileIdByNameAndParent","method","Authorization","auth","getToken","access_token","body","fileContentsPromise","alt","escape","errors","reason","fileModifiedTimePromise","modifiedTime","fileNameCallback","getResponse","newFileName","backupFileId","makeCopy","copy","copyResponse","getFileContentsByNameAndParent","listResponse","PrivacyPolicy","className","href","HeaderBar","props","bindAll","syncBackendType","directoryPath","pathParts","parentDirectoryName","parentPath","to","filePath","src","logo","width","height","onClick","handleSettingsSubPageBackClick","activeModalPage","renderSettingsSubPageBackButton","getPathRoot","renderLogo","renderFileBrowserBackButton","renderOrgFileBackButton","renderSampleFileBackButton","renderSignInBackButton","titleContainerWithText","handleHeaderBarTitleClick","getFilename","isUndoEnabled","isRedoEnabled","isAuthenticated","hasUnseenChangelog","handleModalPageDoneClick","undoIconClassName","classNames","redoIconClassName","settingsIconClassName","target","rel","handleUndoClick","handleRedoClick","handleHelpClick","handleChangelogClick","renderBackButton","renderTitle","renderActions","PureComponent","withRouter","connect","bindActionCreators","baseActions","orgActions","undoActions","syncBackendActions","useEffect","isTopLevelDirectory","getParentDirectoryPath","isBackupFile","isOrgFile","isSettingsFile","iconClass","useState","shouldRenderIndicator","setShouldRenderIndicator","lastMessage","setLastMessage","handleClick","style","opacity","spring","stiffness","onRest","subPartDataAndHandlers","onEnterTableEditMode","onAddNewTableRow","onRemoveTableRow","onAddNewTableColumn","onRemoveTableColumn","TablePart","rawCellValues","generateCellValueMap","shouldIgnoreBlur","prevProps","onTableCellValueUpdate","inTableEditMode","setState","onTableCellSelect","onExitTableEditMode","event","cellValue","insertionIndex","textarea","selectionStart","selectionEnd","focus","shouldDisableActions","isTableSelected","isCellSelected","handleCellSelect","autoFocus","onBlur","handleTextareaBlur","onChange","handleCellChange","ref","handleTextareaRef","handleInsertTimestamp","AttributedString","TableActionDrawer","interpolateColors","colorA","colorB","interpolationFactor","r","parseInt","g","rgbaObject","rgbaString","rgba","uncheckedColor","checkedColor","checkboxStyle","colorFactor","backgroundColor","renderContent","itemId","lineContainerClass","onCheckboxClick","Checkbox","onTimestampClick","ListPart","TimestampPart","TitleLine","titleValue","calculateRawTitle","containerWidth","containerDiv","offsetWidth","storeContainerWidth","inEditMode","div","span","titleSpan","hasContent","isSelected","shouldDoubleTapToEdit","shouldTapTodoToAdvance","stopPropagation","select","newTitle","lastCharacter","color","shouldDisableExplicitWidth","isTodoKeywordInDoneState","titleStyle","wordBreak","handleTitleClick","onDoubleClick","handleTitleDoubleClick","handleRef","handleTodoClick","data-testid","onFocus","handleTextareaFocus","handleTitleChange","handleTitleFieldClick","handleTitleSpanRef","handleTimestampClick","toList","PlanningItems","onEdit","isDrawerCollapsed","setIsDrawerCollapsed","HeaderContent","descriptionValue","calculateRawDescription","planningItemsText","propertyListItemsText","logBookEntriesText","headerText","logEntryIndex","handleDoubleClick","handleDescriptionChange","handlePlanningItemTimestampClick","PropertyListItems","handlePropertyListEdit","LogBookEntries","handleLogEntryTimestampClick","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","HeaderActionDrawer","testId","onEnterTitleEditMode","onEnterDescriptionEditMode","onTagsClick","onPropertiesClick","isFocused","onUnfocus","onAddNewHeader","onDeadlineClick","onClockInOutClick","onScheduledClick","hasActiveClock","onShareHeader","onRefileHeader","iconWithFFClickCatcher","Header","SWIPE_ACTION_ACTIVATION_DISTANCE","FREE_DRAG_ACTIVATION_DISTANCE","isDraggingFreely","dragStartX","dragStartY","currentDragX","isPlayingRemoveAnimation","heightBeforeRemove","onRef","dragX","dragY","closest","abs","swipeDistance","offsetHeight","handleDragStart","clientX","clientY","handleDragMove","handleDragEnd","handleDragCancel","changedTouches","classList","existingDeadlinePlanningItemIndex","handleDeadlineAndScheduledClick","logBook","existingClockIndex","now","subject","mailtoURI","encodeURIComponent","open","bulletStyle","focusedHeader","indentLevel","paddingLeft","marginLeft","heightFactor","handleRest","interpolatedStyle","swipedDistance","isLeftActionActivated","isRightActionActivated","disabledBackgroundColor","leftActivatedBackgroundColor","rightActivatedBackgroundColor","disabledIconColor","activatedIconColor","leftSwipeActionContainerStyle","backgroundColorFactor","rightSwipeActionContainerStyle","headerStyle","handleHeaderClick","onMouseDown","handleMouseDown","onMouseMove","handleMouseMove","onMouseUp","handleMouseUp","onMouseOut","handleMouseOut","onTouchStart","handleTouchStart","onTouchMove","handleTouchMove","onTouchEnd","handleTouchEnd","onTouchCancel","handleTouchCancel","leftInterpolatedStyle","leftStyle","leftIconStyle","display","rightInterpolatedStyle","rightStyle","rightIconStyle","springConfig","marginRight","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleShowPropertyListEditorModal","handleFocus","handleUnfocus","handleAddNewHeader","handleDeadlineClick","handleClockInOutClick","handleScheduledClick","handleShareHeaderClick","handleRefileHeaderRequest","HeaderList","headerRefs","selectedHeaderDiv","boundingRectangle","getBoundingClientRect","viewportHeight","documentElement","clientHeight","top","bottom","scrollIntoView","focusedHeaderId","headerRenderData","displayed","toArray","headerRenderDatum","previousRenderDatum","followingHeaders","followingHeaderIndex","followingHeader","focusedHeaderIndex","headerColors","displayedHeaderRenderData","handleHeaderRef","ActionButton","isDisabled","subIconName","shouldRotateSubIcon","additionalClassName","tooltip","shouldSpinSubIcon","fas","subIconClassName","isFocusedHeaderActive","captureActions","shouldDisableSyncButtons","isDisplayingArrowButtons","setIsDisplayingArrowButtons","isDisplayingCaptureButtons","setIsDisplayingCaptureButtons","isDisplayingSearchButtons","setIsDisplayingSearchButtons","querySelector","paddingBottom","mainArrowButton","useRef","mainArrowButtonBoundingRect","useMemo","current","handleUpClick","handleDownClick","handleLeftClick","handleRightClick","handleMoveSubtreeLeftClick","handleMoveSubtreeRightClick","getAvailableCaptureTemplates","availablePath","handleMainArrowButtonClick","handleMainSearchButtonClick","handleMainCaptureButtonClick","handleTaskListClick","handleSearchClick","baseArrowButtonStyle","boxShadow","centerXOffset","screen","animatedStyles","topRowYOffset","bottomRowYOffset","firstColumnXOffset","secondColumnXOffset","left","right","renderMovementButtons","baseSearchButtonStyle","position","zIndex","mainButtonStyle","animatedStyle","renderSearchButtons","availableCaptureTemplates","baseCaptureButtonStyle","renderCaptureButtons","browser","Bowser","getParser","navigator","userAgent","isMobileSafari13","satisfies","mobile","safari","isMobileBrowser","isIphoneX","matchMedia","isIphone678","isRunningAsPWA","standalone","isInLandscapeMode","orientation","isEnabled","onToggle","disabledColor","enabledColor","switchStyle","grabberStyle","children","shouldIncludeCloseButton","onClose","maxSize","isVisible","setIsVisible","dragOffsetY","setDragOffsetY","useLayoutEffect","initialClientY","innerContainer","innerContainerHeight","handleInnerContainerClick","handleClose","targetTouches","isScrollingDown","scrollHeight","scrollTop","preventDefault","handleTouchEndOrCancel","innerContainerCurrent","removeEventListener","outerClassName","innerStyle","offsetY","innerHeight","transform","overflow","onCapture","targetHeader","textareaValue","setTextareaValue","setShouldPrepend","setSelectionRange","Drawer","Switch","minHeight","onPull","onPush","onCancel","TagsEditorModal","allTags","prevTags","currentTags","lastTextfield","tagIndex","newTag","headerTags","tagName","idx","droppableId","provided","snapshot","innerRef","droppableProps","draggableId","isDragging","draggableProps","handleTagChange","textfield","handleRemoveTag","dragHandleProps","placeholder","handleAddNewTag","handleExistingTagClick","buttons","selectedButton","useEqualWidthTabs","onSelect","handleButtonClick","buttonName","containerClassName","gridTemplateColumns","TimestampEditor","isNumber","newYear","newMonth","newDay","newDayName","startOrEnd","hourKey","minuteKey","hour","minute","newRepeaterType","newRepeaterUnit","newDelayType","newDelayUnit","label","timeKey","showRemoveButton","handleTimeChange","handleRemoveTime","handleAddTime","TabButtons","handleRepeaterTypeChange","min","handleRepeaterValueChange","handleRepeaterUnitChange","handleRemoveRepeater","handleAddRepeater","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange","handleRemoveDelay","handleAddDelay","handleActiveToggle","handleDateChange","nativeEvent","defaultValue","renderTimeField","renderRepeater","renderDelay","TimestampEditorModal","singleTimestampOnly","handleChange","handleRemoveEndTimestamp","handleAddEndTimestamp","PropertyListEditorModal","prevItems","currentItems","propertyListItemId","allPropertyNames","propertyListItemsWithAllPropVals","allPropertyValues","handlePropertyChange","handleValueChange","propertyValue","handleRemoveItem","handleAddNewItem","AgendaDay","onHeaderClick","dateDisplayType","onToggleDateDisplayType","agendaDefaultDeadlineDelayValue","agendaDefaultDeadlineDelayUnit","dateStart","startOfDay","dateEnd","endOfDay","planningItemsAndHeaders","getPlanningItemsAndHeaders","isToday","planningItemDate","hasTodoKeyword","dateClassName","isPast","isTodoKeywordCompleted","appearDate","subHours","subDays","subWeeks","subMonths","subYears","subtractTimestampUnitFromDate","isEqual","isWithinInterval","hasBeenRepeated","sortBy","selectedDate","setSelectedDate","timeframeType","setTimeframeType","setDateDisplayType","handleToggleDateDisplayType","dates","weekStart","startOfWeek","daysAfter","monthStart","startOfMonth","getDaysInMonth","weekEnd","calculateTimeframeHeader","getTimeFromPlanningItem","getTime","Number","MAX_SAFE_INTEGER","planningInformation","setdateDisplayType","taskListViewStyle","string","capitalize","DEFAULT_BINDINGS","calculateNamedKeybindings","customKeybindings","bindingName","binding","OrgFile","hasUncaughtError","loadedPath","urlFragment","container","newTags","popupData","activePopupType","activePopupData","selectedHeader","SyncConfirmationModal","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","CaptureModal","handleCapture","handlePopupClose","handleTagsChange","editingTimestamp","timestampWithId","handleTimestampChange","handlePropertyListItemsChange","handleSearchPopupClose","handleRefilePopupClose","shouldDisableDirtyIndicator","parsingErrorMessage","orgFileErrorMessage","keyMap","bindingAction","calculateActionedKeybindings","preventDefaultAndHandleEditMode","ignoreInEditMode","activeElement","nodeName","handlers","handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","advanceTodo","handleAdvanceTodoHotKey","editTitle","handleEditTitleHotKey","editDescription","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","tabIndex","handleContainerRef","renderActivePopup","activePopup","fontSize","shouldStoreSettingsInSyncBackend","confirm","ShortcutRow","isEditMode","rebindArea","handleKeyPress","code","Minus","Equal","Backspace","Enter","Return","Tab","BracketLeft","BracketRight","Semicolon","Quote","Backslash","Comma","Period","Slash","newModifiers","modifier","newBinding","onBindingChange","currentBinding","symbol","rebindAreaClassName","handleRebindClick","symbolizeKeybinding","handleBindingChange","alreadyInUseBinding","onFieldPathUpdate","onAddNewTemplateOrgFileAvailability","onRemoveTemplateOrgFileAvailability","onAddNewTemplateHeaderPath","onRemoveTemplateHeaderPath","onDeleteTemplate","isCollapsed","setIsCollapsed","handleHeaderBarClick","updateField","fieldName","toggleAvailabilityInAllOrgFiles","togglePrepend","handleAddNewOrgFileAvailability","handleRemoveOrgFileAvailability","handleOrgFileAvailabilityChange","handleAddNewHeaderPath","handleRemoveHeaderPath","handleHeaderPathChange","handleDeleteClick","caretClassName","renderDescriptionField","maxLength","autoCapitalize","autoCorrect","renderIconField","orgFilePath","renderOrgFileAvailability","marginTop","renderHeaderPaths","renderPrependField","renderTemplateField","handleFieldPathUpdate","handleAddNewTemplateOrgFileAvailability","handleRemoveTemplateOrgFileAvailability","handleAddNewTemplateHeaderPath","handleRemoveTemplateHeaderPath","handleDeleteTemplate","handleReorderTemplate","CaptureTemplate","onReorder","WebDAVForm","url","setUrl","username","setUsername","password","setPassword","onSubmit","origin","SyncServiceSignIn","authURL","clientId","getAuthenticationUrl","apiKey","signIn","ux_mode","redirect_uri","handleDropboxClick","DropboxLogo","handleGoogleDriveClick","GoogleDriveLogo","Entry","setChangelogUnseenChanges","lastSeenChangelogHash","hasChanged","shouldPromptWhenLeaving","onbeforeunload","shouldDisableActionDrawer","params","pendingCapturePath","shouldRedirectToCapturePath","LoadingIndicator","when","renderChangelogFile","renderSampleFile","exact","component","render","renderFile","renderFileBrowser","Landing","App","runAllMigrations","hashContents","authenticatedSyncService","dropboxAccessToken","createDropboxSyncBackendClient","persistedDropboxAccessToken","createGoogleDriveSyncBackendClient","login","webdavClient","createClient","basename","filename","getDirectoryContents","putFileContents","overwrite","stat","lastmod","toISOString","status","statusText","log","createWebDAVSyncBackendClient","queryStringContents","captureFile","captureTemplateName","capturePath","createStore","rootReducer","applyMiddleware","thunk","liveSync","syncOnBecomingVisible","Store","subscribe","configFileContents","_error","loadSettingsFromConfigFile","destination","onDragEnd","isLocalhost","Boolean","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","ReactDOM","getElementById","URL","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.ce725367.chunk.js","sourcesContent":["/* eslint-disable */\n/*\n * Generated by PEG.js 0.10.0.\n *\n * http://pegjs.org/\n */\n\n\"use strict\";\n\nfunction peg$subclass(child, parent) {\n  function ctor() { this.constructor = child; }\n  ctor.prototype = parent.prototype;\n  child.prototype = new ctor();\n}\n\nfunction peg$SyntaxError(message, expected, found, location) {\n  this.message  = message;\n  this.expected = expected;\n  this.found    = found;\n  this.location = location;\n  this.name     = \"SyntaxError\";\n\n  if (typeof Error.captureStackTrace === \"function\") {\n    Error.captureStackTrace(this, peg$SyntaxError);\n  }\n}\n\npeg$subclass(peg$SyntaxError, Error);\n\npeg$SyntaxError.buildMessage = function(expected, found) {\n  var DESCRIBE_EXPECTATION_FNS = {\n        literal: function(expectation) {\n          return \"\\\"\" + literalEscape(expectation.text) + \"\\\"\";\n        },\n\n        \"class\": function(expectation) {\n          var escapedParts = \"\",\n              i;\n\n          for (i = 0; i < expectation.parts.length; i++) {\n            escapedParts += expectation.parts[i] instanceof Array\n              ? classEscape(expectation.parts[i][0]) + \"-\" + classEscape(expectation.parts[i][1])\n              : classEscape(expectation.parts[i]);\n          }\n\n          return \"[\" + (expectation.inverted ? \"^\" : \"\") + escapedParts + \"]\";\n        },\n\n        any: function(expectation) {\n          return \"any character\";\n        },\n\n        end: function(expectation) {\n          return \"end of input\";\n        },\n\n        other: function(expectation) {\n          return expectation.description;\n        }\n      };\n\n  function hex(ch) {\n    return ch.charCodeAt(0).toString(16).toUpperCase();\n  }\n\n  function literalEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\"/g,  '\\\\\"')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function classEscape(s) {\n    return s\n      .replace(/\\\\/g, '\\\\\\\\')\n      .replace(/\\]/g, '\\\\]')\n      .replace(/\\^/g, '\\\\^')\n      .replace(/-/g,  '\\\\-')\n      .replace(/\\0/g, '\\\\0')\n      .replace(/\\t/g, '\\\\t')\n      .replace(/\\n/g, '\\\\n')\n      .replace(/\\r/g, '\\\\r')\n      .replace(/[\\x00-\\x0F]/g,          function(ch) { return '\\\\x0' + hex(ch); })\n      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return '\\\\x'  + hex(ch); });\n  }\n\n  function describeExpectation(expectation) {\n    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);\n  }\n\n  function describeExpected(expected) {\n    var descriptions = new Array(expected.length),\n        i, j;\n\n    for (i = 0; i < expected.length; i++) {\n      descriptions[i] = describeExpectation(expected[i]);\n    }\n\n    descriptions.sort();\n\n    if (descriptions.length > 0) {\n      for (i = 1, j = 1; i < descriptions.length; i++) {\n        if (descriptions[i - 1] !== descriptions[i]) {\n          descriptions[j] = descriptions[i];\n          j++;\n        }\n      }\n      descriptions.length = j;\n    }\n\n    switch (descriptions.length) {\n      case 1:\n        return descriptions[0];\n\n      case 2:\n        return descriptions[0] + \" or \" + descriptions[1];\n\n      default:\n        return descriptions.slice(0, -1).join(\", \")\n          + \", or \"\n          + descriptions[descriptions.length - 1];\n    }\n  }\n\n  function describeFound(found) {\n    return found ? \"\\\"\" + literalEscape(found) + \"\\\"\" : \"end of input\";\n  }\n\n  return \"Expected \" + describeExpected(expected) + \" but \" + describeFound(found) + \" found.\";\n};\n\nfunction peg$parse(input, options) {\n  options = options !== void 0 ? options : {};\n\n  var peg$FAILED = {},\n\n      peg$startRuleFunctions = { Expression: peg$parseExpression },\n      peg$startRuleFunction  = peg$parseExpression,\n\n      peg$c0 = peg$otherExpectation(\"filter expression\"),\n      peg$c1 = function(head, tail) {\n            return tail.reduce((result, element) => {\n              result.push(element[1]);\n              return result;\n            }, [head]);\n          },\n      peg$c2 = function() { return [] },\n      peg$c3 = function(a) {\n              a.offset = location().start.offset;\n              a.endOffset = location().end.offset;\n              return a;\n            },\n      peg$c4 = peg$otherExpectation(\"filter term\"),\n      peg$c5 = \"-\",\n      peg$c6 = peg$literalExpectation(\"-\", false),\n      peg$c7 = function(a) { a.exclude = true;  return a; },\n      peg$c8 = function(a) { a.exclude = false; return a; },\n      peg$c9 = peg$otherExpectation(\"text filter term\"),\n      peg$c10 = function(a) {\n              let type = 'ignore-case';\n              // It's hard to check for upper-case chars in JS.\n              // Best approach: https://stackoverflow.com/a/31415820/999007\n              // Simplest approach for now:\n              if (text().match(/[A-Z]/))\n                type = 'case-sensitive';\n\n              return {type: type, words: a}\n        },\n      peg$c11 = peg$otherExpectation(\"tag filter term\"),\n      peg$c12 = \":\",\n      peg$c13 = peg$literalExpectation(\":\", false),\n      peg$c14 = function(a) { return {type: 'tag', words: a} },\n      peg$c15 = peg$otherExpectation(\"property filter term\"),\n      peg$c16 = function(a, b) {\n                return {\n                  type: 'property',\n                  property: a,\n                  words: b === null ? [''] : b\n                }\n              },\n      peg$c17 = peg$otherExpectation(\"alternatives\"),\n      peg$c18 = \"|\",\n      peg$c19 = peg$literalExpectation(\"|\", false),\n      peg$c20 = function(head, tail) {\n             return tail.reduce((result, element) => {\n               result.push(element[1]);\n               return result;\n             }, [head])\n           },\n      peg$c21 = peg$otherExpectation(\"tag alternatives\"),\n      peg$c22 = peg$otherExpectation(\"string\"),\n      peg$c23 = /^[^: \\t|'\"]/,\n      peg$c24 = peg$classExpectation([\":\", \" \", \"\\t\", \"|\", \"'\", \"\\\"\"], true, false),\n      peg$c25 = function() { return text() },\n      peg$c26 = \"'\",\n      peg$c27 = peg$literalExpectation(\"'\", false),\n      peg$c28 = /^[^']/,\n      peg$c29 = peg$classExpectation([\"'\"], true, false),\n      peg$c30 = function(a) { return a.join('') },\n      peg$c31 = \"\\\"\",\n      peg$c32 = peg$literalExpectation(\"\\\"\", false),\n      peg$c33 = /^[^\"]/,\n      peg$c34 = peg$classExpectation([\"\\\"\"], true, false),\n      peg$c35 = peg$otherExpectation(\"property name\"),\n      peg$c36 = /^[^: \\t]/,\n      peg$c37 = peg$classExpectation([\":\", \" \", \"\\t\"], true, false),\n      peg$c38 = peg$otherExpectation(\"tag name\"),\n      peg$c39 = /^[a-zA-Z0-9_@]/,\n      peg$c40 = peg$classExpectation([[\"a\", \"z\"], [\"A\", \"Z\"], [\"0\", \"9\"], \"_\", \"@\"], false, false),\n      peg$c41 = peg$otherExpectation(\"whitespace\"),\n      peg$c42 = /^[ \\t]/,\n      peg$c43 = peg$classExpectation([\" \", \"\\t\"], false, false),\n\n      peg$currPos          = 0,\n      peg$savedPos         = 0,\n      peg$posDetailsCache  = [{ line: 1, column: 1 }],\n      peg$maxFailPos       = 0,\n      peg$maxFailExpected  = [],\n      peg$silentFails      = 0,\n\n      peg$result;\n\n  if (\"startRule\" in options) {\n    if (!(options.startRule in peg$startRuleFunctions)) {\n      throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n    }\n\n    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n  }\n\n  function text() {\n    return input.substring(peg$savedPos, peg$currPos);\n  }\n\n  function location() {\n    return peg$computeLocation(peg$savedPos, peg$currPos);\n  }\n\n  function expected(description, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildStructuredError(\n      [peg$otherExpectation(description)],\n      input.substring(peg$savedPos, peg$currPos),\n      location\n    );\n  }\n\n  function error(message, location) {\n    location = location !== void 0 ? location : peg$computeLocation(peg$savedPos, peg$currPos)\n\n    throw peg$buildSimpleError(message, location);\n  }\n\n  function peg$literalExpectation(text, ignoreCase) {\n    return { type: \"literal\", text: text, ignoreCase: ignoreCase };\n  }\n\n  function peg$classExpectation(parts, inverted, ignoreCase) {\n    return { type: \"class\", parts: parts, inverted: inverted, ignoreCase: ignoreCase };\n  }\n\n  function peg$anyExpectation() {\n    return { type: \"any\" };\n  }\n\n  function peg$endExpectation() {\n    return { type: \"end\" };\n  }\n\n  function peg$otherExpectation(description) {\n    return { type: \"other\", description: description };\n  }\n\n  function peg$computePosDetails(pos) {\n    var details = peg$posDetailsCache[pos], p;\n\n    if (details) {\n      return details;\n    } else {\n      p = pos - 1;\n      while (!peg$posDetailsCache[p]) {\n        p--;\n      }\n\n      details = peg$posDetailsCache[p];\n      details = {\n        line:   details.line,\n        column: details.column\n      };\n\n      while (p < pos) {\n        if (input.charCodeAt(p) === 10) {\n          details.line++;\n          details.column = 1;\n        } else {\n          details.column++;\n        }\n\n        p++;\n      }\n\n      peg$posDetailsCache[pos] = details;\n      return details;\n    }\n  }\n\n  function peg$computeLocation(startPos, endPos) {\n    var startPosDetails = peg$computePosDetails(startPos),\n        endPosDetails   = peg$computePosDetails(endPos);\n\n    return {\n      start: {\n        offset: startPos,\n        line:   startPosDetails.line,\n        column: startPosDetails.column\n      },\n      end: {\n        offset: endPos,\n        line:   endPosDetails.line,\n        column: endPosDetails.column\n      }\n    };\n  }\n\n  function peg$fail(expected) {\n    if (peg$currPos < peg$maxFailPos) { return; }\n\n    if (peg$currPos > peg$maxFailPos) {\n      peg$maxFailPos = peg$currPos;\n      peg$maxFailExpected = [];\n    }\n\n    peg$maxFailExpected.push(expected);\n  }\n\n  function peg$buildSimpleError(message, location) {\n    return new peg$SyntaxError(message, null, null, location);\n  }\n\n  function peg$buildStructuredError(expected, found, location) {\n    return new peg$SyntaxError(\n      peg$SyntaxError.buildMessage(expected, found),\n      expected,\n      found,\n      location\n    );\n  }\n\n  function peg$parseExpression() {\n    var s0, s1, s2, s3, s4, s5, s6;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    s2 = peg$parse_();\n    while (s2 !== peg$FAILED) {\n      s1.push(s2);\n      s2 = peg$parse_();\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseLocationAnnotedTerm();\n      if (s2 !== peg$FAILED) {\n        s3 = [];\n        s4 = peg$currPos;\n        s5 = [];\n        s6 = peg$parse_();\n        if (s6 !== peg$FAILED) {\n          while (s6 !== peg$FAILED) {\n            s5.push(s6);\n            s6 = peg$parse_();\n          }\n        } else {\n          s5 = peg$FAILED;\n        }\n        if (s5 !== peg$FAILED) {\n          s6 = peg$parseLocationAnnotedTerm();\n          if (s6 !== peg$FAILED) {\n            s5 = [s5, s6];\n            s4 = s5;\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s4;\n          s4 = peg$FAILED;\n        }\n        while (s4 !== peg$FAILED) {\n          s3.push(s4);\n          s4 = peg$currPos;\n          s5 = [];\n          s6 = peg$parse_();\n          if (s6 !== peg$FAILED) {\n            while (s6 !== peg$FAILED) {\n              s5.push(s6);\n              s6 = peg$parse_();\n            }\n          } else {\n            s5 = peg$FAILED;\n          }\n          if (s5 !== peg$FAILED) {\n            s6 = peg$parseLocationAnnotedTerm();\n            if (s6 !== peg$FAILED) {\n              s5 = [s5, s6];\n              s4 = s5;\n            } else {\n              peg$currPos = s4;\n              s4 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s4;\n            s4 = peg$FAILED;\n          }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = [];\n          s5 = peg$parse_();\n          while (s5 !== peg$FAILED) {\n            s4.push(s5);\n            s5 = peg$parse_();\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c1(s2, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = [];\n      s2 = peg$parse_();\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        s2 = peg$parse_();\n      }\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c2();\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c0); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseLocationAnnotedTerm() {\n    var s0, s1;\n\n    s0 = peg$currPos;\n    s1 = peg$parseTerm();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c3(s1);\n    }\n    s0 = s1;\n\n    return s0;\n  }\n\n  function peg$parseTerm() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 45) {\n      s1 = peg$c5;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c6); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePlainTerm();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c7(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      s1 = peg$parsePlainTerm();\n      if (s1 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c8(s1);\n      }\n      s0 = s1;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c4); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePlainTerm() {\n    var s0;\n\n    s0 = peg$parseTermText();\n    if (s0 === peg$FAILED) {\n      s0 = peg$parseTermProp();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parseTermTag();\n      }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermText() {\n    var s0, s1;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseStringAlternatives();\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c10(s1);\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c9); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermTag() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parseTagAlternatives();\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c14(s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c11); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTermProp() {\n    var s0, s1, s2, s3, s4;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    if (input.charCodeAt(peg$currPos) === 58) {\n      s1 = peg$c12;\n      peg$currPos++;\n    } else {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c13); }\n    }\n    if (s1 !== peg$FAILED) {\n      s2 = peg$parsePropertyName();\n      if (s2 !== peg$FAILED) {\n        if (input.charCodeAt(peg$currPos) === 58) {\n          s3 = peg$c12;\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c13); }\n        }\n        if (s3 !== peg$FAILED) {\n          s4 = peg$parseStringAlternatives();\n          if (s4 === peg$FAILED) {\n            s4 = null;\n          }\n          if (s4 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c16(s2, s4);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c15); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseStringAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseString();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c18;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c19); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseString();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c18;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c19); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseString();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c20(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c17); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagAlternatives() {\n    var s0, s1, s2, s3, s4, s5;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = peg$parseTagName();\n    if (s1 !== peg$FAILED) {\n      s2 = [];\n      s3 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 124) {\n        s4 = peg$c18;\n        peg$currPos++;\n      } else {\n        s4 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c19); }\n      }\n      if (s4 !== peg$FAILED) {\n        s5 = peg$parseTagName();\n        if (s5 !== peg$FAILED) {\n          s4 = [s4, s5];\n          s3 = s4;\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s3;\n        s3 = peg$FAILED;\n      }\n      while (s3 !== peg$FAILED) {\n        s2.push(s3);\n        s3 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 124) {\n          s4 = peg$c18;\n          peg$currPos++;\n        } else {\n          s4 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c19); }\n        }\n        if (s4 !== peg$FAILED) {\n          s5 = peg$parseTagName();\n          if (s5 !== peg$FAILED) {\n            s4 = [s4, s5];\n            s3 = s4;\n          } else {\n            peg$currPos = s3;\n            s3 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s3;\n          s3 = peg$FAILED;\n        }\n      }\n      if (s2 !== peg$FAILED) {\n        peg$savedPos = s0;\n        s1 = peg$c20(s1, s2);\n        s0 = s1;\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n    } else {\n      peg$currPos = s0;\n      s0 = peg$FAILED;\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c21); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseString() {\n    var s0, s1, s2, s3;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c23.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c24); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c23.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c24); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c25();\n    }\n    s0 = s1;\n    if (s0 === peg$FAILED) {\n      s0 = peg$currPos;\n      if (input.charCodeAt(peg$currPos) === 39) {\n        s1 = peg$c26;\n        peg$currPos++;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c27); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        if (peg$c28.test(input.charAt(peg$currPos))) {\n          s3 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s3 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c29); }\n        }\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            if (peg$c28.test(input.charAt(peg$currPos))) {\n              s3 = input.charAt(peg$currPos);\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c29); }\n            }\n          }\n        } else {\n          s2 = peg$FAILED;\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 39) {\n            s3 = peg$c26;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c27); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$savedPos = s0;\n            s1 = peg$c30(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$FAILED;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        if (input.charCodeAt(peg$currPos) === 34) {\n          s1 = peg$c31;\n          peg$currPos++;\n        } else {\n          s1 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c32); }\n        }\n        if (s1 !== peg$FAILED) {\n          s2 = [];\n          if (peg$c33.test(input.charAt(peg$currPos))) {\n            s3 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c34); }\n          }\n          if (s3 !== peg$FAILED) {\n            while (s3 !== peg$FAILED) {\n              s2.push(s3);\n              if (peg$c33.test(input.charAt(peg$currPos))) {\n                s3 = input.charAt(peg$currPos);\n                peg$currPos++;\n              } else {\n                s3 = peg$FAILED;\n                if (peg$silentFails === 0) { peg$fail(peg$c34); }\n              }\n            }\n          } else {\n            s2 = peg$FAILED;\n          }\n          if (s2 !== peg$FAILED) {\n            if (input.charCodeAt(peg$currPos) === 34) {\n              s3 = peg$c31;\n              peg$currPos++;\n            } else {\n              s3 = peg$FAILED;\n              if (peg$silentFails === 0) { peg$fail(peg$c32); }\n            }\n            if (s3 !== peg$FAILED) {\n              peg$savedPos = s0;\n              s1 = peg$c30(s2);\n              s0 = s1;\n            } else {\n              peg$currPos = s0;\n              s0 = peg$FAILED;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$FAILED;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$FAILED;\n        }\n      }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c22); }\n    }\n\n    return s0;\n  }\n\n  function peg$parsePropertyName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c36.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c37); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c36.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c37); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c25();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c35); }\n    }\n\n    return s0;\n  }\n\n  function peg$parseTagName() {\n    var s0, s1, s2;\n\n    peg$silentFails++;\n    s0 = peg$currPos;\n    s1 = [];\n    if (peg$c39.test(input.charAt(peg$currPos))) {\n      s2 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s2 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c40); }\n    }\n    if (s2 !== peg$FAILED) {\n      while (s2 !== peg$FAILED) {\n        s1.push(s2);\n        if (peg$c39.test(input.charAt(peg$currPos))) {\n          s2 = input.charAt(peg$currPos);\n          peg$currPos++;\n        } else {\n          s2 = peg$FAILED;\n          if (peg$silentFails === 0) { peg$fail(peg$c40); }\n        }\n      }\n    } else {\n      s1 = peg$FAILED;\n    }\n    if (s1 !== peg$FAILED) {\n      peg$savedPos = s0;\n      s1 = peg$c25();\n    }\n    s0 = s1;\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c38); }\n    }\n\n    return s0;\n  }\n\n  function peg$parse_() {\n    var s0, s1;\n\n    peg$silentFails++;\n    if (peg$c42.test(input.charAt(peg$currPos))) {\n      s0 = input.charAt(peg$currPos);\n      peg$currPos++;\n    } else {\n      s0 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c43); }\n    }\n    peg$silentFails--;\n    if (s0 === peg$FAILED) {\n      s1 = peg$FAILED;\n      if (peg$silentFails === 0) { peg$fail(peg$c41); }\n    }\n\n    return s0;\n  }\n\n  peg$result = peg$startRuleFunction();\n\n  if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n    return peg$result;\n  } else {\n    if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n      peg$fail(peg$endExpectation());\n    }\n\n    throw peg$buildStructuredError(\n      peg$maxFailExpected,\n      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,\n      peg$maxFailPos < input.length\n        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)\n        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)\n    );\n  }\n}\n\nmodule.exports = {\n  SyntaxError: peg$SyntaxError,\n  parse:       peg$parse\n};\n","module.exports = __webpack_public_path__ + \"static/media/dropbox.b53eaec4.svg\";","module.exports = __webpack_public_path__ + \"static/media/google_drive.f5fd3e02.png\";","import { displayFile, stopDisplayingFile } from './org';\n\nimport raw from 'raw.macro';\n\nexport const setLoadingMessage = loadingMessage => ({\n  type: 'SET_LOADING_MESSAGE',\n  loadingMessage,\n});\n\nexport const hideLoadingMessage = () => ({\n  type: 'HIDE_LOADING_MESSAGE',\n});\n\nexport const setIsLoading = isLoading => ({\n  type: 'SET_IS_LOADING',\n  isLoading,\n});\n\nexport const setDisappearingLoadingMessage = (loadingMessage, delay) => dispatch => {\n  dispatch(setLoadingMessage(loadingMessage));\n  setTimeout(() => dispatch(hideLoadingMessage()), delay);\n};\n\nexport const setLastViewedFile = (lastViewedPath, lastViewedContents) => ({\n  type: 'SET_LAST_VIEWED_FILE',\n  lastViewedPath,\n  lastViewedContents,\n});\n\nexport const loadStaticFile = staticFile => {\n  return (dispatch, getState) => {\n    dispatch(\n      setLastViewedFile(getState().org.present.get('path'), getState().org.present.get('contents'))\n    );\n\n    const fileContents = {\n      changelog: raw('../../changelog.org'),\n      sample: raw('../../sample.org'),\n    }[staticFile];\n\n    dispatch(displayFile(null, fileContents));\n  };\n};\n\nexport const unloadStaticFile = () => {\n  return (dispatch, getState) => {\n    dispatch(stopDisplayingFile());\n\n    if (!!getState().base.get('lastViewedPath')) {\n      dispatch(\n        displayFile(\n          getState().base.get('lastViewedPath'),\n          getState().base.get('lastViewedContents')\n        )\n      );\n    }\n  };\n};\n\nexport const setFontSize = newFontSize => ({\n  type: 'SET_FONT_SIZE',\n  newFontSize,\n});\n\nexport const setBulletStyle = newBulletStyle => ({\n  type: 'SET_BULLET_STYLE',\n  newBulletStyle,\n});\n\nexport const setShouldTapTodoToAdvance = newShouldTapTodoToAdvance => ({\n  type: 'SET_SHOULD_TAP_TODO_TO_ADVANCE',\n  newShouldTapTodoToAdvance,\n});\n\nexport const setShouldDoubleTapToEdit = newShouldDoubleTapToEdit => ({\n  type: 'SET_SHOULD_DOUBLE_TAP_TO_EDIT',\n  newShouldDoubleTapToEdit,\n});\n\nexport const setAgendaDefaultDeadlineDelayUnit = newAgendaDefaultDeadlineDelayUnit => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT',\n  newAgendaDefaultDeadlineDelayUnit,\n});\n\nexport const setAgendaDefaultDeadlineDelayValue = newAgendaDefaultDeadlineDelayValue => ({\n  type: 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE',\n  newAgendaDefaultDeadlineDelayValue,\n});\n\nexport const setShouldLiveSync = shouldLiveSync => ({\n  type: 'SET_SHOULD_LIVE_SYNC',\n  shouldLiveSync,\n});\n\nexport const setShouldSyncOnBecomingVisibile = shouldSyncOnBecomingVisibile => ({\n  type: 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE',\n  shouldSyncOnBecomingVisibile,\n});\n\nexport const setShouldShowTitleInOrgFile = shouldShowTitleInOrgFile => ({\n  type: 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE',\n  shouldShowTitleInOrgFile,\n});\n\nexport const setShouldStoreSettingsInSyncBackend = newShouldStoreSettingsInSyncBackend => {\n  return (dispatch, getState) => {\n    dispatch({\n      type: 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND',\n      newShouldStoreSettingsInSyncBackend,\n    });\n\n    if (!newShouldStoreSettingsInSyncBackend) {\n      const client = getState().syncBackend.get('client');\n      switch (client.type) {\n        case 'Dropbox':\n        case 'WebDAV':\n          client\n            .deleteFile('/.organice-config.json')\n            .catch((doesFileNotExist, error) =>\n              doesFileNotExist\n                ? null\n                : alert(\n                    `There was an error trying to delete the .organice-config.json file: ${error}`\n                  )\n            );\n          break;\n        case 'Google Drive':\n          client.deleteFileByNameAndParent('.organice-config.json', 'root');\n          break;\n        default:\n      }\n\n      window.previousSettingsFileContents = null;\n    }\n  };\n};\n\nexport const setHasUnseenChangelog = newHasUnseenChangelog => ({\n  type: 'SET_HAS_UNSEEN_CHANGELOG',\n  newHasUnseenChangelog,\n});\n\nexport const setLastSeenChangelogHeader = newLastSeenChangelogHash => ({\n  type: 'SET_LAST_SEEN_CHANGELOG_HEADER',\n  newLastSeenChangelogHash,\n});\n\nexport const setCustomKeybinding = (keybindingName, keybinding) => ({\n  type: 'SET_CUSTOM_KEYBINDING',\n  keybindingName,\n  keybinding,\n});\n\nexport const restoreBaseSettings = newSettings => ({\n  type: 'RESTORE_BASE_SETTINGS',\n  newSettings,\n});\n\nexport const pushModalPage = modalPage => ({\n  type: 'PUSH_MODAL_PAGE',\n  modalPage,\n});\n\nexport const popModalPage = () => ({\n  type: 'POP_MODAL_PAGE',\n});\n\nexport const clearModalStack = () => ({\n  type: 'CLEAR_MODAL_STACK',\n});\n\nexport const activatePopup = (popupType, data) => ({\n  type: 'ACTIVATE_POPUP',\n  popupType,\n  data,\n});\n\nexport const closePopup = () => ({\n  type: 'CLOSE_POPUP',\n});\n","import {\n  format,\n  parse,\n  addHours,\n  addDays,\n  addWeeks,\n  addMonths,\n  addYears,\n  subHours,\n  subDays,\n  subWeeks,\n  subMonths,\n  subYears,\n  isBefore,\n  differenceInMinutes,\n} from 'date-fns';\n\nexport const renderAsText = timestamp => {\n  const {\n    isActive,\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  } = timestamp.toJS();\n\n  let timestampText = '';\n  timestampText += isActive ? '<' : '[';\n  timestampText += `${year}-${month}-${day}`;\n  timestampText += !!dayName ? ` ${dayName}` : '';\n  timestampText += !!startHour ? ` ${startHour}:${startMinute}` : '';\n  timestampText += !!endHour ? `-${endHour}:${endMinute}` : '';\n  timestampText += !!repeaterType ? ` ${repeaterType}${repeaterValue}${repeaterUnit}` : '';\n  timestampText += !!delayType ? ` ${delayType}${delayValue}${delayUnit}` : '';\n  timestampText += isActive ? '>' : ']';\n\n  return timestampText;\n};\n\nexport const getCurrentTimestamp = ({ isActive = true, withStartTime = false } = {}) => {\n  const time = new Date();\n\n  const timestamp = {\n    isActive,\n    year: format(time, 'yyyy'),\n    month: format(time, 'MM'),\n    day: format(time, 'dd'),\n    dayName: format(time, 'eee'),\n    startHour: null,\n    startMinute: null,\n    endHour: null,\n    endMinute: null,\n    repeaterType: null,\n    repeaterValue: null,\n    repeaterUnit: null,\n    delayType: null,\n    delayValue: null,\n    delayUnit: null,\n  };\n\n  if (withStartTime) {\n    timestamp.startHour = format(time, 'HH');\n    timestamp.startMinute = format(time, 'mm');\n  }\n\n  return timestamp;\n};\n\nexport const getCurrentTimestampAsText = () => `<${format(new Date(), 'yyyy-MM-dd eee')}>`;\n\nexport const dateForTimestamp = timestamp => {\n  const { year, month, day, startHour, startMinute } = timestamp.toJS();\n\n  let timestampString = `${year}-${month}-${day}`;\n  if (startHour && startMinute) {\n    timestampString += ` ${startHour.padStart(2, '0')}:${startMinute}`;\n  } else {\n    timestampString += ' 12:00';\n  }\n  return parse(timestampString, 'yyyy-MM-dd HH:mm', new Date());\n};\n\nexport const addTimestampUnitToDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: addHours(date, numUnits),\n    d: addDays(date, numUnits),\n    w: addWeeks(date, numUnits),\n    m: addMonths(date, numUnits),\n    y: addYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const subtractTimestampUnitFromDate = (date, numUnits, timestampUnit) =>\n  ({\n    h: subHours(date, numUnits),\n    d: subDays(date, numUnits),\n    w: subWeeks(date, numUnits),\n    m: subMonths(date, numUnits),\n    y: subYears(date, numUnits),\n  }[timestampUnit]);\n\nexport const applyRepeater = (timestamp, currentDate) => {\n  if (!timestamp.get('repeaterType')) {\n    return timestamp;\n  }\n\n  let newDate = null;\n  switch (timestamp.get('repeaterType')) {\n    case '+':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    case '++':\n      newDate = addTimestampUnitToDate(\n        dateForTimestamp(timestamp),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      while (isBefore(newDate, currentDate)) {\n        newDate = addTimestampUnitToDate(\n          newDate,\n          timestamp.get('repeaterValue'),\n          timestamp.get('repeaterUnit')\n        );\n      }\n      break;\n    case '.+':\n      newDate = addTimestampUnitToDate(\n        new Date(),\n        timestamp.get('repeaterValue'),\n        timestamp.get('repeaterUnit')\n      );\n      break;\n    default:\n      console.error(`Unrecognized timestamp repeater type: ${timestamp.get('repeaterType')}`);\n      return timestamp;\n  }\n\n  timestamp = timestamp\n    .set('day', format(newDate, 'dd'))\n    .set('dayName', format(newDate, 'eee'))\n    .set('month', format(newDate, 'MM'))\n    .set('year', format(newDate, 'yyyy'));\n\n  if (timestamp.get('startHour') !== undefined && timestamp.get('startHour') !== null) {\n    timestamp = timestamp\n      .set('startHour', format(newDate, 'HH'))\n      .set('startMinute', format(newDate, 'mm'));\n  }\n\n  return timestamp;\n};\n\nexport const timestampDuration = (startTimestamp, endTimestamp) => {\n  let [start, end] = [startTimestamp, endTimestamp].map(dateForTimestamp);\n  let pad = ' ';\n  if (start > end) {\n    pad = '-';\n    [start, end] = [end, start];\n  }\n  const minDiff = differenceInMinutes(end, start);\n  const hours = Math.floor(minDiff / 60);\n  if (hours >= 10) {\n    pad = '';\n  }\n  const minutes = minDiff % 60;\n  const minutesText = minutes >= 10 ? minutes : `0${minutes}`;\n  return `${pad}${hours}:${minutesText}`;\n};\n","import _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nimport { renderAsText, timestampDuration } from './timestamps';\n\nconst linkPartToRawText = linkPart => {\n  if (!!linkPart.getIn(['contents', 'title'])) {\n    return `[[${linkPart.getIn(['contents', 'uri'])}][${linkPart.getIn(['contents', 'title'])}]]`;\n  } else {\n    return `[[${linkPart.getIn(['contents', 'uri'])}]]`;\n  }\n};\n\nconst formattedAttributedStringText = parts => {\n  return parts\n    .map(part => {\n      switch (part.get('type')) {\n        case 'text':\n          return part.get('contents');\n        case 'link':\n          if (part.getIn(['contents', 'title'])) {\n            return part.getIn(['contents', 'title']);\n          } else {\n            return part.getIn(['contents', 'uri']);\n          }\n        case 'table':\n          return '';\n        default:\n          return '';\n      }\n    })\n    .join('');\n};\n\nconst tablePartToRawText = tablePart => {\n  const rowHeights = tablePart\n    .get('contents')\n    .map(row =>\n      Math.max(\n        ...row.get('contents').map(cell => (_.countBy(cell.get('rawContents'))['\\n'] || 0) + 1)\n      )\n    )\n    .toJS();\n\n  const numColumns = tablePart.getIn(['contents', 0, 'contents']).size;\n  const columnWidths = _.times(numColumns).map(columnIndex =>\n    Math.max(\n      ...tablePart.get('contents').map(row => {\n        const content = row.getIn(['contents', columnIndex, 'contents']);\n        const formattedText = formattedAttributedStringText(content);\n        const lineLengths = formattedText.split('\\n').map(line => line.trim().length);\n        return Math.max(...lineLengths);\n      })\n    )\n  );\n\n  const rowStrings = _.dropRight(\n    _.flatten(\n      tablePart\n        .get('contents')\n        .map((row, rowIndex) => {\n          const rowHeight = rowHeights[rowIndex];\n\n          const contentRows = _.times(rowHeight)\n            .map(lineIndex =>\n              row\n                .get('contents')\n                .map((cell, columnIndex) => {\n                  const content = cell.get('contents');\n                  const formattedText = formattedAttributedStringText(content);\n                  const formattedLineLengths = formattedText\n                    .split('\\n')\n                    .map(line => line.trim().length);\n                  const line = (cell.get('rawContents').split('\\n')[lineIndex] || '').trim();\n\n                  const padCount = columnWidths[columnIndex] - formattedLineLengths[lineIndex];\n\n                  return line + ' '.repeat(padCount);\n                })\n                .toJS()\n                .join(' | ')\n            )\n            .map(contentRow => `| ${contentRow} |`);\n\n          const separator =\n            '|' + columnWidths.map(columnWidth => '-'.repeat(columnWidth + 2)).join('+') + '|';\n\n          return contentRows.concat(separator);\n        })\n        .toJS()\n    )\n  );\n\n  return rowStrings.join('\\n');\n};\n\nconst listPartToRawText = listPart => {\n  const bulletCharacter = listPart.get('bulletCharacter');\n\n  let previousNumber = 0;\n  return listPart\n    .get('items')\n    .map(item => {\n      const optionalLeadingSpace = !listPart.get('isOrdered') && bulletCharacter === '*' ? ' ' : '';\n\n      const titleText = attributedStringToRawText(item.get('titleLine'));\n\n      const contentText = attributedStringToRawText(item.get('contents'));\n      const indentedContentText = contentText\n        .split('\\n')\n        .map(line => (!!line.trim() ? `${optionalLeadingSpace}  ${line}` : ''))\n        .join('\\n');\n\n      let listItemText = null;\n      if (listPart.get('isOrdered')) {\n        let number = ++previousNumber;\n        let forceNumber = item.get('forceNumber');\n        if (!!forceNumber) {\n          number = forceNumber;\n          previousNumber = number;\n        }\n\n        listItemText = `${number}${listPart.get('numberTerminatorCharacter')}`;\n\n        if (!!forceNumber) {\n          listItemText += ` [@${forceNumber}]`;\n        }\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      } else {\n        listItemText = `${optionalLeadingSpace}${bulletCharacter}`;\n\n        if (item.get('isCheckbox')) {\n          const stateCharacter = {\n            checked: 'X',\n            unchecked: ' ',\n            partial: '-',\n          }[item.get('checkboxState')];\n\n          listItemText += ` [${stateCharacter}]`;\n        }\n\n        listItemText += ` ${titleText}`;\n      }\n\n      if (!!contentText) {\n        listItemText += `\\n${indentedContentText}`;\n      }\n\n      return listItemText;\n    })\n    .join('\\n');\n};\n\nconst timestampPartToRawText = part => {\n  let text = renderAsText(part.get('firstTimestamp'));\n  if (part.get('secondTimestamp')) {\n    text += `--${renderAsText(part.get('secondTimestamp'))}`;\n  }\n\n  return text;\n};\n\nexport const attributedStringToRawText = parts => {\n  if (!parts) {\n    return '';\n  }\n\n  const prevPartTypes = parts.map(part => part.get('type')).unshift(null);\n\n  return parts\n    .zip(prevPartTypes)\n    .map(([part, prevPartType]) => {\n      let text = '';\n      switch (part.get('type')) {\n        case 'text':\n          text = part.get('contents');\n          break;\n        case 'link':\n          text = linkPartToRawText(part);\n          break;\n        case 'fraction-cookie':\n          text = `[${part.getIn(['fraction', 0]) || ''}/${part.getIn(['fraction', 1]) || ''}]`;\n          break;\n        case 'percentage-cookie':\n          text = `[${part.get('percentage') || ''}%]`;\n          break;\n        case 'table':\n          text = tablePartToRawText(part);\n          break;\n        case 'list':\n          text = listPartToRawText(part);\n          break;\n        case 'timestamp':\n          text = timestampPartToRawText(part);\n          break;\n        case 'url':\n        case 'www-url':\n        case 'e-mail':\n        case 'phone-number':\n          text = part.get('content');\n          break;\n        default:\n          console.error(\n            `Unknown attributed string part type in attributedStringToRawText: ${part.get('type')}`\n          );\n      }\n\n      const optionalNewlinePrefix = ['list', 'table'].includes(prevPartType) ? '\\n' : '';\n      return optionalNewlinePrefix + text;\n    })\n    .join('');\n};\n\n// Takes a plain JS object\nexport const generateTitleLine = (header, includeStars) => {\n  let contents = '';\n  if (includeStars) contents += '*'.repeat(header.nestingLevel);\n\n  if (header.titleLine.todoKeyword) {\n    contents += ` ${header.titleLine.todoKeyword}`;\n  }\n  contents += ` ${header.titleLine.rawTitle}`;\n\n  if (header.titleLine.tags.length) {\n    contents += `:${header.titleLine.tags.filter(tag => !!tag).join(':')}:`;\n  }\n\n  if (!includeStars) contents = contents.substring(1);\n  return contents;\n};\n\nexport default (headers, todoKeywordSets, fileConfigLines, linesBeforeHeadings) => {\n  let configContent = '';\n\n  if (fileConfigLines.size > 0) {\n    configContent = fileConfigLines.join('\\n') + '\\n';\n  }\n\n  if (!todoKeywordSets.get(0).get('default')) {\n    configContent =\n      configContent +\n      todoKeywordSets\n        .map(todoKeywordSet => {\n          return todoKeywordSet.get('configLine');\n        })\n        .join('\\n') +\n      '\\n';\n  }\n\n  if (linesBeforeHeadings.size > 0) {\n    configContent = configContent + linesBeforeHeadings.join('\\n');\n  }\n\n  if (configContent.length > 0) {\n    configContent = configContent + '\\n';\n  }\n\n  const headerContent = headers\n    .toJS()\n    .map(header => {\n      // Pad things like planning items and tables appropriately\n      // considering the nestingLevel of the header.\n      const indentation = ' '.repeat(header.nestingLevel + 1);\n      let contents = generateTitleLine(header, true);\n\n      if (header.planningItems.length) {\n        const planningItemsContent = header.planningItems\n          .map(planningItem => {\n            return `${planningItem.type}: ${renderAsText(fromJS(planningItem.timestamp))}`;\n          })\n          .join(' ')\n          .trimRight();\n        contents += `\\n${indentation}${planningItemsContent}`;\n      }\n\n      if (header.propertyListItems.length) {\n        const propertyListItemsContent = header.propertyListItems\n          .map(propertyListItem => {\n            return `${indentation}:${propertyListItem.property}: ${attributedStringToRawText(\n              fromJS(propertyListItem.value)\n            )}`;\n          })\n          .join('\\n');\n        contents += `\\n${indentation}:PROPERTIES:`;\n        contents += `\\n${propertyListItemsContent}`;\n        contents += `\\n${indentation}:END:\\n`;\n      }\n\n      if (header.logBookEntries.length) {\n        const logBookEntriesContent = header.logBookEntries\n          .map(entry => {\n            if (entry.raw !== undefined) {\n              return entry.raw ? `${indentation}${entry.raw}` : '';\n            } else if (entry.end === null) {\n              return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}`;\n            } else {\n              return `${indentation}CLOCK: ${renderAsText(fromJS(entry.start))}--${renderAsText(\n                fromJS(entry.end)\n              )} => ${timestampDuration(fromJS(entry.start), fromJS(entry.end))}`;\n            }\n          })\n          .join('\\n')\n          .trimRight();\n        contents += `\\n${indentation}:LOGBOOK:`;\n        contents += `\\n${logBookEntriesContent}`;\n        contents += `\\n${indentation}:END:\\n`;\n      }\n\n      if (header.description.length > 0) {\n        if (!header.rawDescription.startsWith('\\n') && header.rawDescription.length !== 0) {\n          contents += '\\n';\n        }\n        contents += header.rawDescription;\n      } else {\n        contents = contents.trimRight();\n      }\n\n      return contents;\n    })\n    .join('\\n');\n\n  return configContent + headerContent + (headerContent.endsWith('\\n') ? '' : '\\n');\n};\n","import { Map } from 'immutable';\nimport format from 'date-fns/format';\nimport _ from 'lodash';\n\nexport default (templateString, customVariables = Map()) => {\n  if (!templateString) {\n    return ['', null];\n  }\n\n  const substitutions = {\n    '%t': `<${format(new Date(), 'yyyy-MM-dd eee')}>`,\n    '%T': `<${format(new Date(), 'yyyy-MM-dd eee HH:mm')}>`,\n    '%u': `[${format(new Date(), 'yyyy-MM-dd eee')}]`,\n    '%U': `[${format(new Date(), 'yyyy-MM-dd eee HH:mm')}]`,\n  };\n\n  customVariables.entrySeq().forEach(([key, value]) => {\n    substitutions[`%${key}`] = value;\n  });\n\n  let substitutedString = templateString;\n  _.entries(substitutions).forEach(\n    ([formatString, value]) =>\n      (substitutedString = substitutedString.replace(RegExp(formatString, 'g'), value))\n  );\n\n  const cursorIndex = substitutedString.includes('%?') ? substitutedString.indexOf('%?') : null;\n  substitutedString = substitutedString.replace(/%\\?/, '');\n\n  return [substitutedString, cursorIndex];\n};\n","export default (() => {\n  let nextId = 1;\n  return () => nextId++;\n})();\n","import { List, fromJS } from 'immutable';\nimport _ from 'lodash';\nimport raw from 'raw.macro';\nimport { formatDistanceToNow } from 'date-fns';\n\nimport generateId from './id_generator';\nimport { attributedStringToRawText } from './export_org';\n\nfunction generateHash(list) {\n  return new Promise((resolve, reject) => {\n    crypto.subtle\n      .digest(\n        {\n          name: 'SHA-256',\n        },\n        new Uint8Array(list)\n      )\n      .then(hashArray => {\n        resolve(_.values(new Uint8Array(hashArray)).join(''));\n      });\n  });\n}\n\nexport const changelogHash = () => {\n  return new Promise((resolve, reject) => {\n    const changelogFile = raw('../../changelog.org');\n\n    generateHash(changelogFile.split('').map(c => c.charCodeAt(0))).then(hash => {\n      resolve(hash);\n    });\n  });\n};\n\nexport const indexOfHeaderWithId = (headers, headerId) => {\n  return headers.findIndex(header => header.get('id') === headerId);\n};\n\nexport const headerWithId = (headers, headerId) => {\n  return headers.get(indexOfHeaderWithId(headers, headerId));\n};\n\nexport const subheadersOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const afterHeaders = headers.slice(headerIndex + 1);\n  const nextSiblingHeaderIndex = afterHeaders.findIndex(siblingHeader => {\n    return siblingHeader.get('nestingLevel') <= header.get('nestingLevel');\n  });\n\n  if (nextSiblingHeaderIndex === -1) {\n    return afterHeaders;\n  } else {\n    return afterHeaders.slice(0, nextSiblingHeaderIndex);\n  }\n};\n\nexport const numSubheadersOfHeaderWithId = (headers, headerId) =>\n  subheadersOfHeaderWithId(headers, headerId).size;\n\nexport const directParentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const previousHeader = headers.get(i);\n\n    if (previousHeader.get('nestingLevel') === header.get('nestingLevel') - 1) {\n      return previousHeader.get('id');\n    }\n\n    if (previousHeader.get('nestingLevel') < header.get('nestingLevel')) {\n      return null;\n    }\n  }\n\n  return null;\n};\n\nexport const parentIdOfHeaderWithId = (headers, headerId) => {\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  const parentHeader = previousHeaders.find(\n    previousHeader => previousHeader.get('nestingLevel') < header.get('nestingLevel')\n  );\n\n  if (!parentHeader) {\n    return null;\n  }\n\n  return parentHeader.get('id');\n};\n\nexport const inheritedValueOfProperty = (headers, headerIndex, property) => {\n  const headerProp = headers\n    .getIn([headerIndex, 'propertyListItems'])\n    .find(item => item.get('property') === property);\n  if (headerProp) {\n    return headerProp.get('value');\n  }\n  const parentId = parentIdOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  if (parentId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentId);\n    return inheritedValueOfProperty(headers, parentHeaderIndex, property);\n  }\n  return null;\n};\n\nexport const indexOfPreviousSibling = (headers, headerIndex) => {\n  const nestingLevel = headers.getIn([headerIndex, 'nestingLevel']);\n\n  for (let i = headerIndex - 1; i >= 0; --i) {\n    const header = headers.get(i);\n\n    if (header.get('nestingLevel') < nestingLevel) {\n      return null;\n    }\n\n    if (header.get('nestingLevel') === nestingLevel) {\n      return i;\n    }\n  }\n\n  return null;\n};\n\nconst isHeaderVisible = (headers, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  if (!parentHeaderId) {\n    return true;\n  }\n\n  const parentHeader = headerWithId(headers, parentHeaderId);\n  return parentHeader.get('opened') && isHeaderVisible(headers, parentHeader.get('id'));\n};\n\nexport const nextVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const followingHeaders = headers.slice(headerIndex + 1);\n  return followingHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const previousVisibleHeaderAfterIndex = (headers, headerIndex) => {\n  const previousHeaders = headers.slice(0, headerIndex).reverse();\n  return previousHeaders.find(header => isHeaderVisible(headers, header.get('id')));\n};\n\nexport const openDirectParent = (state, headerId) => {\n  const parentHeaderId = directParentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (parentHeaderId !== null) {\n    const parentHeaderIndex = indexOfHeaderWithId(state.get('headers'), parentHeaderId);\n    state = state.setIn(['headers', parentHeaderIndex, 'opened'], true);\n  }\n\n  return state;\n};\n\nexport const getOpenHeaderPaths = headers => {\n  let openedHeaders = [];\n  for (let i = 0; i < headers.size; ++i) {\n    const header = headers.get(i);\n    if (!header.get('opened')) {\n      continue;\n    }\n\n    const title = header.getIn(['titleLine', 'rawTitle']);\n\n    const subheaders = subheadersOfHeaderWithId(headers, header.get('id'));\n    const openSubheaderPaths = getOpenHeaderPaths(subheaders);\n\n    if (openSubheaderPaths.length > 0) {\n      openSubheaderPaths.forEach(openedSubheaderPath => {\n        openedHeaders.push([title].concat(openedSubheaderPath));\n      });\n    } else {\n      openedHeaders.push([title]);\n    }\n\n    i += subheaders.size;\n  }\n\n  return openedHeaders;\n};\n\nexport const headerWithPath = (headers, headerPath) => {\n  if (headerPath.size === 0) {\n    return null;\n  }\n\n  const firstHeader = headers.find(\n    header =>\n      parentIdOfHeaderWithId(headers, header.get('id')) === null &&\n      header.getIn(['titleLine', 'rawTitle']).trim() === headerPath.first().trim()\n  );\n  if (!firstHeader) {\n    return null;\n  }\n\n  if (headerPath.size === 1) {\n    return firstHeader;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, firstHeader.get('id'));\n  return headerWithPath(subheaders, headerPath.rest());\n};\n\nexport const openHeaderWithPath = (headers, headerPath, maxNestingLevel = 1) => {\n  if (headerPath.size === 0) {\n    return headers;\n  }\n\n  const firstTitle = headerPath.first();\n  const headerIndex = headers.findIndex(header => {\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    const nestingLevel = header.get('nestingLevel');\n    return rawTitle === firstTitle && nestingLevel <= maxNestingLevel;\n  });\n  if (headerIndex === -1) {\n    return headers;\n  }\n\n  headers = headers.update(headerIndex, header => header.set('opened', true));\n\n  let subheaders = subheadersOfHeaderWithId(headers, headers.getIn([headerIndex, 'id']));\n  subheaders = openHeaderWithPath(subheaders, headerPath.rest(), maxNestingLevel + 1);\n\n  headers = headers\n    .take(headerIndex + 1)\n    .concat(subheaders)\n    .concat(headers.takeLast(headers.size - (headerIndex + 1 + subheaders.size)));\n\n  return headers;\n};\n\nconst tablePartContainsCellId = (tablePart, cellId) =>\n  tablePart\n    .get('contents')\n    .some(row => row.get('contents').some(cell => cell.get('id') === cellId));\n\nconst doesAttributedStringContainTableCellId = (parts, cellId) =>\n  parts\n    .filter(part => ['table', 'list'].includes(part.get('type')))\n    .some(part =>\n      part.get('type') === 'table'\n        ? tablePartContainsCellId(part, cellId)\n        : part\n            .get('items')\n            .some(item => doesAttributedStringContainTableCellId(item.get('contents'), cellId))\n    );\n\nexport const headerThatContainsTableCellId = (headers, cellId) =>\n  headers.find(header => doesAttributedStringContainTableCellId(header.get('description'), cellId));\n\nexport const pathAndPartOfTimestampItemWithIdInAttributedString = (parts, timestampId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'timestamp' && part.get('id') === timestampId) {\n        return {\n          path: [partIndex],\n          timestampPart: part,\n        };\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n              item.get('contents'),\n              timestampId\n            );\n            if (!!pathAndPart) {\n              const { path, timestampPart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                timestampPart,\n              };\n            } else {\n              let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                item.get('titleLine'),\n                timestampId\n              );\n              if (!!pathAndPart) {\n                const { path, timestampPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'titleLine'].concat(path),\n                  timestampPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else if (part.get('type') === 'table') {\n        return part\n          .get('contents')\n          .map((row, rowIndex) => {\n            return row\n              .get('contents')\n              .map((cell, cellIndex) => {\n                const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n                  cell.get('contents'),\n                  timestampId\n                );\n                if (!!pathAndPart) {\n                  const { path, timestampPart } = pathAndPart;\n                  return {\n                    path: [\n                      partIndex,\n                      'contents',\n                      rowIndex,\n                      'contents',\n                      cellIndex,\n                      'contents',\n                    ].concat(path),\n                    timestampPart,\n                  };\n                } else {\n                  return null;\n                }\n              })\n              .filter(result => !!result)\n              .first();\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListItemWithIdInAttributedString = (parts, listItemId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            if (item.get('id') === listItemId) {\n              return {\n                path: [partIndex, 'items', itemIndex],\n                listItemPart: item,\n              };\n            } else {\n              const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n                item.get('contents'),\n                listItemId\n              );\n              if (!!pathAndPart) {\n                const { path, listItemPart } = pathAndPart;\n                return {\n                  path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                  listItemPart,\n                };\n              } else {\n                return null;\n              }\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInAttributedString = (parts, cellId) =>\n  parts\n    .map((part, partIndex) => {\n      if (part.get('type') === 'table') {\n        if (tablePartContainsCellId(part, cellId)) {\n          return { path: [partIndex], tablePart: part };\n        } else {\n          return null;\n        }\n      } else if (part.get('type') === 'list') {\n        return part\n          .get('items')\n          .map((item, itemIndex) => {\n            const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n              item.get('contents'),\n              cellId\n            );\n            if (!!pathAndPart) {\n              const { path, tablePart } = pathAndPart;\n              return {\n                path: [partIndex, 'items', itemIndex, 'contents'].concat(path),\n                tablePart,\n              };\n            } else {\n              return null;\n            }\n          })\n          .filter(result => !!result)\n          .first();\n      } else {\n        return null;\n      }\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTimestampItemWithIdInHeaders = (headers, timestampId) =>\n  headers\n    .map((header, headerIndex) => {\n      let pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.getIn(['titleLine', 'title']),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'titleLine', 'title'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n        header.get('description'),\n        timestampId\n      );\n      if (!!pathAndPart) {\n        const { path, timestampPart } = pathAndPart;\n        return {\n          path: [headerIndex, 'description'].concat(path),\n          timestampPart,\n        };\n      }\n\n      pathAndPart = header\n        .get('propertyListItems')\n        .map((propertyListItem, propertyListItemIndex) => {\n          if (!propertyListItem.get('value')) {\n            return null;\n          }\n\n          const plistPathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(\n            propertyListItem.get('value'),\n            timestampId\n          );\n          if (!!plistPathAndPart) {\n            const { path, timestampPart } = plistPathAndPart;\n            return {\n              path: [headerIndex, 'propertyListItems', propertyListItemIndex, 'value'].concat(path),\n              timestampPart,\n            };\n          }\n\n          return null;\n        })\n        .filter(result => !!result)\n        .first();\n      if (!!pathAndPart) {\n        return pathAndPart;\n      }\n\n      return null;\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfListItemWithIdInHeaders = (headers, listItemId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfListItemWithIdInAttributedString(\n        header.get('description'),\n        listItemId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, listItemPart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        listItemPart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const pathAndPartOfTableContainingCellIdInHeaders = (headers, cellId) =>\n  headers\n    .map((header, headerIndex) => {\n      const pathAndPart = pathAndPartOfTableContainingCellIdInAttributedString(\n        header.get('description'),\n        cellId\n      );\n      if (!pathAndPart) {\n        return null;\n      }\n\n      const { path, tablePart } = pathAndPart;\n      return {\n        path: [headerIndex, 'description'].concat(path),\n        tablePart,\n      };\n    })\n    .filter(result => !!result)\n    .first();\n\nexport const updateTableContainingCellId = (headers, cellId, updaterCallbackGenerator) => {\n  const { path, tablePart } = pathAndPartOfTableContainingCellIdInHeaders(headers, cellId);\n\n  const rowIndexContainingCellId = tablePart\n    .get('contents')\n    .findIndex(row => row.get('contents').some(cell => cell.get('id') === cellId));\n  const columnIndexContainingCellId = tablePart\n    .getIn(['contents', rowIndexContainingCellId, 'contents'])\n    .findIndex(cell => cell.get('id') === cellId);\n\n  return headers.updateIn(\n    path.concat(['contents']),\n    updaterCallbackGenerator(rowIndexContainingCellId, columnIndexContainingCellId)\n  );\n};\n\nexport const newEmptyTableRowLikeRows = rows =>\n  rows\n    .get(0)\n    .set('id', generateId())\n    .update('contents', contents =>\n      contents.map(cell =>\n        cell\n          .set('id', generateId())\n          .set('contents', List())\n          .set('rawContents', '')\n      )\n    );\n\nexport const newEmptyTableCell = () =>\n  fromJS({\n    id: generateId(),\n    contents: [],\n    rawContents: '',\n  });\n\nexport const timestampWithIdInAttributedString = (parts, timestampId) => {\n  if (!parts) {\n    return null;\n  }\n\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInAttributedString(parts, timestampId);\n  if (!!pathAndPart) {\n    return pathAndPart.timestampPart;\n  } else {\n    return null;\n  }\n};\n\nexport const timestampWithId = (headers, timestampId) =>\n  headers\n    .map(\n      header =>\n        timestampWithIdInAttributedString(header.getIn(['titleLine', 'title']), timestampId) ||\n        timestampWithIdInAttributedString(header.get('description'), timestampId) ||\n        header\n          .get('propertyListItems')\n          .map(propertyListItem =>\n            timestampWithIdInAttributedString(propertyListItem.get('value'), timestampId)\n          )\n          .filter(result => !!result)\n          .first()\n    )\n    .find(result => !!result);\n\nexport const customFormatDistanceToNow = datetime => {\n  return formatDistanceToNow(datetime, { addSuffix: true });\n};\n\nexport const todoKeywordSetForKeyword = (todoKeywordSets, keyword) =>\n  todoKeywordSets.find(keywordSet => keywordSet.get('keywords').contains(keyword)) ||\n  todoKeywordSets.first();\n\nexport const isTodoKeywordCompleted = (todoKeywordSets, keyword) =>\n  todoKeywordSetForKeyword(todoKeywordSets, keyword)\n    .get('completedKeywords')\n    .includes(keyword);\n\nexport const extractAllOrgTags = headers =>\n  headers\n    .flatMap(h => h.getIn(['titleLine', 'tags']))\n    .toSet()\n    .sort();\n\nexport const extractAllOrgProperties = headers =>\n  headers\n    .map(h => {\n      const propertyList = h.get('propertyListItems');\n      return propertyList.map(property => {\n        const prop = property.get('property');\n        const valParts = property.get('value'); // lineParts, see parser\n        const val = attributedStringToRawText(valParts);\n        return [prop, val];\n      });\n    })\n    .filter(x => !x.isEmpty())\n    .flatten();\n\nexport const computeAllPropertyNames = allOrgProperties =>\n  allOrgProperties\n    .map(([x]) => x)\n    .toSet()\n    .sort();\n\nexport const computeAllPropertyValuesFor = (allOrgProperties, propertyName) =>\n  // toLowerCase() because property names (keys) are case-insensitive:\n  // https://orgmode.org/manual/Property-Syntax.html\n  allOrgProperties\n    .filter(([x]) => x.toLowerCase() === propertyName.toLowerCase())\n    .map(([_, y]) => y)\n    .toSet()\n    .sort();\n\n/**\n * Returns a function which takes a `todoKeyword` which then returns\n * if said `todoKeyword` is in any `todoKeywordSets` states.\n * @param {Object} todoKeywordSets\n */\nexport const createIsTodoKeywordInDoneState = todoKeywordSets => {\n  return todoKeyword => todoKeywordSets.some(x => x.get('completedKeywords').includes(todoKeyword));\n};\n\nexport const getTodoKeywordSetsAsFlattenedArray = state => {\n  return state\n    .get('todoKeywordSets')\n    .flatMap(todoKeywordSet => {\n      return todoKeywordSet.get('keywords');\n    })\n    .toSet()\n    .toJS();\n};\n","import generateId from './id_generator';\n\nimport { fromJS } from 'immutable';\n\nexport default fromJS([\n  {\n    description: 'Groceries',\n    headerPaths: ['Capture', 'Groceries'],\n    iconName: 'lemon',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: false,\n    template: '* TODO %?',\n    isSample: true,\n  },\n  {\n    description: 'Deeply nested header',\n    headerPaths: ['Capture', 'Deeply', 'Nested', 'Headers', 'Work', 'Too!'],\n    iconName: 'fighter-jet',\n    id: generateId(),\n    isAvailableInAllOrgFiles: false,\n    letter: '',\n    orgFilesWhereAvailable: [],\n    shouldPrepend: true,\n    template: '* You can insert timestamps too! %T %?',\n    isSample: true,\n  },\n]);\n","import { ActionCreators } from 'redux-undo';\nimport { debounce } from 'lodash';\nimport {\n  setLoadingMessage,\n  hideLoadingMessage,\n  setIsLoading,\n  setDisappearingLoadingMessage,\n  activatePopup,\n  closePopup,\n} from './base';\nimport exportOrg from '../lib/export_org';\nimport substituteTemplateVariables from '../lib/capture_template_substitution';\nimport { headerWithPath } from '../lib/org_utils';\n\nimport sampleCaptureTemplates from '../lib/sample_capture_templates';\n\nimport { isAfter, addSeconds } from 'date-fns';\nimport { parseISO } from 'date-fns';\n\nexport const displayFile = (path, contents) => ({\n  type: 'DISPLAY_FILE',\n  path,\n  contents,\n});\n\nexport const setLastSyncAt = lastSyncAt => ({\n  type: 'SET_LAST_SYNC_AT',\n  lastSyncAt,\n});\n\nexport const stopDisplayingFile = () => {\n  return (dispatch, getState) => {\n    dispatch({ type: 'STOP_DISPLAYING_FILE' });\n    dispatch(ActionCreators.clearHistory());\n    dispatch(unfocusHeader());\n    dispatch(closePopup());\n    dispatch(setLastSyncAt(null));\n  };\n};\n\nconst syncDebounced = debounce((dispatch, ...args) => dispatch(doSync(...args)), 3000, {\n  leading: true,\n  trailing: true,\n});\n\nexport const sync = (...args) => dispatch => syncDebounced(dispatch, ...args);\n\n// doSync is the actual sync action synchronizing/persisting the Org\n// file. When 'live sync' is enabled, there's potentailly a quick\n// succession of calls to 'sync' and therefore to the sync back-end\n// happening. These calls need to be debounced. If there's a really\n// succession of calls, only the first and last synchronization will\n// happen.\n// Note: This action is a redux-thunk action (because it returns a\n// function). This function is defined every time it is called. Hence,\n// wrapping it in `debounce` will not be good enough. Since it would\n// be a new function every time, it would be called every time. The\n// solution is to define an inner function `sync` outside of the\n// wrapping function `syncDebounced`. This will actually debounce\n// `doSync`, because the inner function `sync` will be created only\n// once.\nconst doSync = ({\n  forceAction = null,\n  successMessage = 'Changes pushed',\n  shouldSuppressMessages = false,\n} = {}) => (dispatch, getState) => {\n  const client = getState().syncBackend.get('client');\n  const path = getState().org.present.get('path');\n  if (!path) {\n    return;\n  }\n\n  // Calls do `doSync` are already debounced using a timer, but on big\n  // Org files or slow connections, it's still possible to have\n  // concurrent requests to `doSync` which has no merit. When\n  // `isLoading`, don't trigger another sync in parallel. Instead,\n  // call `syncDebounced` and return immediately. This will\n  // recursively enqueue the request to do a sync until the current\n  // sync is finished. Since it's a debounced call, enqueueing it\n  // recursively is efficient.\n  if (getState().base.get('isLoading')) {\n    // Since there is a quick succession of debounced requests to\n    // synchronize, the user likely is in a undo/redo workflow with\n    // potential new changes to the Org file in between. In such a\n    // situation, it is easy for the remote file to have a newer\n    // `lastModifiedAt` date than the `lastSyncAt` date. Hence,\n    // pushing is the right action - no need for the modal to ask the\n    // user for her request to pull/push or cancel.\n    dispatch(sync({ forceAction: 'push' }));\n    return;\n  }\n\n  if (!shouldSuppressMessages) {\n    dispatch(setLoadingMessage('Syncing...'));\n  }\n  dispatch(setIsLoading(true));\n  dispatch(setOrgFileErrorMessage(null));\n\n  client\n    .getFileContentsAndMetadata(path)\n    .then(({ contents, lastModifiedAt }) => {\n      const isDirty = getState().org.present.get('isDirty');\n      const lastServerModifiedAt = parseISO(lastModifiedAt);\n      const lastSyncAt = getState().org.present.get('lastSyncAt');\n\n      if (isAfter(lastSyncAt, lastServerModifiedAt) || forceAction === 'push') {\n        if (isDirty) {\n          client\n            .updateFile(\n              path,\n              exportOrg(\n                getState().org.present.get('headers'),\n                getState().org.present.get('todoKeywordSets'),\n                getState().org.present.get('fileConfigLines'),\n                getState().org.present.get('linesBeforeHeadings')\n              )\n            )\n            .then(() => {\n              if (!shouldSuppressMessages) {\n                dispatch(setDisappearingLoadingMessage(successMessage, 2000));\n              }\n              dispatch(setIsLoading(false));\n              dispatch(setDirty(false));\n              dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n            })\n            .catch(error => {\n              const err = `There was an error pushing the file: ${error.toString()}`;\n              console.error(err);\n              dispatch(setDisappearingLoadingMessage(err, 5000));\n              dispatch(hideLoadingMessage());\n              dispatch(setIsLoading(false));\n              // Re-enqueue the file to be synchronized again\n              dispatch(sync());\n            });\n        } else {\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage('Nothing to sync', 2000));\n          }\n          dispatch(setIsLoading(false));\n        }\n      } else {\n        if (isDirty && forceAction !== 'pull') {\n          dispatch(hideLoadingMessage());\n          dispatch(setIsLoading(false));\n          dispatch(activatePopup('sync-confirmation', { lastServerModifiedAt }));\n        } else {\n          dispatch(displayFile(path, contents));\n          dispatch(applyOpennessState());\n          dispatch(setDirty(false));\n          dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n          if (!shouldSuppressMessages) {\n            dispatch(setDisappearingLoadingMessage('Latest version pulled', 2000));\n          }\n          dispatch(setIsLoading(false));\n        }\n      }\n    })\n    .catch(() => {\n      dispatch(hideLoadingMessage());\n      dispatch(setIsLoading(false));\n      dispatch(setOrgFileErrorMessage('File not found'));\n    });\n};\n\nexport const openHeader = headerId => ({\n  type: 'OPEN_HEADER',\n  headerId,\n});\n\nexport const toggleHeaderOpened = headerId => ({\n  type: 'TOGGLE_HEADER_OPENED',\n  headerId,\n});\n\nexport const selectHeader = headerId => dispatch => {\n  dispatch({ type: 'SELECT_HEADER', headerId });\n\n  if (!!headerId) {\n    dispatch(setSelectedTableCellId(null));\n  }\n};\n\nexport const selectHeaderAndOpenParents = headerId => dispatch => {\n  dispatch(selectHeader(headerId));\n  dispatch({ type: 'OPEN_PARENTS_OF_HEADER', headerId });\n};\n\nexport const advanceTodoState = (headerId = null) => ({\n  type: 'ADVANCE_TODO_STATE',\n  headerId,\n  dirtying: true,\n});\n\nexport const enterEditMode = editModeType => ({\n  type: 'ENTER_EDIT_MODE',\n  editModeType,\n});\n\nexport const exitEditMode = () => ({\n  type: 'EXIT_EDIT_MODE',\n});\n\nexport const updateHeaderTitle = (headerId, newRawTitle) => ({\n  type: 'UPDATE_HEADER_TITLE',\n  headerId,\n  newRawTitle,\n  dirtying: true,\n});\n\nexport const updateHeaderDescription = (headerId, newRawDescription) => ({\n  type: 'UPDATE_HEADER_DESCRIPTION',\n  headerId,\n  newRawDescription,\n  dirtying: true,\n});\n\nexport const addHeader = headerId => ({\n  type: 'ADD_HEADER',\n  headerId,\n  // Performance optimization: Don't actually sync a whole Org file\n  // for an empty header. When the user adds some data and triggers\n  // UPDATE_HEADER_TITLE, then it makes sense to save it.\n  dirtying: false,\n});\n\nexport const selectNextSiblingHeader = headerId => ({\n  type: 'SELECT_NEXT_SIBLING_HEADER',\n  headerId,\n});\n\nexport const addHeaderAndEdit = headerId => dispatch => {\n  dispatch(addHeader(headerId));\n  dispatch(selectNextSiblingHeader(headerId));\n  dispatch(enterEditMode('title'));\n};\n\nexport const selectNextVisibleHeader = headerId => ({\n  type: 'SELECT_NEXT_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const selectPreviousVisibleHeader = headerId => ({\n  type: 'SELECT_PREVIOUS_VISIBLE_HEADER',\n  headerId,\n});\n\nexport const removeHeader = headerId => ({\n  type: 'REMOVE_HEADER',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderUp = headerId => ({\n  type: 'MOVE_HEADER_UP',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderDown = headerId => ({\n  type: 'MOVE_HEADER_DOWN',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderLeft = headerId => ({\n  type: 'MOVE_HEADER_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveHeaderRight = headerId => ({\n  type: 'MOVE_HEADER_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeLeft = headerId => ({\n  type: 'MOVE_SUBTREE_LEFT',\n  headerId,\n  dirtying: true,\n});\n\nexport const moveSubtreeRight = headerId => ({\n  type: 'MOVE_SUBTREE_RIGHT',\n  headerId,\n  dirtying: true,\n});\n\nexport const refileSubtree = (sourceHeaderId, targetHeaderId) => ({\n  type: 'REFILE_SUBTREE',\n  sourceHeaderId,\n  targetHeaderId,\n  dirtying: true,\n});\n\nexport const focusHeader = headerId => ({\n  type: 'FOCUS_HEADER',\n  headerId,\n});\n\nexport const unfocusHeader = () => ({\n  type: 'UNFOCUS_HEADER',\n});\n\nexport const applyOpennessState = () => ({\n  type: 'APPLY_OPENNESS_STATE',\n});\n\nexport const setDirty = isDirty => ({\n  type: 'SET_DIRTY',\n  isDirty,\n});\n\nexport const setSelectedTableCellId = cellId => dispatch => {\n  dispatch({ type: 'SET_SELECTED_TABLE_CELL_ID', cellId });\n\n  if (!!cellId) {\n    dispatch(selectHeader(null));\n  }\n};\n\nexport const addNewTableRow = () => ({\n  type: 'ADD_NEW_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const removeTableRow = () => ({\n  type: 'REMOVE_TABLE_ROW',\n  dirtying: true,\n});\n\nexport const addNewTableColumn = () => ({\n  type: 'ADD_NEW_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const removeTableColumn = () => ({\n  type: 'REMOVE_TABLE_COLUMN',\n  dirtying: true,\n});\n\nexport const moveTableRowDown = () => ({\n  type: 'MOVE_TABLE_ROW_DOWN',\n  dirtying: true,\n});\n\nexport const moveTableRowUp = () => ({\n  type: 'MOVE_TABLE_ROW_UP',\n  dirtying: true,\n});\n\nexport const moveTableColumnLeft = () => ({\n  type: 'MOVE_TABLE_COLUMN_LEFT',\n  dirtying: true,\n});\n\nexport const moveTableColumnRight = () => ({\n  type: 'MOVE_TABLE_COLUMN_RIGHT',\n  dirtying: true,\n});\n\nexport const updateTableCellValue = (cellId, newValue) => ({\n  type: 'UPDATE_TABLE_CELL_VALUE',\n  cellId,\n  newValue,\n  dirtying: true,\n});\n\nexport const insertCapture = (templateId, content, shouldPrepend) => (dispatch, getState) => {\n  dispatch(closePopup());\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .concat(sampleCaptureTemplates)\n    .find(template => template.get('id') === templateId);\n  dispatch({ type: 'INSERT_CAPTURE', template, content, shouldPrepend, dirtying: true });\n};\n\nexport const clearPendingCapture = () => ({\n  type: 'CLEAR_PENDING_CAPTURE',\n});\n\nexport const insertPendingCapture = () => (dispatch, getState) => {\n  const pendingCapture = getState().org.present.get('pendingCapture');\n  const templateName = pendingCapture.get('captureTemplateName');\n  const captureContent = pendingCapture.get('captureContent');\n  const customCaptureVariables = pendingCapture.get('customCaptureVariables');\n\n  dispatch(clearPendingCapture());\n  window.history.pushState({}, '', window.location.pathname);\n\n  const template = getState()\n    .capture.get('captureTemplates')\n    .filter(\n      template =>\n        template.get('isAvailableInAllOrgFiles') ||\n        template.get('orgFilesWhereAvailable').includes(getState().org.present.get('path'))\n    )\n    .find(template => template.get('description').trim() === templateName.trim());\n  if (!template) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${templateName}\" template not found or not available in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const targetHeader = headerWithPath(\n    getState().org.present.get('headers'),\n    template.get('headerPaths')\n  );\n  if (!targetHeader) {\n    dispatch(\n      setDisappearingLoadingMessage(\n        `Capture failed: \"${template.get('description')}\" header path invalid in this file`,\n        8000\n      )\n    );\n    return;\n  }\n\n  const [substitutedTemplate, initialCursorIndex] = substituteTemplateVariables(\n    template.get('template'),\n    customCaptureVariables\n  );\n\n  const content = !!initialCursorIndex\n    ? `${substitutedTemplate.substring(\n        0,\n        initialCursorIndex\n      )}${captureContent}${substitutedTemplate.substring(initialCursorIndex)}`\n    : `${substitutedTemplate}${captureContent}`;\n\n  dispatch(insertCapture(template.get('id'), content, template.get('shouldPrepend')));\n  dispatch(sync({ successMessage: 'Item captured' }));\n};\n\nexport const advanceCheckboxState = listItemId => ({\n  type: 'ADVANCE_CHECKBOX_STATE',\n  listItemId,\n  dirtying: true,\n});\n\nexport const setHeaderTags = (headerId, tags) => ({\n  type: 'SET_HEADER_TAGS',\n  headerId,\n  tags,\n  dirtying: true,\n});\n\nexport const reorderTags = (fromIndex, toIndex) => ({\n  type: 'REORDER_TAGS',\n  fromIndex,\n  toIndex,\n  dirtying: true,\n});\n\nexport const reorderPropertyList = (fromIndex, toIndex) => (dispatch, getState) =>\n  dispatch({\n    type: 'REORDER_PROPERTY_LIST',\n    fromIndex,\n    toIndex,\n    headerId: getState().base.getIn(['activePopup', 'data', 'headerId']),\n    dirtying: true,\n  });\n\nexport const updateTimestampWithId = (timestampId, newTimestamp) => ({\n  type: 'UPDATE_TIMESTAMP_WITH_ID',\n  timestampId,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const updatePlanningItemTimestamp = (headerId, planningItemIndex, newTimestamp) => ({\n  type: 'UPDATE_PLANNING_ITEM_TIMESTAMP',\n  headerId,\n  planningItemIndex,\n  newTimestamp,\n  dirtying: true,\n});\n\nexport const addNewPlanningItem = (headerId, planningType) => ({\n  type: 'ADD_NEW_PLANNING_ITEM',\n  headerId,\n  planningType,\n  dirtying: true,\n});\n\nexport const removePlanningItem = (headerId, planningItemIndex) => ({\n  type: 'REMOVE_PLANNING_ITEM',\n  headerId,\n  planningItemIndex,\n  dirtying: true,\n});\n\nexport const updatePropertyListItems = (headerId, newPropertyListItems) => ({\n  type: 'UPDATE_PROPERTY_LIST_ITEMS',\n  headerId,\n  newPropertyListItems,\n  dirtying: true,\n});\n\nexport const setOrgFileErrorMessage = message => ({\n  type: 'SET_ORG_FILE_ERROR_MESSAGE',\n  message,\n});\n\nexport const setLogEntryStop = (headerId, entryId, time) => ({\n  type: 'SET_LOG_ENTRY_STOP',\n  headerId,\n  entryId,\n  time,\n  dirtying: true,\n});\n\nexport const createLogEntryStart = (headerId, time) => ({\n  type: 'CREATE_LOG_ENTRY_START',\n  headerId,\n  time,\n  dirtying: true,\n});\n\nexport const updateLogEntryTime = (headerId, entryIndex, entryType, newTime) => ({\n  type: 'UPDATE_LOG_ENTRY_TIME',\n  headerId,\n  entryIndex,\n  entryType,\n  newTime,\n  dirtying: true,\n});\n\nexport const setSearchFilterInformation = (searchFilter, cursorPosition, context) => ({\n  type: 'SET_SEARCH_FILTER_INFORMATION',\n  searchFilter,\n  cursorPosition,\n  context,\n});\n","import { sync } from '../actions/org';\n\nexport default store => next => action => {\n  if (action.dirtying && store.getState().base.get('shouldLiveSync')) {\n    store.dispatch(sync({ shouldSuppressMessages: true }));\n  }\n\n  return next(action);\n};\n","import { sync } from '../actions/org';\nimport { debounce } from 'lodash';\n\nconst dispatchSync = store => store.dispatch(sync({ shouldSuppressMessages: true }));\n\n// The 'visibilitychange' event might get triggered in some browsers many times for one 'real'\n// event of the browser becoming visible to the user. Debouncing through lodash ensures that\n// it is called at maximum once every second.\nconst debouncedDispatchSync = debounce(dispatchSync, 1000);\n\n// Dealing with vendor prefixes\nfunction getHiddenProp() {\n  const prefixes = ['webkit', 'moz', 'ms', 'o'];\n\n  // if 'hidden' is natively supported just return it\n  if ('hidden' in document) return 'hidden';\n\n  // otherwise loop over all the known prefixes until we find one\n  for (let i = 0; i < prefixes.length; i++) {\n    if (prefixes[i] + 'Hidden' in document) return prefixes[i] + 'Hidden';\n  }\n\n  // otherwise it's not supported\n  return null;\n}\n\nexport default store => next => action => {\n  let visProp = getHiddenProp();\n  if (visProp) {\n    const evtname = visProp.replace(/[H|h]idden/, '') + 'visibilitychange';\n    document.addEventListener(evtname, () => {\n      if (\n        store.getState().syncBackend.get('client') &&\n        store.getState().base.get('shouldSyncOnBecomingVisibile')\n      ) {\n        debouncedDispatchSync(store);\n      }\n    });\n  }\n\n  return next(action);\n};\n","export const addNewEmptyCaptureTemplate = () => ({\n  type: 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE',\n});\n\nexport const updateTemplateFieldPathValue = (templateId, fieldPath, newValue) => ({\n  type: 'UPDATE_TEMPLATE_FIELD_PATH_VALUE',\n  templateId,\n  fieldPath,\n  newValue,\n});\n\nexport const addNewTemplateOrgFileAvailability = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n});\n\nexport const removeTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) => ({\n  type: 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY',\n  templateId,\n  orgFileAvailabilityIndex,\n});\n\nexport const addNewTemplateHeaderPath = templateId => ({\n  type: 'ADD_NEW_TEMPLATE_HEADER_PATH',\n  templateId,\n});\n\nexport const removeTemplateHeaderPath = (templateId, headerPathIndex) => ({\n  type: 'REMOVE_TEMPLATE_HEADER_PATH',\n  templateId,\n  headerPathIndex,\n});\n\nexport const deleteTemplate = templateId => ({\n  type: 'DELETE_TEMPLATE',\n  templateId,\n});\n\nexport const restoreCaptureSettings = newSettings => ({\n  type: 'RESTORE_CAPTURE_SETTINGS',\n  newSettings,\n});\n\nexport const reorderCaptureTemplate = (fromIndex, toIndex) => ({\n  type: 'REORDER_CAPTURE_TEMPLATE',\n  fromIndex,\n  toIndex,\n});\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport { getOpenHeaderPaths } from '../lib/org_utils';\n\nimport { restoreBaseSettings } from '../actions/base';\nimport { restoreCaptureSettings } from '../actions/capture';\n\nimport generateId from '../lib/id_generator';\n\nexport const isLocalStorageAvailable = () => {\n  try {\n    localStorage.setItem('test', 'test');\n    return localStorage.getItem('test') === 'test';\n  } catch (e) {\n    return false;\n  }\n};\n\nconst debouncedPushConfigToSyncBackend = _.debounce(\n  (syncBackendClient, contents) => {\n    switch (syncBackendClient.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        syncBackendClient\n          .createFile('/.organice-config.json', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      case 'Google Drive':\n        syncBackendClient\n          .createFile('.organice-config.json', 'root', contents)\n          .catch(error =>\n            alert(`There was an error trying to push settings to your sync backend: ${error}`)\n          );\n        break;\n      default:\n    }\n  },\n  1000,\n  { maxWait: 3000 }\n);\n\nexport const persistableFields = [\n  {\n    category: 'base',\n    name: 'fontSize',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'bulletStyle',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldTapTodoToAdvance',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldDoubleTapToEdit',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n    default: true\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayUnit',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'agendaDefaultDeadlineDelayValue',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n\n  {\n    category: 'base',\n    name: 'shouldStoreSettingsInSyncBackend',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'lastSeenChangelogHash',\n    type: 'nullable',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'customKeybindings',\n    type: 'json',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldLiveSync',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldSyncOnBecomingVisibile',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'base',\n    name: 'shouldShowTitleInOrgFile',\n    type: 'boolean',\n    shouldStoreInConfig: true,\n  },\n  {\n    category: 'capture',\n    name: 'captureTemplates',\n    type: 'json',\n    shouldStoreInConfig: true,\n    default: List(),\n  },\n];\n\nexport const readOpennessState = () => {\n  const opennessStateJSONString = localStorage.getItem('headerOpenness');\n  return !!opennessStateJSONString ? JSON.parse(opennessStateJSONString) : null;\n};\n\nconst getFieldsToPersist = (state, fields) =>\n  fields\n    .filter(field => !field.depreacted)\n    .filter(field => field.category === 'org')\n    .map(field => field.name)\n    .map(field => [field, state.org.present.get(field)])\n    .concat(\n      persistableFields\n        .filter(field => field.category !== 'org')\n        .map(field =>\n          field.type === 'json'\n            ? [\n                field.name,\n                JSON.stringify(state[field.category].get(field.name) || field.default || {}),\n              ]\n            : [field.name, state[field.category].get(field.name)]\n        )\n    );\n\nconst getConfigFileContents = fieldsToPersist =>\n  JSON.stringify(_.fromPairs(fieldsToPersist), null, 2);\n\nexport const applyCategorySettingsFromConfig = (state, config, category) => {\n  persistableFields\n    .filter(field => field.category === category)\n    .filter(field => field.shouldStoreInConfig)\n    .forEach(field => {\n      field.type === 'json'\n        ? (state = state.set(field.name, fromJS(JSON.parse(config[field.name]))))\n        : (state = state.set(field.name, config[field.name]));\n    });\n\n  return state;\n};\n\nexport const applyCaptureSettingsFromConfig = (state, config) => {\n  const captureTemplates = fromJS(JSON.parse(config.captureTemplates)).map(template =>\n    template.set('id', generateId())\n  );\n\n  return state.set('captureTemplates', captureTemplates);\n};\n\nexport const readInitialState = () => {\n  if (!isLocalStorageAvailable()) {\n    return undefined;\n  }\n\n  let initialState = {\n    syncBackend: Map(),\n    org: {\n      past: [],\n      present: Map({\n        search: Map({\n          searchFilter: '',\n          searchFilterExpr: [],\n        }),\n      }),\n      future: [],\n    },\n    base: Map(),\n    capture: Map(),\n  };\n\n  persistableFields.forEach(field => {\n    let value = localStorage.getItem(field.name);\n\n    if (field.type === 'nullable') {\n      if (value === 'null') {\n        value = null;\n      }\n    } else if (field.type === 'boolean') {\n      value = value === 'true';\n    } else if (field.type === 'json') {\n      if (!value) {\n        value = field.default || Map();\n      } else {\n        value = fromJS(JSON.parse(value));\n      }\n    }\n\n    if (field.category === 'org') {\n      initialState[field.category].present = initialState[field.category].present.set(\n        field.name,\n        value\n      );\n    } else {\n      initialState[field.category] = initialState[field.category].set(field.name, value);\n    }\n  });\n\n  // Assign new ids to the capture templates.\n  if (initialState.capture.get('captureTemplates')) {\n    initialState.capture = initialState.capture.update('captureTemplates', templates =>\n      templates.map(template => template.set('id', generateId()))\n    );\n  }\n\n  const opennessState = readOpennessState();\n  if (!!opennessState) {\n    initialState.org.present = initialState.org.present.set('opennessState', fromJS(opennessState));\n  }\n\n  // Cache the config file contents locally so we don't overwrite on initial page load.\n  window.previousSettingsFileContents = getConfigFileContents(\n    getFieldsToPersist(initialState, persistableFields)\n  );\n\n  return initialState;\n};\n\nexport const loadSettingsFromConfigFile = (dispatch, getState) => {\n  const syncBackendClient = getState().syncBackend.get('client');\n  if (!syncBackendClient) {\n    return;\n  }\n\n  let fileContentsPromise = null;\n  switch (syncBackendClient.type) {\n    case 'Dropbox':\n    case 'WebDAV':\n      fileContentsPromise = syncBackendClient.getFileContents('/.organice-config.json');\n      break;\n    case 'Google Drive':\n      fileContentsPromise = syncBackendClient.getFileContentsByNameAndParent(\n        '.organice-config.json',\n        'root'\n      );\n      break;\n    default:\n  }\n\n  fileContentsPromise\n    .then(configFileContents => {\n      try {\n        const config = JSON.parse(configFileContents);\n        dispatch(restoreBaseSettings(config));\n        dispatch(restoreCaptureSettings(config));\n      } catch (_error) {\n        // Something went wrong parsing the config file, but we don't care, we'll just\n        // overwrite it with a good local copy.\n      }\n    })\n    .catch(() => {});\n};\n\nexport const subscribeToChanges = store => {\n  if (!isLocalStorageAvailable()) {\n    return () => {};\n  } else {\n    return () => {\n      const state = store.getState();\n\n      const fieldsToPersist = getFieldsToPersist(state, persistableFields);\n\n      fieldsToPersist.forEach(([name, value]) => localStorage.setItem(name, value));\n\n      if (state.base.get('shouldStoreSettingsInSyncBackend')) {\n        const settingsFileContents = getConfigFileContents(fieldsToPersist);\n\n        if (window.previousSettingsFileContents !== settingsFileContents) {\n          debouncedPushConfigToSyncBackend(state.syncBackend.get('client'), settingsFileContents);\n        }\n\n        window.previousSettingsFileContents = settingsFileContents;\n      }\n\n      const currentFilePath = state.org.present.get('path');\n      if (!!currentFilePath && state.org.present.get('headers')) {\n        const openHeaderPaths = getOpenHeaderPaths(state.org.present.get('headers'));\n\n        let opennessState = {};\n        const opennessStateJSONString = localStorage.getItem('headerOpenness');\n        if (opennessStateJSONString) {\n          opennessState = JSON.parse(opennessStateJSONString);\n        }\n\n        opennessState[currentFilePath] = openHeaderPaths;\n        localStorage.setItem('headerOpenness', JSON.stringify(opennessState));\n      }\n    };\n  }\n};\n\nexport const persistField = (field, value) => {\n  if (!isLocalStorageAvailable()) {\n    return;\n  } else {\n    localStorage.setItem(field, value);\n  }\n};\n\nexport const getPersistedField = (field, nullable = false) => {\n  if (!isLocalStorageAvailable()) {\n    return null;\n  } else {\n    const value = localStorage.getItem(field);\n    if (nullable) {\n      return value === 'null' ? null : value;\n    } else {\n      return value;\n    }\n  }\n};\n","import { Map, List, fromJS } from 'immutable';\n\nimport { applyCategorySettingsFromConfig } from '../util/settings_persister';\n\nconst setLoadingMessage = (state, action) => state.set('loadingMessage', action.loadingMessage);\n\nconst hideLoadingMessage = (state, action) => state.set('loadingMessage', null);\n\nconst setFontSize = (state, action) => state.set('fontSize', action.newFontSize);\n\nconst setBulletStyle = (state, action) => state.set('bulletStyle', action.newBulletStyle);\n\nconst setShouldTapTodoToAdvance = (state, action) =>\n  state.set('shouldTapTodoToAdvance', action.newShouldTapTodoToAdvance);\n\nconst setShouldDoubleTapToEdit = (state, action) =>\n  state.set('shouldDoubleTapToEdit', action.newShouldDoubleTapToEdit);\n\nconst setAgendaDefaultDeadlineDelayUnit = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayUnit', action.newAgendaDefaultDeadlineDelayUnit);\n\nconst setAgendaDefaultDeadlineDelayValue = (state, action) =>\n  state.set('agendaDefaultDeadlineDelayValue', action.newAgendaDefaultDeadlineDelayValue);\n\nconst setShouldStoreSettingsInSyncBackend = (state, action) =>\n  state.set('shouldStoreSettingsInSyncBackend', action.newShouldStoreSettingsInSyncBackend);\n\nconst setShouldLiveSync = (state, action) => state.set('shouldLiveSync', action.shouldLiveSync);\n\nconst setShouldSyncOnBecomingVisibile = (state, action) =>\n  state.set('shouldSyncOnBecomingVisibile', action.shouldSyncOnBecomingVisibile);\n\nconst setShouldShowTitleInOrgFile = (state, action) =>\n  state.set('shouldShowTitleInOrgFile', action.shouldShowTitleInOrgFile);\n\nconst setHasUnseenChangelog = (state, action) =>\n  state.set('hasUnseenChangelog', action.newHasUnseenChangelog);\n\nconst setLastSeenChangelogHeader = (state, action) =>\n  state.set('lastSeenChangelogHash', action.newLastSeenChangelogHash);\n\nconst setLastViewedFile = (state, action) =>\n  state\n    .set('lastViewedPath', action.lastViewedPath)\n    .set('lastViewedContents', action.lastViewedContents);\n\nconst setCustomKeybinding = (state, action) => {\n  if (!state.get('customKeybindings')) {\n    state = state.set('customKeybindings', Map());\n  }\n\n  return state.setIn(['customKeybindings', action.keybindingName], action.keybinding);\n};\n\nconst restoreBaseSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCategorySettingsFromConfig(state, action.newSettings, 'base');\n};\n\nconst pushModalPage = (state, action) =>\n  state.update('modalPageStack', stack =>\n    !!stack ? stack.push(action.modalPage) : List([action.modalPage])\n  );\n\nconst popModalPage = state =>\n  state.update('modalPageStack', stack => (!!stack ? stack.pop() : stack));\n\nconst clearModalStack = state => state.set('modalPageStack', List());\n\nconst activatePopup = (state, action) => {\n  const { data, popupType } = action;\n\n  // Remember active popup in URL state for popups that are uniquely\n  // identifiable (aka not related to a single header like tags,\n  // properties or timestamps).\n  if (['search', 'task-list', 'agenda'].includes(popupType)) {\n    window.location.hash = popupType;\n  }\n\n  return state.set(\n    'activePopup',\n    fromJS({\n      type: popupType,\n      data,\n    })\n  );\n};\n\nconst closePopup = state => {\n  window.history.replaceState(\n    '',\n    document.title,\n    window.location.pathname + window.location.search\n  );\n  return state.set('activePopup', null);\n};\n\nconst setIsLoading = (state, action) => state.set('isLoading', action.isLoading);\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SET_LOADING_MESSAGE':\n      return setLoadingMessage(state, action);\n    case 'HIDE_LOADING_MESSAGE':\n      return hideLoadingMessage(state, action);\n    case 'SET_FONT_SIZE':\n      return setFontSize(state, action);\n    case 'SET_BULLET_STYLE':\n      return setBulletStyle(state, action);\n    case 'SET_SHOULD_TAP_TODO_TO_ADVANCE':\n      return setShouldTapTodoToAdvance(state, action);\n    case 'SET_SHOULD_DOUBLE_TAP_TO_EDIT':\n      return setShouldDoubleTapToEdit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT':\n      return setAgendaDefaultDeadlineDelayUnit(state, action);\n    case 'SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE':\n      return setAgendaDefaultDeadlineDelayValue(state, action);\n    case 'SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND':\n      return setShouldStoreSettingsInSyncBackend(state, action);\n    case 'SET_SHOULD_LIVE_SYNC':\n      return setShouldLiveSync(state, action);\n    case 'SET_SHOULD_SYNC_ON_BECOMING_VISIBLE':\n      return setShouldSyncOnBecomingVisibile(state, action);\n    case 'SET_SHOULD_SHOW_TITLE_IN_ORG_FILE':\n      return setShouldShowTitleInOrgFile(state, action);\n    case 'SET_HAS_UNSEEN_CHANGELOG':\n      return setHasUnseenChangelog(state, action);\n    case 'SET_LAST_SEEN_CHANGELOG_HEADER':\n      return setLastSeenChangelogHeader(state, action);\n    case 'SET_LAST_VIEWED_FILE':\n      return setLastViewedFile(state, action);\n    case 'SET_CUSTOM_KEYBINDING':\n      return setCustomKeybinding(state, action);\n    case 'RESTORE_BASE_SETTINGS':\n      return restoreBaseSettings(state, action);\n    case 'PUSH_MODAL_PAGE':\n      return pushModalPage(state, action);\n    case 'POP_MODAL_PAGE':\n      return popModalPage(state, action);\n    case 'CLEAR_MODAL_STACK':\n      return clearModalStack(state, action);\n    case 'ACTIVATE_POPUP':\n      return activatePopup(state, action);\n    case 'CLOSE_POPUP':\n      return closePopup(state, action);\n    case 'SET_IS_LOADING':\n      return setIsLoading(state, action);\n    default:\n      return state;\n  }\n};\n","import { Map } from 'immutable';\n\nconst signOut = (state, action) => state.set('isAuthenticated', false).set('client', null);\n\nconst setCurrentFileBrowserDirectoryListing = (state, action) =>\n  state.set(\n    'currentFileBrowserDirectoryListing',\n    Map({\n      listing: action.directoryListing,\n      hasMore: action.hasMore,\n      additionalSyncBackendState: action.additionalSyncBackendState,\n    })\n  );\n\nconst setIsLoadingMoreDirectoryListing = (state, action) =>\n  state\n    .update(\n      'currentFileBrowserDirectoryListing',\n      currentFileBrowserDirectoryListing =>\n        !!currentFileBrowserDirectoryListing ? currentFileBrowserDirectoryListing : Map()\n    )\n    .setIn(['currentFileBrowserDirectoryListing', 'isLoadingMore'], action.isLoadingMore);\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'SIGN_OUT':\n      return signOut(state, action);\n    case 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING':\n      return setCurrentFileBrowserDirectoryListing(state, action);\n    case 'SET_IS_LOADING_MORE_DIRECTORY_LISTING':\n      return setIsLoadingMoreDirectoryListing(state, action);\n    default:\n      return state;\n  }\n};\n","// Matcher\n\nimport { fromJS } from 'immutable';\nimport { attributedStringToRawText } from './export_org.js';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from './org_utils';\n\nexport const isMatch = filterExpr => header => {\n  const headLine = header.get('titleLine');\n  const tags = headLine.get('tags');\n  const todoKeyword = headLine.get('todoKeyword');\n  const rawTitle = headLine.get('rawTitle');\n  const headlineText = todoKeyword ? `${todoKeyword} ${rawTitle}` : rawTitle;\n  const properties = header\n    .get('propertyListItems')\n    .map(p => [p.get('property'), attributedStringToRawText(p.get('value'))]);\n\n  const filterFilter = (type, exclude) => x => x.type === type && x.exclude === exclude;\n  const words = x => x.words;\n  const wordsLowerCase = x => x.words.map(y => y.toLowerCase());\n\n  const filterTags = filterExpr.filter(filterFilter('tag', false)).map(words);\n  const filterCS = filterExpr.filter(filterFilter('case-sensitive', false)).map(words);\n  const filterIC = filterExpr.filter(filterFilter('ignore-case', false)).map(wordsLowerCase);\n  const filterProps = filterExpr\n    .filter(filterFilter('property', false))\n    .map(x => [x.property, x.words]);\n\n  const filterTagsExcl = filterExpr.filter(filterFilter('tag', true)).map(words);\n  const filterCSExcl = filterExpr.filter(filterFilter('case-sensitive', true)).map(words);\n  const filterICExcl = filterExpr.filter(filterFilter('ignore-case', true)).map(wordsLowerCase);\n  const filterPropsExcl = filterExpr\n    .filter(filterFilter('property', true))\n    .map(x => [x.property, x.words]);\n\n  const orChain = source => xs => xs.some(x => source.includes(x));\n  const propertyFilter = ([x, ys]) =>\n    !properties\n      .filter(([key, val]) => {\n        // Property names (keys) are case-insensitive\n        // https://orgmode.org/manual/Property-Syntax.html\n        const nameMatch = key.toLowerCase() === x.toLowerCase();\n        const valueMatch = ys.some(y => val.includes(y));\n        return nameMatch && valueMatch;\n      })\n      .isEmpty();\n  return (\n    filterTags.every(orChain(tags)) &&\n    filterCS.every(orChain(headlineText)) &&\n    filterIC.every(orChain(headlineText.toLowerCase())) &&\n    filterProps.every(propertyFilter) &&\n    !filterTagsExcl.some(orChain(tags)) &&\n    !filterCSExcl.some(orChain(headlineText)) &&\n    !filterICExcl.some(orChain(headlineText.toLowerCase())) &&\n    !filterPropsExcl.some(propertyFilter)\n  );\n};\n\n// Suggestions / Completions\n\n// The computation of completions rely on the fact, that the filter syntax does NOT\n// support quoted strings (i.e. no search for a quoted 'master headline').\n\n// This function is complex and still not perfect. It resembles parts of the\n// filter syntax parser. If the parser would annotate all parsed symbols with\n// offsets information, computeLogicalPosition could simplify the algorithm as\n// long as the filter string is parsed successfully.\n\nexport const computeCompletions = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const tagAndPropNames = [].concat(\n    tagNames,\n    computeAllPropertyNames(fromJS(allProperties))\n      .toJS()\n      .map(x => x + ':')\n  );\n\n  const logicalCursorPosition = filterExpr\n    ? computeLogicalPosition(filterExpr, filterString, curserPosition)\n    : null;\n\n  const charBeforeCursor = filterString.charAt(curserPosition - 1);\n  const charTwoBeforeCursor = curserPosition > 1 ? filterString.charAt(curserPosition - 2) : '';\n\n  if (logicalCursorPosition === null) {\n  } else if (logicalCursorPosition === SPACE_SURROUNDED) {\n    return todoKeywords;\n  } else if (logicalCursorPosition.type === 'case-sensitive') {\n    if (charBeforeCursor.match(/[A-Z]/)) {\n      const textBeforeCursor = charBeforeCursor;\n      const filteredTodoKeywords = todoKeywords\n        .filter(x => x.startsWith(textBeforeCursor))\n        .map(x => x.substring(textBeforeCursor.length));\n      if ([' ', '', '|', '-'].includes(charTwoBeforeCursor)) {\n        return filteredTodoKeywords;\n      }\n    }\n  } else if (logicalCursorPosition.type === 'ignore-case') {\n    // A text filter starting with '-' turns into an exclude filter as soon as text is appended\n    if (charBeforeCursor === '-' && [' ', ''].includes(charTwoBeforeCursor)) return todoKeywords;\n    return [];\n  } else if (logicalCursorPosition.type === 'tag') {\n    // This case will likely not occur because ':' alone cannot be parsed\n    if (charBeforeCursor === ':') return tagAndPropNames;\n  } else if (logicalCursorPosition.type === 'property') {\n    if (charBeforeCursor === ':') {\n      if (charTwoBeforeCursor === ' ' || charTwoBeforeCursor === '') return tagAndPropNames;\n      else {\n        // Either property name or text filter\n        const indexOfOtherColon = filterString.substring(0, curserPosition - 1).lastIndexOf(':');\n        const maybePropertyName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n        const quoteStringIfPossible = x => {\n          if (x.match(/ /)) {\n            if (!x.match(/\"/)) return [`\"${x}\"`];\n            if (!x.match(/'/)) return [`'${x}'`];\n            const match = x.match(/^[^ ]*/);\n            return [match[0]];\n          }\n          return [x];\n        };\n        if (indexOfOtherColon >= 0 && maybePropertyName.match(/^[^ ]+$/)) {\n          // No space in property name -> is property -> return values for that property\n          return computeAllPropertyValuesFor(fromJS(allProperties), maybePropertyName)\n            .flatMap(quoteStringIfPossible)\n            .toJS();\n        }\n      }\n    }\n  }\n\n  // If ':' or '|' is before cursor, the filter string is likely not\n  // successfully parsed and therefore cannot be handled above.\n  if (charBeforeCursor === ':') {\n    if ([' ', '', '-'].includes(charTwoBeforeCursor)) {\n      return tagAndPropNames;\n    }\n  } else if (charBeforeCursor === '|') {\n    const indexOfOtherColon = filterString.substring(0, curserPosition).lastIndexOf(':');\n    const maybeTagName = filterString.substring(indexOfOtherColon + 1, curserPosition - 1);\n    if (indexOfOtherColon > -1 && !maybeTagName.match(/ /)) {\n      // No space characters between ':' and '|'  ->  '|' is in a tag filter\n      return tagNames;\n    } else {\n      return todoKeywords;\n    }\n  }\n\n  return [];\n};\n\nexport const computeCompletionsForDatalist = (todoKeywords, tagNames, allProperties) => (\n  filterExpr,\n  filterString,\n  curserPosition\n) => {\n  const completions = computeCompletions(todoKeywords, tagNames, allProperties)(\n    filterExpr,\n    filterString,\n    curserPosition\n  );\n  return completions.map(\n    x => filterString.substring(0, curserPosition) + x + filterString.substring(curserPosition)\n  );\n};\n\nconst SPACE_SURROUNDED = ' ';\n\n// Compute the logical curser position within the parsed filter expression.\n// Return SPACE_SURROUNDED if the curser is inbetween two expressions and\n// surrounded by spaces (begin and end of line count as space).\n// Return the the filter term if the curser is in or at the edge of an filter term.\nconst computeLogicalPosition = (filterExpr, filterString, curserPosition) => {\n  if (filterExpr.length === 0) return SPACE_SURROUNDED;\n  const tup = (x, y) => ({ value: x, elem: y });\n  const firstElem = { offset: -1, endOffset: -1 };\n  const { value } = filterExpr.reduce(\n    ({ value, elem }, next) => {\n      if (elem === null) {\n        return tup(value, null); // short-circuit if already found\n      }\n      if (curserPosition >= next.offset && curserPosition <= next.endOffset) {\n        return tup(next, null);\n      }\n      if (curserPosition > elem.endOffset && curserPosition < next.offset) {\n        return tup(SPACE_SURROUNDED, null);\n      }\n      return tup(null, next);\n    },\n    { value: null, elem: firstElem }\n  );\n  if (curserPosition > filterExpr[filterExpr.length - 1].endOffset) return SPACE_SURROUNDED;\n  return value;\n};\n","import generateId from './id_generator';\n\nimport { fromJS, List } from 'immutable';\nimport _ from 'lodash';\n\n// Yeah, this thing is pretty wild. I use https://www.debuggex.com/ to edit it, then paste the results in here.\n// But fixing this mess is on my todo list...\nconst markupAndCookieRegex = /(\\[\\[([^\\]]*)\\]\\]|\\[\\[([^\\]]*)\\]\\[([^\\]]*)\\]\\])|(\\[((\\d*%)|(\\d*\\/\\d*))\\])|(([\\s({'\"]?)([*/~=_+])([^\\s,'](.*)[^\\s,'])\\11([\\s\\-.,:;!?'\")}]?))|(([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9\\s]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?[>\\]](?:--([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?[>\\]])?)|(https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_\\\\+.~#?&//=]*))|([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)|(\\+\\d{8,30})|(www(\\.[-_a-zA-Z0-9]+){2,}(\\/[-_a-zA-Z0-9]+)*)/g;\nconst timestampRegex = /* scroll to the right --->                                                                                                                     */ /([<[])(\\d{4})-(\\d{2})-(\\d{2})(?: ([^0-9\\s]{1,9}))?(?: ([012]?\\d:[0-5]\\d))?(?:-([012]?\\d:[0-5]\\d))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?(?: ((?:\\+)|(?:\\+\\+)|(?:\\.\\+)|(?:-)|(?:--))(\\d+)([hdwmy]))?[>\\]]/;\n\n// - HTTP URL regex taken from https://stackoverflow.com/a/3809435/999007\n// - e-mail regex taken from https://stackoverflow.com/a/1373724/999007\n// - phone number regex only for canonical format +xxxxxxxxx\n\nconst timestampFromRegexMatch = (match, partIndices) => {\n  const [\n    typeBracket,\n    year,\n    month,\n    day,\n    dayName,\n    timeStart,\n    timeEnd,\n    firstDelayRepeatType,\n    firstDelayRepeatValue,\n    firstDelayRepeatUnit,\n    secondDelayRepeatType,\n    secondDelayRepeatValue,\n    secondDelayRepeatUnit,\n  ] = partIndices.map(partIndex => match[partIndex]);\n\n  if (!year) {\n    return null;\n  }\n\n  const [startHour, startMinute] = !!timeStart ? timeStart.split(':') : [];\n  const [endHour, endMinute] = !!timeEnd ? timeEnd.split(':') : [];\n\n  let repeaterType, repeaterValue, repeaterUnit;\n  let delayType, delayValue, delayUnit;\n\n  if (['+', '++', '.+'].includes(firstDelayRepeatType)) {\n    repeaterType = firstDelayRepeatType;\n    repeaterValue = firstDelayRepeatValue;\n    repeaterUnit = firstDelayRepeatUnit;\n  } else if (['-', '--'].includes(firstDelayRepeatType)) {\n    delayType = firstDelayRepeatType;\n    delayValue = firstDelayRepeatValue;\n    delayUnit = firstDelayRepeatUnit;\n  }\n  if (['+', '++', '.+'].includes(secondDelayRepeatType)) {\n    repeaterType = secondDelayRepeatType;\n    repeaterValue = secondDelayRepeatValue;\n    repeaterUnit = secondDelayRepeatUnit;\n  } else if (['-', '--'].includes(secondDelayRepeatType)) {\n    delayType = secondDelayRepeatType;\n    delayValue = secondDelayRepeatValue;\n    delayUnit = secondDelayRepeatUnit;\n  }\n\n  return {\n    isActive: typeBracket === '<',\n    year,\n    month,\n    day,\n    dayName,\n    startHour,\n    startMinute,\n    endHour,\n    endMinute,\n    repeaterType,\n    repeaterValue,\n    repeaterUnit,\n    delayType,\n    delayValue,\n    delayUnit,\n  };\n};\n\nexport const parseMarkupAndCookies = (\n  rawText,\n  { shouldAppendNewline = false, excludeCookies = true } = {}\n) => {\n  const matches = [];\n  let match = markupAndCookieRegex.exec(rawText);\n  while (match) {\n    if (!!match[2]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[2],\n        index: match.index,\n      });\n    } else if (!!match[3] && !!match[4]) {\n      matches.push({\n        type: 'link',\n        rawText: match[0],\n        uri: match[3],\n        title: match[4],\n        index: match.index,\n      });\n    } else if (!!match[7]) {\n      const percentCookieMatch = match[7].match(/(\\d*)%/);\n      matches.push({\n        type: 'percentage-cookie',\n        rawText: match[0],\n        percentage: percentCookieMatch[1],\n        index: match.index,\n      });\n    } else if (!!match[8]) {\n      const fractionCookieMatch = match[8].match(/(\\d*)\\/(\\d*)/);\n      matches.push({\n        type: 'fraction-cookie',\n        rawText: match[0],\n        fraction: [fractionCookieMatch[1], fractionCookieMatch[2]],\n        index: match.index,\n      });\n    } else if (!!match[11]) {\n      const markupType = {\n        '~': 'inline-code',\n        '*': 'bold',\n        '/': 'italic',\n        '+': 'strikethrough',\n        _: 'underline',\n        '=': 'verbatim',\n      }[match[11]];\n\n      const markupPrefixLength = match[10].length;\n\n      matches.push({\n        type: 'inline-markup',\n        rawText: match[0].substring(markupPrefixLength, match[12].length + 2 + markupPrefixLength),\n        index: match.index + markupPrefixLength,\n        content: match[12],\n        markupType,\n      });\n    } else if (!!match[15]) {\n      const firstTimestamp = timestampFromRegexMatch(match, _.range(16, 29));\n      const secondTimestamp = timestampFromRegexMatch(match, _.range(29, 42));\n\n      matches.push({\n        type: 'timestamp',\n        rawText: match[0],\n        index: match.index,\n        firstTimestamp,\n        secondTimestamp,\n      });\n    } else if (!!match[42]) {\n      matches.push({\n        type: 'url',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[45]) {\n      matches.push({\n        type: 'e-mail',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[46]) {\n      matches.push({\n        type: 'phone-number',\n        rawText: match[0],\n        index: match.index,\n      });\n    } else if (!!match[47]) {\n      matches.push({\n        type: 'www-url',\n        rawText: match[0],\n        index: match.index,\n      });\n    }\n    match = markupAndCookieRegex.exec(rawText);\n  }\n\n  const lineParts = [];\n  let startIndex = 0;\n  matches.forEach(match => {\n    let index = match.index;\n\n    // Get the part before the first match:\n    if (index !== startIndex) {\n      const text = rawText.substring(startIndex, index);\n      lineParts.push({\n        type: 'text',\n        contents: text,\n      });\n    }\n\n    // Get this match:\n    const part = computeParseResults(rawText, match);\n    lineParts.push(part);\n\n    startIndex = match.index + match.rawText.length;\n  });\n\n  if (startIndex !== rawText.length || shouldAppendNewline) {\n    const trailingText =\n      rawText.substring(startIndex, rawText.length) + (shouldAppendNewline ? '\\n' : '');\n    lineParts.push({\n      type: 'text',\n      contents: trailingText,\n    });\n  }\n\n  return lineParts;\n};\n\nconst computeParseResults = (rawText, match) => {\n  switch (match.type) {\n    case 'link':\n      const linkPart = {\n        id: generateId(),\n        type: 'link',\n        contents: {\n          uri: match.uri,\n        },\n      };\n      if (match.title) {\n        linkPart.contents.title = match.title;\n      }\n      return linkPart;\n    case 'percentage-cookie':\n      return {\n        id: generateId(),\n        type: 'percentage-cookie',\n        percentage: match.percentage,\n      };\n    case 'fraction-cookie':\n      return {\n        id: generateId(),\n        type: 'fraction-cookie',\n        fraction: match.fraction,\n      };\n    case 'inline-markup':\n      return {\n        id: generateId(),\n        type: 'inline-markup',\n        content: match.content,\n        markupType: match.markupType,\n      };\n    case 'timestamp':\n      return {\n        id: generateId(),\n        type: 'timestamp',\n        firstTimestamp: match.firstTimestamp,\n        secondTimestamp: match.secondTimestamp,\n      };\n    case 'url':\n    case 'www-url':\n    case 'e-mail':\n    case 'phone-number':\n      return {\n        id: generateId(),\n        type: match.type,\n        content: match.rawText,\n      };\n    default:\n      throw Error(\n        'The regex parser parsed something but it is not converted to proper data structure.'\n      );\n  }\n};\n\nconst parseTable = tableLines => {\n  const table = {\n    id: generateId(),\n    type: 'table',\n    contents: [[]],\n    columnProperties: [],\n  };\n\n  tableLines\n    .map(line => line.trim())\n    .forEach(line => {\n      if (line.startsWith('|-')) {\n        table.contents.push([]);\n      } else {\n        const lastRow = _.last(table.contents);\n        const lineCells = line.substr(1, line.length - 2).split('|');\n\n        if (lastRow.length === 0) {\n          lineCells.forEach(cell => lastRow.push(cell));\n        } else {\n          lineCells.forEach((cellContents, cellIndex) => {\n            lastRow[cellIndex] += `\\n${cellContents}`;\n          });\n        }\n      }\n    });\n\n  // Parse the contents of each cell.\n  table.contents = table.contents.map(row => ({\n    id: generateId(),\n    contents: row.map(rawContents => ({\n      id: generateId(),\n      contents: parseMarkupAndCookies(rawContents, { excludeCookies: true }),\n      rawContents,\n    })),\n  }));\n\n  // We sometimes end up with an extra, empty row - remove it if so.\n  if (_.last(table.contents).contents.length === 0) {\n    table.contents = table.contents.slice(0, table.contents.length - 1);\n  }\n\n  // Make sure each row has the same number of columns.\n  const maxNumColumns = Math.max(...table.contents.map(row => row.contents.length));\n  table.contents.forEach(row => {\n    if (row.contents.length < maxNumColumns) {\n      _.times(maxNumColumns - row.contents.length, () => {\n        row.contents.push({\n          id: generateId(),\n          contents: [],\n          rawContents: '',\n        });\n      });\n    }\n  });\n\n  return table;\n};\n\nexport const parseRawText = (rawText, { excludeContentElements = false } = {}) => {\n  const lines = rawText.split('\\n');\n\n  const LIST_HEADER_REGEX = /^\\s*([-+*]|(\\d+(\\.|\\)))) (.*)/;\n\n  let currentListHeaderNestingLevel = null;\n  const rawLineParts = _.flatten(\n    lines.map((line, lineIndex) => {\n      const numLeadingSpaces = line.match(/^( *)/)[0].length;\n\n      if (\n        currentListHeaderNestingLevel !== null &&\n        (numLeadingSpaces > currentListHeaderNestingLevel || !line.trim())\n      ) {\n        return [\n          {\n            type: 'raw-list-content',\n            line,\n          },\n        ];\n      } else {\n        currentListHeaderNestingLevel = null;\n\n        if (!!line.match(LIST_HEADER_REGEX) && !excludeContentElements) {\n          currentListHeaderNestingLevel = numLeadingSpaces;\n\n          return [\n            {\n              type: 'raw-list-header',\n              line,\n            },\n          ];\n        } else if (line.trim().startsWith('|') && !excludeContentElements) {\n          return [\n            {\n              type: 'raw-table',\n              line,\n            },\n          ];\n        } else {\n          return parseMarkupAndCookies(line, {\n            shouldAppendNewline: lineIndex !== lines.length - 1,\n            excludeCookies: true,\n          });\n        }\n      }\n    })\n  );\n\n  const processedLineParts = [];\n  for (let partIndex = 0; partIndex < rawLineParts.length; ++partIndex) {\n    const linePart = rawLineParts[partIndex];\n    if (linePart.type === 'raw-table') {\n      const tableLines = _.takeWhile(\n        rawLineParts.slice(partIndex),\n        part => part.type === 'raw-table'\n      ).map(part => part.line);\n\n      processedLineParts.push(parseTable(tableLines));\n\n      partIndex += tableLines.length - 1;\n    } else if (linePart.type === 'raw-list-header') {\n      const numLeadingSpaces = linePart.line.match(/^( *)/)[0].length;\n      const contentLines = _.takeWhile(\n        rawLineParts.slice(partIndex + 1),\n        part => part.type === 'raw-list-content'\n      )\n        .map(part => part.line)\n        .map(line =>\n          line.startsWith(' '.repeat(numLeadingSpaces + 2))\n            ? line.substr(numLeadingSpaces + 2)\n            : line.substr(numLeadingSpaces + 1)\n        );\n      if (contentLines[contentLines.length - 1] === '') {\n        contentLines[contentLines.length - 1] = ' ';\n      }\n      const contents = parseRawText(contentLines.join('\\n')).toJS();\n\n      partIndex += contentLines.length;\n\n      const isOrdered = !!linePart.line.match(/^\\s*\\d+[.)]/);\n\n      // Remove the leading -, +, *, or number characters.\n      let line = linePart.line.match(LIST_HEADER_REGEX)[4];\n\n      let forceNumber = null;\n      if (line.match(/^\\s*\\[@\\d+\\]/)) {\n        forceNumber = line.match(/^\\s*\\[@(\\d+)\\]/)[1];\n        line = line.replace(/^\\s*\\[@\\d+\\]\\s*/, '');\n      }\n\n      let checkboxState = null;\n      const isCheckbox = !!line.match(/^\\s*\\[[ X-]\\]/);\n      if (isCheckbox) {\n        const stateCharacter = line.match(/^\\s*\\[([ X-])\\]/)[1];\n        checkboxState = {\n          ' ': 'unchecked',\n          X: 'checked',\n          '-': 'partial',\n        }[stateCharacter];\n\n        line = line.replace(/^\\s*\\[[ X-]\\]\\s*/, '');\n      }\n\n      const newListItem = {\n        id: generateId(),\n        titleLine: parseMarkupAndCookies(line),\n        contents,\n        forceNumber,\n        isCheckbox,\n        checkboxState,\n      };\n\n      const lastIndex = processedLineParts.length - 1;\n      if (lastIndex >= 0 && processedLineParts[lastIndex].type === 'list') {\n        processedLineParts[lastIndex].items.push(newListItem);\n      } else {\n        processedLineParts.push({\n          type: 'list',\n          id: generateId(),\n          items: [newListItem],\n          bulletCharacter: linePart.line.trim()[0],\n          numberTerminatorCharacter: isOrdered ? linePart.line.match(/\\s*\\d+([.)])/)[1] : null,\n          isOrdered,\n        });\n      }\n    } else {\n      processedLineParts.push(linePart);\n    }\n  }\n\n  return fromJS(processedLineParts);\n};\n\nexport const _parsePlanningItems = rawText => {\n  const singlePlanningItemRegex = concatRegexes(/(DEADLINE|SCHEDULED|CLOSED):\\s*/, timestampRegex);\n  const optionalSinglePlanningItemRegex = RegExp(\n    '(' +\n      singlePlanningItemRegex\n        .toString()\n        .substring(1, singlePlanningItemRegex.toString().length - 1) +\n      ')?'\n  );\n\n  // FIXME: The whitespace part of the regex matches `rawText` inputs\n  //        like \" - indented list\\n - Foo\".\n  //        This is a mistake, because the input isn't really a\n  //        planning item. If the regexp could be adapted, we could\n  //        return earlier after the regexp check.\n  //        Before this can get cleaned up, this function needs loads\n  //        more tests, because currently it matches too many things.\n  //        It does work well for planning items, though.\n  const planningRegex = concatRegexes(\n    /^\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/,\n    optionalSinglePlanningItemRegex,\n    /\\s*/\n  );\n  const planningMatch = rawText.match(planningRegex);\n\n  const planningItems = fromJS(\n    [2, 17, 32]\n      .map(planningTypeIndex => {\n        const type = planningMatch[planningTypeIndex];\n        if (!type) {\n          return null;\n        }\n\n        const timestamp = timestampFromRegexMatch(\n          planningMatch,\n          _.range(planningTypeIndex + 1, planningTypeIndex + 1 + 13)\n        );\n\n        return { type, timestamp, id: generateId() };\n      })\n      .filter(item => !!item)\n  );\n\n  if (planningItems.size > 0) {\n    // The `rawText` can look like:\n    // `SCHEDULED: <2019-07-30 Tue>\n    //   - indented list\n    //      - Foo`\n    // For the remaining description, filter the planning item out\n    const remainingDescriptionWithoutPlanningItem = rawText\n      .split('\\n')\n      .filter(line => {\n        return !line.includes(planningMatch[0].trim());\n      })\n      .join('\\n');\n    return { planningItems, strippedDescription: remainingDescriptionWithoutPlanningItem };\n  } else {\n    return { planningItems: fromJS([]), strippedDescription: rawText };\n  }\n};\n\nconst parsePropertyList = rawText => {\n  const lines = rawText.split('\\n');\n  const propertiesLineIndex = lines.findIndex(line => line.trim() === ':PROPERTIES:');\n  const endLineIndex = lines.findIndex(line => line.trim() === ':END:');\n\n  if (\n    propertiesLineIndex === -1 ||\n    endLineIndex === -1 ||\n    !rawText.trim().startsWith(':PROPERTIES:')\n  ) {\n    return {\n      propertyListItems: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const propertyListItems = fromJS(\n    lines\n      .slice(propertiesLineIndex + 1, endLineIndex)\n      .map(line => {\n        const match = line.match(/:([^\\s]*):(?: (.*))?/);\n        if (!match) {\n          return null;\n        }\n\n        const value = !!match[2] ? parseMarkupAndCookies(match[2]) : null;\n\n        return {\n          property: match[1],\n          value,\n          id: generateId(),\n        };\n      })\n      .filter(result => !!result)\n  );\n\n  return {\n    propertyListItems,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nconst parseLogbook = rawText => {\n  const lines = rawText.split('\\n');\n  const logbookLineIndex = lines.findIndex(line => line.trim() === ':LOGBOOK:');\n  const endLineIndex = lines.findIndex(line => line.trim() === ':END:');\n\n  if (logbookLineIndex === -1 || endLineIndex === -1 || !rawText.trim().startsWith(':LOGBOOK:')) {\n    return {\n      logBookEntries: List(),\n      strippedDescription: rawText,\n    };\n  }\n\n  const logBookEntryStartRegex = concatRegexes(/^CLOCK: /, timestampRegex, /$/);\n  const logBookEntryFullRegex = concatRegexes(\n    /^CLOCK: /,\n    timestampRegex,\n    '/--/',\n    timestampRegex,\n    /\\s*=>\\s*\\S+$/\n  );\n  const logBookEntries = fromJS(\n    lines.slice(logbookLineIndex + 1, endLineIndex).map(line => {\n      const lineFullMatch = line.trim().match(logBookEntryFullRegex);\n      if (lineFullMatch) {\n        return {\n          start: timestampFromRegexMatch(lineFullMatch, _.range(1, 14)),\n          end: timestampFromRegexMatch(lineFullMatch, _.range(14, 31)),\n          id: generateId(),\n        };\n      }\n      const lineStartMatch = line.trim().match(logBookEntryStartRegex);\n      if (lineStartMatch) {\n        return {\n          start: timestampFromRegexMatch(lineStartMatch, _.range(1, 14)),\n          end: null,\n          id: generateId(),\n        };\n      }\n      return { raw: line.trimLeft(), id: generateId() };\n    })\n  );\n\n  return {\n    logBookEntries,\n    strippedDescription: lines.slice(endLineIndex + 1).join('\\n'),\n  };\n};\n\nexport const parseDescriptionPrefixElements = rawText => {\n  const planningItemsParse = _parsePlanningItems(rawText);\n  const propertyListParse = parsePropertyList(planningItemsParse.strippedDescription);\n  const logBookParse = parseLogbook(propertyListParse.strippedDescription);\n\n  return {\n    planningItems: planningItemsParse.planningItems,\n    propertyListItems: propertyListParse.propertyListItems,\n    strippedDescription: logBookParse.strippedDescription,\n    logBookEntries: logBookParse.logBookEntries,\n  };\n};\n\nfunction _updateHeaderFromDescription(header, description) {\n  const {\n    planningItems,\n    propertyListItems,\n    strippedDescription,\n    logBookEntries,\n  } = parseDescriptionPrefixElements(description);\n  return header\n    .set('rawDescription', strippedDescription)\n    .set('description', parseRawText(strippedDescription))\n    .set('planningItems', planningItems)\n    .set('propertyListItems', propertyListItems)\n    .set('logBookEntries', logBookEntries);\n}\n\nconst defaultKeywordSets = fromJS([\n  {\n    keywords: ['TODO', 'DONE'],\n    completedKeywords: ['DONE'],\n    default: true,\n  },\n]);\n\nexport const parseTitleLine = (titleLine, todoKeywordSets) => {\n  const allKeywords = todoKeywordSets.flatMap(todoKeywordSet => {\n    return todoKeywordSet.get('keywords');\n  });\n  const todoKeyword = allKeywords.filter(keyword => titleLine.startsWith(keyword + ' ')).first();\n  let rawTitle = titleLine;\n  if (todoKeyword) {\n    rawTitle = rawTitle.substr(todoKeyword.length + 1);\n  }\n\n  // Check for tags.\n  let tags = [];\n  if (rawTitle.trimRight().endsWith(':')) {\n    const titleParts = rawTitle.trimRight().split(' ');\n    const possibleTags = titleParts[titleParts.length - 1];\n    if (/^:[^\\s]+:$/.test(possibleTags)) {\n      rawTitle = rawTitle.substr(0, rawTitle.length - possibleTags.length);\n      tags = possibleTags.split(':').filter(tag => tag !== '');\n    }\n  }\n\n  const title = parseMarkupAndCookies(rawTitle);\n\n  return fromJS({ title, rawTitle, todoKeyword, tags });\n};\n\nexport const newHeaderWithTitle = (line, nestingLevel, todoKeywordSets) => {\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  const titleLine = parseTitleLine(line, todoKeywordSets);\n  return fromJS({\n    titleLine,\n    rawDescription: '',\n    description: [],\n    opened: false,\n    id: generateId(),\n    nestingLevel,\n    planningItems: [],\n    propertyListItems: [],\n    logBookEntries: [],\n  });\n};\n\nconst concatRegexes = (...regexes) =>\n  regexes.reduce((prev, curr) =>\n    RegExp(\n      prev.toString().substring(1, prev.toString().length - 1) +\n        curr.toString().substring(1, curr.toString().length - 1)\n    )\n  );\n\nexport const newHeaderFromText = (rawText, todoKeywordSets) => {\n  // This function is currently only used for capture templates.\n  // Hence, it's acceptable that it is opinionated on treating\n  // whitespace.\n  const titleLine = rawText.split('\\n')[0].replace(/^\\**\\s*|\\s*$/g, '');\n  const description = rawText\n    .split('\\n')\n    .slice(1)\n    .join('\\n');\n\n  const newHeader = newHeaderWithTitle(titleLine, 1, todoKeywordSets);\n  return _updateHeaderFromDescription(newHeader, description);\n};\n\nexport const parseTodoKeywordConfig = line => {\n  if (!line.startsWith('#+TODO: ') && !line.startsWith('#+TYP_TODO: ')) {\n    return null;\n  }\n\n  const keywordsString = line.substr(line.indexOf(':') + 2);\n  const keywordTokens = keywordsString.split(/\\s/);\n  const keywords = keywordTokens\n    .filter(keyword => keyword !== '|')\n    // Remove fast access TODO states suffix from keyword, because\n    // there's no UI to handle those in organice\n    // https://orgmode.org/manual/Fast-access-to-TODO-states.html#Fast-access-to-TODO-states\n    .map(keyword => keyword.replace(/\\(.[!@]?(\\/[!@])?\\)$/, ''));\n\n  const pipeIndex = keywordTokens.indexOf('|');\n  const completedKeywords = pipeIndex >= 0 ? keywords.slice(pipeIndex) : [];\n\n  return fromJS({\n    keywords,\n    completedKeywords,\n    configLine: line,\n    default: false,\n  });\n};\n\nexport const parseOrg = fileContents => {\n  let headers = List();\n  const lines = fileContents.split('\\n');\n\n  let todoKeywordSets = List();\n  let fileConfigLines = List();\n  let linesBeforeHeadings = List();\n\n  lines.forEach(line => {\n    // A header has to start with at least one consecutive asterisk\n    // followed by a blank\n    // eslint-disable-next-line no-useless-escape\n    if (line.match(/^\\*+\\ /)) {\n      let nestingLevel = line.indexOf(' ');\n      if (nestingLevel === -1) {\n        nestingLevel = line.length;\n      }\n      const title = line.substr(nestingLevel + 1);\n      headers = headers.push(newHeaderWithTitle(title, nestingLevel, todoKeywordSets));\n    } else {\n      if (headers.size === 0) {\n        const newKeywordSet = parseTodoKeywordConfig(line);\n        if (newKeywordSet) {\n          todoKeywordSets = todoKeywordSets.push(newKeywordSet);\n        } else if (line.startsWith('#+')) {\n          fileConfigLines = fileConfigLines.push(line);\n        } else {\n          linesBeforeHeadings = linesBeforeHeadings.push(line);\n        }\n      } else {\n        headers = headers.updateIn([headers.size - 1, 'rawDescription'], rawDescription => {\n          // In the beginning of the `parseOrg` function, the original\n          // fileContent lines are split by '\\n'. Therefore, if the\n          // original line was a newline, it will show up here as an\n          // empty `line` with an empty `rawDescription`. Add a\n          // newline here to the list, so that the exported file will\n          // have newlines in the same places as the originally parsed\n          // file.\n          if (!line && !rawDescription) return '\\n';\n\n          if (rawDescription.length === 0) return line;\n\n          return rawDescription + '\\n' + line;\n        });\n      }\n    }\n  });\n\n  if (todoKeywordSets.size === 0) {\n    todoKeywordSets = defaultKeywordSets;\n  }\n\n  headers = headers.map(header => {\n    const description = header.get('rawDescription');\n    return _updateHeaderFromDescription(header, description);\n  });\n\n  return fromJS({\n    headers,\n    todoKeywordSets,\n    fileConfigLines,\n    linesBeforeHeadings,\n  });\n};\n","import { Map, List, fromJS } from 'immutable';\nimport _ from 'lodash';\n\nimport headline_filter_parser from '../lib/headline_filter_parser';\nimport { isMatch, computeCompletionsForDatalist } from '../lib/headline_filter';\n\nimport {\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  getTodoKeywordSetsAsFlattenedArray,\n} from '../lib/org_utils';\n\nimport {\n  parseOrg,\n  parseTitleLine,\n  parseRawText,\n  parseDescriptionPrefixElements,\n  parseMarkupAndCookies,\n  newHeaderWithTitle,\n  newHeaderFromText,\n} from '../lib/parse_org';\nimport { attributedStringToRawText } from '../lib/export_org';\nimport {\n  indexOfHeaderWithId,\n  headerWithId,\n  parentIdOfHeaderWithId,\n  subheadersOfHeaderWithId,\n  numSubheadersOfHeaderWithId,\n  indexOfPreviousSibling,\n  openDirectParent,\n  openHeaderWithPath,\n  nextVisibleHeaderAfterIndex,\n  previousVisibleHeaderAfterIndex,\n  updateTableContainingCellId,\n  newEmptyTableRowLikeRows,\n  newEmptyTableCell,\n  headerThatContainsTableCellId,\n  headerWithPath,\n  pathAndPartOfListItemWithIdInHeaders,\n  pathAndPartOfTimestampItemWithIdInHeaders,\n  todoKeywordSetForKeyword,\n  inheritedValueOfProperty,\n} from '../lib/org_utils';\nimport { getCurrentTimestamp, applyRepeater, renderAsText } from '../lib/timestamps';\nimport generateId from '../lib/id_generator';\n\nconst displayFile = (state, action) => {\n  const parsedFile = parseOrg(action.contents);\n\n  return state\n    .set('path', action.path)\n    .set('contents', action.contents)\n    .set('headers', parsedFile.get('headers'))\n    .set('todoKeywordSets', parsedFile.get('todoKeywordSets'))\n    .set('fileConfigLines', parsedFile.get('fileConfigLines'))\n    .set('linesBeforeHeadings', parsedFile.get('linesBeforeHeadings'));\n};\n\nconst stopDisplayingFile = state =>\n  state\n    .set('path', null)\n    .set('contents', null)\n    .set('headers', null)\n    .set('filteredHeaders', null)\n    .set('todoKeywordSets', null)\n    .set('fileConfigLines', null)\n    .set('linesBeforeHeadings', null);\n\nconst openHeader = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'opened'], true);\n};\n\nconst toggleHeaderOpened = (state, action) => {\n  const headers = state.get('headers');\n\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const isOpened = headerWithId(headers, action.headerId).get('opened');\n\n  if (isOpened && state.get('focusedHeaderId') === action.headerId) {\n    return state;\n  }\n\n  if (isOpened) {\n    const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n    subheaders.forEach(index => {\n      state = state.setIn(['headers', headerIndex + index + 1, 'opened'], false);\n    });\n  }\n\n  return state.setIn(['headers', headerIndex, 'opened'], !isOpened);\n};\n\nconst selectHeader = (state, action) => {\n  return state.set('selectedHeaderId', action.headerId);\n};\n\nconst openParentsOfHeader = (state, action) => {\n  let headers = state.get('headers');\n  const { headerId } = action;\n\n  let parentHeaderId = parentIdOfHeaderWithId(headers, headerId);\n  while (!!parentHeaderId) {\n    const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeaderId);\n    headers = headers.setIn([parentHeaderIndex, 'opened'], true);\n    parentHeaderId = parentIdOfHeaderWithId(headers, parentHeaderId);\n  }\n\n  return state.set('headers', headers);\n};\n\nconst updateCookiesInAttributedStringWithChildCompletionStates = (parts, completionStates) => {\n  const doneCount = completionStates.filter(isDone => isDone).length;\n  const totalCount = completionStates.length;\n\n  return parts.map(part => {\n    switch (part.get('type')) {\n      case 'fraction-cookie':\n        return part.set('fraction', List([doneCount, totalCount]));\n      case 'percentage-cookie':\n        return part.set('percentage', Math.floor((doneCount / totalCount) * 100));\n      default:\n        return part;\n    }\n  });\n};\n\nconst updateCookiesOfHeaderWithId = (state, headerId) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, headerId);\n\n  const directChildren = [];\n  for (let i = 0; i < subheaders.size; ++i) {\n    const subheader = subheaders.get(i);\n    directChildren.push(subheader);\n\n    const subheaderSubheaders = subheadersOfHeaderWithId(headers, subheader.get('id'));\n    i += subheaderSubheaders.size;\n  }\n\n  let completionStates = directChildren\n    .map(header => header.getIn(['titleLine', 'todoKeyword']))\n    .filter(todoKeyword => !!todoKeyword)\n    .map(todoKeyword =>\n      todoKeywordSetForKeyword(state.get('todoKeywordSets'), todoKeyword)\n        .get('completedKeywords')\n        .contains(todoKeyword)\n    );\n\n  // If there are no headers with possible completion states, check for plain lists instead.\n  if (completionStates.length === 0) {\n    completionStates = headers\n      .get(headerIndex)\n      .get('description')\n      .filter(part => part.get('type') === 'list')\n      .flatMap(listPart => listPart.get('items'))\n      .filter(item => item.get('isCheckbox'))\n      .map(item => item.get('checkboxState') === 'checked')\n      .toJS();\n  }\n\n  return state\n    .updateIn(['headers', headerIndex, 'titleLine', 'title'], title =>\n      updateCookiesInAttributedStringWithChildCompletionStates(title, completionStates)\n    )\n    .updateIn(['headers', headerIndex, 'titleLine'], titleLine =>\n      titleLine.set('rawTitle', attributedStringToRawText(titleLine.get('title')))\n    );\n};\n\nconst updateCookiesOfParentOfHeaderWithId = (state, headerId) => {\n  const parentHeaderId = parentIdOfHeaderWithId(state.get('headers'), headerId);\n  if (!parentHeaderId) {\n    return state;\n  }\n\n  return updateCookiesOfHeaderWithId(state, parentHeaderId);\n};\n\nconst advanceTodoState = (state, action) => {\n  const headerId = action.headerId || state.get('selectedHeaderId');\n  if (!headerId) {\n    return state;\n  }\n\n  const headers = state.get('headers');\n  const header = headerWithId(headers, headerId);\n  const headerIndex = indexOfHeaderWithId(headers, headerId);\n\n  const currentTodoState = header.getIn(['titleLine', 'todoKeyword']);\n  const currentTodoSet = todoKeywordSetForKeyword(state.get('todoKeywordSets'), currentTodoState);\n\n  const currentStateIndex = currentTodoSet.get('keywords').indexOf(currentTodoState);\n  const newStateIndex = currentStateIndex + 1;\n  const newTodoState = currentTodoSet.get('keywords').get(newStateIndex) || '';\n\n  const indexedPlanningItemsWithRepeaters = header\n    .get('planningItems')\n    .map((planningItem, index) => [planningItem, index])\n    .filter(([planningItem]) => !!planningItem.getIn(['timestamp', 'repeaterType']));\n\n  state = updateHeadlines(\n    currentTodoSet,\n    newTodoState,\n    indexedPlanningItemsWithRepeaters,\n    state,\n    headerIndex,\n    currentTodoState\n  );\n\n  state = updateCookiesOfParentOfHeaderWithId(state, headerId);\n\n  return state;\n};\n\nconst enterEditMode = (state, action) => state.set('editMode', action.editModeType);\n\nconst exitEditMode = state => state.set('editMode', null);\n\nconst updateHeaderTitle = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const newTitleLine = parseTitleLine(action.newRawTitle.trim(), state.get('todoKeywordSets'));\n\n  state = state.setIn(['headers', headerIndex, 'titleLine'], newTitleLine);\n\n  return updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n};\n\nconst updateHeaderDescription = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  return state.updateIn(['headers', headerIndex], header => {\n    const {\n      planningItems,\n      propertyListItems,\n      strippedDescription,\n      logBookEntries,\n    } = parseDescriptionPrefixElements(action.newRawDescription);\n\n    return header\n      .set('rawDescription', strippedDescription)\n      .set('description', parseRawText(strippedDescription))\n      .set('planningItems', planningItems)\n      .set('propertyListItems', propertyListItems)\n      .set('logBookEntries', logBookEntries);\n  });\n};\n\nconst addHeader = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n  const newHeader = newHeaderWithTitle(\n    todoKeyword ? todoKeyword + ' ' : '',\n    header.get('nestingLevel'),\n    state.get('todoKeywordSets')\n  );\n\n  if (action.headerId === state.get('focusedHeaderId')) {\n    state = state.set('focusedHeaderId', null);\n  }\n\n  return state.update('headers', headers =>\n    headers.insert(headerIndex + subheaders.size + 1, newHeader)\n  );\n};\n\nconst selectNextSiblingHeader = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  const nextSibling = headers.get(headerIndex + subheaders.size + 1);\n\n  if (!nextSibling || nextSibling.get('nestingLevel') !== header.get('nestingLevel')) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextSibling.get('id'));\n};\n\nconst selectNextVisibleHeader = state => {\n  const headers = state.get('headers');\n\n  if (state.get('selectedHeaderId') === undefined) {\n    return state.set('selectedHeaderId', headers.getIn([0, 'id']));\n  }\n\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const nextVisibleHeader = nextVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!nextVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', nextVisibleHeader.get('id'));\n};\n\nconst selectPreviousVisibleHeader = state => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, state.get('selectedHeaderId'));\n\n  const previousVisibleHeader = previousVisibleHeaderAfterIndex(headers, headerIndex);\n\n  if (!previousVisibleHeader) {\n    return state;\n  }\n\n  return state.set('selectedHeaderId', previousVisibleHeader.get('id'));\n};\n\nconst removeHeader = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const numHeadersToRemove = 1 + subheaders.size;\n\n  const parentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  _.times(numHeadersToRemove).forEach(() => {\n    headers = headers.delete(headerIndex);\n  });\n\n  if (action.headerId === state.get('focusedHeaderId')) {\n    state = state.set('focusedHeaderId', null);\n  }\n\n  state = state.set('headers', headers);\n\n  if (parentHeaderId) {\n    state = updateCookiesOfHeaderWithId(state, parentHeaderId);\n  }\n\n  return state;\n};\n\nconst moveHeaderUp = (state, action) => {\n  let headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousSiblingIndex = indexOfPreviousSibling(headers, headerIndex);\n  if (previousSiblingIndex === null) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  _.times(1 + subheaders.size).forEach(() => {\n    headers = headers.insert(previousSiblingIndex, headers.get(headerIndex + subheaders.size));\n    headers = headers.delete(headerIndex + subheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderDown = (state, action) => {\n  let headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n  const nextSiblingIndex = headerIndex + subheaders.size + 1;\n  const nextSibling = headers.get(nextSiblingIndex);\n  if (nextSibling.get('nestingLevel') < header.get('nestingLevel')) {\n    return state;\n  }\n\n  const nextSiblingSubheaders = subheadersOfHeaderWithId(headers, nextSibling.get('id'));\n  _.times(1 + nextSiblingSubheaders.size).forEach(() => {\n    headers = headers.insert(\n      headerIndex,\n      headers.get(nextSiblingIndex + nextSiblingSubheaders.size)\n    );\n    headers = headers.delete(nextSiblingIndex + nextSiblingSubheaders.size + 1);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst moveHeaderLeft = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveHeaderRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex }, '+');\n  state = openDirectParent(state, action.headerId);\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeLeft = (state, action) => {\n  const headers = state.get('headers');\n  const header = headerWithId(headers, action.headerId);\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  if (header.get('nestingLevel') === 1) {\n    return state;\n  }\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '-');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return state;\n};\n\nconst moveSubtreeRight = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n\n  const previousParentHeaderId = parentIdOfHeaderWithId(headers, action.headerId);\n\n  const subheaders = subheadersOfHeaderWithId(headers, action.headerId);\n\n  state = shiftTreeNestingLevel({ state, headerIndex, subheaders }, '+');\n  state = updateCookies(state, previousParentHeaderId, action);\n\n  return openDirectParent(state, action.headerId);\n};\n\nconst refileSubtree = (state, action) => {\n  /**\n   * Move an item in an immutablejs List from one index to another.\n   * @param {list} List\n   * @param {integer} fromIndex\n   * @param {integer} toIndex\n   * @param {any} integer\n   */\n  function moveItem({ list, fromIndex, toIndex, item }) {\n    const targetItem = list.get(toIndex);\n    list = list.delete(fromIndex);\n    const targetIndex = list.indexOf(targetItem);\n    return list.insert(targetIndex + 1, item);\n  }\n\n  const { sourceHeaderId, targetHeaderId } = action;\n  let headers = state.get('headers');\n  let sourceHeader = headerWithId(headers, sourceHeaderId);\n  const sourceHeaderIndex = indexOfHeaderWithId(headers, sourceHeaderId);\n  let targetHeaderIndex = indexOfHeaderWithId(headers, targetHeaderId);\n\n  // Do not attempt to move a header to itself\n  if (sourceHeaderIndex === targetHeaderIndex) return state;\n\n  let subheadersOfSourceHeader = subheadersOfHeaderWithId(headers, sourceHeaderId);\n\n  const nestingLevelSource = state.getIn(['headers', sourceHeaderIndex, 'nestingLevel']);\n  const nestingLevelTarget = state.getIn(['headers', targetHeaderIndex, 'nestingLevel']);\n\n  // Indent the newly placed sourceheader so that it fits underneath the targetHeader\n  sourceHeader = sourceHeader.set('nestingLevel', nestingLevelTarget + 1);\n\n  // Put the sourceHeader into the right slot after the targetHeader\n  headers = moveItem({\n    list: headers,\n    fromIndex: sourceHeaderIndex,\n    toIndex: targetHeaderIndex,\n    item: sourceHeader,\n  });\n\n  // Put the subheaders of the sourceHeader right after\n  subheadersOfSourceHeader.forEach((subheader, index) => {\n    subheader = subheader.set(\n      'nestingLevel',\n      // target\n      // 1\n      //   source\n      //   2 (1)\n      //     subheader\n      //      3 (2)\n      //       subheader\n      //       4 (3)\n      subheader.get('nestingLevel') - nestingLevelSource + nestingLevelTarget + 1\n    );\n    const fromIndex = indexOfHeaderWithId(headers, subheader.get('id'));\n\n    targetHeaderIndex = indexOfHeaderWithId(headers, targetHeaderId);\n    const toIndex = targetHeaderIndex + index + 1;\n\n    headers = moveItem({\n      list: headers,\n      fromIndex,\n      toIndex,\n      item: subheader,\n    });\n  });\n\n  state = updateCookies(state, sourceHeaderId, action);\n  state = updateCookies(state, targetHeaderId, action);\n\n  state = state.set('headers', headers);\n\n  return state;\n};\n\nconst focusHeader = (state, action) => {\n  return state.set('focusedHeaderId', action.headerId);\n};\n\nconst unfocusHeader = state => state.set('focusedHeaderId', null);\n\nconst applyOpennessState = state => {\n  const opennessState = state.get('opennessState');\n  if (!opennessState) {\n    return state;\n  }\n\n  const fileOpennessState = opennessState.get(state.get('path'));\n  if (!fileOpennessState || fileOpennessState.size === 0) {\n    return state;\n  }\n\n  let headers = state.get('headers');\n  fileOpennessState.forEach(openHeaderPath => {\n    headers = openHeaderWithPath(headers, openHeaderPath);\n  });\n\n  return state.set('headers', headers);\n};\n\nconst setDirty = (state, action) => state.set('isDirty', action.isDirty);\n\nconst setSelectedTableCellId = (state, action) => state.set('selectedTableCellId', action.cellId);\n\nconst updateDescriptionOfHeaderContainingTableCell = (state, cellId, header = null) => {\n  const headers = state.get('headers');\n  if (!header) {\n    header = headerThatContainsTableCellId(headers, cellId);\n  }\n  const headerIndex = indexOfHeaderWithId(headers, header.get('id'));\n\n  return state.updateIn(['headers', headerIndex], header =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n};\n\nconst addNewTableRow = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, rowIndex => rows =>\n      rows.insert(rowIndex + 1, newEmptyTableRowLikeRows(rows))\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableRow = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, rowIndex => rows =>\n      rows.delete(rowIndex)\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst addNewTableColumn = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => rows =>\n      rows.map(row =>\n        row.update('contents', contents => contents.insert(colIndex + 1, newEmptyTableCell()))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst removeTableColumn = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  const containingHeader = headerThatContainsTableCellId(state.get('headers'), selectedTableCellId);\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, colIndex) => rows =>\n      rows.map(row => row.update('contents', contents => contents.delete(colIndex)))\n    )\n  );\n\n  state = state.set('selectedTableCellId', null);\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId, containingHeader);\n};\n\nconst moveTableRowDown = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, rowIndex => rows =>\n      rowIndex + 1 === rows.size\n        ? rows\n        : rows.insert(rowIndex, rows.get(rowIndex + 1)).delete(rowIndex + 2)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableRowUp = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, rowIndex => rows =>\n      rowIndex === 0 ? rows : rows.insert(rowIndex - 1, rows.get(rowIndex)).delete(rowIndex + 1)\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnLeft = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => rows =>\n      columnIndex === 0\n        ? rows\n        : rows.map(row =>\n            row.update('contents', contents =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex - 1, contents.get(columnIndex))\n                    .delete(columnIndex + 1)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst moveTableColumnRight = state => {\n  const selectedTableCellId = state.get('selectedTableCellId');\n  if (!selectedTableCellId) {\n    return state;\n  }\n\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, selectedTableCellId, (_rowIndex, columnIndex) => rows =>\n      columnIndex + 1 >= rows.getIn([0, 'contents']).size\n        ? rows\n        : rows.map(row =>\n            row.update('contents', contents =>\n              contents.size === 0\n                ? contents\n                : contents\n                    .insert(columnIndex, contents.get(columnIndex + 1))\n                    .delete(columnIndex + 2)\n            )\n          )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, selectedTableCellId);\n};\n\nconst updateTableCellValue = (state, action) => {\n  state = state.update('headers', headers =>\n    updateTableContainingCellId(headers, action.cellId, (rowIndex, colIndex) => rows =>\n      rows.updateIn([rowIndex, 'contents', colIndex], cell =>\n        cell\n          .set('rawContents', action.newValue)\n          .set('contents', fromJS(parseMarkupAndCookies(action.newValue, { excludeCookies: true })))\n      )\n    )\n  );\n\n  return updateDescriptionOfHeaderContainingTableCell(state, action.cellId);\n};\n\nconst insertCapture = (state, action) => {\n  const headers = state.get('headers');\n  const { template, content, shouldPrepend } = action;\n\n  const parentHeader = headerWithPath(headers, template.get('headerPaths'));\n  if (!parentHeader) {\n    return state;\n  }\n\n  const newHeader = newHeaderFromText(content, state.get('todoKeywordSets')).set(\n    'nestingLevel',\n    parentHeader.get('nestingLevel') + 1\n  );\n\n  const parentHeaderIndex = indexOfHeaderWithId(headers, parentHeader.get('id'));\n  const numSubheaders = numSubheadersOfHeaderWithId(headers, parentHeader.get('id'));\n  const newIndex = parentHeaderIndex + 1 + (shouldPrepend ? 0 : numSubheaders);\n\n  state = state.update('headers', headers => headers.insert(newIndex, newHeader));\n\n  state = updateCookiesOfHeaderWithId(state, parentHeader.get('id'));\n\n  return state;\n};\n\nconst clearPendingCapture = state => state.set('pendingCapture', null);\n\nconst updateParentListCheckboxes = (state, itemPath) => {\n  const parentListItemPath = itemPath.slice(0, itemPath.length - 4);\n  const parentListItem = state.getIn(parentListItemPath);\n  if (!parentListItem.has('checkboxState')) {\n    return state;\n  }\n\n  const childrenCheckedStates = parentListItem\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .flatMap(listPart =>\n      listPart\n        .get('items')\n        .filter(item => item.get('isCheckbox'))\n        .map(checkboxItem => checkboxItem.get('checkboxState'))\n    );\n\n  if (childrenCheckedStates.every(state => state === 'checked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'checked');\n  } else if (childrenCheckedStates.every(state => state === 'unchecked')) {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'unchecked');\n  } else {\n    state = state.setIn(parentListItemPath.concat(['checkboxState']), 'partial');\n  }\n\n  const childCompletionStates = childrenCheckedStates\n    .map(state => {\n      switch (state) {\n        case 'checked':\n          return true;\n        case 'unchecked':\n          return false;\n        case 'partial':\n          return false;\n        default:\n          return false;\n      }\n    })\n    .toJS();\n\n  state = state.updateIn(parentListItemPath.concat('titleLine'), titleLine =>\n    updateCookiesInAttributedStringWithChildCompletionStates(titleLine, childCompletionStates)\n  );\n\n  if (parentListItem.get('isCheckbox')) {\n    return updateParentListCheckboxes(state, parentListItemPath);\n  } else {\n    return state;\n  }\n};\n\nconst advanceCheckboxState = (state, action) => {\n  const pathAndPart = pathAndPartOfListItemWithIdInHeaders(state.get('headers'), action.listItemId);\n  const { path, listItemPart } = pathAndPart;\n\n  const hasDirectCheckboxChildren = listItemPart\n    .get('contents')\n    .filter(part => part.get('type') === 'list')\n    .some(listPart => listPart.get('items').some(item => item.get('isCheckbox')));\n  if (hasDirectCheckboxChildren) {\n    return state;\n  }\n\n  const newCheckboxState = {\n    checked: 'unchecked',\n    unchecked: 'checked',\n    partial: 'unchecked',\n  }[listItemPart.get('checkboxState')];\n\n  state = state.setIn(['headers'].concat(path).concat(['checkboxState']), newCheckboxState);\n  state = updateParentListCheckboxes(state, ['headers'].concat(path));\n\n  const headerIndex = path[0];\n  state = updateCookiesOfHeaderWithId(state, state.getIn(['headers', headerIndex, 'id']));\n  state = state.updateIn(['headers', headerIndex], header =>\n    header.set('rawDescription', attributedStringToRawText(header.get('description')))\n  );\n\n  return state;\n};\n\nconst setLastSyncAt = (state, action) => state.set('lastSyncAt', action.lastSyncAt);\n\nconst setHeaderTags = (state, action) => {\n  const headers = state.get('headers');\n  const headerIndex = indexOfHeaderWithId(headers, action.headerId);\n  if (headerIndex === -1) {\n    return state;\n  }\n\n  return state.setIn(['headers', headerIndex, 'titleLine', 'tags'], action.tags);\n};\n\nconst reorderTags = (state, action) => {\n  const selectedHeaderId = state.get('selectedHeaderId');\n  if (!selectedHeaderId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), selectedHeaderId);\n\n  return state.updateIn(['headers', headerIndex, 'titleLine', 'tags'], tags =>\n    tags.splice(action.fromIndex, 1).splice(action.toIndex, 0, tags.get(action.fromIndex))\n  );\n};\n\nconst reorderPropertyList = (state, action) => {\n  const headerId = action.headerId;\n  if (!headerId) {\n    return state;\n  }\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\n    propertyListItems\n      .splice(action.fromIndex, 1)\n      .splice(action.toIndex, 0, propertyListItems.get(action.fromIndex))\n  );\n};\n\nconst updateTimestampWithId = (state, action) => {\n  const pathAndPart = pathAndPartOfTimestampItemWithIdInHeaders(\n    state.get('headers'),\n    action.timestampId\n  );\n  if (!pathAndPart) {\n    return state;\n  }\n\n  const { path } = pathAndPart;\n  const headerIndex = path[0];\n\n  return state\n    .setIn(['headers'].concat(path), action.newTimestamp)\n    .updateIn(['headers', headerIndex], header =>\n      header.set('rawDescription', attributedStringToRawText(header.get('description')))\n    )\n    .updateIn(['headers', headerIndex], header =>\n      header.setIn(\n        ['titleLine', 'rawTitle'],\n        attributedStringToRawText(header.getIn(['titleLine', 'title']))\n      )\n    );\n};\n\nconst updatePlanningItemTimestamp = (state, action) => {\n  const { headerId, planningItemIndex, newTimestamp } = action;\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), headerId);\n\n  return state.setIn(\n    ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n    newTimestamp\n  );\n};\n\nconst addNewPlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  const newPlanningItem = fromJS({\n    id: generateId(),\n    type: action.planningType,\n    timestamp: getCurrentTimestamp(),\n  });\n\n  return state.updateIn(['headers', headerIndex, 'planningItems'], planningItems =>\n    !!planningItems ? planningItems.push(newPlanningItem) : List([newPlanningItem])\n  );\n};\n\nconst removePlanningItem = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n  const { planningItemIndex } = action;\n\n  return state.removeIn(['headers', headerIndex, 'planningItems', planningItemIndex]);\n};\n\nexport const updatePropertyListItems = (state, action) => {\n  const headerIndex = indexOfHeaderWithId(state.get('headers'), action.headerId);\n\n  return state.setIn(['headers', headerIndex, 'propertyListItems'], action.newPropertyListItems);\n};\n\nexport const setLogEntryStop = (state, action) => {\n  const { headerId, entryId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const entryIndex = state\n    .getIn(['headers', headerIdx, 'logBookEntries'])\n    .findIndex(entry => entry.get('id') === entryId);\n  return state.setIn(['headers', headerIdx, 'logBookEntries', entryIndex, 'end'], fromJS(time));\n};\n\nexport const createLogEntryStart = (state, action) => {\n  const { headerId, time } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  const newEntry = fromJS({\n    id: generateId(),\n    start: time,\n    end: null,\n  });\n  return state.updateIn(['headers', headerIdx, 'logBookEntries'], entries =>\n    !!entries ? entries.unshift(newEntry) : List([newEntry])\n  );\n};\n\nexport const updateLogEntryTime = (state, action) => {\n  const { headerId, entryIndex, entryType, newTime } = action;\n  const headerIdx = indexOfHeaderWithId(state.get('headers'), headerId);\n  return state.setIn(\n    ['headers', headerIdx, 'logBookEntries', entryIndex, entryType],\n    fromJS(newTime)\n  );\n};\n\nexport const setSearchFilterInformation = (state, action) => {\n  const { searchFilter, cursorPosition, context } = action;\n  const headers = state.get('headers');\n  state = state.asMutable();\n\n  let searchFilterValid = true;\n  let searchFilterExpr;\n  try {\n    searchFilterExpr = headline_filter_parser.parse(searchFilter);\n    state.setIn(['search', 'searchFilterExpr'], searchFilterExpr);\n  } catch (e) {\n    // No need to print this parser exceptions. They are expected, see\n    // *.grammar.pegjs. However, we don't need to update the filtered\n    // headers when given an invalid search filter.\n    searchFilterValid = false;\n  }\n\n  state.setIn(['search', 'searchFilterValid'], searchFilterValid);\n  // Only run filter if a filter is given and parsing was successfull\n  if (searchFilterValid) {\n    let filteredHeaders = headers.filter(isMatch(searchFilterExpr));\n\n    // Filter selectedHeader and its subheaders from `headers`,\n    // because you don't want to refile a header to itself or to one\n    // of it's subheaders.\n    if (context === 'refile') {\n      const selectedHeaderId = state.get('selectedHeaderId');\n      const subheaders = subheadersOfHeaderWithId(headers, selectedHeaderId);\n      let filterIds = subheaders.map(s => s.get('id')).toJS();\n      filterIds.push(selectedHeaderId);\n      filteredHeaders = filteredHeaders.filter(h => {\n        return !filterIds.includes(h.get('id'));\n      });\n    }\n\n    state.setIn(['search', 'filteredHeaders'], filteredHeaders);\n  }\n\n  state.setIn(['search', 'searchFilter'], searchFilter);\n\n  // INFO: This is a POC draft of a future feature\n  // This could come from the last session, hence from localStorage.\n  // Just some more examples for now:\n  const lastUsedFilterStrings = [\n    'TODO organice',\n    '-organice :medium',\n    '-DONE doc|man :assignee:none',\n  ];\n\n  let searchFilterSuggestions = [];\n  if (_.isEmpty(searchFilter)) {\n    // Only for an empty filter string,  provide last used filters as suggestions.\n    searchFilterSuggestions = lastUsedFilterStrings;\n  } else {\n    const todoKeywords = getTodoKeywordSetsAsFlattenedArray(state);\n    const tagNames = extractAllOrgTags(headers).toJS();\n    const allProperties = extractAllOrgProperties(headers).toJS();\n    searchFilterSuggestions = computeCompletionsForDatalist(todoKeywords, tagNames, allProperties)(\n      searchFilterExpr,\n      searchFilter,\n      cursorPosition\n    );\n  }\n\n  state.setIn(['search', 'searchFilterSuggestions'], searchFilterSuggestions);\n\n  return state.asImmutable();\n};\n\nconst setOrgFileErrorMessage = (state, action) => state.set('orgFileErrorMessage', action.message);\n\nexport default (state = Map(), action) => {\n  if (action.dirtying) {\n    state = state.set('isDirty', true);\n  }\n\n  switch (action.type) {\n    case 'DISPLAY_FILE':\n      return displayFile(state, action);\n    case 'STOP_DISPLAYING_FILE':\n      return stopDisplayingFile(state, action);\n    case 'TOGGLE_HEADER_OPENED':\n      return toggleHeaderOpened(state, action);\n    case 'OPEN_HEADER':\n      return openHeader(state, action);\n    case 'SELECT_HEADER':\n      return selectHeader(state, action);\n    case 'OPEN_PARENTS_OF_HEADER':\n      return openParentsOfHeader(state, action);\n    case 'ADVANCE_TODO_STATE':\n      return advanceTodoState(state, action);\n    case 'ENTER_EDIT_MODE':\n      return enterEditMode(state, action);\n    case 'EXIT_EDIT_MODE':\n      return exitEditMode(state, action);\n    case 'UPDATE_HEADER_TITLE':\n      return updateHeaderTitle(state, action);\n    case 'UPDATE_HEADER_DESCRIPTION':\n      return updateHeaderDescription(state, action);\n    case 'ADD_HEADER':\n      return addHeader(state, action);\n    case 'SELECT_NEXT_SIBLING_HEADER':\n      return selectNextSiblingHeader(state, action);\n    case 'SELECT_NEXT_VISIBLE_HEADER':\n      return selectNextVisibleHeader(state, action);\n    case 'SELECT_PREVIOUS_VISIBLE_HEADER':\n      return selectPreviousVisibleHeader(state, action);\n    case 'REMOVE_HEADER':\n      return removeHeader(state, action);\n    case 'MOVE_HEADER_UP':\n      return moveHeaderUp(state, action);\n    case 'MOVE_HEADER_DOWN':\n      return moveHeaderDown(state, action);\n    case 'MOVE_HEADER_LEFT':\n      return moveHeaderLeft(state, action);\n    case 'MOVE_HEADER_RIGHT':\n      return moveHeaderRight(state, action);\n    case 'MOVE_SUBTREE_LEFT':\n      return moveSubtreeLeft(state, action);\n    case 'MOVE_SUBTREE_RIGHT':\n      return moveSubtreeRight(state, action);\n    case 'REFILE_SUBTREE':\n      return refileSubtree(state, action);\n    case 'APPLY_OPENNESS_STATE':\n      return applyOpennessState(state, action);\n    case 'SET_DIRTY':\n      return setDirty(state, action);\n    case 'FOCUS_HEADER':\n      return focusHeader(state, action);\n    case 'UNFOCUS_HEADER':\n      return unfocusHeader(state, action);\n    case 'SET_SELECTED_TABLE_CELL_ID':\n      return setSelectedTableCellId(state, action);\n    case 'ADD_NEW_TABLE_ROW':\n      return addNewTableRow(state, action);\n    case 'REMOVE_TABLE_ROW':\n      return removeTableRow(state, action);\n    case 'ADD_NEW_TABLE_COLUMN':\n      return addNewTableColumn(state, action);\n    case 'REMOVE_TABLE_COLUMN':\n      return removeTableColumn(state, action);\n    case 'MOVE_TABLE_ROW_DOWN':\n      return moveTableRowDown(state, action);\n    case 'MOVE_TABLE_ROW_UP':\n      return moveTableRowUp(state, action);\n    case 'MOVE_TABLE_COLUMN_LEFT':\n      return moveTableColumnLeft(state, action);\n    case 'MOVE_TABLE_COLUMN_RIGHT':\n      return moveTableColumnRight(state, action);\n    case 'UPDATE_TABLE_CELL_VALUE':\n      return updateTableCellValue(state, action);\n    case 'INSERT_CAPTURE':\n      return insertCapture(state, action);\n    case 'CLEAR_PENDING_CAPTURE':\n      return clearPendingCapture(state, action);\n    case 'ADVANCE_CHECKBOX_STATE':\n      return advanceCheckboxState(state, action);\n    case 'SET_LAST_SYNC_AT':\n      return setLastSyncAt(state, action);\n    case 'SET_HEADER_TAGS':\n      return setHeaderTags(state, action);\n    case 'REORDER_TAGS':\n      return reorderTags(state, action);\n    case 'REORDER_PROPERTY_LIST':\n      return reorderPropertyList(state, action);\n    case 'UPDATE_TIMESTAMP_WITH_ID':\n      return updateTimestampWithId(state, action);\n    case 'UPDATE_PLANNING_ITEM_TIMESTAMP':\n      return updatePlanningItemTimestamp(state, action);\n    case 'ADD_NEW_PLANNING_ITEM':\n      return addNewPlanningItem(state, action);\n    case 'REMOVE_PLANNING_ITEM':\n      return removePlanningItem(state, action);\n    case 'UPDATE_PROPERTY_LIST_ITEMS':\n      return updatePropertyListItems(state, action);\n    case 'SET_ORG_FILE_ERROR_MESSAGE':\n      return setOrgFileErrorMessage(state, action);\n    case 'SET_LOG_ENTRY_STOP':\n      return setLogEntryStop(state, action);\n    case 'CREATE_LOG_ENTRY_START':\n      return createLogEntryStart(state, action);\n    case 'UPDATE_LOG_ENTRY_TIME':\n      return updateLogEntryTime(state, action);\n    case 'SET_SEARCH_FILTER_INFORMATION':\n      return setSearchFilterInformation(state, action);\n\n    default:\n      return state;\n  }\n};\n\n/**\n * Updates Headlines with the next todoKeyword `newTodoState`. Also\n * reschedules planning items with repeaters if applicable.\n * @param {any} currentTodoSet\n * @param {String} newTodoState\n * @param {any} indexedPlanningItemsWithRepeaters\n * @param {Object} state - redux state\n * @param {Number} headerIndex\n * @param {String} currentTodoState\n */\nfunction updateHeadlines(\n  currentTodoSet,\n  newTodoState,\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoState\n) {\n  if (\n    currentTodoSet.get('completedKeywords').includes(newTodoState) &&\n    indexedPlanningItemsWithRepeaters.size > 0\n  )\n    state = updatePlanningItemsWithRepeaters(\n      indexedPlanningItemsWithRepeaters,\n      state,\n      headerIndex,\n      currentTodoSet,\n      newTodoState,\n      currentTodoState\n    );\n  else {\n    // Update simple headline (without repeaters)\n    state = state.setIn(['headers', headerIndex, 'titleLine', 'todoKeyword'], newTodoState);\n  }\n  return state;\n}\n\nfunction updatePlanningItemsWithRepeaters(\n  indexedPlanningItemsWithRepeaters,\n  state,\n  headerIndex,\n  currentTodoSet,\n  newTodoState,\n  currentTodoState\n) {\n  indexedPlanningItemsWithRepeaters.forEach(([planningItem, planningItemIndex]) => {\n    state = state.setIn(\n      ['headers', headerIndex, 'planningItems', planningItemIndex, 'timestamp'],\n      applyRepeater(planningItem.get('timestamp'), new Date())\n    );\n  });\n  state = state.setIn(\n    ['headers', headerIndex, 'titleLine', 'todoKeyword'],\n    currentTodoSet.get('keywords').first()\n  );\n  if (!noLogRepeatEnabledP({ state, headerIndex })) {\n    const lastRepeatTimestamp = getCurrentTimestamp({ isActive: false, withStartTime: true });\n    const newLastRepeatValue = [\n      {\n        type: 'timestamp',\n        id: generateId(),\n        firstTimestamp: lastRepeatTimestamp,\n        secondTimestamp: null,\n      },\n    ];\n\n    state = state.updateIn(['headers', headerIndex, 'propertyListItems'], propertyListItems =>\n      propertyListItems.some(item => item.get('property') === 'LAST_REPEAT')\n        ? propertyListItems.map(item =>\n            item.get('property') === 'LAST_REPEAT'\n              ? item.set('value', fromJS(newLastRepeatValue))\n              : item\n          )\n        : propertyListItems.push(\n            fromJS({\n              property: 'LAST_REPEAT',\n              value: newLastRepeatValue,\n              id: generateId(),\n            })\n          )\n    );\n    state = state.updateIn(['headers', headerIndex], header => {\n      let rawDescription = header.get('rawDescription');\n      if (rawDescription.startsWith('\\n')) {\n        rawDescription = rawDescription.slice(1);\n      }\n      rawDescription =\n        `\\n- State \"${newTodoState}\"       from \"${currentTodoState}\"       ${renderAsText(\n          fromJS(lastRepeatTimestamp)\n        )}\\n` + rawDescription;\n      return header\n        .set('rawDescription', rawDescription)\n        .set('description', parseRawText(rawDescription));\n    });\n  }\n  return state;\n}\n\n/**\n * Is the `nologrepeat` feature enabled for this buffer?\n * More info:\n * https://www.gnu.org/software/emacs/manual/html_node/org/Repeated-tasks.html\n */\nexport function noLogRepeatEnabledP({ state, headerIndex }) {\n  const startupOptNoLogRepeat = state\n    .get('fileConfigLines')\n    .some(elt => elt.match(/^#\\+STARTUP:.*nologrepeat.*/));\n  const loggingProp = inheritedValueOfProperty(state.get('headers'), headerIndex, 'LOGGING');\n  return !!(\n    startupOptNoLogRepeat ||\n    (loggingProp &&\n      loggingProp.some(\n        v => v.get('type') === 'text' && v.get('contents').match(/\\s*nologrepeat\\s*/)\n      ))\n  );\n}\n\n/**\n * Function wrapper around `updateCookiesOfHeaderWithId` and\n * `updateCookiesOfParentOfHeaderWithId`.\n */\nfunction updateCookies(state, previousParentHeaderId, action) {\n  state = updateCookiesOfHeaderWithId(state, previousParentHeaderId);\n  state = updateCookiesOfParentOfHeaderWithId(state, action.headerId);\n  return state;\n}\n\n/**\n * Helper function to calculate the new state when moving a header\n * (either with or without subheaders) to the left or right.\n * @param {Object} param0 - Current state\n * @param {Object} param0.state - Redux `state` object\n * @param {Object} param0.headerIndex - Position of relevant header object\n * @param {Object} param0.subheaders - List of subheaders of relevant header\n * @param {String} direction: Can be either '-' to move the header left\n * or '+' to move it right\n */\nfunction shiftTreeNestingLevel({ state, headerIndex, subheaders = [] }, direction = '-') {\n  state = state.updateIn(['headers', headerIndex, 'nestingLevel'], calculateNestingLevel());\n  subheaders.forEach((_, index) => {\n    state = state.updateIn(\n      ['headers', headerIndex + index + 1, 'nestingLevel'],\n      calculateNestingLevel()\n    );\n  });\n  return state;\n\n  function calculateNestingLevel() {\n    return nestingLevel => {\n      if (direction === '-') {\n        // Don't move a header further to the left than the first\n        // column\n        return Math.max(nestingLevel - 1, 1);\n      } else {\n        return nestingLevel + 1;\n      }\n    };\n  }\n}\n","import { Map, List, fromJS } from 'immutable';\n\nimport generateId from '../lib/id_generator';\nimport { applyCaptureSettingsFromConfig } from '../util/settings_persister';\n\nconst indexOfTemplateWithId = (templates, templateId) =>\n  templates.findIndex(template => template.get('id') === templateId);\n\nconst addNewEmptyCaptureTemplate = state => {\n  if (!state.get('captureTemplates')) {\n    state = state.set('captureTemplates', List());\n  }\n\n  return state.update('captureTemplates', templates =>\n    templates.push(\n      fromJS({\n        id: generateId(),\n        description: '',\n        letter: '',\n        iconName: '',\n        isAvailableInAllOrgFiles: true,\n        orgFilesWhereAvailable: [''],\n        headerPaths: [''],\n        shouldPrepend: false,\n        template: '',\n      })\n    )\n  );\n};\n\nconst updateTemplateFieldPathValue = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.setIn(['captureTemplates', templateIndex].concat(action.fieldPath), action.newValue);\n};\n\nconst addNewTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.push('')\n  );\n};\n\nconst removeTemplateOrgFileAvailability = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'orgFilesWhereAvailable'], orgFiles =>\n    orgFiles.delete(action.orgFileAvailabilityIndex)\n  );\n};\n\nconst addNewTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.push('')\n  );\n};\n\nconst removeTemplateHeaderPath = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.updateIn(['captureTemplates', templateIndex, 'headerPaths'], headerPaths =>\n    headerPaths.delete(action.headerPathIndex)\n  );\n};\n\nconst deleteTemplate = (state, action) => {\n  const templateIndex = indexOfTemplateWithId(state.get('captureTemplates'), action.templateId);\n\n  return state.update('captureTemplates', templates => templates.delete(templateIndex));\n};\n\nconst restoreCaptureSettings = (state, action) => {\n  if (!action.newSettings) {\n    return state;\n  }\n\n  return applyCaptureSettingsFromConfig(state, action.newSettings);\n};\n\nconst reorderCaptureTemplate = (state, action) =>\n  state.update('captureTemplates', templates =>\n    templates.splice(action.fromIndex, 1).splice(action.toIndex, 0, templates.get(action.fromIndex))\n  );\n\nexport default (state = Map(), action) => {\n  switch (action.type) {\n    case 'ADD_NEW_EMPTY_CAPTURE_TEMPLATE':\n      return addNewEmptyCaptureTemplate(state, action);\n    case 'UPDATE_TEMPLATE_FIELD_PATH_VALUE':\n      return updateTemplateFieldPathValue(state, action);\n    case 'ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return addNewTemplateOrgFileAvailability(state, action);\n    case 'REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY':\n      return removeTemplateOrgFileAvailability(state, action);\n    case 'ADD_NEW_TEMPLATE_HEADER_PATH':\n      return addNewTemplateHeaderPath(state, action);\n    case 'REMOVE_TEMPLATE_HEADER_PATH':\n      return removeTemplateHeaderPath(state, action);\n    case 'DELETE_TEMPLATE':\n      return deleteTemplate(state, action);\n    case 'RESTORE_CAPTURE_SETTINGS':\n      return restoreCaptureSettings(state, action);\n    case 'REORDER_CAPTURE_TEMPLATE':\n      return reorderCaptureTemplate(state, action);\n    default:\n      return state;\n  }\n};\n","import { combineReducers } from 'redux';\nimport undoable, { includeAction, ActionCreators, ActionTypes } from 'redux-undo';\n\nimport baseReducer from './base';\nimport syncBackendReducer from './sync_backend';\nimport orgReducer from './org';\nimport captureReducer from './capture';\nimport { setDirty, sync } from '../actions/org';\n\nconst UNDOABLE_ACTIONS = [\n  'ADD_HEADER',\n  'REMOVE_HEADER',\n  'MOVE_HEADER_UP',\n  'MOVE_HEADER_DOWN',\n  'MOVE_HEADER_LEFT',\n  'MOVE_HEADER_RIGHT',\n  'MOVE_SUBTREE_LEFT',\n  'MOVE_SUBTREE_RIGHT',\n  'ADVANCE_TODO_STATE',\n  'UPDATE_HEADER_TITLE',\n  'UPDATE_HEADER_DESCRIPTION',\n  'ADD_NEW_TABLE_ROW',\n  'ADD_NEW_TABLE_COLUMN',\n  'MOVE_TABLE_ROW_DOWN',\n  'MOVE_TABLE_ROW_UP',\n  'MOVE_TABLE_COLUMN_LEFT',\n  'MOVE_TABLE_COLUMN_RIGHT',\n  'INSERT_CAPTURE',\n  'REFILE_SUBTREE',\n  'SET_HEADER_TAGS',\n  'UPDATE_PROPERTY_LIST_ITEMS',\n  'ADD_NEW_PLANNING_ITEM',\n  'REMOVE_PLANNING_ITEM',\n  'CREATE_LOG_ENTRY_START',\n  'SET_LOG_ENTRY_STOP',\n];\n\n// INFO: An `undo` in organice is always related to changing the Org\n// file structure. Hence, it is necessary to trigger a `sync` action.\n// This needs a little extra work, because this `sync` would result in\n// a conflict: The state is now in the `past` the Org file has been\n// synchronized in the `future`. Hence the `lastModifiedAt` timestamp\n// will be in the future and organice won't see a reason to push. Even\n// if we wanted to push, organice would show the 'conflict' modal,\n// because the remote file is newer. For this reason, when doing an\n// 'undo', organice will suppress this modal and 'force' a push. We\n// don't want the user to need to understand that an 'undo' means\n// moving to the past and the conflict has been created by herself in\n// the future (which in real life might have been seconds ago).\n\n// Implementation: Override the redux-undo `undo` and `redo` action creators. Additionally to the redux `undo`, they will force a sync, always.\nActionCreators.undo = function() {\n  return dispatch => {\n    dispatch({ type: ActionTypes.UNDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nActionCreators.redo = function() {\n  return dispatch => {\n    dispatch({ type: ActionTypes.REDO });\n    dispatch(setDirty(true));\n    dispatch(sync({ forceAction: 'push' }));\n  };\n};\n\nexport default combineReducers({\n  base: baseReducer,\n  syncBackend: syncBackendReducer,\n  org: undoable(orgReducer, {\n    filter: includeAction(UNDOABLE_ACTIONS),\n  }),\n  capture: captureReducer,\n});\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport thunk from 'redux-thunk';\nimport liveSync from './middleware/live_sync';\nimport syncOnBecomingVisible from './middleware/sync_on_becoming_visible';\nimport rootReducer from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nexport default initialState =>\n  createStore(\n    rootReducer,\n    initialState,\n    composeEnhancers(applyMiddleware(thunk, liveSync, syncOnBecomingVisible))\n  );\n","import migrateAccessTokenToDropboxAccessToken from './migrate_access_token_to_dropbox_access_token';\nimport migrateStoreInDropboxToStoreInSyncBackend from './migrate_store_in_dropbox_to_store_in_sync_backend';\n\nexport default () => {\n  migrateAccessTokenToDropboxAccessToken();\n  migrateStoreInDropboxToStoreInSyncBackend();\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const accessToken = localStorage.getItem('accessToken');\n  if (!accessToken) {\n    return;\n  }\n\n  localStorage.setItem('dropboxAccessToken', accessToken);\n  localStorage.removeItem('accessToken');\n};\n","import { isLocalStorageAvailable } from '../util/settings_persister';\n\nexport default () => {\n  if (!isLocalStorageAvailable) {\n    return;\n  }\n\n  const shouldStoreSettingsInDropbox = localStorage.getItem('shouldStoreSettingsInDropbox');\n  if (!shouldStoreSettingsInDropbox) {\n    return;\n  }\n\n  localStorage.setItem('shouldStoreSettingsInSyncBackend', shouldStoreSettingsInDropbox);\n  localStorage.removeItem('shouldStoreSettingsInDropbox');\n};\n","const parseQueryString = str => {\n  var ret = Object.create(null);\n\n  if (typeof str !== 'string') {\n    return ret;\n  }\n\n  str = str.trim().replace(/^(\\?|#|&)/, '');\n\n  if (!str) {\n    return ret;\n  }\n\n  str.split('&').forEach(function(param) {\n    var parts = param.replace(/\\+/g, ' ').split('=');\n    // Firefox (pre 40) decodes `%3D` to `=`\n    // https://github.com/sindresorhus/query-string/pull/37\n    var key = parts.shift();\n    var val = parts.length > 0 ? parts.join('=') : undefined;\n\n    key = decodeURIComponent(key);\n\n    // missing `=` should be `null`:\n    // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n    val = val === undefined ? null : decodeURIComponent(val);\n\n    if (ret[key] === undefined) {\n      ret[key] = val;\n    } else if (Array.isArray(ret[key])) {\n      ret[key].push(val);\n    } else {\n      ret[key] = [ret[key], val];\n    }\n  });\n\n  return ret;\n};\n\nexport default parseQueryString;\n","/* global gapi */\nimport { ActionCreators } from 'redux-undo';\n\nimport { setLoadingMessage, hideLoadingMessage, clearModalStack, setIsLoading } from './base';\nimport {\n  displayFile,\n  applyOpennessState,\n  setDirty,\n  setLastSyncAt,\n  setOrgFileErrorMessage,\n} from './org';\nimport { persistField } from '../util/settings_persister';\n\nimport { addSeconds } from 'date-fns';\n\nexport const signOut = () => (dispatch, getState) => {\n  switch (getState().syncBackend.get('client', {}).type) {\n    case 'WebDAV':\n      ['Endpoint', 'Username', 'Password'].forEach(e => {\n        persistField('webdav' + e, null);\n      });\n      break;\n    case 'Dropbox':\n      persistField('dropboxAccessToken', null);\n      break;\n    case 'Google Drive':\n      gapi.auth2.getAuthInstance().signOut();\n      break;\n    default:\n  }\n\n  persistField('authenticatedSyncService', null);\n\n  dispatch({ type: 'SIGN_OUT' });\n  dispatch(clearModalStack());\n  dispatch(hideLoadingMessage());\n};\n\nexport const setCurrentFileBrowserDirectoryListing = (\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState\n) => ({\n  type: 'SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING',\n  directoryListing,\n  hasMore,\n  additionalSyncBackendState,\n});\n\nexport const setIsLoadingMoreDirectoryListing = isLoadingMore => ({\n  type: 'SET_IS_LOADING_MORE_DIRECTORY_LISTING',\n  isLoadingMore,\n});\n\nexport const getDirectoryListing = path => (dispatch, getState) => {\n  dispatch(setLoadingMessage('Getting listing...'));\n\n  const client = getState().syncBackend.get('client');\n  client\n    .getDirectoryListing(path)\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      dispatch(setCurrentFileBrowserDirectoryListing(listing, hasMore, additionalSyncBackendState));\n      dispatch(hideLoadingMessage());\n    })\n    .catch(error => {\n      alert('There was an error retrieving files!');\n      console.error(error);\n      dispatch(hideLoadingMessage());\n    });\n};\n\nexport const loadMoreDirectoryListing = () => (dispatch, getState) => {\n  dispatch(setIsLoadingMoreDirectoryListing(true));\n\n  const client = getState().syncBackend.get('client');\n  const currentFileBrowserDirectoryListing = getState().syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  client\n    .getMoreDirectoryListing(currentFileBrowserDirectoryListing.get('additionalSyncBackendState'))\n    .then(({ listing, hasMore, additionalSyncBackendState }) => {\n      const extendedListing = currentFileBrowserDirectoryListing.get('listing').concat(listing);\n      dispatch(\n        setCurrentFileBrowserDirectoryListing(extendedListing, hasMore, additionalSyncBackendState)\n      );\n      dispatch(setIsLoadingMoreDirectoryListing(false));\n    });\n};\n\nexport const pushBackup = (pathOrFileId, contents) => {\n  return (dispatch, getState) => {\n    const client = getState().syncBackend.get('client');\n    switch (client.type) {\n      case 'Dropbox':\n      case 'WebDAV':\n        client.createFile(`${pathOrFileId}.organice-bak`, contents);\n        break;\n      case 'Google Drive':\n        pathOrFileId = pathOrFileId.startsWith('/') ? pathOrFileId.substr(1) : pathOrFileId;\n        client.duplicateFile(pathOrFileId, fileName => `${fileName}.organice-bak`);\n        break;\n      default:\n    }\n  };\n};\n\nexport const downloadFile = path => {\n  return (dispatch, getState) => {\n    dispatch(setLoadingMessage('Downloading file...'));\n\n    getState()\n      .syncBackend.get('client')\n      .getFileContents(path)\n      .then(fileContents => {\n        dispatch(setDirty(false));\n        dispatch(hideLoadingMessage());\n        dispatch(pushBackup(path, fileContents));\n        dispatch(setLastSyncAt(addSeconds(new Date(), 5)));\n        dispatch(displayFile(path, fileContents));\n        dispatch(applyOpennessState());\n        dispatch(ActionCreators.clearHistory());\n      })\n      .catch(() => {\n        dispatch(hideLoadingMessage());\n        dispatch(setIsLoading(false));\n        dispatch(setOrgFileErrorMessage('File not found'));\n      });\n  };\n};\n","import { Dropbox } from 'dropbox';\nimport { isEmpty } from 'lodash';\n\nimport { fromJS, Map } from 'immutable';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = listing => {\n  const filteredListing = listing.filter(file => {\n    // Show all folders\n    if (file['.tag'] === 'folder') return true;\n    // Filter out all non-org files\n    return file.name.match(/org$|org_archive$/);\n  });\n  return filteredListing.sort((a, b) => {\n    // Folders before files\n    if (a['.tag'] === 'folder' && b['.tag'] === 'file') {\n      return -1;\n    } else {\n      // Sorth both folders and files alphabetically\n      return a.name > b.name ? 1 : -1;\n    }\n  });\n};\n\nexport default accessToken => {\n  const dropboxClient = new Dropbox({ accessToken, fetch });\n\n  const isSignedIn = () => new Promise(resolve => resolve(true));\n\n  const transformDirectoryListing = listing => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry['.tag'] === 'folder',\n        path: entry.path_display,\n      }))\n    );\n  };\n\n  const getDirectoryListing = path =>\n    new Promise((resolve, reject) => {\n      dropboxClient\n        .filesListFolder({ path })\n        .then(response =>\n          resolve({\n            listing: transformDirectoryListing(response.entries),\n            hasMore: response.has_more,\n            additionalSyncBackendState: Map({\n              cursor: response.cursor,\n            }),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const cursor = additionalSyncBackendState.get('cursor');\n    return new Promise((resolve, reject) =>\n      dropboxClient.filesListFolderContinue({ cursor }).then(response =>\n        resolve({\n          listing: transformDirectoryListing(response.entries),\n          hasMore: response.has_more,\n          additionalSyncBackendState: Map({\n            cursor: response.cursor,\n          }),\n        })\n      )\n    );\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesUpload({\n          path,\n          contents,\n          mode: {\n            '.tag': 'overwrite',\n          },\n          autorename: true,\n        })\n        .then(resolve)\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDownload({ path })\n        .then(response => {\n          const reader = new FileReader();\n          reader.addEventListener('loadend', () =>\n            resolve({\n              contents: reader.result,\n              lastModifiedAt: response.server_modified,\n            })\n          );\n          reader.readAsText(response.fileBlob);\n        })\n        .catch(error => {\n          // INFO: It's possible organice is using the Dropbox API\n          // wrongly. In any case, for some files and only sometimes,\n          // when a file is requested, there's either:\n          //   - a 400 with a plain text error or\n          //   - a 409 with an embedded JSON error\n          //   - a 409 with a plain text error under `.error`\n          // coming back. Sometimes, there's even two API calls to\n          // `/download` happening at the same time (of types `json`\n          // and `octet-stream`) where one might fail and the other\n          // might prevail.\n          // More debug information in this issue:\n          // https://github.com/200ok-ch/organice/issues/108\n          const objectContainsTagErrorP = (function() {\n            try {\n              return JSON.parse(error.error).error.path['.tag'] === 'not_found';\n            } catch (e) {\n              return false;\n            }\n          })();\n          if (\n            (typeof error === 'string' && error.match(/missing required field 'path'/)) ||\n            objectContainsTagErrorP\n          ) {\n            reject();\n          }\n        })\n    );\n\n  const getFileContents = path => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = path =>\n    new Promise((resolve, reject) =>\n      dropboxClient\n        .filesDelete({ path })\n        .then(resolve)\n        .catch(error => reject(error.error.error['.tag'] === 'path_lookup', error))\n    );\n\n  return {\n    type: 'Dropbox',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","/* global process */\n\nimport { fromJS, Map } from 'immutable';\n\nexport default () => {\n  const initGoogleDriveAPIClient = () =>\n    new Promise((resolve, reject) =>\n      window.gapi.load('client:auth2', () => {\n        window.location.hash = window.initialHash;\n        window.gapi.client\n          .init({\n            client_id: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n            scope: 'https://www.googleapis.com/auth/drive.file',\n          })\n          .then(resolve);\n      })\n    );\n\n  const getAPIClient = (() => {\n    let isInited = false;\n    let isIniting = false;\n    const afterInitCallbacks = [];\n\n    return () => {\n      return new Promise((resolve, reject) => {\n        if (isInited) {\n          resolve(window.gapi);\n        } else {\n          if (window.gapi && !isIniting) {\n            isIniting = true;\n            initGoogleDriveAPIClient().then(() => {\n              isInited = true;\n              afterInitCallbacks.forEach(callback => callback(window.gapi));\n              resolve(window.gapi);\n            });\n          } else {\n            afterInitCallbacks.push(resolve);\n          }\n        }\n      });\n    };\n  })();\n\n  // Trigger the API client init when the gapi script loads.\n  if (window.gapi) {\n    getAPIClient();\n  } else {\n    // This handler will be called when the <script> tag loads.\n    window.handleGoogleDriveClientLoad = getAPIClient;\n  }\n\n  const isSignedIn = () =>\n    new Promise((resolve, reject) =>\n      getAPIClient().then(gapi => resolve(gapi.auth2.getAuthInstance().isSignedIn.get()))\n    );\n\n  const transformDirectoryListing = listing =>\n    fromJS(\n      listing.map(entry => ({\n        id: entry.id,\n        name: entry.name,\n        isDirectory: entry.mimeType === 'application/vnd.google-apps.folder',\n        path: `/${entry.id}`,\n      }))\n    );\n\n  const getFiles = (directoryId, nextPageToken = null) => {\n    const fileListPromise = new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .list({\n            pageSize: 30,\n            fields: 'nextPageToken, files(id, name, mimeType, parents)',\n            q: `'${directoryId === '' ? 'root' : directoryId}' in parents and trashed = false`,\n            pageToken: nextPageToken,\n          })\n          .then(response => {\n            resolve({\n              listing: transformDirectoryListing(response.result.files),\n              hasMore: !!response.result.nextPageToken,\n              additionalSyncBackendState: Map({\n                currentDirectoryId: directoryId,\n                nextPageToken: response.result.nextPageToken,\n              }),\n            });\n          })\n          .catch(reject);\n      });\n    });\n\n    const fileParentPromise = new Promise((resolve, reject) => {\n      if (directoryId === '') {\n        resolve(null);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: directoryId,\n              fields: 'parents',\n            })\n          )\n          .then(response => {\n            if (!response.result.parents) {\n              resolve(null);\n            } else {\n              resolve(response.result.parents[0]);\n            }\n          })\n          .catch(reject);\n      }\n    });\n\n    const rootFolderIdPromise = new Promise((resolve, reject) => {\n      if (!!window.rootFolderId) {\n        resolve(window.rootFolderId);\n      } else {\n        getAPIClient()\n          .then(gapi =>\n            gapi.client.drive.files.get({\n              fileId: 'root',\n              fields: 'id',\n            })\n          )\n          .then(response => {\n            window.rootFolderId = response.result.id;\n            resolve(response.result.id);\n          })\n          .catch(reject);\n      }\n    });\n\n    return new Promise((resolve, reject) => {\n      Promise.all([fileListPromise, fileParentPromise, rootFolderIdPromise]).then(\n        ([listing, parentId, rootFolderId]) => {\n          const directoryParentId = parentId === rootFolderId ? '' : parentId;\n          listing.additionalSyncBackendState = listing.additionalSyncBackendState.set(\n            'parentId',\n            directoryParentId\n          );\n          resolve(listing);\n        }\n      );\n    });\n  };\n\n  const getDirectoryListing = directoryId =>\n    getFiles(directoryId.startsWith('/') ? directoryId.substr(1) : directoryId);\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    const directoryId = additionalSyncBackendState.get('currentDirectoryId');\n    const nextPageToken = additionalSyncBackendState.get('nextPageToken');\n    return getFiles(directoryId, nextPageToken);\n  };\n\n  const fileIdByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient()\n        .then(gapi =>\n          gapi.client.drive.files.list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n        )\n        .then(response =>\n          resolve(response.result.files.length > 0 ? response.result.files[0].id : null)\n        )\n        .catch(reject);\n    });\n\n  const updateFile = (fileId, contents) => {\n    fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n    return getAPIClient().then(gapi => {\n      fetch(`https://www.googleapis.com/upload/drive/v3/files/${fileId}?uploadType=media`, {\n        method: 'PATCH',\n        headers: {\n          Authorization: `Bearer ${gapi.auth.getToken().access_token}`,\n        },\n        body: contents,\n      });\n    });\n  };\n\n  const createFile = (name, parentId, contents) => {\n    return new Promise((resolve, reject) => {\n      fileIdByNameAndParent(name, parentId)\n        .then(fileId =>\n          !!fileId\n            ? updateFile(fileId, contents)\n                .then(resolve)\n                .catch(reject)\n            : getAPIClient().then(gapi => {\n                gapi.client.drive.files\n                  .create({\n                    name,\n                    parents: parentId,\n                  })\n                  .then(response => updateFile(response.result.id, contents))\n                  .then(resolve)\n                  .catch(reject);\n              })\n        )\n        .catch(reject);\n    });\n  };\n\n  const duplicateFile = (fileId, fileNameCallback) => {\n    return new Promise((resolve, reject) => {\n      getAPIClient().then(gapi => {\n        gapi.client.drive.files\n          .get({\n            fileId,\n            fields: 'name, parents',\n          })\n          .then(getResponse => {\n            if (!getResponse.result.name) {\n              reject();\n            } else {\n              const newFileName = fileNameCallback(getResponse.result.name);\n              const parents = getResponse.result.parents[0];\n              fileIdByNameAndParent(newFileName, parents).then(backupFileId => {\n                const makeCopy = () => {\n                  gapi.client.drive.files\n                    .copy({\n                      fileId,\n                      parents,\n                      name: newFileName,\n                    })\n                    .then(copyResponse => {\n                      resolve();\n                    })\n                    .catch(reject);\n                };\n\n                if (!!backupFileId) {\n                  gapi.client.drive.files\n                    .delete({ fileId: backupFileId })\n                    .then(makeCopy)\n                    .catch(reject);\n                } else {\n                  makeCopy();\n                }\n              });\n            }\n          });\n      });\n    });\n  };\n\n  const getFileContentsAndMetadata = fileId =>\n    new Promise((resolve, reject) => {\n      if (!fileId) return reject();\n      getAPIClient().then(gapi => {\n        fileId = fileId.startsWith('/') ? fileId.substr(1) : fileId;\n\n        const fileContentsPromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              alt: 'media',\n            })\n            .then(response => resolve(decodeURIComponent(escape(response.body))))\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        const fileModifiedTimePromise = new Promise(resolve => {\n          gapi.client.drive.files\n            .get({\n              fileId,\n              fields: 'modifiedTime',\n            })\n            .then(response => {\n              resolve(response.result.modifiedTime);\n            })\n            .catch(error => {\n              if (error.body && JSON.parse(error.body).error.errors[0].reason === 'notFound') {\n                reject();\n              }\n            });\n        });\n\n        Promise.all([fileContentsPromise, fileModifiedTimePromise]).then(\n          ([contents, lastModifiedAt]) => {\n            resolve({\n              contents,\n              lastModifiedAt,\n            });\n          }\n        );\n      });\n    });\n\n  const getFileContents = fileId => {\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(fileId)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const getFileContentsByNameAndParent = (name, parentId) => {\n    return new Promise((resolve, reject) =>\n      fileIdByNameAndParent(name, parentId).then(fileId => {\n        if (fileId) {\n          getFileContents(fileId).then(resolve);\n        } else {\n          reject();\n        }\n      })\n    );\n  };\n\n  const deleteFileByNameAndParent = (name, parentId) =>\n    new Promise((resolve, reject) => {\n      getAPIClient().then(gapi =>\n        gapi.client.drive.files\n          .list({\n            pageSize: 1,\n            fields: 'files(id)',\n            q: `'${parentId}' in parents and trashed = false and name = '${name}'`,\n          })\n          .then(listResponse => {\n            if (listResponse.result.files.length > 0) {\n              gapi.client.drive.files\n                .delete({\n                  fileId: listResponse.result.files[0].id,\n                })\n                .then(resolve)\n                .catch(reject);\n            } else {\n              resolve();\n            }\n          })\n      );\n    });\n\n  return {\n    type: 'Google Drive',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    duplicateFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    getFileContentsByNameAndParent,\n    deleteFileByNameAndParent,\n  };\n};\n","import React from 'react';\nimport './stylesheet.css';\nconst PrivacyPolicy = () => {\n  return (\n    <div className=\"privacy-policy-container\">\n      <h1>Privacy Policy</h1>\n      <p>Last updated: September 6nd, 2019</p>\n\n      <p>\n        <a href=\"https://200ok.ch/\">200ok llc</a> operates the https://organice.200ok.ch website and\n        mobile apps.\n      </p>\n\n      <p>\n        This page is used to inform website visitors regarding our policies with the collection,\n        use, and disclosure of Personal Information if anyone decided to use our Service.\n      </p>\n      <p>\n        If you choose to use our Service, then you agree to the collection and use of information in\n        relation with this policy. The Personal Information that we collect are used for providing\n        and improving the Service. We will not use or share your information with anyone except as\n        described in this Privacy Policy.\n      </p>\n      {/* <p> */}\n      {/*   <span> */}\n      {/*     The terms used in this Privacy Policy have the same meanings as in our */}\n      {/*     <a href=\"/static/terms-of-service\">Terms and Conditions</a> */}\n      {/*   </span> */}\n      {/*   <span>, unless otherwise defined in this Privacy Policy.</span> */}\n      {/* </p> */}\n      <p>\n        <strong>Information Collection and Use</strong>\n      </p>\n      <p>\n        For a better experience while using our Service, we may require you to provide us with\n        certain personally identifiable information, including but not limited to your name, phone\n        number, and postal address. The information that we collect will be used to contact or\n        identify you.\n      </p>\n      <p>\n        <strong>Log Data</strong>\n      </p>\n      <p>\n        We want to inform you that whenever you visit our Service, we collect information that your\n        browser sends to us that is called Log Data. This Log Data may include information such as\n        your computer’s Internet Protocol (“IP”) address, browser version, pages of our Service that\n        you visit, the time and date of your visit, the time spent on those pages, and other\n        statistics.\n      </p>\n      <p>\n        <strong>Cookies</strong>\n      </p>\n      <p>\n        Cookies are files with small amount of data that is commonly used an anonymous unique\n        identifier. These are sent to your browser from the website that you visit and are stored on\n        your computer’s hard drive.\n      </p>\n      <p>\n        Our website uses these “cookies” to collection information and to improve our Service. You\n        have the option to either accept or refuse these cookies, and know when a cookie is being\n        sent to your computer. If you choose to refuse our cookies, you may not be able to use some\n        portions of our Service.\n      </p>\n      <p>\n        <strong>Service Providers</strong>\n      </p>\n      <p>We may employ third-party companies and individuals due to the following reasons:</p>\n      <ul>\n        <li>To facilitate our Service;</li>\n        <li>To provide the Service on our behalf;</li>\n        <li>To perform Service-related services; or</li>\n        <li>To assist us in analyzing how our Service is used.</li>\n      </ul>\n\n      <p>\n        We want to inform our Service users that these third parties have access to your Personal\n        Information. The reason is to perform the tasks assigned to them on our behalf. However,\n        they are obligated not to disclose or use the information for any other purpose.\n      </p>\n      <p>\n        <strong>Security</strong>\n      </p>\n      <p>\n        We value your trust in providing us your Personal Information, thus we are striving to use\n        commercially acceptable means of protecting it. But remember that no method of transmission\n        over the internet, or method of electronic storage is 100% secure and reliable, and we\n        cannot guarantee its absolute security.\n      </p>\n\n      <p>\n        <strong>Links to Other Sites</strong>\n      </p>\n      <p>\n        Our Service may contain links to other sites. If you click on a third-party link, you will\n        be directed to that site. Note that these external sites are not operated by us. Therefore,\n        we strongly advise you to review the Privacy Policy of these websites. We have no control\n        over, and assume no responsibility for the content, privacy policies, or practices of any\n        third-party sites or services.\n      </p>\n      <p>\n        <strong>Children’s Privacy</strong>\n      </p>\n      <p>\n        Our Services do not address anyone under the age of 13. We do not knowingly collect personal\n        identifiable information from children under 13. In the case we discover that a child under\n        13 has provided us with personal information, we immediately delete this from our servers.\n        If you are a parent or guardian and you are aware that your child has provided us with\n        personal information, please contact us so that we will be able to do necessary actions.\n      </p>\n      <p>\n        <strong>Changes to This Privacy Policy</strong>\n      </p>\n      <p>\n        We may update our Privacy Policy from time to time. Thus, we advise you to review this page\n        periodically for any changes. We will notify you of any changes by posting the new Privacy\n        Policy on this page. These changes are effective immediately, after they are posted on this\n        page.\n      </p>\n\n      <p>\n        <strong>Contact us</strong>\n      </p>\n\n      <p>\n        If you have any questions about this Privacy Policy, please{' '}\n        <a href=\"mailto:info@200ok.ch\">contact us</a>.\n      </p>\n    </div>\n  );\n};\nexport default PrivacyPolicy;\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link, withRouter } from 'react-router-dom';\n\nimport logo from '../../images/organice.svg';\n\nimport './stylesheet.css';\n\nimport * as baseActions from '../../actions/base';\nimport * as orgActions from '../../actions/org';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderBar extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleChangelogClick',\n      'handleModalPageDoneClick',\n      'handleHeaderBarTitleClick',\n      'handleSettingsSubPageBackClick',\n      'handleUndoClick',\n      'handleRedoClick',\n      'handleHelpClick',\n    ]);\n  }\n\n  getPathRoot() {\n    const {\n      location: { pathname },\n    } = this.props;\n    return pathname.split('/')[1];\n  }\n\n  getFilename() {\n    const {\n      location: { pathname },\n    } = this.props;\n    // only show a filename if it's a file and not a path\n    if (pathname.includes('.org')) {\n      return pathname.substring(pathname.lastIndexOf('/') + 1, pathname.lastIndexOf('.'));\n    } else {\n      return '';\n    }\n  }\n\n  renderFileBrowserBackButton() {\n    const {\n      location: { pathname },\n      syncBackendType,\n    } = this.props;\n    if (syncBackendType === 'Google Drive') {\n      return <div />;\n    }\n\n    let directoryPath = pathname.substr('/files'.length);\n    if (directoryPath.endsWith('/')) {\n      directoryPath = directoryPath.substring(0, directoryPath.length - 1);\n    }\n\n    if (directoryPath === '') {\n      return <div />;\n    } else {\n      const pathParts = directoryPath.split('/');\n      const parentDirectoryName = pathParts[pathParts.length - 2];\n      const parentPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n      return (\n        <Link to={`/files${parentPath}`} className=\"header-bar__back-button\">\n          <i className=\"fas fa-chevron-left\" />\n          <span className=\"header-bar__back-button__directory-path\">{parentDirectoryName}/</span>\n        </Link>\n      );\n    }\n  }\n\n  renderOrgFileBackButton() {\n    const {\n      location: { pathname },\n    } = this.props;\n\n    let filePath = pathname.substr('/file'.length);\n    if (filePath.endsWith('/')) {\n      filePath = filePath.substring(0, filePath.length - 1);\n    }\n\n    const pathParts = filePath.split('/');\n    const directoryPath = pathParts.slice(0, pathParts.length - 1).join('/');\n\n    return (\n      <Link to={`/files${directoryPath}`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">File browser</span>\n      </Link>\n    );\n  }\n\n  renderLogo() {\n    return (\n      <div className=\"header-bar__logo-container\">\n        <img className=\"header-bar__logo\" src={logo} alt=\"Logo\" width=\"30\" height=\"30\" />\n        <h2 className=\"header-bar__app-name\">organice</h2>\n      </div>\n    );\n  }\n\n  renderSampleFileBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  renderSignInBackButton() {\n    return (\n      <Link to={`/`} className=\"header-bar__back-button\">\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Home</span>\n      </Link>\n    );\n  }\n\n  handleSettingsSubPageBackClick() {\n    this.props.base.popModalPage();\n  }\n\n  renderSettingsSubPageBackButton() {\n    return (\n      <div className=\"header-bar__back-button\" onClick={this.handleSettingsSubPageBackClick}>\n        <i className=\"fas fa-chevron-left\" />\n        <span className=\"header-bar__back-button__directory-path\">Settings</span>\n      </div>\n    );\n  }\n\n  renderBackButton() {\n    const { activeModalPage } = this.props;\n\n    switch (activeModalPage) {\n      case 'changelog':\n        return this.renderSettingsSubPageBackButton();\n      case 'keyboard_shortcuts_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'capture_templates_editor':\n        return this.renderSettingsSubPageBackButton();\n      case 'sample':\n        return this.renderSettingsSubPageBackButton();\n      case 'settings':\n        return <div />;\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case '':\n        return this.renderLogo();\n      case 'files':\n        return this.renderFileBrowserBackButton();\n      case 'file':\n        return this.renderOrgFileBackButton();\n      case 'sample':\n        return this.renderSampleFileBackButton();\n      case 'sign_in':\n        return this.renderSignInBackButton();\n      default:\n        return <div />;\n    }\n  }\n\n  renderTitle() {\n    const titleContainerWithText = text => (\n      <div className=\"header-bar__title\" onClick={this.handleHeaderBarTitleClick}>\n        {text}\n      </div>\n    );\n\n    switch (this.props.activeModalPage) {\n      case 'changelog':\n        return titleContainerWithText('Changelog');\n      case 'settings':\n        return titleContainerWithText('Settings');\n      case 'keyboard_shortcuts_editor':\n        return titleContainerWithText('Shortcuts');\n      case 'capture_templates_editor':\n        return titleContainerWithText('Capture');\n      case 'sample':\n        return titleContainerWithText('Sample');\n      default:\n    }\n\n    switch (this.getPathRoot()) {\n      case 'sample':\n        return titleContainerWithText('Sample');\n      case 'sign_in':\n        return titleContainerWithText('Sign in');\n      default:\n    }\n\n    return titleContainerWithText(this.props.shouldShowTitleInOrgFile ? this.getFilename() : '');\n  }\n\n  handleChangelogClick() {\n    this.props.base.pushModalPage('changelog');\n  }\n\n  handleModalPageDoneClick() {\n    this.props.base.clearModalStack();\n  }\n\n  handleHeaderBarTitleClick() {\n    this.props.org.selectHeader(null);\n  }\n\n  handleUndoClick() {\n    if (this.props.isUndoEnabled) {\n      this.props.undo.undo();\n    }\n  }\n\n  handleRedoClick() {\n    if (this.props.isRedoEnabled) {\n      this.props.undo.redo();\n    }\n  }\n\n  handleHelpClick() {\n    this.props.base.pushModalPage('settings');\n    this.props.base.pushModalPage('sample');\n  }\n\n  renderActions() {\n    const {\n      isAuthenticated,\n      hasUnseenChangelog,\n      activeModalPage,\n      path,\n      isUndoEnabled,\n      isRedoEnabled,\n    } = this.props;\n\n    if (!!activeModalPage) {\n      return (\n        <div className=\"header-bar__actions\" onClick={this.handleModalPageDoneClick}>\n          Done\n        </div>\n      );\n    } else {\n      const undoIconClassName = classNames('fas fa-undo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isUndoEnabled,\n      });\n      const redoIconClassName = classNames('fas fa-redo header-bar__actions__item', {\n        'header-bar__actions__item--disabled': !isRedoEnabled,\n      });\n\n      const settingsIconClassName = classNames('fas fa-cogs header-bar__actions__item');\n\n      return (\n        <div className=\"header-bar__actions\">\n          {!isAuthenticated && this.getPathRoot() !== 'sign_in' && (\n            <Link to=\"/sign_in\">\n              <div className=\"header-bar__actions__item\" title=\"Sign in\">\n                Sign in\n              </div>\n            </Link>\n          )}\n\n          {!isAuthenticated && (\n            <a\n              href=\"https://github.com/200ok-ch/organice\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              <i className=\"fab fa-github header-bar__actions__item\" />\n            </a>\n          )}\n\n          {isAuthenticated && !activeModalPage && !!path && (\n            <Fragment>\n              <i className={undoIconClassName} onClick={this.handleUndoClick} title=\"Undo\" />\n              <i className={redoIconClassName} onClick={this.handleRedoClick} title=\"Redo\" />\n              <i\n                className=\"fas fa-question-circle header-bar__actions__item\"\n                onClick={this.handleHelpClick}\n                title=\"Help\"\n              />\n            </Fragment>\n          )}\n\n          {isAuthenticated && (\n            <div>\n              {hasUnseenChangelog && (\n                <i\n                  className=\"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift\"\n                  onClick={this.handleChangelogClick}\n                />\n              )}\n              <Link to=\"/settings\">\n                <i className={settingsIconClassName} title=\"Settings\" />\n              </Link>\n            </div>\n          )}\n        </div>\n      );\n    }\n  }\n\n  render() {\n    const className = classNames('header-bar', {\n      'header-bar--with-logo': this.getPathRoot() === '',\n    });\n\n    return (\n      <div className={className}>\n        {this.renderBackButton()}\n        {this.renderTitle()}\n        {this.renderActions()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    path: state.org.present.get('path'),\n    isUndoEnabled: state.org.past.length > 0,\n    isRedoEnabled: state.org.future.length > 0,\n    syncBackendType: state.syncBackend.get('client') && state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(HeaderBar));\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nimport './stylesheet.css';\nimport logo from '../../images/organice.svg';\n\nexport default () => {\n  return (\n    <main className=\"landing-container-wrapper\">\n      <div className=\"landing-container\">\n        <h1 className=\"landing-app-name\">organice</h1>\n\n        <img className=\"landing-logo\" src={logo} alt=\"Logo\" />\n\n        <h2 className=\"landing-tagline\">organice organizes Org files nicely!</h2>\n\n        <h2 className=\"landing-tagline\">\n          Syncs with Dropbox,\n          <br /> Google Drive and WebDAV.\n        </h2>\n\n        <Link to=\"/sample\">\n          <div className=\"btn landing-button view-sample-button\">View sample</div>\n        </Link>\n        <Link to=\"/sign_in\">\n          <div className=\"btn landing-button\">Sign in</div>\n        </Link>\n      </div>\n      <footer>\n        <Link to=\"/privacy-policy\">Privacy Policy</Link>\n      </footer>\n    </main>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Link } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\n\nconst FileBrowser = ({\n  path,\n  listing,\n  hasMore,\n  isLoadingMore,\n  syncBackendType,\n  syncBackend,\n  additionalSyncBackendState,\n}) => {\n  useEffect(() => syncBackend.getDirectoryListing(path), [syncBackend, path]);\n\n  const handleLoadMoreClick = () => syncBackend.loadMoreDirectoryListing();\n\n  const getParentDirectoryPath = () => {\n    switch (syncBackendType) {\n      case 'Dropbox':\n      case 'WebDAV':\n        const pathParts = path.split('/');\n        return pathParts.slice(0, pathParts.length - 1).join('/');\n      case 'Google Drive':\n        return !!additionalSyncBackendState.get('parentId')\n          ? '/' + additionalSyncBackendState.get('parentId')\n          : null;\n      default:\n        return null;\n    }\n  };\n\n  const isTopLevelDirectory = path === '';\n\n  return (\n    <div className=\"file-browser-container\">\n      {syncBackendType === 'Dropbox' && (\n        <h3 className=\"file-browser__header\">Directory: {isTopLevelDirectory ? '/' : path}</h3>\n      )}\n\n      <ul className=\"file-browser__file-list\">\n        {!isTopLevelDirectory && (\n          <Link to={`/files${getParentDirectoryPath()}`}>\n            <li className=\"file-browser__file-list__element\">\n              <i className=\"fas fa-folder file-browser__file-list__icon--directory\" /> ..\n            </li>\n          </Link>\n        )}\n\n        {(listing || []).map(file => {\n          const isDirectory = file.get('isDirectory');\n          const isBackupFile = file.get('name').endsWith('.organice-bak');\n          const isOrgFile = file.get('name').endsWith('.org');\n          const isSettingsFile = file.get('name') === '.organice-config.json';\n\n          const iconClass = classNames('file-browser__file-list__icon fas', {\n            'fa-folder': isDirectory,\n            'file-browser__file-list__icon--directory': isDirectory,\n            'fa-file': !isDirectory && !isBackupFile && !isSettingsFile,\n            'file-browser__file-list__icon--not-org': !isOrgFile,\n            'fa-copy': isBackupFile,\n            'fa-cogs': isSettingsFile,\n          });\n\n          if (file.get('isDirectory')) {\n            return (\n              <Link to={`/files${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}/\n                </li>\n              </Link>\n            );\n          } else {\n            return (\n              <Link to={`/file${file.get('path')}`} key={file.get('id')}>\n                <li className=\"file-browser__file-list__element\">\n                  <i className={iconClass} /> {file.get('name')}\n                </li>\n              </Link>\n            );\n          }\n        })}\n\n        {hasMore &&\n          (isLoadingMore ? (\n            <li className=\"file-browser__file-list__loading-more-container\">\n              <i className=\"fas fa-spinner fa-lg fa-spin\" />\n            </li>\n          ) : (\n            <li\n              className=\"file-browser__file-list__element file-browser__file-list__element--load-more-row\"\n              onClick={handleLoadMoreClick}\n            >\n              Load more...\n            </li>\n          ))}\n      </ul>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  const currentFileBrowserDirectoryListing = state.syncBackend.get(\n    'currentFileBrowserDirectoryListing'\n  );\n  return {\n    syncBackendType: state.syncBackend.get('client').type,\n    listing: !!currentFileBrowserDirectoryListing\n      ? currentFileBrowserDirectoryListing.get('listing')\n      : null,\n    hasMore:\n      !!currentFileBrowserDirectoryListing && currentFileBrowserDirectoryListing.get('hasMore'),\n    isLoadingMore:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('isLoadingMore'),\n    additionalSyncBackendState:\n      !!currentFileBrowserDirectoryListing &&\n      currentFileBrowserDirectoryListing.get('additionalSyncBackendState'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(FileBrowser);\n","import React, { useState, useEffect } from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nexport default ({ message }) => {\n  const [shouldRenderIndicator, setShouldRenderIndicator] = useState(true);\n  const [lastMessage, setLastMessage] = useState(message);\n\n  useEffect(\n    () => {\n      if (!!message) {\n        setLastMessage(message);\n        setShouldRenderIndicator(true);\n      }\n    },\n    [message]\n  );\n\n  const handleAnimationRest = () => {\n    if (!!message) {\n      return;\n    }\n\n    setShouldRenderIndicator(false);\n    setLastMessage(null);\n  };\n\n  const handleClick = () => setShouldRenderIndicator(false);\n\n  if (!shouldRenderIndicator) {\n    return null;\n  }\n\n  const style = {\n    opacity: spring(!!message ? 0.9 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={style} onRest={handleAnimationRest}>\n      {style => (\n        <div className=\"loading-indicator\" style={style} onClick={handleClick}>\n          {lastMessage}\n        </div>\n      )}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nexport default ({\n  subPartDataAndHandlers: {\n    onEnterTableEditMode,\n    onAddNewTableRow,\n    onRemoveTableRow,\n    onAddNewTableColumn,\n    onRemoveTableColumn,\n  },\n}) => {\n  return (\n    <div className=\"table-action-drawer-container\">\n      <div className=\" table-action-drawer__edit-icon-container\" onClick={onEnterTableEditMode}>\n        <i className=\"fas fa-pencil-alt fa-lg\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableRow}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableRow}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onAddNewTableColumn}>\n        <i className=\"fas fa-plus fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n\n      <div className=\"table-action-drawer__sub-icon-container\" onClick={onRemoveTableColumn}>\n        <i className=\"fas fa-times fa-lg table-action-drawer__main-icon\" />\n        <i className=\"fas fa-columns fa-sm table-action-drawer__sub-icon\" />\n      </div>\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\nimport TableActionDrawer from './TableActionDrawer';\n\nimport { getCurrentTimestampAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\nimport { Map } from 'immutable';\n\nexport default class TablePart extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleCellSelect',\n      'handleTextareaBlur',\n      'handleCellChange',\n      'handleInsertTimestamp',\n      'handleTextareaRef',\n    ]);\n\n    this.state = {\n      rawCellValues: this.generateCellValueMap(props.table),\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const {\n      subPartDataAndHandlers: { onTableCellValueUpdate, selectedTableCellId, inTableEditMode },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    if (prevProps.subPartDataAndHandlers.inTableEditMode && !inTableEditMode) {\n      if (rawCellValues.has(selectedTableCellId)) {\n        onTableCellValueUpdate(selectedTableCellId, rawCellValues.get(selectedTableCellId));\n      }\n    }\n\n    if (this.props.table !== prevProps.table) {\n      this.setState({ rawCellValues: this.generateCellValueMap(this.props.table) });\n    }\n  }\n\n  generateCellValueMap(table) {\n    return Map(\n      table\n        .get('contents')\n        .map(row => row.get('contents').map(cell => [cell.get('id'), cell.get('rawContents')]))\n        .flatten()\n    );\n  }\n\n  handleCellSelect(cellId) {\n    return () => this.props.subPartDataAndHandlers.onTableCellSelect(cellId);\n  }\n\n  handleTextareaBlur() {\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.subPartDataAndHandlers.onExitTableEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleCellChange(event) {\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n\n    this.setState({\n      rawCellValues: rawCellValues.set(selectedTableCellId, event.target.value),\n    });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { rawCellValues } = this.state;\n    const {\n      subPartDataAndHandlers: { selectedTableCellId },\n    } = this.props;\n    const cellValue = rawCellValues.get(selectedTableCellId);\n\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      rawCellValues: rawCellValues.set(\n        selectedTableCellId,\n        cellValue.substring(0, insertionIndex) +\n          getCurrentTimestampAsText() +\n          cellValue.substring(this.textarea.selectionEnd || insertionIndex)\n      ),\n    });\n\n    this.textarea.focus();\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  render() {\n    const {\n      table,\n      subPartDataAndHandlers: { selectedTableCellId, inTableEditMode, shouldDisableActions },\n    } = this.props;\n    const { rawCellValues } = this.state;\n\n    const isTableSelected = table\n      .get('contents')\n      .some(row => row.get('contents').some(cell => cell.get('id') === selectedTableCellId));\n\n    return (\n      <Fragment>\n        <table className=\"table-part\">\n          <tbody>\n            {table.get('contents').map(row => (\n              <tr key={row.get('id')}>\n                {row.get('contents').map(cell => {\n                  const isCellSelected = cell.get('id') === selectedTableCellId;\n\n                  const className = classNames('table-part__cell', {\n                    'table-part__cell--selected': isCellSelected,\n                  });\n\n                  return (\n                    <td\n                      className={className}\n                      key={cell.get('id')}\n                      onClick={this.handleCellSelect(cell.get('id'))}\n                    >\n                      {isCellSelected && inTableEditMode ? (\n                        <div className=\"table-cell__edit-container\">\n                          <textarea\n                            autoFocus\n                            className=\"textarea\"\n                            rows=\"3\"\n                            value={rawCellValues.get(cell.get('id'))}\n                            onBlur={this.handleTextareaBlur}\n                            onChange={this.handleCellChange}\n                            ref={this.handleTextareaRef}\n                          />\n                          <div\n                            className=\"table-cell__insert-timestamp-button\"\n                            onClick={this.handleInsertTimestamp}\n                          >\n                            <i className=\"fas fa-plus insert-timestamp-icon\" />\n                            Insert timestamp\n                          </div>\n                        </div>\n                      ) : cell.get('contents').size > 0 ? (\n                        <AttributedString\n                          parts={cell.get('contents')}\n                          subPartDataAndHandlers={this.props.subPartDataAndHandlers}\n                        />\n                      ) : (\n                        '   '\n                      )}\n                    </td>\n                  );\n                })}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n\n        <Collapse isOpened={isTableSelected && !shouldDisableActions}>\n          <TableActionDrawer subPartDataAndHandlers={this.props.subPartDataAndHandlers} />\n        </Collapse>\n      </Fragment>\n    );\n  }\n}\n","// Interpolates between two colors.\n// colorA and colorB should be objects with keys {r, g, b, a}.\n// interpolationFactor should be a number between 0 and 1 representing how far from colorA to\n// colorB it should interpolate.\n// An object with keys {r, g, b, a} will be returned.\nexport const interpolateColors = (colorA, colorB, interpolationFactor) => {\n  return {\n    r: parseInt((colorB.r - colorA.r) * interpolationFactor + colorA.r, 10),\n    g: parseInt((colorB.g - colorA.g) * interpolationFactor + colorA.g, 10),\n    b: parseInt((colorB.b - colorA.b) * interpolationFactor + colorA.b, 10),\n    a: (colorB.a - colorA.a) * interpolationFactor + colorA.a,\n  };\n};\n\nexport const rgbaObject = (r, g, b, a) => {\n  return { r, g, b, a };\n};\n\nexport const rgbaString = rgba => {\n  return `rgba(${rgba.r}, ${rgba.g}, ${rgba.b}, ${rgba.a})`;\n};\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ state, onClick }) => {\n  const uncheckedColor = rgbaObject(255, 255, 255, 1);\n  const checkedColor = rgbaObject(238, 232, 213, 1);\n\n  const checkboxStyle = {\n    colorFactor: spring(\n      {\n        checked: 1,\n        partial: 1,\n        unchecked: 0,\n      }[state],\n      { stiffness: 300 }\n    ),\n  };\n\n  return (\n    <Motion style={checkboxStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(uncheckedColor, checkedColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"checkbox\" onClick={onClick} style={{ backgroundColor }}>\n            <div className=\"checkbox__inner-container\">\n              {state === 'checked' && <i className=\"fas fa-check\" />}\n              {state === 'partial' && <i className=\"fas fa-minus\" />}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString/';\nimport Checkbox from '../../../../../UI/Checkbox/';\n\nimport classNames from 'classnames';\n\nexport default ({ part, subPartDataAndHandlers }) => {\n  const handleCheckboxClick = itemId => () => subPartDataAndHandlers.onCheckboxClick(itemId);\n\n  const renderContent = () => {\n    return part.get('items').map(item => {\n      const lineContainerClass = classNames({\n        'list-part__checkbox-container': item.get('isCheckbox'),\n      });\n\n      return (\n        <li key={item.get('id')} value={item.get('forceNumber')}>\n          <span\n            className={lineContainerClass}\n            onClick={item.get('isCheckbox') ? handleCheckboxClick(item.get('id')) : null}\n          >\n            {item.get('isCheckbox') && <Checkbox state={item.get('checkboxState')} />}\n            <AttributedString\n              parts={item.get('titleLine')}\n              subPartDataAndHandlers={subPartDataAndHandlers}\n            />\n          </span>\n          <br />\n          <AttributedString\n            parts={item.get('contents')}\n            subPartDataAndHandlers={subPartDataAndHandlers}\n          />\n        </li>\n      );\n    });\n  };\n\n  return part.get('isOrdered') ? (\n    <ol className=\"attributed-string__list-part attributed-string__list-part--ordered\">\n      {renderContent()}\n    </ol>\n  ) : (\n    <ul className=\"attributed-string__list-part\">{renderContent()}</ul>\n  );\n};\n","import React, { Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nexport default ({ part, subPartDataAndHandlers: { onTimestampClick, shouldDisableActions } }) => {\n  const handleClick = () => (shouldDisableActions ? void 0 : onTimestampClick(part.get('id')));\n\n  const firstTimestamp = part.get('firstTimestamp');\n  const secondTimestamp = part.get('secondTimestamp');\n\n  return (\n    <span className=\"attributed-string__timestamp-part\" onClick={handleClick}>\n      {!!firstTimestamp && renderAsText(firstTimestamp)}\n      {!!secondTimestamp && (\n        <Fragment>\n          {'--'}\n          {renderAsText(secondTimestamp)}\n        </Fragment>\n      )}\n    </span>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport TablePart from './components/TablePart';\nimport ListPart from './components/ListPart';\nimport TimestampPart from './components/TimestampPart';\n\nimport classNames from 'classnames';\n\nexport default ({ parts, subPartDataAndHandlers }) => {\n  let className;\n\n  return (\n    <span>\n      {parts.map(part => {\n        switch (part.get('type')) {\n          case 'text':\n            return part.get('contents');\n          case 'link':\n            const uri = part.getIn(['contents', 'uri']);\n            const title = part.getIn(['contents', 'title']) || uri;\n\n            return (\n              <a key={part.get('id')} href={uri} target=\"_blank\" rel=\"noopener noreferrer\">\n                {title}\n              </a>\n            );\n          case 'percentage-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                parseInt(part.get('percentage'), 10) === 100,\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.get('percentage')}\n                %]\n              </span>\n            );\n          case 'fraction-cookie':\n            className = classNames('attributed-string__cookie-part', {\n              'attributed-string__cookie-part--complete':\n                part.getIn(['fraction', 0]) !== '' &&\n                part.getIn(['fraction', 0]) === part.getIn(['fraction', 1]),\n            });\n\n            return (\n              <span key={part.get('id')} className={className}>\n                [{part.getIn(['fraction', 0])}/{part.getIn(['fraction', 1])}]\n              </span>\n            );\n          case 'table':\n            return (\n              <TablePart\n                key={part.get('id')}\n                table={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'list':\n            return (\n              <ListPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'inline-markup':\n            className = classNames(\n              'attributed-string__inline-markup',\n              `attributed-string__inline-markup--${part.get('markupType')}`\n            );\n\n            return (\n              <span key={part.get('id')} className={className}>\n                {part.get('content')}\n              </span>\n            );\n          case 'timestamp':\n            return (\n              <TimestampPart\n                key={part.get('id')}\n                part={part}\n                subPartDataAndHandlers={subPartDataAndHandlers}\n              />\n            );\n          case 'url':\n            return (\n              <a\n                href={part.get('content')}\n                key={part.get('id')}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {part.get('content')}\n              </a>\n            );\n          case 'www-url':\n            return (\n              <a\n                href={`https://${part.get('content')}`}\n                key={part.get('id')}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {part.get('content')}\n              </a>\n            );\n          case 'e-mail':\n            return (\n              <a href={`mailto:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          case 'phone-number':\n            return (\n              <a href={`tel:${part.get('content')}`} key={part.get('id')}>\n                {part.get('content')}\n              </a>\n            );\n          default:\n            console.error(`Unrecognized attributed string part type! ${part.get('type')}`);\n            return '';\n        }\n      })}\n    </span>\n  );\n};\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { createIsTodoKeywordInDoneState } from '../../../../lib/org_utils';\n\nimport { generateTitleLine } from '../../../../lib/export_org';\nimport AttributedString from '../AttributedString';\n\nclass TitleLine extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTitleSpanRef',\n      'handleTextareaRef',\n      'handleTitleClick',\n      'handleTextareaBlur',\n      'handleTextareaFocus',\n      'handleTitleChange',\n      'handleTitleFieldClick',\n      'handleTodoClick',\n      'handleTimestampClick',\n      'handleInsertTimestamp',\n      'handleTitleDoubleClick',\n    ]);\n\n    this.state = {\n      titleValue: this.calculateRawTitle(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderTitle(header.get('id'), this.state.titleValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          titleValue: this.calculateRawTitle(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleTitleSpanRef(span) {\n    this.titleSpan = span;\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  calculateRawTitle(header) {\n    return generateTitleLine(header.toJS(), false);\n  }\n\n  handleTitleClick(event) {\n    const { header, hasContent, isSelected, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n    } else {\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleTitleDoubleClick() {\n    if (this.props.shouldDoubleTapToEdit) {\n      this.props.org.enterEditMode('title');\n    }\n  }\n\n  handleTodoClick(event) {\n    const { header, shouldTapTodoToAdvance, onClick } = this.props;\n\n    if (!!onClick) {\n      onClick();\n      event.stopPropagation();\n    } else {\n      this.props.org.selectHeader(header.get('id'));\n\n      if (shouldTapTodoToAdvance) {\n        this.props.org.advanceTodoState();\n      }\n    }\n  }\n\n  handleTextareaBlur(event) {\n    // Give the \"Insert timestamp\" button click a chance to tell us to ignore the blur event.\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleTextareaFocus(event) {\n    const { header, shouldDoubleTapToEdit } = this.props;\n    const rawTitle = header.getIn(['titleLine', 'rawTitle']);\n    if (rawTitle === '') {\n      const text = event.target.value;\n      event.target.selectionStart = text.length;\n      event.target.selectionEnd = text.length;\n    } else if (shouldDoubleTapToEdit) {\n      // select title contents to emulate a file browser's double-tap-to-rename\n      event.target.select();\n    }\n  }\n\n  handleTitleChange(event) {\n    // If the last character typed was a newline at the end, exit edit mode.\n    const newTitle = event.target.value;\n    const lastCharacter = newTitle[newTitle.length - 1];\n    if (\n      this.state.titleValue === newTitle.substring(0, newTitle.length - 1) &&\n      lastCharacter === '\\n'\n    ) {\n      this.props.org.exitEditMode();\n      return;\n    }\n\n    this.setState({ titleValue: newTitle });\n  }\n\n  handleTitleFieldClick(event) {\n    event.stopPropagation();\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleInsertTimestamp(event) {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { titleValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      titleValue:\n        titleValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        titleValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n\n    this.textarea.focus();\n\n    event.stopPropagation();\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      inEditMode,\n      shouldDisableActions,\n      shouldDisableExplicitWidth,\n      todoKeywordSets,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    const isTodoKeywordInDoneState = createIsTodoKeywordInDoneState(todoKeywordSets);\n    const todoKeyword = header.getIn(['titleLine', 'todoKeyword']);\n\n    const titleStyle = {\n      color,\n      wordBreak: 'break-word',\n    };\n\n    return (\n      <div\n        className=\"title-line\"\n        onClick={this.handleTitleClick}\n        onDoubleClick={this.handleTitleDoubleClick}\n        ref={this.handleRef}\n        style={{ width: shouldDisableExplicitWidth ? '' : containerWidth }}\n      >\n        {!inEditMode && !!todoKeyword ? (\n          <span\n            // INFO: Instead of `todoKeyword.toLowerCase()` it would\n            // be best to render todo-keyword--done if the keyword is\n            // the last of a keywordSet. Then it would get rendered\n            // with the appropriate color, no matter what the keyword\n            // is.\n            // Relevant issue: https://github.com/200ok-ch/organice/issues/16\n            className={classNames(\n              'todo-keyword',\n              isTodoKeywordInDoneState(todoKeyword) ? 'todo-keyword--done-state' : null\n            )}\n            onClick={this.handleTodoClick}\n          >\n            {todoKeyword}\n          </span>\n        ) : (\n          ''\n        )}\n\n        {inEditMode ? (\n          <div className=\"title-line__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              data-testid=\"titleLineInput\"\n              rows=\"3\"\n              ref={this.handleTextareaRef}\n              value={this.state.titleValue}\n              onBlur={this.handleTextareaBlur}\n              onFocus={this.handleTextareaFocus}\n              onChange={this.handleTitleChange}\n              onClick={this.handleTitleFieldClick}\n            />\n            <div\n              className=\"title-line__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <div>\n            <span style={titleStyle} ref={this.handleTitleSpanRef}>\n              <AttributedString\n                parts={header.getIn(['titleLine', 'title'])}\n                subPartDataAndHandlers={{\n                  onTimestampClick: this.handleTimestampClick,\n                  shouldDisableActions,\n                }}\n              />\n              {!header.get('opened') && hasContent ? '...' : ''}\n            </span>\n\n            {header.getIn(['titleLine', 'tags']).size > 0 && (\n              <div>\n                {header\n                  .getIn(['titleLine', 'tags'])\n                  .toSet()\n                  .toList()\n                  .filter(tag => !!tag)\n                  .map(tag => (\n                    <div className=\"header-tag\" key={tag}>\n                      {tag}\n                    </div>\n                  ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'title' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    shouldDoubleTapToEdit: state.base.get('shouldDoubleTapToEdit'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    todoKeywordSets: state.org.present.get('todoKeywordSets'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TitleLine);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\n\nexport default class PlanningItems extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleTimestampClick']);\n  }\n\n  handleTimestampClick(planningItemIndex) {\n    return () => this.props.onClick(planningItemIndex);\n  }\n\n  render() {\n    const { planningItems } = this.props;\n\n    if (planningItems.size === 0) {\n      return null;\n    }\n\n    return (\n      <div>\n        {planningItems.map((planningItem, index) => (\n          <div key={planningItem.get('id')} className=\"planning-items__item-container\">\n            <div className=\"planning-item__type\">{planningItem.get('type')}: </div>\n            <div className=\"planning-item__timestamp\" onClick={this.handleTimestampClick(index)}>\n              {renderAsText(planningItem.get('timestamp'))}\n            </div>\n          </div>\n        ))}\n      </div>\n    );\n  }\n}\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport AttributedString from '../../../AttributedString';\n\nexport default ({ propertyListItems, shouldDisableActions, onTimestampClick, onEdit }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  return propertyListItems.size === 0 ? null : (\n    <div className=\"property-list-container\">\n      <div className=\"property-list__property\" onClick={handleCollapseToggle}>\n        :PROPERTIES:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {propertyListItems.map(propertyListItem => (\n            <div className=\"property-list__item-container\" key={propertyListItem.get('id')}>\n              <div\n                className=\"property-list__property\"\n                onClick={shouldDisableActions ? null : onEdit}\n              >\n                :{propertyListItem.get('property')}:\n              </div>\n              <div className=\"property-list__value\">\n                <AttributedString\n                  parts={propertyListItem.get('value') || []}\n                  subPartDataAndHandlers={{\n                    onTimestampClick,\n                    shouldDisableActions,\n                  }}\n                />\n              </div>\n            </div>\n          ))}\n\n          <div className=\"property-list__property\" onClick={onEdit}>\n            :END:\n          </div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { Fragment, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport { renderAsText, timestampDuration } from '../../../../../../lib/timestamps';\n\nexport default ({ logBookEntries, onTimestampClick, shouldDisableActions }) => {\n  const [isDrawerCollapsed, setIsDrawerCollapsed] = useState(true);\n\n  const handleCollapseToggle = () => setIsDrawerCollapsed(!isDrawerCollapsed);\n\n  const onClick = (entryIndex, type) => () =>\n    shouldDisableActions ? void 0 : onTimestampClick(entryIndex, type);\n\n  return logBookEntries.size === 0 ? null : (\n    <div className=\"logbook-entries-container\">\n      <div className=\"logbook-entries__logbook\" onClick={handleCollapseToggle}>\n        :LOGBOOK:\n        {isDrawerCollapsed ? '...' : ''}\n      </div>\n      {!isDrawerCollapsed && (\n        <Fragment>\n          {logBookEntries.map((entry, index) =>\n            entry.get('raw') !== undefined ? (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                {entry.get('raw') || ' '}\n              </div>\n            ) : (\n              <div className=\"logbook-entries__item-container\" key={entry.get('id')}>\n                <span className=\"logbook-entries__item-clock\">CLOCK:</span>\n                <span className=\"logbook-entries__item-start\" onClick={onClick(index, 'start')}>\n                  {renderAsText(entry.get('start'))}\n                </span>\n                {entry.get('end') === null ? (\n                  ''\n                ) : (\n                  <Fragment>\n                    --\n                    <span className=\"logbook-entries__item-end\" onClick={onClick(index, 'end')}>\n                      {renderAsText(entry.get('end'))}\n                    </span>\n                    <span className=\"logbook-entries__item-duration\">\n                      => {timestampDuration(entry.get('start'), entry.get('end'))}\n                    </span>\n                  </Fragment>\n                )}\n              </div>\n            )\n          )}\n          <div className=\"logbook-entries__logbook\">:END:</div>\n        </Fragment>\n      )}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport PlanningItems from './components/PlanningItems';\nimport PropertyListItems from './components/PropertyListItems';\nimport LogBookEntries from './components/LogBookEntries';\n\nimport _ from 'lodash';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport { renderAsText, getCurrentTimestampAsText } from '../../../../lib/timestamps';\nimport { attributedStringToRawText } from '../../../../lib/export_org';\n\nimport AttributedString from '../AttributedString';\n\nclass HeaderContent extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleTextareaRef',\n      'handleDescriptionChange',\n      'handleTextareaBlur',\n      'handleTableCellSelect',\n      'handleExitTableEditMode',\n      'handleTableCellValueUpdate',\n      'handleEnterTableEditMode',\n      'handleAddNewTableRow',\n      'handleRemoveTableRow',\n      'handleAddNewTableColumn',\n      'handleRemoveTableColumn',\n      'handleCheckboxClick',\n      'handleTimestampClick',\n      'handleLogEntryTimestampClick',\n      'handleInsertTimestamp',\n      'handlePlanningItemTimestampClick',\n      'handlePropertyListEdit',\n      'handleDoubleClick'\n    ]);\n\n    this.state = {\n      descriptionValue: this.calculateRawDescription(props.header),\n      containerWidth: null,\n      shouldIgnoreBlur: false,\n    };\n  }\n\n  storeContainerWidth() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  componentDidMount() {\n    this.storeContainerWidth();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { header } = this.props;\n\n    if (prevProps.inEditMode && !this.props.inEditMode) {\n      this.props.org.updateHeaderDescription(header.get('id'), this.state.descriptionValue);\n    }\n\n    if (prevProps.header !== this.props.header) {\n      this.setState(\n        {\n          descriptionValue: this.calculateRawDescription(this.props.header),\n        },\n        () => this.storeContainerWidth()\n      );\n    }\n  }\n\n  calculateRawDescription(header) {\n    const planningItems = header.get('planningItems');\n    const propertyListItems = header.get('propertyListItems');\n    const logBookEntries = header.get('logBookEntries');\n\n    const planningItemsText = planningItems\n      .map(\n        planningItem =>\n          `${planningItem.get('type')}: ${renderAsText(planningItem.get('timestamp'))}`\n      )\n      .join(' ');\n\n    let propertyListItemsText = '';\n    if (propertyListItems.size > 0) {\n      propertyListItemsText += ':PROPERTIES:\\n';\n      propertyListItemsText += propertyListItems\n        .map(\n          propertyListItem =>\n            `:${propertyListItem.get('property')}: ${attributedStringToRawText(\n              propertyListItem.get('value')\n            )}`\n        )\n        .join('\\n');\n      propertyListItemsText += '\\n:END:';\n    }\n\n    let logBookEntriesText = '';\n    if (logBookEntries.size > 0) {\n      logBookEntriesText += ':LOGBOOK:\\n';\n      logBookEntriesText += logBookEntries\n        .map(entry =>\n          entry.get('raw') !== undefined\n            ? entry.get('raw')\n            : entry.get('end') === null\n            ? `CLOCK: ${renderAsText(entry.get('start'))}`\n            : `CLOCK: ${renderAsText(entry.get('start'))}--${renderAsText(entry.get('end'))}`\n        )\n        .join('\\n');\n      logBookEntriesText += '\\n:END:';\n    }\n\n    const headerText = [planningItemsText, propertyListItemsText, logBookEntriesText]\n      .filter(str => str.length !== 0)\n      .join('\\n');\n\n    return headerText + (headerText.length === 0 ? '' : '\\n') + header.get('rawDescription');\n  }\n\n  handleTextareaRef(textarea) {\n    this.textarea = textarea;\n  }\n\n  handleRef(div) {\n    this.containerDiv = div;\n  }\n\n  handleDescriptionChange(event) {\n    this.setState({ descriptionValue: event.target.value });\n  }\n\n  handleTextareaBlur() {\n    // Give the \"Insert timestamp\" button click a chance to tell us to ignore the blur event.\n    setTimeout(() => {\n      if (!this.state.shouldIgnoreBlur) {\n        this.props.org.exitEditMode();\n      } else {\n        this.setState({ shouldIgnoreBlur: false });\n      }\n    }, 0);\n  }\n\n  handleTableCellSelect(cellId) {\n    this.props.org.setSelectedTableCellId(cellId);\n  }\n\n  handleExitTableEditMode() {\n    this.props.org.exitEditMode();\n  }\n\n  handleTableCellValueUpdate(cellId, newValue) {\n    this.props.org.updateTableCellValue(cellId, newValue);\n  }\n\n  handleEnterTableEditMode() {\n    this.props.org.enterEditMode('table');\n  }\n\n  handleAddNewTableRow() {\n    this.props.org.addNewTableRow();\n  }\n\n  handleRemoveTableRow() {\n    this.props.org.removeTableRow();\n  }\n\n  handleAddNewTableColumn() {\n    this.props.org.addNewTableColumn();\n  }\n\n  handleRemoveTableColumn() {\n    this.props.org.removeTableColumn();\n  }\n\n  handleCheckboxClick(listItemId) {\n    this.props.org.advanceCheckboxState(listItemId);\n  }\n\n  handleTimestampClick(timestampId) {\n    this.props.base.activatePopup('timestamp-editor', { timestampId });\n  }\n\n  handleLogEntryTimestampClick(headerId) {\n    return (logEntryIndex, entryType) =>\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId,\n        logEntryIndex,\n        entryType,\n      });\n  }\n\n  handleInsertTimestamp() {\n    // Clicking this button will unfocus the textarea, but we don't want to exit edit mode,\n    // so instruct the blur handler to ignore the event.\n    this.setState({ shouldIgnoreBlur: true });\n\n    const { descriptionValue } = this.state;\n    const insertionIndex = this.textarea.selectionStart;\n    this.setState({\n      descriptionValue:\n        descriptionValue.substring(0, insertionIndex) +\n        getCurrentTimestampAsText() +\n        descriptionValue.substring(this.textarea.selectionEnd || insertionIndex),\n    });\n    this.textarea.focus();\n  }\n\n  handlePlanningItemTimestampClick(headerId) {\n    return planningItemIndex =>\n      this.props.base.activatePopup('timestamp-editor', { headerId, planningItemIndex });\n  }\n\n  handlePropertyListEdit() {\n    const { header } = this.props;\n    this.props.base.activatePopup('property-list-editor', { headerId: header.get('id') });\n  }\n\n  handleDoubleClick() {\n    if (this.props.shouldDoubleTapToEdit) {\n      this.props.org.openHeader(this.props.header.get('id'));\n      this.props.org.enterEditMode('description');\n    }\n  }\n\n  render() {\n    const {\n      header,\n      inEditMode,\n      selectedTableCellId,\n      inTableEditMode,\n      shouldDisableActions,\n    } = this.props;\n    const { containerWidth } = this.state;\n\n    if (!header.get('opened')) {\n      return <div />;\n    }\n\n    return (\n      <div\n        className=\"header-content-container nice-scroll\"\n        ref={this.handleRef}\n        onDoubleClick={this.handleDoubleClick}\n        style={{ width: containerWidth }}\n      >\n        {inEditMode ? (\n          <div className=\"header-content__edit-container\">\n            <textarea\n              autoFocus\n              className=\"textarea\"\n              rows=\"8\"\n              ref={this.handleTextareaRef}\n              value={this.state.descriptionValue}\n              onBlur={this.handleTextareaBlur}\n              onChange={this.handleDescriptionChange}\n            />\n            <div\n              className=\"header-content__insert-timestamp-button\"\n              onClick={this.handleInsertTimestamp}\n            >\n              <i className=\"fas fa-plus insert-timestamp-icon\" />\n              Insert timestamp\n            </div>\n          </div>\n        ) : (\n          <Fragment>\n            <PlanningItems\n              planningItems={header.get('planningItems')}\n              onClick={this.handlePlanningItemTimestampClick(header.get('id'))}\n            />\n            <PropertyListItems\n              propertyListItems={header.get('propertyListItems')}\n              onTimestampClick={this.handleTimestampClick}\n              shouldDisableActions={shouldDisableActions}\n              onEdit={this.handlePropertyListEdit}\n            />\n            <LogBookEntries\n              logBookEntries={header.get('logBookEntries')}\n              onTimestampClick={this.handleLogEntryTimestampClick(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n            <AttributedString\n              parts={header.get('description')}\n              subPartDataAndHandlers={{\n                onTableCellSelect: this.handleTableCellSelect,\n                selectedTableCellId: selectedTableCellId,\n                inTableEditMode: inTableEditMode,\n                onExitTableEditMode: this.handleExitTableEditMode,\n                onTableCellValueUpdate: this.handleTableCellValueUpdate,\n                onEnterTableEditMode: this.handleEnterTableEditMode,\n                onAddNewTableRow: this.handleAddNewTableRow,\n                onRemoveTableRow: this.handleRemoveTableRow,\n                onAddNewTableColumn: this.handleAddNewTableColumn,\n                onRemoveTableColumn: this.handleRemoveTableColumn,\n                onCheckboxClick: this.handleCheckboxClick,\n                onTimestampClick: this.handleTimestampClick,\n                shouldDisableActions,\n              }}\n            />\n          </Fragment>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode:\n      state.org.present.get('editMode') === 'description' &&\n      state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    isSelected: state.org.present.get('selectedHeaderId') === props.header.get('id'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    inTableEditMode: state.org.present.get('editMode') === 'table',\n    shouldDoubleTapToEdit: state.base.get('shouldDoubleTapToEdit'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderContent);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nexport default class HeaderActionDrawer extends PureComponent {\n  // A nasty hack required to get click handling to work properly in Firefox. No idea why its\n  // broken in the first place or why this fixes it.\n  iconWithFFClickCatcher({ className, onClick, title, testId = '' }) {\n    return (\n      <div\n        title={title}\n        onClick={onClick}\n        className=\"header-action-drawer__ff-click-catcher-container\"\n      >\n        <div className=\"header-action-drawer__ff-click-catcher\" />\n        <i className={className} data-testid={testId} />\n      </div>\n    );\n  }\n\n  render() {\n    const {\n      onEnterTitleEditMode,\n      onEnterDescriptionEditMode,\n      onTagsClick,\n      onPropertiesClick,\n      isFocused,\n      onFocus,\n      onUnfocus,\n      onAddNewHeader,\n      onDeadlineClick,\n      onClockInOutClick,\n      onScheduledClick,\n      hasActiveClock,\n      onShareHeader,\n      onRefileHeader,\n    } = this.props;\n\n    return (\n      <div className=\"header-action-drawer-container\">\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-pencil-alt fa-lg',\n            onClick: onEnterTitleEditMode,\n            title: 'Edit header title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-edit fa-lg',\n            onClick: onEnterDescriptionEditMode,\n            title: 'Edit header description',\n            testId: 'edit-header-title',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-tags fa-lg',\n            onClick: onTagsClick,\n            title: 'Modify tags',\n          })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-list fa-lg',\n            onClick: onPropertiesClick,\n            title: 'Modify properties',\n          })}\n\n          {isFocused\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-expand fa-lg',\n                onClick: onUnfocus,\n                title: 'Narrow to subtree (Focus on this header)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-compress fa-lg',\n                onClick: onFocus,\n                title: 'Widen (Unfocus from this header)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-plus fa-lg',\n            onClick: onAddNewHeader,\n            testId: 'header-action-plus',\n            title: 'Create new header below',\n          })}\n        </div>\n\n        <div className=\"header-action-drawer__row\">\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-envelope fa-lg',\n            onClick: onShareHeader,\n            testId: 'share',\n            title: 'Share this header via email',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-calendar-check fa-lg',\n            onClick: onDeadlineClick,\n            title: 'Set deadline datetime',\n          })}\n          {this.iconWithFFClickCatcher({\n            className: 'far fa-calendar-check fa-lg',\n            onClick: onScheduledClick,\n            title: 'Set scheduled datetime',\n          })}\n          {hasActiveClock\n            ? this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-end fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-out',\n                title: 'Clock out (Stop the clock)',\n              })\n            : this.iconWithFFClickCatcher({\n                className: 'fas fa-hourglass-start fa-lg',\n                onClick: onClockInOutClick,\n                testId: 'org-clock-in',\n                title: 'Clock in (Start the clock)',\n              })}\n\n          {this.iconWithFFClickCatcher({\n            className: 'fas fa-file-export fa-lg',\n            onClick: onRefileHeader,\n            testId: 'org-refile',\n            title: 'Refile this header to another header',\n          })}\n\n          {/* Placeholder to align the other icons */}\n          {this.iconWithFFClickCatcher({\n            className: '',\n            onClick: () => {},\n            title: '',\n          })}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as baseActions from '../../../../actions/base';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nimport TitleLine from '../TitleLine';\nimport HeaderContent from '../HeaderContent';\nimport HeaderActionDrawer from './components/HeaderActionDrawer';\n\nimport { headerWithId } from '../../../../lib/org_utils';\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../../lib/color';\nimport { getCurrentTimestamp } from '../../../../lib/timestamps';\n\nclass Header extends PureComponent {\n  SWIPE_ACTION_ACTIVATION_DISTANCE = 80;\n  FREE_DRAG_ACTIVATION_DISTANCE = 10;\n\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleRef',\n      'handleMouseDown',\n      'handleMouseMove',\n      'handleMouseUp',\n      'handleMouseOut',\n      'handleTouchMove',\n      'handleTouchStart',\n      'handleTouchEnd',\n      'handleTouchCancel',\n      'handleHeaderClick',\n      'handleEnterTitleEditMode',\n      'handleEnterDescriptionEditMode',\n      'handleShowTagsModal',\n      'handleShowPropertyListEditorModal',\n      'handleFocus',\n      'handleUnfocus',\n      'handleAddNewHeader',\n      'handleRest',\n      'handleDeadlineClick',\n      'handleClockInOutClick',\n      'handleScheduledClick',\n      'handleShareHeaderClick',\n      'handleRefileHeaderRequest',\n    ]);\n\n    this.state = {\n      isDraggingFreely: false,\n      dragStartX: null,\n      dragStartY: null,\n      currentDragX: null,\n      containerWidth: null,\n      isPlayingRemoveAnimation: false,\n      heightBeforeRemove: null,\n    };\n  }\n\n  componentDidMount() {\n    if (this.containerDiv) {\n      this.setState({ containerWidth: this.containerDiv.offsetWidth });\n    }\n  }\n\n  handleRef(containerDiv) {\n    this.containerDiv = containerDiv;\n    this.props.onRef(containerDiv);\n  }\n\n  handleDragStart(event, dragX, dragY) {\n    if (this.props.shouldDisableActions) {\n      return;\n    }\n    if (this.props.inEditMode) {\n      return;\n    }\n\n    if (!!event.target.closest('.table-part')) {\n      return;\n    }\n\n    this.setState({\n      dragStartX: dragX,\n      dragStartY: dragY,\n    });\n  }\n\n  handleDragMove(dragX, dragY) {\n    const { dragStartX, dragStartY } = this.state;\n    if (dragStartX === null) {\n      return;\n    }\n\n    if (!this.state.isDraggingFreely) {\n      if (Math.abs(dragX - dragStartX) >= this.FREE_DRAG_ACTIVATION_DISTANCE) {\n        this.setState({ isDraggingFreely: true });\n      }\n    }\n\n    if (Math.abs(dragY - dragStartY) >= this.SWIPE_ACTION_ACTIVATION_DISTANCE / 2) {\n      this.setState({ dragStartX: null });\n    } else {\n      this.setState({ currentDragX: dragX });\n    }\n  }\n\n  handleDragEnd() {\n    const { dragStartX, currentDragX } = this.state;\n\n    if (!!dragStartX && !!currentDragX) {\n      const swipeDistance = currentDragX - dragStartX;\n\n      if (swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.props.org.advanceTodoState(this.props.header.get('id'));\n      }\n\n      if (-1 * swipeDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE) {\n        this.setState({\n          isPlayingRemoveAnimation: true,\n          heightBeforeRemove: this.containerDiv.offsetHeight,\n        });\n      }\n    }\n\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleDragCancel() {\n    this.setState({\n      dragStartX: null,\n      currentDragX: null,\n      isDraggingFreely: false,\n    });\n  }\n\n  handleMouseDown(event) {\n    this.handleDragStart(event, event.clientX, event.clientY);\n  }\n\n  handleMouseMove(event) {\n    this.handleDragMove(event.clientX, event.clientY);\n  }\n\n  handleMouseUp() {\n    this.handleDragEnd();\n  }\n\n  handleMouseOut() {\n    this.handleDragCancel();\n  }\n\n  handleTouchStart(event) {\n    this.handleDragStart(event, event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchMove(event) {\n    this.handleDragMove(event.changedTouches[0].clientX, event.changedTouches[0].clientY);\n  }\n\n  handleTouchEnd() {\n    this.handleDragEnd();\n  }\n\n  handleTouchCancel() {\n    this.handleDragCancel();\n  }\n\n  handleHeaderClick(event) {\n    const classList = event.target.classList;\n    if (classList.contains('header') || classList.contains('header__bullet')) {\n      const { header, hasContent, isSelected } = this.props;\n\n      if (hasContent && (!header.get('opened') || isSelected)) {\n        this.props.org.toggleHeaderOpened(header.get('id'));\n      }\n\n      this.props.org.selectHeader(header.get('id'));\n    }\n  }\n\n  handleEnterTitleEditMode() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEnterDescriptionEditMode() {\n    this.props.org.openHeader(this.props.header.get('id'));\n    this.props.org.enterEditMode('description');\n  }\n\n  handleShowTagsModal() {\n    this.props.base.activatePopup('tags-editor');\n  }\n\n  handleShowPropertyListEditorModal() {\n    this.props.base.activatePopup('property-list-editor');\n  }\n\n  handleFocus() {\n    this.props.org.focusHeader(this.props.header.get('id'));\n  }\n\n  handleUnfocus() {\n    this.props.org.unfocusHeader();\n  }\n\n  handleAddNewHeader() {\n    this.props.org.addHeaderAndEdit(this.props.header.get('id'));\n  }\n\n  handleRest() {\n    if (this.state.isPlayingRemoveAnimation) {\n      this.props.org.removeHeader(this.props.header.get('id'));\n    }\n  }\n\n  handleDeadlineAndScheduledClick(planningType) {\n    const { header } = this.props;\n\n    const existingDeadlinePlanningItemIndex = header\n      .get('planningItems', [])\n      .findIndex(planningItem => planningItem.get('type') === planningType);\n\n    if (existingDeadlinePlanningItemIndex === -1) {\n      this.props.org.addNewPlanningItem(header.get('id'), planningType);\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: header.get('planningItems').size,\n      });\n    } else {\n      this.props.base.activatePopup('timestamp-editor', {\n        headerId: header.get('id'),\n        planningItemIndex: existingDeadlinePlanningItemIndex,\n      });\n    }\n\n    this.props.org.openHeader(header.get('id'));\n  }\n\n  handleDeadlineClick() {\n    this.handleDeadlineAndScheduledClick('DEADLINE');\n  }\n\n  handleClockInOutClick() {\n    const { header } = this.props;\n    const logBook = header.get('logBookEntries', []);\n    const existingClockIndex = logBook.findIndex(entry => entry.get('end') === null);\n    const now = getCurrentTimestamp({ isActive: false, withStartTime: true });\n    if (existingClockIndex !== -1) {\n      this.props.org.setLogEntryStop(\n        header.get('id'),\n        logBook.getIn([existingClockIndex, 'id']),\n        now\n      );\n    } else {\n      this.props.org.createLogEntryStart(header.get('id'), now);\n    }\n  }\n\n  handleScheduledClick() {\n    this.handleDeadlineAndScheduledClick('SCHEDULED');\n  }\n\n  handleShareHeaderClick() {\n    const { header } = this.props;\n\n    const titleLine = header.get('titleLine');\n    const todoKeyword = titleLine.get('todoKeyword');\n    const tags = titleLine.get('tags');\n    const title = titleLine.get('rawTitle').trim();\n    const subject = todoKeyword ? `${todoKeyword} ${title}` : title;\n    const body = `\n${tags.isEmpty() ? '' : `Tags: ${tags.join(' ')}\\n`}\n${header.get('rawDescription')}\n`;\n    //const titleParts = titleLine.get('title'); // List of parsed tokens in title\n    //const properties = header.get('propertyListItem'); //.get(0) .get('property') or .get('value')\n    //const planningItems = header.get('planningItems'); //.get(0) .get('type') [DEADLINE|SCHEDULED] or .get('timestamp')\n    const mailtoURI = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(\n      body\n    )}`;\n    // TODO: If available, use webshare\n    // Maybe there's synergy with this PR: https://github.com/200ok-ch/organice/pull/138/files\n\n    window.open(mailtoURI);\n    // INFO: Alternative implementation that works without having a\n    // popup window. We didn't go this route, because it's non-trivial\n    // to mock the window object, so it's harder to test. Having\n    // slightly worse UX in favor of having a test is not optimal, as\n    // well, of course.\n    // window.location.href = mailtoURI;\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleRefileHeaderRequest() {\n    this.props.base.activatePopup('refile');\n  }\n\n  render() {\n    const {\n      header,\n      color,\n      hasContent,\n      isSelected,\n      bulletStyle,\n      focusedHeader,\n      isFocused,\n      shouldDisableActions,\n    } = this.props;\n\n    const indentLevel = !!focusedHeader\n      ? header.get('nestingLevel') - focusedHeader.get('nestingLevel') + 1\n      : header.get('nestingLevel');\n\n    const {\n      dragStartX,\n      currentDragX,\n      isDraggingFreely,\n      isPlayingRemoveAnimation,\n      containerWidth,\n    } = this.state;\n    const marginLeft =\n      !!dragStartX && !!currentDragX && isDraggingFreely\n        ? currentDragX - dragStartX\n        : isPlayingRemoveAnimation\n        ? spring(-1 * containerWidth, { stiffness: 300 })\n        : spring(0, { stiffness: 300 });\n\n    const style = {\n      paddingLeft: 20 * indentLevel,\n      marginLeft,\n      heightFactor: isPlayingRemoveAnimation ? spring(0, { stiffness: 300 }) : 1,\n    };\n\n    const className = classNames('header', {\n      'header--selected': isSelected,\n      'header--removing': isPlayingRemoveAnimation,\n    });\n\n    const logBookEntries = header\n      .get('logBookEntries')\n      .filter(entry => entry.get('raw') === undefined);\n    const hasActiveClock =\n      logBookEntries.size !== 0 && logBookEntries.filter(entry => !entry.get('end')).size !== 0;\n\n    return (\n      <Motion style={style} onRest={this.handleRest}>\n        {interpolatedStyle => {\n          const swipedDistance = interpolatedStyle.marginLeft;\n          const isLeftActionActivated = swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n          const isRightActionActivated =\n            -1 * swipedDistance >= this.SWIPE_ACTION_ACTIVATION_DISTANCE;\n\n          const disabledBackgroundColor = rgbaObject(211, 211, 211, 1);\n          const leftActivatedBackgroundColor = rgbaObject(0, 128, 0, 1);\n          const rightActivatedBackgroundColor = rgbaObject(255, 0, 0, 1);\n\n          const disabledIconColor = rgbaObject(0, 0, 0, 1);\n          const activatedIconColor = rgbaObject(255, 255, 255, 1);\n\n          const leftSwipeActionContainerStyle = {\n            width: interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isLeftActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n          const rightSwipeActionContainerStyle = {\n            width: -1 * interpolatedStyle.marginLeft,\n            backgroundColorFactor: spring(isRightActionActivated ? 1 : 0, { stiffness: 300 }),\n          };\n\n          const { heightFactor, ...headerStyle } = interpolatedStyle;\n\n          if (isPlayingRemoveAnimation) {\n            headerStyle.height = this.state.heightBeforeRemove * heightFactor;\n          }\n\n          return (\n            <div\n              className={className}\n              style={headerStyle}\n              ref={this.handleRef}\n              onClick={this.handleHeaderClick}\n              onMouseDown={this.handleMouseDown}\n              onMouseMove={this.handleMouseMove}\n              onMouseUp={this.handleMouseUp}\n              onMouseOut={this.handleMouseOut}\n              onTouchStart={this.handleTouchStart}\n              onTouchMove={this.handleTouchMove}\n              onTouchEnd={this.handleTouchEnd}\n              onTouchCancel={this.handleTouchCancel}\n            >\n              <Motion style={leftSwipeActionContainerStyle}>\n                {leftInterpolatedStyle => {\n                  const leftStyle = {\n                    width: leftInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledBackgroundColor,\n                        leftActivatedBackgroundColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const leftIconStyle = {\n                    display: swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        leftInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"left-swipe-action-container\" style={leftStyle}>\n                      <i\n                        className=\"fas fa-check swipe-action-container__icon swipe-action-container__icon--left\"\n                        style={leftIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n              <Motion style={rightSwipeActionContainerStyle}>\n                {rightInterpolatedStyle => {\n                  const rightStyle = {\n                    width: rightInterpolatedStyle.width,\n                    backgroundColor: rgbaString(\n                      interpolateColors(\n                        disabledBackgroundColor,\n                        rightActivatedBackgroundColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  const rightIconStyle = {\n                    display: -1 * swipedDistance > 30 ? '' : 'none',\n                    color: rgbaString(\n                      interpolateColors(\n                        disabledIconColor,\n                        activatedIconColor,\n                        rightInterpolatedStyle.backgroundColorFactor\n                      )\n                    ),\n                  };\n\n                  return (\n                    <div className=\"right-swipe-action-container\" style={rightStyle}>\n                      <i\n                        className=\"fas fa-times swipe-action-container__icon swipe-action-container__icon--right\"\n                        style={rightIconStyle}\n                      />\n                    </div>\n                  );\n                }}\n              </Motion>\n\n              <div style={{ marginLeft: -16, color }} className=\"header__bullet\">\n                {bulletStyle === 'Fancy' ? '●' : '*'}\n              </div>\n              <TitleLine\n                header={header}\n                color={color}\n                hasContent={hasContent}\n                isSelected={isSelected}\n                shouldDisableActions={shouldDisableActions}\n              />\n\n              <Collapse\n                isOpened={isSelected && !shouldDisableActions}\n                springConfig={{ stiffness: 300 }}\n                style={{ marginRight: rightSwipeActionContainerStyle.width }}\n              >\n                <HeaderActionDrawer\n                  onEnterTitleEditMode={this.handleEnterTitleEditMode}\n                  onEnterDescriptionEditMode={this.handleEnterDescriptionEditMode}\n                  isFocused={isFocused}\n                  onTagsClick={this.handleShowTagsModal}\n                  onPropertiesClick={this.handleShowPropertyListEditorModal}\n                  onFocus={this.handleFocus}\n                  onUnfocus={this.handleUnfocus}\n                  onAddNewHeader={this.handleAddNewHeader}\n                  onDeadlineClick={this.handleDeadlineClick}\n                  onClockInOutClick={this.handleClockInOutClick}\n                  onScheduledClick={this.handleScheduledClick}\n                  hasActiveClock={hasActiveClock}\n                  onShareHeader={this.handleShareHeaderClick}\n                  onRefileHeader={this.handleRefileHeaderRequest}\n                />\n              </Collapse>\n\n              <HeaderContent\n                  header={header}\n                  onEnterDescriptionEditMode={this.handleEnterDescriptionEditMode}\n                  shouldDisableActions={shouldDisableActions} />\n            </div>\n          );\n        }}\n      </Motion>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const focusedHeader = !!state.org.present.get('focusedHeaderId')\n    ? headerWithId(state.org.present.get('headers'), state.org.present.get('focusedHeaderId'))\n    : null;\n\n  return {\n    bulletStyle: state.base.get('bulletStyle'),\n    focusedHeader,\n    isFocused: !!focusedHeader && focusedHeader.get('id') === props.header.get('id'),\n    inEditMode: !!state.org.present.get('editMode'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n  base: bindActionCreators(baseActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Header);\n","import React, { PureComponent } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport Header from '../Header';\n\nimport { numSubheadersOfHeaderWithId } from '../../../../lib/org_utils';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nclass HeaderList extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.headerRefs = {};\n\n    _.bindAll(this, ['handleHeaderRef']);\n  }\n\n  componentDidUpdate(prevProps) {\n    if (prevProps.selectedHeaderId !== this.props.selectedHeaderId) {\n      const selectedHeaderDiv = this.headerRefs[this.props.selectedHeaderId];\n      if (!!selectedHeaderDiv) {\n        const boundingRectangle = selectedHeaderDiv.getBoundingClientRect();\n        const viewportHeight = document.documentElement.clientHeight;\n\n        if (boundingRectangle.top > viewportHeight * 0.9 || boundingRectangle.bottom < 0) {\n          selectedHeaderDiv.scrollIntoView();\n        }\n      }\n    }\n  }\n\n  handleHeaderRef(headerId) {\n    return div => (this.headerRefs[headerId] = div);\n  }\n\n  render() {\n    const { headers, selectedHeaderId, focusedHeaderId, shouldDisableActions } = this.props;\n\n    const headerRenderData = headers\n      .map(header => {\n        return {\n          header,\n          displayed: false,\n          hasContent:\n            !!header.get('rawDescription') ||\n            header.get('planningItems').size !== 0 ||\n            header.get('propertyListItems').size !== 0 ||\n            header.get('logBookEntries').size !== 0,\n        };\n      })\n      .toArray();\n\n    headerRenderData.forEach((headerRenderDatum, index) => {\n      const nestingLevel = headerRenderDatum.header.get('nestingLevel');\n\n      const hasNoParents = headerRenderData\n        .slice(0, index)\n        .every(\n          previousRenderDatum => previousRenderDatum.header.get('nestingLevel') >= nestingLevel\n        );\n      if (hasNoParents) {\n        headerRenderDatum.displayed = true;\n      }\n\n      const followingHeaders = headerRenderData.slice(index + 1);\n      for (\n        let followingHeaderIndex = 0;\n        followingHeaderIndex < followingHeaders.length;\n        ++followingHeaderIndex\n      ) {\n        const followingHeader = followingHeaders[followingHeaderIndex];\n        if (followingHeader.header.get('nestingLevel') <= nestingLevel) {\n          break;\n        }\n\n        headerRenderDatum.hasContent = true;\n\n        followingHeader.displayed =\n          headerRenderDatum.header.get('opened') && headerRenderDatum.displayed;\n      }\n    });\n\n    if (!!focusedHeaderId) {\n      const focusedHeaderIndex = headerRenderData.findIndex(\n        headerRenderDatum => headerRenderDatum.header.get('id') === focusedHeaderId\n      );\n\n      const previousHeaders = headerRenderData.slice(0, focusedHeaderIndex);\n      previousHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n\n      const numSubheaders = numSubheadersOfHeaderWithId(headers, focusedHeaderId);\n      const followingHeaders = headerRenderData.slice(focusedHeaderIndex + numSubheaders + 1);\n      followingHeaders.forEach(headerRenderDatum => (headerRenderDatum.displayed = false));\n    }\n\n    const headerColors = [\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n      'var(--blue)',\n      'var(--green)',\n      'var(--cyan)',\n      'var(--yellow)',\n    ];\n\n    const displayedHeaderRenderData = headerRenderData.filter(\n      headerRenderDatum => headerRenderDatum.displayed\n    );\n\n    const className = classNames('header-list-container', {\n      'header-list-container--focused': !!focusedHeaderId,\n    });\n    return (\n      <div className={className}>\n        {displayedHeaderRenderData.map((headerRenderDatum, index) => {\n          const header = headerRenderDatum.header;\n          const color = headerColors[(header.get('nestingLevel') - 1) % headerColors.length];\n\n          return (\n            <Header\n              key={header.get('id')}\n              header={header}\n              color={color}\n              hasContent={headerRenderDatum.hasContent}\n              isSelected={header.get('id') === selectedHeaderId}\n              onRef={this.handleHeaderRef(header.get('id'))}\n              shouldDisableActions={shouldDisableActions}\n            />\n          );\n        })}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    headers: state.org.present.get('headers'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    focusedHeaderId: state.org.present.get('focusedHeaderId'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {};\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HeaderList);\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport _ from 'lodash';\n\nexport default class ActionButton extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleClick']);\n  }\n\n  handleClick() {\n    const { onClick, isDisabled } = this.props;\n\n    if (isDisabled) {\n      return;\n    }\n\n    onClick();\n  }\n\n  render() {\n    const {\n      iconName,\n      subIconName,\n      isDisabled,\n      shouldRotateSubIcon,\n      letter,\n      additionalClassName,\n      style,\n      tooltip,\n      shouldSpinSubIcon,\n      onRef,\n    } = this.props;\n\n    const className = classNames(\n      'btn',\n      'btn--circle',\n      'action-drawer__btn',\n      additionalClassName || '',\n      {\n        fas: !letter,\n        'fa-lg': !letter,\n        [`fa-${iconName}`]: !letter,\n        'action-drawer__btn--with-sub-icon': !!subIconName,\n        'btn--disabled': isDisabled,\n        'action-drawer__btn--letter': !!letter,\n      }\n    );\n\n    const subIconClassName = classNames(\n      'fas',\n      'fa-xs',\n      `fa-${subIconName}`,\n      'action-drawer__btn__sub-icon',\n      {\n        'action-drawer__btn__sub-icon--rotated': shouldRotateSubIcon,\n        'fa-spin': shouldSpinSubIcon,\n      }\n    );\n\n    return (\n      <button\n        className={className}\n        onClick={this.handleClick}\n        style={style}\n        title={tooltip}\n        ref={onRef}\n      >\n        {!!letter && letter}\n        {!!subIconName && <i className={subIconClassName} />}\n      </button>\n    );\n  }\n}\n","import React, { Fragment, useState, useEffect, useMemo, useRef } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Motion, spring } from 'react-motion';\n\nimport './stylesheet.css';\n\nimport { List } from 'immutable';\n\nimport * as orgActions from '../../../../actions/org';\nimport * as captureActions from '../../../../actions/capture';\nimport * as baseActions from '../../../../actions/base';\n\nimport sampleCaptureTemplates from '../../../../lib/sample_capture_templates';\n\nimport ActionButton from './components/ActionButton/';\n\nconst ActionDrawer = ({\n  org,\n  selectedHeaderId,\n  base,\n  staticFile,\n  captureTemplates,\n  path,\n  selectedTableCellId,\n  inEditMode,\n  isLoading,\n  shouldDisableSyncButtons,\n}) => {\n  const [isDisplayingArrowButtons, setIsDisplayingArrowButtons] = useState(false);\n  const [isDisplayingCaptureButtons, setIsDisplayingCaptureButtons] = useState(false);\n  const [isDisplayingSearchButtons, setIsDisplayingSearchButtons] = useState(false);\n\n  useEffect(() => {\n    document.querySelector('html').style.paddingBottom = '90px';\n\n    return () => (document.querySelector('html').style.paddingBottom = '0px');\n  });\n\n  const mainArrowButton = useRef(null);\n\n  const mainArrowButtonBoundingRect = useMemo(\n    () => (!!mainArrowButton.current ? mainArrowButton.current.getBoundingClientRect() : null),\n    [mainArrowButton]\n  );\n\n  const handleUpClick = () =>\n    !!selectedHeaderId ? org.moveHeaderUp(selectedHeaderId) : org.moveTableRowUp();\n\n  const handleDownClick = () =>\n    !!selectedHeaderId ? org.moveHeaderDown(selectedHeaderId) : org.moveTableRowDown();\n\n  const handleLeftClick = () =>\n    !!selectedHeaderId ? org.moveHeaderLeft(selectedHeaderId) : org.moveTableColumnLeft();\n\n  const handleRightClick = () =>\n    !!selectedHeaderId ? org.moveHeaderRight(selectedHeaderId) : org.moveTableColumnRight();\n\n  const handleMoveSubtreeLeftClick = () => org.moveSubtreeLeft(selectedHeaderId);\n\n  const handleMoveSubtreeRightClick = () => org.moveSubtreeRight(selectedHeaderId);\n\n  const handleDoneClick = () => org.exitEditMode();\n\n  const handleCaptureButtonClick = templateId => () => {\n    setIsDisplayingCaptureButtons(false);\n    base.activatePopup('capture', { templateId });\n  };\n\n  const getSampleCaptureTemplates = () => sampleCaptureTemplates;\n\n  const getAvailableCaptureTemplates = () =>\n    staticFile === 'sample'\n      ? getSampleCaptureTemplates()\n      : captureTemplates.filter(\n          template =>\n            template.get('isAvailableInAllOrgFiles') ||\n            template\n              .get('orgFilesWhereAvailable')\n              .map(availablePath =>\n                availablePath.trim().startsWith('/')\n                  ? availablePath.trim()\n                  : '/' + availablePath.trim()\n              )\n              .includes((path || '').trim())\n        );\n\n  const handleSync = () => org.sync();\n\n  const handleMainArrowButtonClick = () => setIsDisplayingArrowButtons(!isDisplayingArrowButtons);\n\n  const handleMainSearchButtonClick = () => {\n    setIsDisplayingSearchButtons(!isDisplayingSearchButtons);\n  };\n\n  const handleMainCaptureButtonClick = () => {\n    if (!isDisplayingCaptureButtons && getAvailableCaptureTemplates().size === 0) {\n      alert(\n        `You don't have any capture templates set up for this file! Add some in Settings > Capture Templates`\n      );\n      return;\n    }\n\n    setIsDisplayingCaptureButtons(!isDisplayingCaptureButtons);\n  };\n\n  const renderCaptureButtons = () => {\n    const availableCaptureTemplates = getAvailableCaptureTemplates();\n\n    const baseCaptureButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons || isDisplayingSearchButtons ? 0 : 1,\n    };\n    if (!isDisplayingCaptureButtons) {\n      baseCaptureButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons || isDisplayingSearchButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingCaptureButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {style => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingCaptureButtons ? 'times' : 'plus'}\n              isDisabled={false}\n              onClick={handleMainCaptureButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingCaptureButtons ? 'Hide capture templates' : 'Show capture templates'\n              }\n            />\n\n            {availableCaptureTemplates.map((template, index) => (\n              <ActionButton\n                key={template.get('id')}\n                letter={template.get('letter')}\n                iconName={template.get('iconName')}\n                isDisabled={false}\n                onClick={handleCaptureButtonClick(template.get('id'))}\n                style={{ ...baseCaptureButtonStyle, bottom: style.bottom * (index + 1) }}\n                tooltip={`Activate \"${template.get('description')}\" capture template`}\n              />\n            ))}\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderSearchButtons = () => {\n    const baseSearchButtonStyle = {\n      position: 'absolute',\n      zIndex: 0,\n      left: 0,\n      opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n    };\n    if (!isDisplayingSearchButtons) {\n      baseSearchButtonStyle.boxShadow = 'none';\n    }\n\n    const mainButtonStyle = {\n      opacity: isDisplayingArrowButtons || isDisplayingCaptureButtons ? 0 : 1,\n      position: 'relative',\n      zIndex: 1,\n    };\n\n    const animatedStyle = {\n      bottom: spring(isDisplayingSearchButtons ? 70 : 0, { stiffness: 300 }),\n    };\n\n    return (\n      <Motion style={animatedStyle}>\n        {style => (\n          <div className=\"action-drawer__capture-buttons-container\">\n            <ActionButton\n              iconName={isDisplayingSearchButtons ? 'times' : 'search'}\n              isDisabled={false}\n              onClick={handleMainSearchButtonClick}\n              style={mainButtonStyle}\n              tooltip={\n                isDisplayingSearchButtons ? 'Hide Search / Task List' : 'Show Search / Task List'\n              }\n            />\n\n            <ActionButton\n              iconName=\"search\"\n              isDisabled={false}\n              onClick={handleSearchClick}\n              style={{ ...baseSearchButtonStyle, bottom: style.bottom * 1 }}\n              tooltip=\"Show search\"\n            />\n\n            <ActionButton\n              iconName=\"tasks\"\n              isDisabled={false}\n              onClick={handleTaskListClick}\n              style={{ ...baseSearchButtonStyle, bottom: style.bottom * 2 }}\n              tooltip=\"Show task list\"\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const renderMovementButtons = () => {\n    const baseArrowButtonStyle = {\n      opacity: isDisplayingCaptureButtons || isDisplayingSearchButtons ? 0 : 1,\n    };\n    if (!isDisplayingArrowButtons) {\n      baseArrowButtonStyle.boxShadow = 'none';\n    }\n\n    let centerXOffset = 0;\n    if (!!mainArrowButtonBoundingRect) {\n      centerXOffset =\n        window.screen.width / 2 -\n        (mainArrowButtonBoundingRect.x + mainArrowButtonBoundingRect.width / 2);\n    }\n\n    const animatedStyles = {\n      centerXOffset: spring(isDisplayingArrowButtons ? centerXOffset : 0, { stiffness: 300 }),\n      topRowYOffset: spring(isDisplayingArrowButtons ? 150 : 0, { stiffness: 300 }),\n      bottomRowYOffset: spring(isDisplayingArrowButtons ? 80 : 0, { stiffness: 300 }),\n      firstColumnXOffset: spring(isDisplayingArrowButtons ? 70 : 0, {\n        stiffness: 300,\n      }),\n      secondColumnXOffset: spring(isDisplayingArrowButtons ? 140 : 0, {\n        stiffness: 300,\n      }),\n    };\n\n    return (\n      <Motion style={animatedStyles}>\n        {style => (\n          <div\n            className=\"action-drawer__arrow-buttons-container\"\n            style={{ left: style.centerXOffset }}\n          >\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-up\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleUpClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.topRowYOffset }}\n              tooltip={!!selectedTableCellId ? 'Move row up' : 'Move header up'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-down\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleDownClick}\n              style={{ ...baseArrowButtonStyle, bottom: style.bottomRowYOffset }}\n              tooltip={!!selectedTableCellId ? 'Move row down' : 'Move header down'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-left\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleLeftClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                right: style.firstColumnXOffset,\n              }}\n              tooltip={!!selectedTableCellId ? 'Move column left' : 'Move header left'}\n            />\n            <ActionButton\n              additionalClassName=\"action-drawer__arrow-button\"\n              iconName=\"arrow-right\"\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              isDisabled={false}\n              onClick={handleRightClick}\n              style={{\n                ...baseArrowButtonStyle,\n                bottom: style.bottomRowYOffset,\n                left: style.firstColumnXOffset,\n              }}\n              tooltip={!!selectedTableCellId ? 'Move column right' : 'Move header right'}\n            />\n            {!selectedTableCellId && (\n              <Fragment>\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-left\"\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeLeftClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    right: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree left\"\n                />\n                <ActionButton\n                  additionalClassName=\"action-drawer__arrow-button\"\n                  iconName=\"chevron-right\"\n                  isDisabled={false}\n                  onClick={handleMoveSubtreeRightClick}\n                  style={{\n                    ...baseArrowButtonStyle,\n                    bottom: style.bottomRowYOffset,\n                    left: style.secondColumnXOffset,\n                  }}\n                  tooltip=\"Move entire subtree right\"\n                />\n              </Fragment>\n            )}\n\n            <ActionButton\n              iconName={isDisplayingArrowButtons ? 'times' : 'arrows-alt'}\n              subIconName={!!selectedTableCellId ? 'table' : null}\n              additionalClassName=\"action-drawer__main-arrow-button\"\n              isDisabled={false}\n              onClick={handleMainArrowButtonClick}\n              style={{ opacity: isDisplayingCaptureButtons || isDisplayingSearchButtons ? 0 : 1 }}\n              tooltip={isDisplayingArrowButtons ? 'Hide movement buttons' : 'Show movement buttons'}\n              onRef={mainArrowButton}\n            />\n          </div>\n        )}\n      </Motion>\n    );\n  };\n\n  const handleAgendaClick = () => base.activatePopup('agenda');\n  const handleTaskListClick = () => {\n    setIsDisplayingSearchButtons(false);\n    base.activatePopup('task-list');\n  };\n  const handleSearchClick = () => {\n    setIsDisplayingSearchButtons(false);\n    base.activatePopup('search');\n  };\n\n  return (\n    <div className=\"action-drawer-container nice-scroll\">\n      {inEditMode ? (\n        <button className=\"btn action-drawer__done-btn\" onClick={handleDoneClick}>\n          Done\n        </button>\n      ) : (\n        <Fragment>\n          <ActionButton\n            iconName=\"cloud\"\n            subIconName=\"sync-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={shouldDisableSyncButtons}\n            onClick={handleSync}\n            style={{\n              opacity:\n                isDisplayingArrowButtons || isDisplayingCaptureButtons || isDisplayingSearchButtons\n                  ? 0\n                  : 1,\n            }}\n            tooltip=\"Sync changes\"\n          />\n\n          <ActionButton\n            iconName=\"calendar-alt\"\n            shouldSpinSubIcon={isLoading}\n            isDisabled={false}\n            onClick={handleAgendaClick}\n            style={{\n              opacity:\n                isDisplayingArrowButtons || isDisplayingCaptureButtons || isDisplayingSearchButtons\n                  ? 0\n                  : 1,\n            }}\n            tooltip=\"Show agenda\"\n          />\n\n          {renderMovementButtons()}\n\n          {renderSearchButtons()}\n          {renderCaptureButtons()}\n        </Fragment>\n      )}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    inEditMode: !!state.org.present.get('editMode'),\n    selectedHeaderId: state.org.present.get('selectedHeaderId'),\n    isDirty: state.org.present.get('isDirty'),\n    isFocusedHeaderActive: !!state.org.present.get('focusedHeaderId'),\n    selectedTableCellId: state.org.present.get('selectedTableCellId'),\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    path: state.org.present.get('path'),\n    isLoading: state.base.get('isLoading'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    org: bindActionCreators(orgActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ActionDrawer);\n","import Bowser from 'bowser';\n\nconst browser = Bowser.getParser(window.navigator.userAgent);\n\n/** Is the browser Mobile Safari with iOS version of at least 13, but\nless than 13.3 */\nexport const isMobileSafari13 = (() => {\n  return (\n    browser.satisfies({\n      mobile: {\n        safari: '>=13',\n      },\n    }) &&\n    browser.satisfies({\n      mobile: {\n        safari: '<13.0.4',\n      },\n    })\n  );\n})();\n\n/** Is the OS iOS or Android? */\nexport const isMobileBrowser = (() => {\n  return browser.satisfies({\n    mobile: {\n      safari: '>=6',\n      'android browser': '>3',\n    },\n  });\n})();\n\n/** Is iPhone Model X (tested with Xs) */\nexport const isIphoneX = window.matchMedia\n  ? window.matchMedia('(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)').matches\n  : false;\n\n/** Is iPhone Model 6, 7 or 8 (tested with 6s) */\nexport const isIphone678 = window.matchMedia\n  ? window.matchMedia('(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)').matches\n  : false;\n\n/** Is running in standalone mode (not in Mobile Safari) */\nexport const isRunningAsPWA = 'standalone' in window.navigator && window.navigator.standalone;\n\n/** Is running in Landscape Mode (as opposed to Portait Mode) */\nexport function isInLandscapeMode() {\n  return [90, -90].includes(window.orientation);\n}\n","import React from 'react';\nimport { Motion, spring } from 'react-motion';\n\nimport { interpolateColors, rgbaObject, rgbaString } from '../../../lib/color';\n\nimport './stylesheet.css';\n\nexport default ({ isEnabled, onToggle }) => {\n  const disabledColor = rgbaObject(255, 255, 255, 1);\n  const enabledColor = rgbaObject(238, 232, 213, 1);\n\n  const switchStyle = {\n    colorFactor: spring(isEnabled ? 1 : 0, { stiffness: 300 }),\n  };\n\n  const grabberStyle = {\n    marginLeft: spring(isEnabled ? 42 : 0, { stiffness: 300 }),\n  };\n\n  return (\n    <Motion style={switchStyle}>\n      {style => {\n        const backgroundColor = rgbaString(\n          interpolateColors(disabledColor, enabledColor, style.colorFactor)\n        );\n\n        return (\n          <div className=\"switch\" style={{ backgroundColor }} onClick={onToggle}>\n            <Motion style={grabberStyle}>\n              {style => <div className=\"switch__grabber\" style={style} />}\n            </Motion>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { useState, useEffect, useLayoutEffect, useRef } from 'react';\n\nimport './stylesheet.css';\n\nimport { Motion, spring } from 'react-motion';\nimport classNames from 'classnames';\n\nexport default ({ children, shouldIncludeCloseButton, onClose, maxSize = false }) => {\n  const [isVisible, setIsVisible] = useState(false);\n  const [dragOffsetY, setDragOffsetY] = useState(null);\n\n  useLayoutEffect(() => {\n    setIsVisible(true);\n  }, []);\n\n  const initialClientY = useRef();\n  const innerContainer = useRef();\n\n  const innerContainerHeight = useRef();\n  useLayoutEffect(() => {\n    innerContainerHeight.current = innerContainer.current.offsetHeight;\n  });\n\n  const handleInnerContainerClick = event => event.stopPropagation();\n\n  const handleClose = () => setIsVisible(false);\n\n  const handleAnimationRest = () => (!isVisible && !!onClose ? onClose() : void 0);\n\n  const handleTouchStart = event => (initialClientY.current = event.targetTouches[0].clientY);\n\n  const handleTouchMove = event => {\n    if (event.target.classList.contains('drag-handle')) {\n      return;\n    }\n\n    const isScrollingDown = initialClientY.current > event.targetTouches[0].clientY;\n\n    if (\n      isScrollingDown &&\n      innerContainer.current.scrollHeight - innerContainer.current.scrollTop <=\n        innerContainer.current.clientHeight\n    ) {\n      event.preventDefault();\n    } else if (!isScrollingDown && innerContainer.current.scrollTop === 0) {\n      event.preventDefault();\n\n      setDragOffsetY(event.targetTouches[0].clientY - initialClientY.current);\n    }\n  };\n\n  useEffect(() => {\n    const endInnerContainerDrag = () => {\n      setIsVisible(dragOffsetY <= innerContainerHeight.current * 0.3);\n      setDragOffsetY(null);\n    };\n    const handleTouchEndOrCancel = event => endInnerContainerDrag();\n\n    if (!!innerContainer.current) {\n      // Super annoying logic for disabling scrolling of the body when a slide up is active.\n      // Briefly: if we're already at the top of our Drawer and trying to scroll up, disable\n      // scrolling. Likewise, if we're already at the bottom of our Drawer and trying to scroll\n      // down, disable scrolling.\n      innerContainer.current.addEventListener('touchstart', handleTouchStart);\n      innerContainer.current.addEventListener('touchmove', handleTouchMove);\n      innerContainer.current.addEventListener('touchend', handleTouchEndOrCancel);\n      innerContainer.current.addEventListener('touchcancel', handleTouchEndOrCancel);\n\n      // Tmp variable for cleanup. Otherwise the linter will complain\n      // that the `current` value will change. It suggested this tmp\n      // variable.\n      const innerContainerCurrent = innerContainer.current;\n\n      return () => {\n        innerContainerCurrent.removeEventListener('touchstart', handleTouchStart);\n        innerContainerCurrent.removeEventListener('touchmove', handleTouchMove);\n        innerContainerCurrent.removeEventListener('touchend', handleTouchEndOrCancel);\n        innerContainerCurrent.removeEventListener('touchcancel', handleTouchEndOrCancel);\n      };\n    } else {\n      return null;\n    }\n  }, [innerContainer, dragOffsetY]);\n\n  const outerClassName = classNames('drawer-outer-container', {\n    'drawer-outer-container--visible': isVisible,\n  });\n\n  const innerStyle = {\n    offsetY:\n      dragOffsetY ||\n      spring(isVisible ? 0 : innerContainerHeight.current || window.innerHeight, {\n        stiffness: 300,\n      }),\n  };\n\n  return (\n    <Motion style={innerStyle} onRest={handleAnimationRest}>\n      {style => {\n        const interpolatedStyle = {\n          transform: `translateY(${style.offsetY}px)`,\n        };\n\n        // For maximized drawers, there's different rules:\n        if (maxSize) {\n          interpolatedStyle.height = '92%';\n          interpolatedStyle.overflow = 'none';\n        }\n\n        return (\n          <div className={outerClassName} onClick={!!onClose ? handleClose : null}>\n            <div\n              onClick={handleInnerContainerClick}\n              className=\"drawer-inner-container nice-scroll\"\n              data-testid=\"drawer\"\n              ref={innerContainer}\n              style={interpolatedStyle}\n            >\n              <div className=\"drawer__grabber\" />\n\n              {shouldIncludeCloseButton && (\n                <button className=\"fas fa-times fa-lg drawer__close-button\" onClick={handleClose} />\n              )}\n\n              {children}\n            </div>\n          </div>\n        );\n      }}\n    </Motion>\n  );\n};\n","import React, { Fragment, useState, useEffect, useRef, useMemo } from 'react';\nimport {\n  isMobileSafari13,\n  isRunningAsPWA,\n  isInLandscapeMode,\n  isIphoneX,\n  isIphone678,\n} from '../../../../lib/browser_utils';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../ActionDrawer/components/ActionButton/';\nimport Switch from '../../../UI/Switch/';\nimport Drawer from '../../../UI/Drawer/';\n\nimport { headerWithPath } from '../../../../lib/org_utils';\nimport substituteTemplateVariables from '../../../../lib/capture_template_substitution';\n\nexport default ({ template, onCapture, headers, onClose }) => {\n  const [substitutedTemplate, initialCursorIndex] = useMemo(\n    () => substituteTemplateVariables(template.get('template')),\n    [template]\n  );\n\n  const targetHeader = useMemo(() => headerWithPath(headers, template.get('headerPaths')), [\n    headers,\n    template,\n  ]);\n\n  const [textareaValue, setTextareaValue] = useState(substitutedTemplate);\n  const [shouldPrepend, setShouldPrepend] = useState(template.get('shouldPrepend'));\n\n  /** INFO: Some versions of Mobile Safari do _not_ like it when the\n  focus is set without an explicit user interaction. This is the case\n  in organice, because the user interaction is on a button which in\n  turn opens a textarea which should have the focus. It will open the\n  software keyboard, but the capture template will stay on the bottom\n  of the view, so it will be hidden by the keyboard. The user would\n  have to manually scroll down. On iOS 12, it worked without this\n  workaround. Starting with iOS 13.3, the workaround isn't needed,\n  anymore. */\n  const getMinHeight = () => {\n    // Only Mobile Safari needs the shenannigans for moving the input\n    // above the software keyboard.\n    if (isMobileSafari13) {\n      if (isRunningAsPWA) {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '23em';\n          } else if (isIphone678) {\n            return '19em';\n          }\n          // For unmeasured models, it's safest to stick with the\n          // default iOS behavior - even if the keyboard hides the\n          // input field it's better than if it's moved too far up.\n          else {\n            return 'auto';\n          }\n        }\n      }\n      // Portrait mode\n      else {\n        if (isInLandscapeMode()) {\n          return '9em';\n        } else {\n          if (isIphoneX) {\n            return '18em';\n          } else if (isIphone678) {\n            return '18em';\n          } else {\n            return 'auto';\n          }\n        }\n      }\n    } else {\n      return 'auto';\n    }\n  };\n\n  const textarea = useRef(null);\n\n  useEffect(() => {\n    if (textarea.current) {\n      textarea.current.focus();\n      // Set Cursor position to the %? part of the template.\n      textarea.current.setSelectionRange(initialCursorIndex, initialCursorIndex);\n    }\n  }, [textarea, initialCursorIndex]);\n\n  const handleCaptureClick = () => onCapture(template.get('id'), textareaValue, shouldPrepend);\n\n  const handleTextareaChange = event => setTextareaValue(event.target.value);\n\n  const handlePrependSwitchToggle = () => setShouldPrepend(!shouldPrepend);\n\n  return (\n    <Drawer onClose={onClose}>\n      <div className=\"capture-modal-header\">\n        <ActionButton\n          letter={template.get('letter')}\n          iconName={template.get('iconName')}\n          isDisabled={false}\n          onClick={() => {}}\n          style={{ marginRight: 20 }}\n        />\n\n        <span>{template.get('description')}</span>\n      </div>\n\n      <div className=\"capture-modal-header-path\">{template.get('headerPaths').join(' > ')}</div>\n\n      {targetHeader ? (\n        <Fragment>\n          <textarea\n            className=\"textarea capture-modal-textarea\"\n            rows=\"4\"\n            value={textareaValue}\n            onChange={handleTextareaChange}\n            autoFocus={true}\n            ref={textarea}\n          />\n          <div className=\"capture-modal-button-container\">\n            <div className=\"capture-modal-prepend-container\">\n              <span className=\"capture-modal-prepend-label\">Prepend:</span>\n              <Switch isEnabled={shouldPrepend} onToggle={handlePrependSwitchToggle} />\n            </div>\n\n            <button className=\"btn capture-modal-button\" onClick={handleCaptureClick}>\n              Capture\n            </button>\n          </div>\n          {/* Add padding to move the above textarea above the fold.\n          More documentation, see getMinHeight(). */}\n          {isMobileSafari13 && <div style={{ minHeight: getMinHeight() }} />}\n        </Fragment>\n      ) : (\n        <div className=\"capture-modal-error-message\">\n          The specified header path doesn't exist in this org file!\n        </div>\n      )}\n\n      <br />\n    </Drawer>\n  );\n};\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport { customFormatDistanceToNow } from '../../../../lib/org_utils';\nimport format from 'date-fns/format';\n\nexport default ({ lastServerModifiedAt, onPull, onPush, onCancel }) => {\n  return (\n    <Drawer>\n      <h2 className=\"sync-confirmation-modal__header\">Sync conflict</h2>\n      Since you last pulled, a newer version of the file has been pushed to the server. The newer\n      version is from:\n      <br />\n      <br />\n      <div className=\"sync-confirmation-modal__last-sync-time\">\n        {format(lastServerModifiedAt, 'MMMM do, yyyy [at] h:mm:ss a')}\n        <br />({customFormatDistanceToNow(lastServerModifiedAt)})\n      </div>\n      <div className=\"sync-confirmation-modal__buttons-container\">\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPull}>\n          Pull latest version from server\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onPush}>\n          Overwrite server version\n        </button>\n        <button className=\"btn sync-confirmation-modal__button\" onClick={onCancel}>\n          Cancel sync\n        </button>\n      </div>\n      <br />\n    </Drawer>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class TagsEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRemoveTag', 'handleAddNewTag', 'handleTagChange']);\n\n    this.state = {\n      allTags: props.allTags,\n    };\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevTags = prevProps.header.getIn(['titleLine', 'tags']);\n    const currentTags = this.props.header.getIn(['titleLine', 'tags']);\n    if (prevTags.size === currentTags.size - 1 && currentTags.last() === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handleTagChange(tagIndex) {\n    return event => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.set(tagIndex, event.target.value.replace(/(\\s+|:)/g, '')));\n    };\n  }\n\n  handleRemoveTag(tagIndex) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      this.props.onChange(tags.delete(tagIndex));\n    };\n  }\n\n  handleAddNewTag() {\n    const tags = this.props.header.getIn(['titleLine', 'tags']);\n    this.props.onChange(tags.push(''));\n  }\n\n  handleExistingTagClick(newTag) {\n    return () => {\n      const tags = this.props.header.getIn(['titleLine', 'tags']);\n      if (tags.includes(newTag)) {\n        this.props.onChange(tags.filter(tag => tag !== newTag));\n      } else {\n        this.props.onChange(tags.push(newTag));\n      }\n    };\n  }\n\n  render() {\n    const { header, onClose } = this.props;\n    const { allTags } = this.state;\n\n    const headerTags = header.getIn(['titleLine', 'tags']);\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit tags</h2>\n\n        <datalist id=\"drawer-modal__datalist-tag-names\">\n          {allTags.map((tagName, idx) => (\n            <option key={idx} value={tagName} />\n          ))}\n        </datalist>\n\n        {headerTags.size === 0 ? (\n          <div className=\"no-tags-message\">\n            This header doesn't have any tags.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one, or choose from the list\n            of all of your tags below.\n          </div>\n        ) : (\n          <Droppable droppableId=\"tags-editor-droppable\" type=\"TAG\">\n            {(provided, snapshot) => (\n              <div className=\"tags-container\" ref={provided.innerRef} {...provided.droppableProps}>\n                <Fragment>\n                  {headerTags.map((tag, index) => (\n                    <Draggable draggableId={`tag--${index}`} index={index} key={index}>\n                      {(provided, snapshot) => (\n                        <div\n                          className={classNames('tag-container', {\n                            'tag-container--dragging': snapshot.isDragging,\n                          })}\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          <input\n                            type=\"text\"\n                            className=\"textfield tag-container__textfield\"\n                            value={tag}\n                            onChange={this.handleTagChange(index)}\n                            ref={textfield => (this.lastTextfield = textfield)}\n                            list=\"drawer-modal__datalist-tag-names\"\n                          />\n                          <div className=\"tag-container__actions-container\">\n                            <i\n                              className=\"fas fa-times fa-lg\"\n                              onClick={this.handleRemoveTag(index)}\n                            />\n                            <i\n                              className=\"fas fa-bars fa-lg tag-container__drag-handle drag-handle\"\n                              {...provided.dragHandleProps}\n                            />\n                          </div>\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"tags-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewTag} />\n        </div>\n\n        <hr className=\"tags-editor__separator\" />\n\n        <h2 className=\"tags-editor__title\">All tags</h2>\n\n        <div className=\"all-tags-container\">\n          {allTags\n            .filter(tag => !!tag)\n            .map(tag => {\n              const className = classNames('all-tags__tag', {\n                'all-tags__tag--in-use': headerTags.includes(tag),\n              });\n\n              return (\n                <div className={className} key={tag} onClick={this.handleExistingTagClick(tag)}>\n                  {tag}\n                </div>\n              );\n            })}\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React from 'react';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\n\nexport default ({ buttons, selectedButton, useEqualWidthTabs, onSelect }) => {\n  const handleButtonClick = buttonName => () => onSelect(buttonName);\n\n  const containerClassName = classNames('tab-buttons', {\n    'tab-buttons--equal-width-tabs': useEqualWidthTabs,\n  });\n\n  const style = {\n    gridTemplateColumns: useEqualWidthTabs ? `repeat(${buttons.length}, 1fr)` : null,\n  };\n\n  return (\n    <div className={containerClassName} style={style}>\n      {buttons.map(buttonName => {\n        const className = classNames('tab-buttons__btn', {\n          'tab-buttons__btn--selected': buttonName === selectedButton,\n        });\n\n        return (\n          <div key={buttonName} className={className} onClick={handleButtonClick(buttonName)}>\n            {buttonName}\n          </div>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport Switch from '../../../../../UI/Switch/';\nimport TabButtons from '../../../../../UI/TabButtons/';\n\nimport * as orgActions from '../../../../../../actions/org';\n\nimport { renderAsText } from '../../../../../../lib/timestamps';\n\nimport _ from 'lodash';\nimport { parseISO } from 'date-fns';\nimport format from 'date-fns/format';\n\nclass TimestampEditor extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleActiveToggle',\n      'handleDateChange',\n      'handleAddRepeater',\n      'handleRemoveRepeater',\n      'handleRepeaterTypeChange',\n      'handleRepeaterValueChange',\n      'handleRepeaterUnitChange',\n      'handleAddDelay',\n      'handleRemoveDelay',\n      'handleDelayTypeChange',\n      'handleDelayValueChange',\n      'handleDelayUnitChange',\n    ]);\n  }\n\n  handleActiveToggle() {\n    this.props.onChange(this.props.timestamp.update('isActive', isActive => !isActive));\n  }\n\n  handleDateChange(event, planningItemIndex) {\n    // The user deleted the timestamp\n    if (_.isEmpty(event.target.value)) {\n      // It's a planning item and the parser knows which one.\n      // TODO: Also delete timestamps which are not planningItems\n      if (_.isNumber(planningItemIndex)) {\n        this.props.org.removePlanningItem(this.props.selectedHeaderId, planningItemIndex);\n      }\n      this.props.onClose();\n    } else {\n      const { onChange, timestamp } = this.props;\n\n      const [newYear, newMonth, newDay, newDayName] = format(\n        parseISO(event.target.value),\n        'yyyy MM dd eee'\n      ).split(' ');\n      onChange(\n        timestamp\n          .set('year', newYear)\n          .set('month', newMonth)\n          .set('day', newDay)\n          .set('dayName', newDayName)\n      );\n    }\n  }\n\n  handleAddTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      const [hour, minute] = format(new Date(), 'HH:mm').split(':');\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleRemoveTime(startOrEnd) {\n    return () => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      onChange(timestamp.set(hourKey, null).set(minuteKey, null));\n    };\n  }\n\n  handleTimeChange(startOrEnd) {\n    return event => {\n      const { onChange, timestamp } = this.props;\n\n      const [hourKey, minuteKey] =\n        startOrEnd === 'start' ? ['startHour', 'startMinute'] : ['endHour', 'endMinute'];\n      let [hour, minute] = event.target.value.split(':');\n      hour = hour.startsWith('0') ? hour.substring(1) : hour;\n      onChange(timestamp.set(hourKey, hour).set(minuteKey, minute));\n    };\n  }\n\n  handleAddRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp\n        .set('repeaterType', '+')\n        .set('repeaterValue', 1)\n        .set('repeaterUnit', 'h')\n    );\n  }\n\n  handleRemoveRepeater() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp\n        .set('repeaterType', null)\n        .set('repeaterValue', null)\n        .set('repeaterUnit', null)\n    );\n  }\n\n  handleRepeaterTypeChange(newRepeaterType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterType', newRepeaterType));\n  }\n\n  handleRepeaterValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterValue', event.target.value));\n  }\n\n  handleRepeaterUnitChange(newRepeaterUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('repeaterUnit', newRepeaterUnit));\n  }\n\n  handleAddDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp\n        .set('delayType', '-')\n        .set('delayValue', 1)\n        .set('delayUnit', 'h')\n    );\n  }\n\n  handleRemoveDelay() {\n    const { onChange, timestamp } = this.props;\n    onChange(\n      timestamp\n        .set('delayType', null)\n        .set('delayValue', null)\n        .set('delayUnit', null)\n    );\n  }\n\n  handleDelayTypeChange(newDelayType) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayType', newDelayType));\n  }\n\n  handleDelayValueChange(event) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayValue', event.target.value));\n  }\n\n  handleDelayUnitChange(newDelayUnit) {\n    const { onChange, timestamp } = this.props;\n    onChange(timestamp.set('delayUnit', newDelayUnit));\n  }\n\n  renderTimeField(label, timeKey, hour, minute, showRemoveButton = true) {\n    return (\n      <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n        <div className=\"timestamp-editor__field-title\">{label}</div>\n        <div className=\"timestamp-editor__field\">\n          {!!hour ? (\n            <Fragment>\n              <input\n                type=\"time\"\n                className=\"timestamp-editor__time-input\"\n                value={`${hour.padStart(2, '0')}:${minute.padStart(2, '0')}`}\n                onChange={this.handleTimeChange(timeKey)}\n              />\n              {showRemoveButton && (\n                <i\n                  className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                  onClick={this.handleRemoveTime(timeKey)}\n                />\n              )}\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddTime(timeKey)}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderRepeater() {\n    const { repeaterType, repeaterValue, repeaterUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Repeater</div>\n        <div className=\"timestamp-editor__field timestamp-editor__field--delay-repeater\">\n          {!!repeaterType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['+', '++', '.+']}\n                  selectedButton={repeaterType || '+'}\n                  onSelect={this.handleRepeaterTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={repeaterValue || 1}\n                onChange={this.handleRepeaterValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={repeaterUnit || 'h'}\n                  onSelect={this.handleRepeaterUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveRepeater}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddRepeater}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  renderDelay() {\n    const { delayType, delayValue, delayUnit } = this.props.timestamp.toJS();\n\n    return (\n      <div className=\"timestamp-editor__field-container\">\n        <div className=\"timestamp-editor__field-title\">Delay</div>\n        <div className=\"timestamp-editor__field\">\n          {!!delayType ? (\n            <Fragment>\n              <div className=\"timestamp-editor__delay-repeater-type\">\n                <TabButtons\n                  buttons={['-', '--']}\n                  selectedButton={delayType || '-'}\n                  onSelect={this.handleDelayTypeChange}\n                />\n              </div>\n              <input\n                type=\"number\"\n                min=\"1\"\n                className=\"textfield delay-repeater-value-input\"\n                value={delayValue || 1}\n                onChange={this.handleDelayValueChange}\n              />\n              <div>\n                <TabButtons\n                  buttons={'hdwmy'.split('')}\n                  selectedButton={delayUnit || 'h'}\n                  onSelect={this.handleDelayUnitChange}\n                />\n              </div>\n              <i\n                className=\"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove\"\n                onClick={this.handleRemoveDelay}\n              />\n            </Fragment>\n          ) : (\n            <i\n              className=\"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add\"\n              onClick={this.handleAddDelay}\n            />\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const { timestamp, planningItemIndex } = this.props;\n    const {\n      isActive,\n      year,\n      month,\n      day,\n      startHour,\n      startMinute,\n      endHour,\n      endMinute,\n    } = timestamp.toJS();\n\n    return (\n      <div>\n        <div className=\"timestamp-editor__render\">{renderAsText(timestamp)}</div>\n\n        <div className=\"timestamp-editor__date-time-fields-container\">\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Active</div>\n            <div className=\"timestamp-editor__field\">\n              <Switch isEnabled={isActive} onToggle={this.handleActiveToggle} />\n            </div>\n          </div>\n\n          <div className=\"timestamp-editor__field-container timestamp-editor__field-container--inline\">\n            <div className=\"timestamp-editor__field-title\">Date</div>\n            <div className=\"timestamp-editor__field\">\n              <input\n                data-testid=\"timestamp-selector\"\n                type=\"date\"\n                className=\"timestamp-editor__date-input\"\n                onChange={event => this.handleDateChange(event, planningItemIndex)}\n                // Needed for iOS due to React bug\n                // https://github.com/facebook/react/issues/8938#issuecomment-519074141\n                onFocus={event => (event.nativeEvent.target.defaultValue = '')}\n                value={`${year}-${month}-${day}`}\n              />\n            </div>\n          </div>\n\n          {this.renderTimeField('Start time', 'start', startHour, startMinute, !endHour)}\n          {!!startHour && this.renderTimeField('End time', 'end', endHour, endMinute)}\n        </div>\n\n        {this.renderRepeater()}\n        {this.renderDelay()}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  const selectedHeaderId = state.org.present.get('selectedHeaderId');\n  return {\n    selectedHeaderId,\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TimestampEditor);\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TimestampEditor from './components/TimestampEditor';\nimport Drawer from '../../../UI/Drawer/';\n\nimport _ from 'lodash';\nimport format from 'date-fns/format';\nimport { Map } from 'immutable';\n\nexport default class TimestampEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddEndTimestamp', 'handleRemoveEndTimestamp']);\n  }\n\n  handleChange(key) {\n    return newTimestamp => this.props.onChange(this.props.timestamp.set(key, newTimestamp));\n  }\n\n  handleAddEndTimestamp() {\n    const { timestamp } = this.props;\n    const [year, month, day, dayName] = format(new Date(), 'yyyy MM dd eee').split(' ');\n    this.props.onChange(\n      timestamp.set(\n        'secondTimestamp',\n        Map({\n          year,\n          month,\n          day,\n          dayName,\n          isActive: timestamp.getIn(['firstTimestamp', 'isActive']),\n        })\n      )\n    );\n  }\n\n  handleRemoveEndTimestamp() {\n    this.props.onChange(this.props.timestamp.set('secondTimestamp', null));\n  }\n\n  render() {\n    const { timestamp, onClose, singleTimestampOnly, planningItemIndex } = this.props;\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"timestamp-editor__title\">Edit timestamp</h2>\n\n        <TimestampEditor\n          timestamp={timestamp.get('firstTimestamp')}\n          planningItemIndex={planningItemIndex}\n          onClose={onClose}\n          onChange={this.handleChange('firstTimestamp')}\n        />\n\n        {!singleTimestampOnly &&\n          (!!timestamp.get('secondTimestamp') ? (\n            <Fragment>\n              <div className=\"timestamp-editor__separator\">\n                <div className=\"timestamp-editor__separator__margin-line\" />\n                to\n                <div className=\"timestamp-editor__separator__margin-line\" />\n              </div>\n\n              <TimestampEditor\n                timestamp={timestamp.get('secondTimestamp')}\n                onChange={this.handleChange('secondTimestamp')}\n              />\n\n              <div className=\"timestamp-editor__button-container\">\n                <button\n                  className=\"btn timestamp-editor__add-new-button\"\n                  onClick={this.handleRemoveEndTimestamp}\n                >\n                  Remove end timestamp\n                </button>\n              </div>\n            </Fragment>\n          ) : (\n            <div className=\"timestamp-editor__button-container\">\n              <button\n                className=\"btn timestamp-editor__add-new-button\"\n                onClick={this.handleAddEndTimestamp}\n              >\n                Add end timestamp\n              </button>\n            </div>\n          ))}\n\n        <br />\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport Drawer from '../../../UI/Drawer';\n\nimport { attributedStringToRawText } from '../../../../lib/export_org';\nimport generateId from '../../../../lib/id_generator';\nimport { parseMarkupAndCookies } from '../../../../lib/parse_org';\n\nimport { Droppable, Draggable } from 'react-beautiful-dnd';\nimport classNames from 'classnames';\nimport { fromJS } from 'immutable';\nimport _ from 'lodash';\nimport { computeAllPropertyNames, computeAllPropertyValuesFor } from '../../../../lib/org_utils';\n\nexport default class PropertyListEditorModal extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleAddNewItem']);\n  }\n\n  componentDidUpdate(prevProps) {\n    const prevItems = prevProps.propertyListItems;\n    const currentItems = this.props.propertyListItems;\n    if (prevItems.size === currentItems.size - 1 && currentItems.last().get('property') === '') {\n      if (this.lastTextfield) {\n        this.lastTextfield.focus();\n      }\n    }\n  }\n\n  handlePropertyChange(propertyListItemId) {\n    return event => {\n      const propertyListItemIndex = this.props.propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      this.props.onChange(\n        this.props.propertyListItems.setIn([propertyListItemIndex, 'property'], event.target.value)\n      );\n    };\n  }\n\n  handleValueChange(propertyListItemId) {\n    return event => {\n      const { propertyListItems, onChange } = this.props;\n\n      const propertyListItemIndex = propertyListItems.findIndex(\n        propertyListItem => propertyListItem.get('id') === propertyListItemId\n      );\n      onChange(\n        propertyListItems.setIn(\n          [propertyListItemIndex, 'value'],\n          fromJS(parseMarkupAndCookies(event.target.value))\n        )\n      );\n    };\n  }\n\n  handleRemoveItem(propertyListItemId) {\n    return () =>\n      this.props.onChange(\n        this.props.propertyListItems.filter(\n          propertyListItem => propertyListItem.get('id') !== propertyListItemId\n        )\n      );\n  }\n\n  handleAddNewItem() {\n    this.props.onChange(\n      this.props.propertyListItems.push(\n        fromJS({\n          property: '',\n          value: '',\n          id: generateId(),\n        })\n      )\n    );\n  }\n\n  render() {\n    const { onClose, propertyListItems, allOrgProperties } = this.props;\n    const allPropertyNames = computeAllPropertyNames(allOrgProperties);\n\n    const propertyListItemsWithAllPropVals = propertyListItems.map(p => {\n      const propertyName = p.get('property');\n      const allPropertyValues = computeAllPropertyValuesFor(allOrgProperties, propertyName);\n      return [p, allPropertyValues];\n    });\n\n    return (\n      <Drawer onClose={onClose}>\n        <h2 className=\"drawer-modal__title\">Edit property list</h2>\n\n        <datalist id=\"drawer-modal__datalist-property-names\">\n          {allPropertyNames.map((propertyName, idx) => (\n            <option key={idx} value={propertyName} />\n          ))}\n        </datalist>\n\n        {propertyListItems.size === 0 ? (\n          <div className=\"no-items-message\">\n            There are no items in this property list.\n            <br />\n            <br />\n            Click the <i className=\"fas fa-plus\" /> button to add a new one.\n          </div>\n        ) : (\n          <Droppable droppableId=\"property-list-editor-droppable\" type=\"PROPERTY-LIST\">\n            {(provided, snapshot) => (\n              <div\n                className=\"property-list-editor__items-container\"\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n              >\n                <Fragment>\n                  {propertyListItemsWithAllPropVals.map(\n                    ([propertyListItem, allPropertyValues], index) => (\n                      <Draggable\n                        draggableId={`property-list-item--${index}`}\n                        index={index}\n                        key={propertyListItem.get('id')}\n                      >\n                        {(provided, snapshot) => (\n                          <div\n                            className={classNames('property-list-editor__item-container', {\n                              'property-list-editor__item-container--dragging': snapshot.isDragging,\n                            })}\n                            ref={provided.innerRef}\n                            {...provided.draggableProps}\n                          >\n                            <div className=\"item__textfields-container\">\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={propertyListItem.get('property')}\n                                onChange={this.handlePropertyChange(propertyListItem.get('id'))}\n                                ref={textfield => (this.lastTextfield = textfield)}\n                                list=\"drawer-modal__datalist-property-names\"\n                              />\n                              <input\n                                type=\"text\"\n                                className=\"textfield item-container__textfield\"\n                                value={attributedStringToRawText(propertyListItem.get('value'))}\n                                onChange={this.handleValueChange(propertyListItem.get('id'))}\n                                list={`drawer-modal__datalist-property-${index}-values`}\n                              />\n                              <datalist id={`drawer-modal__datalist-property-${index}-values`}>\n                                {allPropertyValues.map((propertyValue, idx) => (\n                                  <option key={idx} value={propertyValue} />\n                                ))}\n                              </datalist>\n                            </div>\n                            <div className=\"item-container__actions-container\">\n                              <i\n                                className=\"fas fa-times fa-lg\"\n                                onClick={this.handleRemoveItem(propertyListItem.get('id'))}\n                              />\n                              <i\n                                className=\"fas fa-bars fa-lg item-container__drag-handle drag-handle\"\n                                {...provided.dragHandleProps}\n                              />\n                            </div>\n                          </div>\n                        )}\n                      </Draggable>\n                    )\n                  )}\n\n                  {provided.placeholder}\n                </Fragment>\n              </div>\n            )}\n          </Droppable>\n        )}\n\n        <div className=\"property-list-editor__add-new-container\">\n          <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={this.handleAddNewItem} />\n        </div>\n      </Drawer>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { isTodoKeywordCompleted, customFormatDistanceToNow } from '../../../../../../lib/org_utils';\nimport {\n  dateForTimestamp,\n  subtractTimestampUnitFromDate,\n  addTimestampUnitToDate,\n} from '../../../../../../lib/timestamps';\n\nimport {\n  format,\n  isToday,\n  startOfDay,\n  endOfDay,\n  isBefore,\n  isAfter,\n  isEqual,\n  isWithinInterval,\n  isPast,\n} from 'date-fns';\nimport classNames from 'classnames';\n\nexport default class AgendaDay extends PureComponent {\n  handleHeaderClick(headerId) {\n    return () => this.props.onHeaderClick(headerId);\n  }\n\n  render() {\n    const {\n      date,\n      headers,\n      todoKeywordSets,\n      dateDisplayType,\n      onToggleDateDisplayType,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n    } = this.props;\n\n    const dateStart = startOfDay(date);\n    const dateEnd = endOfDay(date);\n\n    const planningItemsAndHeaders = this.getPlanningItemsAndHeaders({\n      headers,\n      todoKeywordSets,\n      date,\n      agendaDefaultDeadlineDelayValue,\n      agendaDefaultDeadlineDelayUnit,\n      dateStart,\n      dateEnd,\n    });\n\n    return (\n      <div className=\"agenda-day__container\">\n        <div className=\"agenda-day__title\">\n          {isToday(date) && <div className=\"agenda-day__today-indicator\" />}\n          <div className=\"agenda-day__title__day-name\">{format(date, 'eeee')}</div>\n          <div className=\"agenda-day__title__date\">{format(date, 'MMMM do, yyyy')}</div>\n        </div>\n\n        <div className=\"agenda-day__headers-container\">\n          {planningItemsAndHeaders.map(([planningItem, header]) => {\n            const planningItemDate = dateForTimestamp(planningItem.get('timestamp'));\n            const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n            const dateClassName = classNames('agenda-day__header-planning-date', {\n              'agenda-day__header-planning-date--overdue':\n                hasTodoKeyword && isPast(planningItemDate),\n            });\n\n            return (\n              <div key={planningItem.get('id')} className=\"agenda-day__header-container\">\n                <div className=\"agenda-day__header__planning-item-container\">\n                  <div className=\"agenda-day__header-planning-type\">{planningItem.get('type')}</div>\n                  <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                    {dateDisplayType === 'absolute'\n                      ? format(planningItemDate, 'MM/dd')\n                      : customFormatDistanceToNow(planningItemDate)}\n\n                    {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                      <Fragment>\n                        <br />\n                        {format(planningItemDate, 'h:mma')}\n                      </Fragment>\n                    )}\n                  </div>\n                </div>\n                <div className=\"agenda-day__header__header-container\">\n                  <TitleLine\n                    header={header}\n                    color=\"black\"\n                    hasContent={false}\n                    isSelected={false}\n                    shouldDisableActions\n                    shouldDisableExplicitWidth\n                    onClick={this.handleHeaderClick(header.get('id'))}\n                  />\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    );\n  }\n\n  getPlanningItemsAndHeaders({\n    headers,\n    todoKeywordSets,\n    date,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n    dateStart,\n    dateEnd,\n  }) {\n    return headers\n      .flatMap(header => {\n        const planningItemsforDate = header.get('planningItems').filter(planningItem => {\n          const timestamp = planningItem.get('timestamp');\n          if (!timestamp.get('isActive')) {\n            return false;\n          }\n          const planningItemDate = dateForTimestamp(timestamp);\n          const isCompletedTodo =\n            !!header.getIn(['titleLine', 'todoKeyword']) &&\n            isTodoKeywordCompleted(todoKeywordSets, header.getIn(['titleLine', 'todoKeyword']));\n          if (isCompletedTodo) {\n            return false;\n          }\n          if (planningItem.get('type') === 'DEADLINE') {\n            if (isToday(date)) {\n              if (isBefore(planningItemDate, new Date())) {\n                return true;\n              }\n              const [delayValue, delayUnit] = !!timestamp.get('delayType')\n                ? [timestamp.get('delayValue'), timestamp.get('delayUnit')]\n                : [agendaDefaultDeadlineDelayValue, agendaDefaultDeadlineDelayUnit];\n              const appearDate = subtractTimestampUnitFromDate(\n                planningItemDate,\n                delayValue,\n                delayUnit\n              );\n              return isAfter(date, appearDate) || isEqual(date, appearDate);\n            } else {\n              return isWithinInterval(planningItemDate, { start: dateStart, end: dateEnd });\n            }\n          } else if (planningItem.get('type') === 'SCHEDULED') {\n            let appearDate = planningItemDate;\n            if (!!timestamp.get('delayType')) {\n              const hasBeenRepeated = header\n                .get('propertyListItems')\n                .some(propertyListItem => propertyListItem.get('property') === 'LAST_REPEAT');\n              if (timestamp.get('delayType') === '--' && !hasBeenRepeated) {\n                appearDate = addTimestampUnitToDate(\n                  planningItemDate,\n                  timestamp.get('delayValue'),\n                  timestamp.get('delayUnit')\n                );\n              }\n            }\n            if (isToday(date) && isAfter(date, appearDate)) {\n              return true;\n            }\n            return isWithinInterval(appearDate, { start: dateStart, end: dateEnd });\n          } else {\n            return false;\n          }\n        });\n        return planningItemsforDate.map(planningItem => [planningItem, header]);\n      })\n      .sortBy(([planningItem, header]) => {\n        const { startHour, startMinute, endHour, endMinute, month, day } = planningItem\n          .get('timestamp')\n          .toJS();\n        return [!!startHour ? 0 : 1, startHour, startMinute, endHour, endMinute, month, day];\n      });\n  }\n}\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport AgendaDay from './components/AgendaDay';\nimport Drawer from '../../../UI/Drawer';\nimport TabButtons from '../../../UI/TabButtons';\n\nimport * as orgActions from '../../../../actions/org';\n\nimport _ from 'lodash';\nimport {\n  addDays,\n  addWeeks,\n  addMonths,\n  subDays,\n  subWeeks,\n  subMonths,\n  startOfWeek,\n  startOfMonth,\n  getDaysInMonth,\n} from 'date-fns';\nimport format from 'date-fns/format';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction AgendaModal(props) {\n  const [selectedDate, setSelectedDate] = useState(new Date());\n  const [timeframeType, setTimeframeType] = useState('Week');\n  const [dateDisplayType, setDateDisplayType] = useState('absolute');\n\n  function handleTimeframeTypeChange(timeframeType) {\n    setTimeframeType(timeframeType);\n  }\n\n  function handleNextDateClick() {\n    switch (timeframeType) {\n      case 'Day':\n        setSelectedDate(addDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(addWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(addMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleHeaderClick(headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(headerId);\n  }\n\n  function handlePreviousDateClick() {\n    switch (timeframeType) {\n      case 'Day':\n        setSelectedDate(subDays(selectedDate, 1));\n        break;\n      case 'Week':\n        setSelectedDate(subWeeks(selectedDate, 1));\n        break;\n      case 'Month':\n        setSelectedDate(subMonths(selectedDate, 1));\n        break;\n      default:\n        return '';\n    }\n  }\n\n  function handleToggleDateDisplayType() {\n    setDateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function calculateTimeframeHeader() {\n    switch (timeframeType) {\n      case 'Day':\n        return format(selectedDate, 'MMMM do');\n      case 'Week':\n        const weekStart = startOfWeek(selectedDate);\n        const weekEnd = addWeeks(weekStart, 1);\n        return `${format(weekStart, 'MMM do')} - ${format(weekEnd, 'MMM do')} (W${format(\n          weekStart,\n          'w'\n        )})`;\n      case 'Month':\n        return format(selectedDate, 'MMMM');\n      default:\n        return '';\n    }\n  }\n\n  const {\n    onClose,\n    headers,\n    todoKeywordSets,\n    agendaDefaultDeadlineDelayValue,\n    agendaDefaultDeadlineDelayUnit,\n  } = props;\n\n  let dates = [];\n  switch (timeframeType) {\n    case 'Day':\n      dates = [selectedDate];\n      break;\n    case 'Week':\n      const weekStart = startOfWeek(selectedDate);\n      dates = _.range(7).map(daysAfter => addDays(weekStart, daysAfter));\n      break;\n    case 'Month':\n      const monthStart = startOfMonth(selectedDate);\n      dates = _.range(getDaysInMonth(selectedDate)).map(daysAfter =>\n        addDays(monthStart, daysAfter)\n      );\n      break;\n    default:\n  }\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <h2 className=\"agenda__title\">Agenda</h2>\n\n      <div className=\"agenda__tab-container\">\n        <TabButtons\n          buttons={['Day', 'Week', 'Month']}\n          selectedButton={timeframeType}\n          onSelect={handleTimeframeTypeChange}\n          useEqualWidthTabs\n        />\n      </div>\n\n      <div className=\"agenda__timeframe-header-container\">\n        <i className=\"fas fa-chevron-left fa-lg\" onClick={handlePreviousDateClick} />\n        <div className=\"agenda__timeframe-header\">{calculateTimeframeHeader()}</div>\n        <i className=\"fas fa-chevron-right fa-lg\" onClick={handleNextDateClick} />\n      </div>\n\n      <div className=\"agenda__days-container\">\n        {dates.map(date => (\n          <AgendaDay\n            key={format(date, 'yyyy MM dd')}\n            date={date}\n            headers={headers}\n            onHeaderClick={handleHeaderClick}\n            todoKeywordSets={todoKeywordSets}\n            dateDisplayType={dateDisplayType}\n            onToggleDateDisplayType={handleToggleDateDisplayType}\n            agendaDefaultDeadlineDelayValue={agendaDefaultDeadlineDelayValue}\n            agendaDefaultDeadlineDelayUnit={agendaDefaultDeadlineDelayUnit}\n          />\n        ))}\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = state => ({\n  todoKeywordSets: state.org.present.get('todoKeywordSets'),\n  agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n  agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AgendaModal);\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\n\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nimport { dateForTimestamp } from '../../../../../../lib/timestamps';\nimport {\n  createIsTodoKeywordInDoneState,\n  customFormatDistanceToNow,\n} from '../../../../../../lib/org_utils';\n\nimport { format, isPast } from 'date-fns';\nimport classNames from 'classnames';\n\nfunction TaskListView(props) {\n  function handleHeaderClick(headerId) {\n    return () => props.onHeaderClick(headerId);\n  }\n\n  const { dateDisplayType, onToggleDateDisplayType, headers, todoKeywordSets } = props;\n\n  const planningItemsAndHeaders = getPlanningItemsAndHeaders({\n    headers,\n    todoKeywordSets,\n  });\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {planningItemsAndHeaders.map(([planningItem, header]) => {\n          const planningItemDate = planningItem\n            ? dateForTimestamp(planningItem.get('timestamp'))\n            : null;\n          const hasTodoKeyword = !!header.getIn(['titleLine', 'todoKeyword']);\n\n          const dateClassName = classNames('task-list__header-planning-date', {\n            'task-list__header-planning-date--overdue':\n              hasTodoKeyword && planningItem && isPast(planningItemDate),\n          });\n\n          let planningInformation = <div />;\n          if (planningItemDate) {\n            planningInformation = (\n              <div className=\"agenda-day__header__planning-item-container\">\n                <div className=\"task-list__header-planning-type\">{planningItem.get('type')}</div>\n                <div className={dateClassName} onClick={onToggleDateDisplayType}>\n                  {dateDisplayType === 'absolute'\n                    ? format(planningItemDate, 'MM/dd')\n                    : customFormatDistanceToNow(planningItemDate)}\n\n                  {!!planningItem.getIn(['timestamp', 'startHour']) && (\n                    <Fragment>\n                      <br />\n                      {format(planningItemDate, 'h:mma')}\n                    </Fragment>\n                  )}\n                </div>\n              </div>\n            );\n          }\n\n          return (\n            <div key={header.get('id')} className=\"agenda-day__header-container\">\n              <div className=\"agenda-day__header__header-container\">\n                <TitleLine\n                  header={header}\n                  color=\"black\"\n                  hasContent={false}\n                  isSelected={false}\n                  shouldDisableActions\n                  shouldDisableExplicitWidth\n                  onClick={handleHeaderClick(header.get('id'))}\n                />\n                {planningInformation}\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n\n  // Doing this on every render of the TaskListView is potentially\n  // inefficient and could be done in the reducer. However, doing it\n  // on every update of the headers state when not even looking at the\n  // Agenda is certainly more inefficient. Hence, we're doing it on\n  // every render.\n  function getPlanningItemsAndHeaders({ headers, todoKeywordSets }) {\n    const isTodoKeywordInDoneState = createIsTodoKeywordInDoneState(todoKeywordSets);\n\n    return headers\n      .filter(header => header.getIn(['titleLine', 'todoKeyword']))\n      .map(header => {\n        const earliestPlanningItem = header\n          .get('planningItems')\n          .sortBy(getTimeFromPlanningItem)\n          .first();\n        return [earliestPlanningItem, header];\n      })\n      .sortBy(([planningItem, header]) => {\n        const doneState = isTodoKeywordInDoneState(header.getIn(['titleLine', 'todoKeyword']));\n\n        const timeAsSortCriterion = planningItem\n          ? getTimeFromPlanningItem(planningItem)\n          : Number.MAX_SAFE_INTEGER; // Sort tasks without timestamp last\n        const title = header.getIn(['titleLine', 'rawTitle']);\n        return [doneState, timeAsSortCriterion, title];\n      });\n  }\n}\n\nconst mapStateToProps = state => ({\n  todoKeywordSets: state.org.present.get('todoKeywordSets'),\n  // When no filtering has happened, yet (initial state), use all headers.\n  headers:\n    state.org.present.getIn(['search', 'filteredHeaders']) || state.org.present.get('headers'),\n});\n\nconst mapDispatchToProps = dispatch => ({});\n\nconst getTimeFromPlanningItem = planningItem =>\n  dateForTimestamp(planningItem.get('timestamp')).getTime();\n\nexport default connect(mapStateToProps, mapDispatchToProps)(TaskListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport TaskListView from './components/TaskListView';\nimport Drawer from '../../../UI/Drawer';\n\nimport { isMobileBrowser } from '../../../../lib/browser_utils';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction TaskListModal(props) {\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n\n  function handleHeaderClick(headerId) {\n    props.onClose();\n    props.org.selectHeaderAndOpenParents(headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(event.target.value, event.target.selectionStart);\n  }\n\n  const { onClose, searchFilter, searchFilterValid, searchFilterSuggestions } = props;\n\n  // On mobile devices, the Drawer already handles the touch event.\n  // Hence, scrolling within the Drawers container does not work with\n  // the same event. Therefore, we're just opting to scroll the whole\n  // drawer. That's not the best UX. And a better CSS juggler than me\n  // is welcome to improve on it.\n  let taskListViewStyle = {\n    overflow: (() => {\n      return isMobileBrowser ? 'none' : 'auto';\n    })(),\n  };\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <h2 className=\"agenda__title\">Task list</h2>\n\n      <datalist id=\"task-list__datalist-filter\">\n        {searchFilterSuggestions.map((string, idx) => (\n          <option key={idx} value={string} />\n        ))}\n      </datalist>\n\n      <div className=\"task-list__input-container\">\n        <input\n          type=\"text\"\n          value={searchFilter}\n          className={classNames('textfield', 'task-list__filter-input', {\n            'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n          })}\n          placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n          list=\"task-list__datalist-filter\"\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div className=\"task-list__headers-container\" style={taskListViewStyle}>\n        <TaskListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n        />\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = state => ({\n  searchFilter: state.org.present.getIn(['search', 'searchFilter']) || '',\n  searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n  searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(TaskListModal);\n","import React, { useEffect } from 'react';\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\nimport * as orgActions from '../../../../../../actions/org';\nimport './stylesheet.css';\n\nimport TitleLine from '../../../TitleLine';\n\nfunction HeaderListView(props) {\n  const { context } = props;\n  function handleHeaderClick(headerId) {\n    return () => props.onHeaderClick(headerId);\n  }\n\n  // Populate filteredHeaders\n  useEffect(() => {\n    // No specific searchFilter and cursorPosition, but set the\n    // context (like 'search' or 'refile')\n    props.org.setSearchFilterInformation('', 0, context);\n  }, [context, props.org]);\n\n  const { headers } = props;\n\n  return (\n    <div className=\"agenda-day__container\">\n      <div className=\"agenda-day__headers-container\">\n        {headers.map(header => {\n          return (\n            <div key={header.get('id')} className=\"agenda-day__header-container\">\n              <div className=\"agenda-day__header__header-container\">\n                <TitleLine\n                  header={header}\n                  color=\"black\"\n                  hasContent={false}\n                  isSelected={false}\n                  shouldDisableActions\n                  shouldDisableExplicitWidth\n                  onClick={handleHeaderClick(header.get('id'))}\n                />\n              </div>\n            </div>\n          );\n        })}\n      </div>\n    </div>\n  );\n}\n\nconst mapStateToProps = state => ({\n  // When no filtering has happened, yet (initial state), use all headers.\n  headers:\n    state.org.present.getIn(['search', 'filteredHeaders']) || state.org.present.get('headers'),\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(HeaderListView);\n","import React, { useState } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { capitalize } from 'lodash';\n\nimport './stylesheet.css';\n\nimport classNames from 'classnames';\nimport HeaderListView from './components/HeaderListView';\nimport Drawer from '../../../UI/Drawer';\n\nimport { isMobileBrowser } from '../../../../lib/browser_utils';\n\nimport * as orgActions from '../../../../actions/org';\n\n// INFO: SearchModal, AgendaModal and TaskListModal are very similar\n// in structure and partially in logic. When changing one, consider\n// changing all.\nfunction SearchModal(props) {\n  const [dateDisplayType, setdateDisplayType] = useState('absolute');\n  const { onClose, searchFilter, searchFilterValid, searchFilterSuggestions, context } = props;\n\n  function handleHeaderClick(headerId) {\n    props.onClose(headerId);\n  }\n\n  function handleToggleDateDisplayType() {\n    setdateDisplayType(dateDisplayType === 'absolute' ? 'relative' : 'absolute');\n  }\n\n  function handleFilterChange(event) {\n    props.org.setSearchFilterInformation(event.target.value, event.target.selectionStart, context);\n  }\n\n  // On mobile devices, the Drawer already handles the touch event.\n  // Hence, scrolling within the Drawers container does not work with\n  // the same event. Therefore, we're just opting to scroll the whole\n  // drawer. That's not the best UX. And a better CSS juggler than me\n  // is welcome to improve on it.\n  let taskListViewStyle = {\n    overflow: (() => {\n      return isMobileBrowser ? 'none' : 'auto';\n    })(),\n  };\n\n  return (\n    <Drawer onClose={onClose} maxSize={true}>\n      <h2 className=\"agenda__title\">{capitalize(context)}</h2>\n\n      <datalist id=\"task-list__datalist-filter\">\n        {searchFilterSuggestions.map((string, idx) => (\n          <option key={idx} value={string} />\n        ))}\n      </datalist>\n\n      <div className=\"task-list__input-container\">\n        <input\n          type=\"text\"\n          value={searchFilter}\n          className={classNames('textfield', 'task-list__filter-input', {\n            'task-list__filter-input--invalid': !!searchFilter && !searchFilterValid,\n          })}\n          placeholder=\"e.g. -DONE doc|man :simple|easy :assignee:nobody|none\"\n          list=\"task-list__datalist-filter\"\n          onChange={handleFilterChange}\n        />\n      </div>\n\n      <div className=\"task-list__headers-container\" style={taskListViewStyle}>\n        <HeaderListView\n          onHeaderClick={handleHeaderClick}\n          dateDisplayType={dateDisplayType}\n          onToggleDateDisplayType={handleToggleDateDisplayType}\n          context={context}\n        />\n      </div>\n\n      <br />\n    </Drawer>\n  );\n}\n\nconst mapStateToProps = state => ({\n  searchFilter: state.org.present.getIn(['search', 'searchFilter']) || '',\n  searchFilterValid: state.org.present.getIn(['search', 'searchFilterValid']),\n  searchFilterSuggestions: state.org.present.getIn(['search', 'searchFilterSuggestions']) || [],\n});\n\nconst mapDispatchToProps = dispatch => ({\n  org: bindActionCreators(orgActions, dispatch),\n});\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SearchModal);\n","const DEFAULT_BINDINGS = [\n  ['Select next header', 'selectNextVisibleHeader', 'ctrl+down'],\n  ['Select previous header', 'selectPreviousVisibleHeader', 'ctrl+up'],\n  ['Toggle header opened', 'toggleHeaderOpened', 'tab'],\n  ['Advance todo state', 'advanceTodo', 'alt+t'],\n  ['Edit title', 'editTitle', 'ctrl+h'],\n  ['Edit description', 'editDescription', 'ctrl+d'],\n  ['Exit edit mode', 'exitEditMode', 'alt+enter'],\n  ['Add header', 'addHeader', 'ctrl+enter'],\n  ['Remove header', 'removeHeader', 'backspace'],\n  ['Move header up', 'moveHeaderUp', 'alt+up'],\n  ['Move header down', 'moveHeaderDown', 'alt+down'],\n  ['Move header left', 'moveHeaderLeft', 'alt+shift+left'],\n  ['Move header right', 'moveHeaderRight', 'alt+shift+right'],\n  ['Undo', 'undo', 'ctrl+/'],\n];\n\nexport const calculateNamedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, _bindingAction, binding]) => [\n    bindingName,\n    customKeybindings.get(bindingName, binding),\n  ]);\n\nexport const calculateActionedKeybindings = customKeybindings =>\n  DEFAULT_BINDINGS.map(([bindingName, bindingAction, binding]) => [\n    bindingAction,\n    customKeybindings.get(bindingName, binding),\n  ]);\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Redirect } from 'react-router-dom';\n\nimport { HotKeys } from 'react-hotkeys';\n\nimport './stylesheet.css';\n\nimport HeaderList from './components/HeaderList';\nimport ActionDrawer from './components/ActionDrawer';\nimport CaptureModal from './components/CaptureModal';\nimport SyncConfirmationModal from './components/SyncConfirmationModal';\nimport TagsEditorModal from './components/TagsEditorModal';\nimport TimestampEditorModal from './components/TimestampEditorModal';\nimport PropertyListEditorModal from './components/PropertyListEditorModal';\nimport AgendaModal from './components/AgendaModal';\nimport TaskListModal from './components/TaskListModal';\nimport SearchModal from './components/SearchModal';\n\nimport * as baseActions from '../../actions/base';\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as captureActions from '../../actions/capture';\nimport { ActionCreators as undoActions } from 'redux-undo';\n\nimport sampleCaptureTemplates from '../../lib/sample_capture_templates';\nimport { calculateActionedKeybindings } from '../../lib/keybindings';\nimport {\n  timestampWithId,\n  headerWithId,\n  extractAllOrgTags,\n  extractAllOrgProperties,\n  changelogHash,\n} from '../../lib/org_utils';\n\nimport _ from 'lodash';\nimport { fromJS } from 'immutable';\n\nclass OrgFile extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'handleSelectNextVisibleHeaderHotKey',\n      'handleSelectPreviousVisibleHeaderHotKey',\n      'handleToggleHeaderOpenedHotKey',\n      'handleAdvanceTodoHotKey',\n      'handleEditTitleHotKey',\n      'handleEditDescriptionHotKey',\n      'handleExitEditModeHotKey',\n      'handleAddHeaderHotKey',\n      'handleRemoveHeaderHotKey',\n      'handleMoveHeaderUpHotKey',\n      'handleMoveHeaderDownHotKey',\n      'handleMoveHeaderLeftHotKey',\n      'handleMoveHeaderRightHotKey',\n      'handleUndoHotKey',\n      'handleContainerRef',\n      'handleCapture',\n      'handlePopupClose',\n      'handleSearchPopupClose',\n      'handleRefilePopupClose',\n      'handleSyncConfirmationPull',\n      'handleSyncConfirmationPush',\n      'handleSyncConfirmationCancel',\n      'handleTagsChange',\n      'handlePropertyListItemsChange',\n    ]);\n\n    this.state = {\n      hasUncaughtError: false,\n    };\n  }\n\n  componentDidMount() {\n    const { staticFile, path, loadedPath } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.loadStaticFile(staticFile);\n\n      if (staticFile === 'changelog') {\n        this.props.base.setHasUnseenChangelog(false);\n        changelogHash().then(hash => {\n          this.props.base.setLastSeenChangelogHeader(hash);\n        });\n      }\n\n      setTimeout(() => (document.querySelector('html').scrollTop = 0), 0);\n    } else if (!_.isEmpty(path) && path !== loadedPath) {\n      this.props.syncBackend.downloadFile(path);\n    }\n\n    this.activatePopup();\n  }\n\n  // If a fragment is set in the URL (by the activatePopup base\n  // action), activate the appropriate pop-up\n  activatePopup() {\n    const urlFragment = window.location.hash.substr(1);\n    if (!_.isEmpty(urlFragment)) {\n      this.props.base.activatePopup(urlFragment);\n    }\n  }\n\n  componentWillUnmount() {\n    const { staticFile } = this.props;\n\n    if (!!staticFile) {\n      this.props.base.unloadStaticFile();\n    } else {\n      this.props.org.stopDisplayingFile();\n    }\n  }\n\n  componentDidUpdate() {\n    const { headers, pendingCapture } = this.props;\n    if (!!pendingCapture && !!headers && headers.size > 0) {\n      this.props.org.insertPendingCapture();\n    }\n  }\n\n  componentDidCatch(error) {\n    // TODO: Track the `error` into a bug tracker\n    this.setState({ hasUncaughtError: true });\n  }\n\n  handleSelectNextVisibleHeaderHotKey() {\n    this.props.org.selectNextVisibleHeader();\n  }\n\n  handleSelectPreviousVisibleHeaderHotKey() {\n    this.props.org.selectPreviousVisibleHeader();\n  }\n\n  handleToggleHeaderOpenedHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    if (selectedHeaderId) {\n      this.props.org.toggleHeaderOpened(selectedHeaderId);\n    }\n  }\n\n  handleAdvanceTodoHotKey() {\n    this.props.org.advanceTodoState();\n  }\n\n  handleEditTitleHotKey() {\n    this.props.org.enterEditMode('title');\n  }\n\n  handleEditDescriptionHotKey() {\n    this.props.org.openHeader(this.props.selectedHeaderId);\n    this.props.org.enterEditMode('description');\n  }\n\n  handleExitEditModeHotKey() {\n    this.props.org.exitEditMode();\n    this.container.focus();\n  }\n\n  handleAddHeaderHotKey() {\n    this.props.org.addHeaderAndEdit(this.props.selectedHeaderId);\n  }\n\n  handleRemoveHeaderHotKey() {\n    const { selectedHeaderId } = this.props;\n\n    this.props.org.selectNextSiblingHeader(selectedHeaderId);\n    this.props.org.removeHeader(selectedHeaderId);\n  }\n\n  handleMoveHeaderUpHotKey() {\n    this.props.org.moveHeaderUp(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderDownHotKey() {\n    this.props.org.moveHeaderDown(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderLeftHotKey() {\n    this.props.org.moveHeaderLeft(this.props.selectedHeaderId);\n  }\n\n  handleMoveHeaderRightHotKey() {\n    this.props.org.moveHeaderRight(this.props.selectedHeaderId);\n  }\n\n  handleUndoHotKey() {\n    this.props.undo.undo();\n  }\n\n  handleContainerRef(container) {\n    this.container = container;\n    if (this.container) {\n      this.container.focus();\n    }\n  }\n\n  handleCapture(templateId, content, shouldPrepend) {\n    this.props.org.insertCapture(templateId, content, shouldPrepend);\n  }\n\n  handlePopupClose() {\n    this.props.base.closePopup();\n  }\n\n  handleSearchPopupClose(headerId) {\n    this.props.base.closePopup();\n    this.props.org.selectHeaderAndOpenParents(headerId);\n  }\n\n  handleRefilePopupClose(targetHeaderId) {\n    this.props.base.closePopup();\n    // When the user closes the drawer without selecting a header, do\n    // not trigger refiling.\n    if (targetHeaderId) {\n      const { selectedHeaderId } = this.props;\n      this.props.org.refileSubtree(selectedHeaderId, targetHeaderId);\n    }\n  }\n\n  handleSyncConfirmationPull() {\n    this.props.org.sync({ forceAction: 'pull' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationPush() {\n    this.props.org.sync({ forceAction: 'push' });\n    this.props.base.closePopup();\n  }\n\n  handleSyncConfirmationCancel() {\n    this.props.base.closePopup();\n  }\n\n  handleTagsChange(newTags) {\n    this.props.org.setHeaderTags(this.props.selectedHeaderId, newTags);\n  }\n\n  handlePropertyListItemsChange(newPropertyListItems) {\n    this.props.org.updatePropertyListItems(this.props.selectedHeaderId, newPropertyListItems);\n  }\n\n  handleTimestampChange(popupData) {\n    if (!!popupData.get('timestampId')) {\n      return newTimestamp =>\n        this.props.org.updateTimestampWithId(popupData.get('timestampId'), newTimestamp);\n    } else if (popupData.get('logEntryIndex') !== undefined) {\n      return newTimestamp =>\n        this.props.org.updateLogEntryTime(\n          popupData.get('headerId'),\n          popupData.get('logEntryIndex'),\n          popupData.get('entryType'),\n          newTimestamp.get('firstTimestamp')\n        );\n    } else {\n      return newTimestamp =>\n        this.props.org.updatePlanningItemTimestamp(\n          popupData.get('headerId'),\n          popupData.get('planningItemIndex'),\n          newTimestamp.get('firstTimestamp')\n        );\n    }\n  }\n\n  renderActivePopup() {\n    const {\n      activePopupType,\n      activePopupData,\n      captureTemplates,\n      headers,\n      selectedHeader,\n    } = this.props;\n\n    switch (activePopupType) {\n      case 'sync-confirmation':\n        return (\n          <SyncConfirmationModal\n            lastServerModifiedAt={activePopupData.get('lastServerModifiedAt')}\n            onPull={this.handleSyncConfirmationPull}\n            onPush={this.handleSyncConfirmationPush}\n            onCancel={this.handleSyncConfirmationCancel}\n          />\n        );\n      case 'capture':\n        return (\n          <CaptureModal\n            template={captureTemplates.find(\n              template => template.get('id') === activePopupData.get('templateId')\n            )}\n            headers={headers}\n            onCapture={this.handleCapture}\n            onClose={this.handlePopupClose}\n          />\n        );\n      case 'tags-editor':\n        const allTags = extractAllOrgTags(headers);\n        return !!selectedHeader ? (\n          <TagsEditorModal\n            header={selectedHeader}\n            allTags={allTags}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTagsChange}\n          />\n        ) : null;\n      case 'timestamp-editor':\n        let editingTimestamp = null;\n        if (activePopupData.get('timestampId')) {\n          editingTimestamp = timestampWithId(headers, activePopupData.get('timestampId'));\n        } else if (activePopupData.get('logEntryIndex') !== undefined) {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'logBookEntries',\n              activePopupData.get('logEntryIndex'),\n              activePopupData.get('entryType'),\n            ]),\n          });\n        } else {\n          editingTimestamp = fromJS({\n            firstTimestamp: headerWithId(headers, activePopupData.get('headerId')).getIn([\n              'planningItems',\n              activePopupData.get('planningItemIndex'),\n              'timestamp',\n            ]),\n          });\n        }\n\n        return (\n          <TimestampEditorModal\n            timestamp={editingTimestamp}\n            planningItemIndex={activePopupData.get('planningItemIndex')}\n            singleTimestampOnly={!activePopupData.get('timestampId')}\n            onClose={this.handlePopupClose}\n            onChange={this.handleTimestampChange(activePopupData)}\n          />\n        );\n\n      case 'property-list-editor':\n        const allOrgProperties = extractAllOrgProperties(headers);\n        return selectedHeader ? (\n          <PropertyListEditorModal\n            onClose={this.handlePopupClose}\n            onChange={this.handlePropertyListItemsChange}\n            propertyListItems={selectedHeader.get('propertyListItems')}\n            allOrgProperties={allOrgProperties}\n          />\n        ) : null;\n      case 'agenda':\n        return <AgendaModal onClose={this.handlePopupClose} headers={headers} />;\n      case 'task-list':\n        return <TaskListModal onClose={this.handlePopupClose} headers={headers} />;\n      case 'search':\n        return <SearchModal onClose={this.handleSearchPopupClose} context=\"search\" />;\n      case 'refile':\n        return <SearchModal onClose={this.handleRefilePopupClose} context=\"refile\" />;\n      default:\n        return null;\n    }\n  }\n\n  render() {\n    const {\n      headers,\n      shouldDisableDirtyIndicator,\n      shouldDisableSyncButtons,\n      shouldDisableActions,\n      isDirty,\n      parsingErrorMessage,\n      path,\n      staticFile,\n      customKeybindings,\n      inEditMode,\n      orgFileErrorMessage,\n    } = this.props;\n\n    if (!path && !staticFile) {\n      return <Redirect to=\"/files\" />;\n    }\n\n    if (this.state.hasUncaughtError) {\n      return (\n        <div className=\"error-message-container\">\n          Uh oh, you ran into a bug!\n          <br />\n          <br />\n          This was probably the result of an error in attempting to parse your org file. It'd be\n          super helpful if you could{' '}\n          <a\n            href=\"https://github.com/200ok-ch/organice/issues/new\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            create an issue\n          </a>{' '}\n          (and include the org file if possible!)\n        </div>\n      );\n    }\n\n    if (!!orgFileErrorMessage) {\n      return <div className=\"error-message-container\">{orgFileErrorMessage}</div>;\n    }\n\n    if (!headers) {\n      return <div />;\n    }\n\n    const keyMap = _.fromPairs(calculateActionedKeybindings(customKeybindings));\n\n    // Automatically call preventDefault on all the keyboard events that come through for\n    // these hotkeys.\n    const preventDefaultAndHandleEditMode = (callback, ignoreInEditMode = false) => event => {\n      if (ignoreInEditMode && inEditMode) {\n        return;\n      }\n\n      if (ignoreInEditMode && ['TEXTAREA', 'INPUT'].includes(document.activeElement.nodeName)) {\n        return;\n      }\n\n      event.preventDefault();\n      callback(event);\n    };\n\n    const handlers = {\n      selectNextVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectNextVisibleHeaderHotKey\n      ),\n      selectPreviousVisibleHeader: preventDefaultAndHandleEditMode(\n        this.handleSelectPreviousVisibleHeaderHotKey\n      ),\n      toggleHeaderOpened: preventDefaultAndHandleEditMode(\n        this.handleToggleHeaderOpenedHotKey,\n        true\n      ),\n      advanceTodo: preventDefaultAndHandleEditMode(this.handleAdvanceTodoHotKey),\n      editTitle: preventDefaultAndHandleEditMode(this.handleEditTitleHotKey),\n      editDescription: preventDefaultAndHandleEditMode(this.handleEditDescriptionHotKey),\n      exitEditMode: preventDefaultAndHandleEditMode(this.handleExitEditModeHotKey),\n      addHeader: preventDefaultAndHandleEditMode(this.handleAddHeaderHotKey),\n      removeHeader: preventDefaultAndHandleEditMode(this.handleRemoveHeaderHotKey, true),\n      moveHeaderUp: preventDefaultAndHandleEditMode(this.handleMoveHeaderUpHotKey),\n      moveHeaderDown: preventDefaultAndHandleEditMode(this.handleMoveHeaderDownHotKey),\n      moveHeaderLeft: preventDefaultAndHandleEditMode(this.handleMoveHeaderLeftHotKey),\n      moveHeaderRight: preventDefaultAndHandleEditMode(this.handleMoveHeaderRightHotKey),\n      undo: preventDefaultAndHandleEditMode(this.handleUndoHotKey),\n    };\n\n    return (\n      <HotKeys keyMap={keyMap} handlers={handlers}>\n        <div className=\"org-file-container\" tabIndex=\"-1\" ref={this.handleContainerRef}>\n          {headers.size === 0 ? (\n            <div className=\"org-file__parsing-error-message\">\n              <h3>Couldn't parse file</h3>\n\n              {!!parsingErrorMessage ? (\n                <Fragment>{parsingErrorMessage}</Fragment>\n              ) : (\n                <Fragment>\n                  If you think this is a bug, please{' '}\n                  <a\n                    href=\"https://github.com/200ok-ch/organice/issues/new\"\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    create an issue\n                  </a>{' '}\n                  and include the org file if possible!\n                </Fragment>\n              )}\n            </div>\n          ) : (\n            <HeaderList shouldDisableActions={shouldDisableActions} />\n          )}\n\n          {isDirty && !shouldDisableDirtyIndicator && (\n            <div className=\"dirty-indicator\">Unpushed changes</div>\n          )}\n\n          {!shouldDisableActions && (\n            <ActionDrawer\n              shouldDisableSyncButtons={shouldDisableSyncButtons}\n              staticFile={staticFile}\n            />\n          )}\n\n          {this.renderActivePopup()}\n        </div>\n      </HotKeys>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  const headers = state.org.present.get('headers');\n  const selectedHeaderId = state.org.present.get('selectedHeaderId');\n  const activePopup = state.base.get('activePopup');\n\n  return {\n    headers,\n    selectedHeaderId,\n    isDirty: state.org.present.get('isDirty'),\n    loadedPath: state.org.present.get('path'),\n    selectedHeader: headers && headers.find(header => header.get('id') === selectedHeaderId),\n    customKeybindings: state.base.get('customKeybindings'),\n    inEditMode: !!state.org.present.get('editMode'),\n    activePopupType: !!activePopup ? activePopup.get('type') : null,\n    activePopupData: !!activePopup ? activePopup.get('data') : null,\n    captureTemplates: state.capture.get('captureTemplates').concat(sampleCaptureTemplates),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    orgFileErrorMessage: state.org.present.get('orgFileErrorMessage'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    undo: bindActionCreators(undoActions, dispatch),\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(OrgFile);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter, Link } from 'react-router-dom';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as baseActions from '../../actions/base';\n\nimport './stylesheet.css';\n\nimport TabButtons from '../UI/TabButtons';\nimport Switch from '../UI/Switch';\n\nconst Settings = ({\n  fontSize,\n  bulletStyle,\n  shouldTapTodoToAdvance,\n  shouldDoubleTapToEdit,\n  shouldStoreSettingsInSyncBackend,\n  shouldLiveSync,\n  shouldSyncOnBecomingVisibile,\n  shouldShowTitleInOrgFile,\n  agendaDefaultDeadlineDelayValue,\n  agendaDefaultDeadlineDelayUnit,\n  hasUnseenChangelog,\n  syncBackend,\n  base,\n}) => {\n  const handleSignOutClick = () =>\n    window.confirm('Are you sure you want to sign out?') ? syncBackend.signOut() : void 0;\n\n  const handleKeyboardShortcutsClick = () => base.pushModalPage('keyboard_shortcuts_editor');\n\n  const handleCaptureTemplatesClick = () => base.pushModalPage('capture_templates_editor');\n\n  const handleFontSizeChange = newFontSize => base.setFontSize(newFontSize);\n\n  const handleBulletStyleChange = newBulletStyle => base.setBulletStyle(newBulletStyle);\n\n  const handleShouldTapTodoToAdvanceChange = () =>\n    base.setShouldTapTodoToAdvance(!shouldTapTodoToAdvance);\n\n  const handleShouldDoubleTapToEdit = () =>\n    base.setShouldDoubleTapToEdit(!shouldDoubleTapToEdit);\n\n  const handleAgendaDefaultDeadlineDelayValueChange = event =>\n    base.setAgendaDefaultDeadlineDelayValue(event.target.value);\n\n  const handleAgendaDefaultDeadlineDelayUnitChange = newDelayUnit =>\n    base.setAgendaDefaultDeadlineDelayUnit(newDelayUnit);\n\n  const handleShouldLiveSyncChange = () => base.setShouldLiveSync(!shouldLiveSync);\n\n  const handleShouldSyncOnBecomingVisibleChange = () =>\n    base.setShouldSyncOnBecomingVisibile(!shouldSyncOnBecomingVisibile);\n\n  const handleShouldShowTitleInOrgFile = () =>\n    base.setShouldShowTitleInOrgFile(!shouldShowTitleInOrgFile);\n\n  const handleShouldStoreSettingsInSyncBackendChange = () =>\n    base.setShouldStoreSettingsInSyncBackend(!shouldStoreSettingsInSyncBackend);\n\n  const handleChangelogClick = () => base.pushModalPage('changelog');\n\n  return (\n    <div className=\"settings-container\">\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Font size</div>\n        <TabButtons\n          buttons={['Regular', 'Large']}\n          selectedButton={fontSize}\n          onSelect={handleFontSizeChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Bullet style</div>\n        <TabButtons\n          buttons={['Classic', 'Fancy']}\n          selectedButton={bulletStyle}\n          onSelect={handleBulletStyleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Tap TODO to advance state</div>\n        <Switch isEnabled={shouldTapTodoToAdvance} onToggle={handleShouldTapTodoToAdvanceChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">Double tap title or description to edit</div>\n        <Switch isEnabled={shouldDoubleTapToEdit} onToggle={handleShouldDoubleTapToEdit} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Live sync\n          <div className=\"setting-label__description\">\n            If enabled, changes are automatically pushed to the sync backend as you make them.\n          </div>\n        </div>\n        <Switch isEnabled={shouldLiveSync} onToggle={handleShouldLiveSyncChange} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Sync on application becoming visible\n          <div className=\"setting-label__description\">\n            If enabled, the current org file is pulled from the sync backend when the browser tab\n            becomes visible. This prevents you from having a stale file before starting to make\n            changes to it.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldSyncOnBecomingVisibile}\n          onToggle={handleShouldSyncOnBecomingVisibleChange}\n        />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Show Org filename as Title\n          <div className=\"setting-label__description\">\n            When in an Org file view, it shows the filename in the HeaderBar.\n          </div>\n        </div>\n        <Switch isEnabled={shouldShowTitleInOrgFile} onToggle={handleShouldShowTitleInOrgFile} />\n      </div>\n\n      <div className=\"setting-container\">\n        <div className=\"setting-label\">\n          Store settings in sync backend\n          <div className=\"setting-label__description\">\n            Store settings and keyboard shortcuts in a .organice-config.json file in your sync\n            backend to sync between multiple devices.\n          </div>\n        </div>\n        <Switch\n          isEnabled={shouldStoreSettingsInSyncBackend}\n          onToggle={handleShouldStoreSettingsInSyncBackendChange}\n        />\n      </div>\n\n      <div className=\"setting-container setting-container--vertical\">\n        <div className=\"setting-label\">Default DEADLINE warning period</div>\n\n        <div className=\"default-deadline-warning-container\">\n          <input\n            type=\"number\"\n            min=\"0\"\n            className=\"textfield default-deadline-value-textfield\"\n            value={agendaDefaultDeadlineDelayValue}\n            onChange={handleAgendaDefaultDeadlineDelayValueChange}\n          />\n\n          <TabButtons\n            buttons={'hdwmy'.split('')}\n            selectedButton={agendaDefaultDeadlineDelayUnit}\n            onSelect={handleAgendaDefaultDeadlineDelayUnitChange}\n          />\n        </div>\n      </div>\n\n      <div className=\"settings-buttons-container\">\n        <button className=\"btn settings-btn\" onClick={handleCaptureTemplatesClick}>\n          Capture templates\n        </button>\n        <button className=\"btn settings-btn\" onClick={handleKeyboardShortcutsClick}>\n          Keyboard shortcuts\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleChangelogClick}>\n          Changelog\n          {hasUnseenChangelog && (\n            <div className=\"changelog-badge-container\">\n              <i className=\"fas fa-gift\" />\n              &nbsp; What's New?\n            </div>\n          )}\n        </button>\n\n        <Link to=\"/sample\" className=\"btn settings-btn\">\n          Help\n        </Link>\n\n        <button className=\"btn settings-btn\">\n          <a\n            href=\"https://organice.200ok.ch/documentation.html\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n          >\n            Documentation <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <button className=\"btn settings-btn\">\n          <a href=\"https://github.com/200ok-ch/organice\" target=\"_blank\" rel=\"noopener noreferrer\">\n            Github repo <i className=\"fas fa-external-link-alt fa-sm\" />\n          </a>\n        </button>\n\n        <hr className=\"settings-button-separator\" />\n\n        <button className=\"btn settings-btn\" onClick={handleSignOutClick}>\n          Sign out\n        </button>\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    fontSize: state.base.get('fontSize') || 'Regular',\n    bulletStyle: state.base.get('bulletStyle') || 'Classic',\n    shouldTapTodoToAdvance: state.base.get('shouldTapTodoToAdvance'),\n    shouldDoubleTapToEdit: state.base.get('shouldDoubleTapToEdit'),\n    agendaDefaultDeadlineDelayValue: state.base.get('agendaDefaultDeadlineDelayValue') || 5,\n    agendaDefaultDeadlineDelayUnit: state.base.get('agendaDefaultDeadlineDelayUnit') || 'd',\n    shouldStoreSettingsInSyncBackend: state.base.get('shouldStoreSettingsInSyncBackend'),\n    shouldLiveSync: state.base.get('shouldLiveSync'),\n    shouldSyncOnBecomingVisibile: state.base.get('shouldSyncOnBecomingVisibile'),\n    shouldShowTitleInOrgFile: state.base.get('shouldShowTitleInOrgFile'),\n    hasUnseenChangelog: state.base.get('hasUnseenChangelog'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Settings));\n","import React, { PureComponent } from 'react';\n\nimport './stylesheet.css';\n\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nexport default class ShortcutRow extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleRebindClick', 'handleKeyPress']);\n\n    this.state = {\n      isEditMode: false,\n    };\n  }\n\n  componentDidMount() {\n    this.rebindArea.addEventListener('blur', () => this.setState({ isEditMode: false }));\n  }\n\n  handleRebindClick() {\n    this.setState({ isEditMode: true });\n    document.addEventListener('keypress', this.handleKeyPress);\n  }\n\n  handleKeyPress(event) {\n    this.setState({ isEditMode: false });\n    document.removeEventListener('keypress', this.handleKeyPress);\n\n    let key = null;\n    if (event.code.startsWith('Key')) {\n      key = event.code.substr(3).toLowerCase();\n    } else if (event.code.startsWith('Digit')) {\n      key = event.code.substr(5);\n    } else {\n      key = {\n        Minus: '-',\n        Equal: '=',\n        Backspace: 'backspace',\n        Enter: 'enter',\n        Return: 'return',\n        Tab: 'tab',\n        BracketLeft: '[',\n        BracketRight: ']',\n        Semicolon: ';',\n        Quote: '\"',\n        Backslash: '\\\\',\n        Comma: ',',\n        Period: '.',\n        Slash: '/',\n      }[event.code];\n    }\n\n    if (!key) {\n      return;\n    }\n\n    const modifiers = [\n      ['ctrlKey', 'ctrl'],\n      ['altKey', 'alt'],\n      ['metaKey', 'meta'],\n      ['shiftKey', 'shift'],\n    ];\n\n    const newModifiers = modifiers\n      .filter(([modifier, _]) => event[modifier])\n      .map(([_, symbol]) => symbol)\n      .join('+');\n    const newBinding = `${newModifiers}${!!newModifiers ? '+' : ''}${key}`;\n\n    this.props.onBindingChange(this.props.name, newBinding);\n  }\n\n  symbolizeKeybinding(binding) {\n    if (!binding) {\n      return '';\n    }\n\n    const replacements = [\n      ['ctrl', '^'],\n      ['alt', '⌥'],\n      ['option', '⌥'],\n      ['command', '⌘'],\n      ['meta', '⌘'],\n      ['shift', '⇧'],\n      ['backspace', '⌫'],\n      ['return', '⏎'],\n      ['enter', '⏎'],\n      ['left', '←'],\n      ['right', '→'],\n      ['up', '↑'],\n      ['down', '↓'],\n    ];\n\n    return replacements.reduce(\n      (currentBinding, [name, symbol]) => currentBinding.replace(RegExp(`${name}\\\\+?`), symbol),\n      binding\n    );\n  }\n\n  render() {\n    const { name, binding } = this.props;\n    const { isEditMode } = this.state;\n\n    const rebindAreaClassName = classNames('keyboard-shortcut-container__shortcut-key', {\n      'keyboard-shortcut-container__shortcut-key--edit-mode': isEditMode,\n    });\n\n    return (\n      <div className=\"keyboard-shortcut-container\">\n        <div className=\"keyboard-shortcut-container__shortcut-name\">{name}</div>\n        <div\n          className={rebindAreaClassName}\n          onClick={this.handleRebindClick}\n          tabIndex=\"-1\"\n          ref={div => (this.rebindArea = div)}\n        >\n          {isEditMode ? '...' : this.symbolizeKeybinding(binding)}\n        </div>\n      </div>\n    );\n  }\n}\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { withRouter } from 'react-router-dom';\n\nimport { Map } from 'immutable';\n\nimport ShortcutRow from './components/ShortcutRow';\n\nimport * as baseActions from '../../actions/base';\n\nimport { calculateNamedKeybindings } from '../../lib/keybindings';\n\nimport './stylesheet.css';\n\nconst KeyboardShortcutsEditor = ({ customKeybindings, base }) => {\n  const handleBindingChange = (bindingName, newBinding) => {\n    const alreadyInUseBinding = calculateNamedKeybindings(customKeybindings).filter(\n      ([_, binding]) => binding === newBinding\n    )[0];\n\n    if (!!alreadyInUseBinding) {\n      alert(`That binding is already in use for \"${alreadyInUseBinding[0]}\"`);\n      return;\n    }\n\n    base.setCustomKeybinding(bindingName, newBinding);\n  };\n\n  return (\n    <div className=\"keyboard-shortcuts-editor-container\">\n      {calculateNamedKeybindings(customKeybindings).map(([name, binding]) => (\n        <ShortcutRow\n          key={name}\n          name={name}\n          binding={binding}\n          onBindingChange={handleBindingChange}\n        />\n      ))}\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    customKeybindings: state.base.get('customKeybindings') || Map(),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  )(KeyboardShortcutsEditor)\n);\n","import React, { Fragment, useState } from 'react';\nimport { UnmountClosed as Collapse } from 'react-collapse';\n\nimport { Draggable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport ActionButton from '../../../OrgFile/components/ActionDrawer/components/ActionButton';\nimport Switch from '../../../UI/Switch/';\n\nimport classNames from 'classnames';\n\nexport default ({\n  template,\n  index,\n  onFieldPathUpdate,\n  onAddNewTemplateOrgFileAvailability,\n  onRemoveTemplateOrgFileAvailability,\n  onAddNewTemplateHeaderPath,\n  onRemoveTemplateHeaderPath,\n  onDeleteTemplate,\n  syncBackendType,\n}) => {\n  const [isCollapsed, setIsCollapsed] = useState(!!template.get('description'));\n  const handleHeaderBarClick = () => setIsCollapsed(!isCollapsed);\n\n  const updateField = fieldName => event =>\n    onFieldPathUpdate(template.get('id'), [fieldName], event.target.value);\n\n  const toggleAvailabilityInAllOrgFiles = () =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['isAvailableInAllOrgFiles'],\n      !template.get('isAvailableInAllOrgFiles')\n    );\n\n  const togglePrepend = () =>\n    onFieldPathUpdate(template.get('id'), ['shouldPrepend'], !template.get('shouldPrepend'));\n\n  const handleAddNewOrgFileAvailability = () => {\n    onAddNewTemplateOrgFileAvailability(template.get('id'));\n  };\n\n  const handleRemoveOrgFileAvailability = index => () =>\n    onRemoveTemplateOrgFileAvailability(template.get('id'), index);\n\n  const handleOrgFileAvailabilityChange = orgFileAvailabilityIndex => event =>\n    onFieldPathUpdate(\n      template.get('id'),\n      ['orgFilesWhereAvailable', orgFileAvailabilityIndex],\n      event.target.value\n    );\n\n  const handleAddNewHeaderPath = () => onAddNewTemplateHeaderPath(template.get('id'));\n\n  const handleRemoveHeaderPath = headerPathIndex => () =>\n    onRemoveTemplateHeaderPath(template.get('id'), headerPathIndex);\n\n  const handleHeaderPathChange = headerPathIndex => event =>\n    onFieldPathUpdate(template.get('id'), ['headerPaths', headerPathIndex], event.target.value);\n\n  const handleDeleteClick = () => {\n    if (\n      window.confirm(\n        `Are you sure you want to delete the \"${template.get('description')}\" template?`\n      )\n    ) {\n      onDeleteTemplate(template.get('id'));\n    }\n  };\n\n  const renderDescriptionField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Description:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('description', '')}\n          onChange={updateField('description')}\n        />\n      </div>\n    </div>\n  );\n\n  const renderIconField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Letter:</div>\n        <input\n          type=\"text\"\n          className=\"textfield capture-template__letter-textfield\"\n          maxLength=\"1\"\n          value={template.get('letter', '')}\n          onChange={updateField('letter')}\n          autoCapitalize=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__field__or-container\">\n        <div className=\"capture-template__field__or-line\" />\n        <div className=\"capture-template__field__or\">or</div>\n        <div className=\"capture-template__field__or-line\" />\n      </div>\n\n      <div className=\"capture-template__field\">\n        <div>Icon name:</div>\n        <input\n          type=\"text\"\n          className=\"textfield\"\n          value={template.get('iconName')}\n          onChange={updateField('iconName')}\n          autoCapitalize=\"none\"\n          autoCorrect=\"none\"\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or\n        calendar-plus) to use as the capture icon. You can search the available icons{' '}\n        <a\n          href=\"https://fontawesome.com/icons?d=gallery&s=solid&m=free\"\n          target=\"_blank\"\n          rel=\"noopener noreferrer\"\n        >\n          here\n        </a>\n        .\n      </div>\n    </div>\n  );\n\n  const renderOrgFileAvailability = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Available in all org files?</div>\n        <Switch\n          isEnabled={template.get('isAvailableInAllOrgFiles')}\n          onToggle={toggleAvailabilityInAllOrgFiles}\n        />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        You can make this capture template available in all org files, or just the ones you specify.\n        {syncBackendType === 'Dropbox' && (\n          <Fragment>\n            {' '}\n            Specify full paths starting from the root of your Dropbox, like{' '}\n            <code>/org/todo.org</code>\n          </Fragment>\n        )}\n        {syncBackendType === 'Google Drive' && (\n          <Fragment>\n            {' '}\n            Specify the file id of each file. You can find the file id in the URL of the file in\n            organice (e.g.,{' '}\n            <code>\n              /file/\n              {'<file id>'}\n            </code>\n            ).\n          </Fragment>\n        )}\n      </div>\n\n      <Collapse\n        isOpened={!template.get('isAvailableInAllOrgFiles')}\n        springConfig={{ stiffness: 300 }}\n      >\n        <div className=\"multi-textfields-container\">\n          {template.get('orgFilesWhereAvailable').map((orgFilePath, index) => (\n            <div key={`org-file-availability-${index}`} className=\"multi-textfield-container\">\n              <input\n                type=\"text\"\n                placeholder=\"e.g., /org/todo.org\"\n                className=\"textfield multi-textfield-field\"\n                value={orgFilePath}\n                onChange={handleOrgFileAvailabilityChange(index)}\n              />\n              <button\n                className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n                onClick={handleRemoveOrgFileAvailability(index)}\n              />\n            </div>\n          ))}\n        </div>\n\n        <div className=\"add-new-multi-textfield-button-container\">\n          <button\n            className=\"fas fa-plus add-new-multi-textfield-button\"\n            onClick={handleAddNewOrgFileAvailability}\n          />\n        </div>\n      </Collapse>\n    </div>\n  );\n\n  const renderHeaderPaths = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Header path</div>\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        Specify the path to the header under which the new header should be filed. One header per\n        textfield.\n      </div>\n\n      <div className=\"multi-textfields-container\">\n        {template.get('headerPaths').map((headerPath, index) => (\n          <div key={`header-path-${index}`} className=\"multi-textfield-container\">\n            <input\n              type=\"text\"\n              placeholder=\"e.g., Todos\"\n              className=\"textfield multi-textfield-field\"\n              value={headerPath}\n              onChange={handleHeaderPathChange(index)}\n            />\n            <button\n              className=\"fas fa-times fa-lg remove-multi-textfield-button\"\n              onClick={handleRemoveHeaderPath(index)}\n            />\n          </div>\n        ))}\n      </div>\n\n      <div className=\"add-new-multi-textfield-button-container\">\n        <button\n          className=\"fas fa-plus add-new-multi-textfield-button\"\n          onClick={handleAddNewHeaderPath}\n        />\n      </div>\n    </div>\n  );\n\n  const renderPrependField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\">\n        <div>Prepend?</div>\n        <Switch isEnabled={template.get('shouldPrepend')} onToggle={togglePrepend} />\n      </div>\n\n      <div className=\"capture-template__help-text\">\n        By default, new captured headers are appended to the specified header path. Enable this\n        setting to prepend them instead.\n      </div>\n    </div>\n  );\n\n  const renderTemplateField = template => (\n    <div className=\"capture-template__field-container\">\n      <div className=\"capture-template__field\" style={{ marginTop: 7 }}>\n        <div>Template</div>\n      </div>\n\n      <textarea\n        className=\"textarea template-textarea\"\n        rows=\"3\"\n        value={template.get('template')}\n        onChange={updateField('template')}\n      />\n\n      <div className=\"capture-template__help-text\">\n        The template for creating the capture item. You can use the following template variables\n        that will be expanded upon capture:\n        <ul>\n          <li>\n            <code>%?</code> - Place the cursor here.\n          </li>\n          <li>\n            <code>%t</code> - Timestamp, date only.\n          </li>\n          <li>\n            <code>%T</code> - Timestamp, with date and time.\n          </li>\n          <li>\n            <code>%u</code> - Inactive timestamp, date only.\n          </li>\n          <li>\n            <code>%U</code> - Inactive timestamp, with date and time.\n          </li>\n          <li>\n            <code>%{'<custom variable>'}</code> - A custom variable from a URL param capture. See{' '}\n            <a href=\"https://github.com/200ok-ch/organice/#capture-params-and-siri-support\">\n              the README file\n            </a>{' '}\n            for more details.\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n\n  const renderDeleteButton = template => (\n    <div className=\"capture-template__field-container capture-template__delete-button-container\">\n      <button\n        className=\"btn settings-btn capture-template__delete-button\"\n        onClick={handleDeleteClick}\n      >\n        Delete template\n      </button>\n    </div>\n  );\n\n  const caretClassName = classNames(\n    'fas fa-2x fa-caret-right capture-template-container__header__caret',\n    {\n      'capture-template-container__header__caret--rotated': !isCollapsed,\n    }\n  );\n\n  return (\n    <Draggable draggableId={`capture-template--${template.get('id')}`} index={index}>\n      {(provided, snapshot) => (\n        <div\n          className={classNames('capture-template-container', {\n            'capture-template-container--dragging': snapshot.isDragging,\n          })}\n          ref={provided.innerRef}\n          {...provided.draggableProps}\n        >\n          <div className=\"capture-template-container__header\" onClick={handleHeaderBarClick}>\n            <i className={caretClassName} />\n            <ActionButton\n              iconName={template.get('iconName')}\n              letter={template.get('letter')}\n              onClick={() => {}}\n              style={{ marginRight: 20 }}\n            />\n            <span className=\"capture-template-container__header__title\">\n              {template.get('description')}\n            </span>\n            <i\n              className=\"fas fa-bars fa-lg capture-template-container__header__drag-handle\"\n              {...provided.dragHandleProps}\n            />\n          </div>\n\n          <Collapse isOpened={!isCollapsed} springConfig={{ stiffness: 300 }}>\n            <div className=\"capture-template-container__content\">\n              {renderDescriptionField(template)}\n              {renderIconField(template)}\n              {renderOrgFileAvailability(template)}\n              {renderHeaderPaths(template)}\n              {renderPrependField(template)}\n              {renderTemplateField(template)}\n              {renderDeleteButton(template)}\n            </div>\n          </Collapse>\n        </div>\n      )}\n    </Draggable>\n  );\n};\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Droppable } from 'react-beautiful-dnd';\n\nimport './stylesheet.css';\n\nimport * as captureActions from '../../actions/capture';\n\nimport CaptureTemplate from './components/CaptureTemplate';\n\nimport { List } from 'immutable';\n\nconst CaptureTemplatesEditor = ({ captureTemplates, syncBackendType, capture }) => {\n  const handleAddNewTemplateClick = () => capture.addNewEmptyCaptureTemplate();\n\n  const handleFieldPathUpdate = (templateId, fieldPath, newValue) =>\n    capture.updateTemplateFieldPathValue(templateId, fieldPath, newValue);\n\n  const handleAddNewTemplateOrgFileAvailability = templateId =>\n    capture.addNewTemplateOrgFileAvailability(templateId);\n\n  const handleRemoveTemplateOrgFileAvailability = (templateId, orgFileAvailabilityIndex) =>\n    capture.removeTemplateOrgFileAvailability(templateId, orgFileAvailabilityIndex);\n\n  const handleAddNewTemplateHeaderPath = templateId => capture.addNewTemplateHeaderPath(templateId);\n\n  const handleRemoveTemplateHeaderPath = (templateId, headerPathIndex) =>\n    capture.removeTemplateHeaderPath(templateId, headerPathIndex);\n\n  const handleDeleteTemplate = templateId => capture.deleteTemplate(templateId);\n\n  const handleReorderTemplate = (fromIndex, toIndex) =>\n    capture.reorderCaptureTemplate(fromIndex, toIndex);\n\n  return (\n    <div>\n      <Droppable droppableId=\"capture-templates-editor-droppable\" type=\"CAPTURE-TEMPLATE\">\n        {(provided, snapshot) => (\n          <div\n            className=\"capture-templates-container\"\n            ref={provided.innerRef}\n            {...provided.droppableProps}\n          >\n            {captureTemplates.size === 0 ? (\n              <div className=\"no-capture-templates-message\">\n                You don't currently have any capture templates - add one by pressing the{' '}\n                <i className=\"fas fa-plus\" /> button.\n                <br />\n                <br />\n                Capture templates show up in the action drawer and give you quick access to creating\n                new headers (like org-capture).\n              </div>\n            ) : (\n              <Fragment>\n                {captureTemplates.map((template, index) => (\n                  <CaptureTemplate\n                    key={template.get('id')}\n                    index={index}\n                    template={template}\n                    syncBackendType={syncBackendType}\n                    onFieldPathUpdate={handleFieldPathUpdate}\n                    onAddNewTemplateOrgFileAvailability={handleAddNewTemplateOrgFileAvailability}\n                    onRemoveTemplateOrgFileAvailability={handleRemoveTemplateOrgFileAvailability}\n                    onAddNewTemplateHeaderPath={handleAddNewTemplateHeaderPath}\n                    onRemoveTemplateHeaderPath={handleRemoveTemplateHeaderPath}\n                    onDeleteTemplate={handleDeleteTemplate}\n                    onReorder={handleReorderTemplate}\n                  />\n                ))}\n\n                {provided.placeholder}\n              </Fragment>\n            )}\n          </div>\n        )}\n      </Droppable>\n\n      <div className=\"new-capture-template-button-container\">\n        <button className=\"fas fa-plus fa-lg btn btn--circle\" onClick={handleAddNewTemplateClick} />\n      </div>\n    </div>\n  );\n};\n\nconst mapStateToProps = (state, props) => {\n  return {\n    captureTemplates: state.capture.get('captureTemplates', List()),\n    syncBackendType: state.syncBackend.get('client').type,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    capture: bindActionCreators(captureActions, dispatch),\n  };\n};\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(CaptureTemplatesEditor);\n","/* global process, gapi */\n\nimport React, { PureComponent, useState } from 'react';\n\nimport './stylesheet.css';\n\nimport DropboxLogo from './dropbox.svg';\nimport GoogleDriveLogo from './google_drive.png';\n\nimport { persistField } from '../../util/settings_persister';\n\nimport { Dropbox } from 'dropbox';\n\nimport _ from 'lodash';\n\nfunction WebDAVForm() {\n  const [isVisible, setIsVisible] = useState(false);\n  const [url, setUrl] = useState('');\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n\n  return !isVisible ? (\n    <div\n      id=\"webdavLogin\"\n      onClick={() => {\n        setIsVisible(true);\n      }}\n    >\n      <h2>WebDAV</h2>\n    </div>\n  ) : (\n    <div id=\"webdavLogin\">\n      <h2>WebDAV</h2>\n      <form\n        onSubmit={event => {\n          event.preventDefault();\n          persistField('authenticatedSyncService', 'WebDAV');\n          persistField('webdavEndpoint', url);\n          persistField('webdavUsername', username);\n          persistField('webdavPassword', password);\n          window.location = window.location.origin + '/';\n        }}\n      >\n        <p>\n          <label>Url:</label>\n          <input\n            type=\"url\"\n            value={url}\n            className=\"textfield\"\n            onChange={e => {\n              setUrl(e.target.value);\n            }}\n          />\n        </p>\n        <p>\n          <label>Username:</label>\n          <input\n            type=\"text\"\n            className=\"textfield\"\n            value={username}\n            onChange={e => {\n              setUsername(e.target.value);\n            }}\n          />\n        </p>\n        <p>\n          <label>Password:</label>\n          <input\n            type=\"password\"\n            className=\"textfield\"\n            value={password}\n            onChange={e => {\n              setPassword(e.target.value);\n            }}\n          />\n        </p>\n        <input type=\"submit\" value=\"Sign-in\" />\n      </form>\n    </div>\n  );\n}\n\nexport default class SyncServiceSignIn extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, ['handleDropboxClick', 'handleGoogleDriveClick']);\n  }\n\n  handleDropboxClick() {\n    persistField('authenticatedSyncService', 'Dropbox');\n\n    const dropbox = new Dropbox({ clientId: process.env.REACT_APP_DROPBOX_CLIENT_ID, fetch });\n    const authURL = dropbox.getAuthenticationUrl(window.location.origin + '/');\n    window.location = authURL;\n  }\n\n  handleGoogleDriveClick() {\n    try {\n      gapi.load('client:auth2', () => {\n        gapi.client\n          .init({\n            apiKey: process.env.REACT_APP_GOOGLE_DRIVE_API_KEY,\n            clientId: process.env.REACT_APP_GOOGLE_DRIVE_CLIENT_ID,\n            discoveryDocs: ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n            scope: 'https://www.googleapis.com/auth/drive',\n          })\n          .then(() => {\n            persistField('authenticatedSyncService', 'Google Drive');\n\n            gapi.auth2.getAuthInstance().signIn({\n              ux_mode: 'redirect',\n              redirect_uri: window.location.origin,\n            });\n          });\n      });\n    } catch (error) {\n      alert(\n        `The Google Drive API client isn't available - you might be blocking it with an ad blocker`\n      );\n      return;\n    }\n  }\n\n  render() {\n    return (\n      <div className=\"sync-service-sign-in-container\">\n        <p className=\"sync-service-sign-in__help-text\">\n          organice syncs your files with Dropbox, Google Drive and WebDAV.\n        </p>\n        <p className=\"sync-service-sign-in__help-text\">Click to sign in with:</p>\n\n        <div className=\"sync-service-container\" onClick={this.handleDropboxClick}>\n          <img src={DropboxLogo} alt=\"Dropbox logo\" className=\"dropbox-logo\" />\n        </div>\n\n        <div className=\"sync-service-container\" onClick={this.handleGoogleDriveClick}>\n          <img src={GoogleDriveLogo} alt=\"Google Drive logo\" className=\"google-drive-logo\" />\n        </div>\n\n        <div className=\"sync-service-container\">\n          <WebDAVForm />\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { PureComponent, Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\n\nimport { Route, Switch, Redirect, Prompt, withRouter } from 'react-router-dom';\n\nimport './stylesheet.css';\n\nimport { List } from 'immutable';\nimport _ from 'lodash';\nimport classNames from 'classnames';\n\nimport { changelogHash } from '../../lib/org_utils';\nimport PrivacyPolicy from '../PrivacyPolicy';\nimport HeaderBar from '../HeaderBar';\nimport Landing from '../Landing';\nimport FileBrowser from '../FileBrowser';\nimport LoadingIndicator from '../LoadingIndicator';\nimport OrgFile from '../OrgFile';\nimport Settings from '../Settings';\nimport KeyboardShortcutsEditor from '../KeyboardShortcutsEditor';\nimport CaptureTemplatesEditor from '../CaptureTemplatesEditor';\nimport SyncServiceSignIn from '../SyncServiceSignIn';\n\nimport * as syncBackendActions from '../../actions/sync_backend';\nimport * as orgActions from '../../actions/org';\nimport * as baseActions from '../../actions/base';\n\nclass Entry extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    _.bindAll(this, [\n      'renderChangelogFile',\n      'renderSampleFile',\n      'renderFileBrowser',\n      'renderFile',\n      'setChangelogUnseenChanges',\n    ]);\n  }\n\n  componentDidMount() {\n    this.setChangelogUnseenChanges();\n  }\n\n  // TODO: Should this maybe done on init of the application and not in the component?\n  setChangelogUnseenChanges() {\n    const { lastSeenChangelogHash, isAuthenticated } = this.props;\n    changelogHash().then(changelogHash => {\n      const hasChanged =\n        isAuthenticated &&\n        lastSeenChangelogHash &&\n        !_.isEqual(changelogHash, lastSeenChangelogHash);\n\n      this.props.base.setHasUnseenChangelog(hasChanged);\n    });\n  }\n\n  componentDidUpdate() {\n    this.shouldPromptWhenLeaving()\n      ? (window.onbeforeunload = () => true)\n      : (window.onbeforeunload = undefined);\n  }\n\n  componentWillUnmount() {\n    window.onbeforeunload = undefined;\n  }\n\n  renderChangelogFile() {\n    return (\n      <OrgFile\n        staticFile=\"changelog\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActions={true}\n        shouldDisableSyncButtons={false}\n        parsingErrorMessage={\n          \"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderSampleFile() {\n    return (\n      <OrgFile\n        staticFile=\"sample\"\n        shouldDisableDirtyIndicator={true}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={true}\n        parsingErrorMessage={\n          \"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!\"\n        }\n      />\n    );\n  }\n\n  renderFileBrowser({\n    match: {\n      params: { path = '' },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return <FileBrowser path={path} />;\n  }\n\n  renderFile({\n    match: {\n      params: { path },\n    },\n  }) {\n    if (!!path) {\n      path = '/' + path;\n    }\n\n    return (\n      <OrgFile\n        path={path}\n        shouldDisableDirtyIndicator={false}\n        shouldDisableActionDrawer={false}\n        shouldDisableSyncButtons={false}\n      />\n    );\n  }\n\n  shouldPromptWhenLeaving() {\n    return this.props.location.pathname.startsWith('/file/') && this.props.isDirty;\n  }\n\n  render() {\n    const {\n      isAuthenticated,\n      loadingMessage,\n      fontSize,\n      activeModalPage,\n      pendingCapture,\n      location: { pathname },\n    } = this.props;\n\n    const pendingCapturePath = !!pendingCapture && `/file${pendingCapture.get('capturePath')}`;\n    const shouldRedirectToCapturePath = pendingCapturePath && pendingCapturePath !== pathname;\n\n    const className = classNames('entry-container', {\n      'entry-container--large-font': fontSize === 'Large',\n    });\n\n    return (\n      <div className={className}>\n        <HeaderBar />\n\n        <LoadingIndicator message={loadingMessage} />\n\n        <Prompt\n          when={this.shouldPromptWhenLeaving()}\n          message={() => 'You have unpushed changes - are you sure you want to leave this page?'}\n        />\n\n        {activeModalPage === 'changelog' ? (\n          this.renderChangelogFile()\n        ) : isAuthenticated ? (\n          ['keyboard_shortcuts_editor', 'settings', 'capture_templates_editor', 'sample'].includes(\n            activeModalPage\n          ) ? (\n            <Fragment>\n              {activeModalPage === 'keyboard_shortcuts_editor' && <KeyboardShortcutsEditor />}\n              {activeModalPage === 'capture_templates_editor' && <CaptureTemplatesEditor />}\n              {activeModalPage === 'sample' && this.renderSampleFile()}\n            </Fragment>\n          ) : (\n            <Switch>\n              {shouldRedirectToCapturePath && <Redirect to={pendingCapturePath} />}\n              <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n              <Route path=\"/file/:path+\" render={this.renderFile} />\n              <Route path=\"/files/:path*\" render={this.renderFileBrowser} />\n              <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n              <Route path=\"/settings\" exact={true}>\n                <Settings />\n              </Route>\n              <Redirect to=\"/files\" />\n            </Switch>\n          )\n        ) : (\n          <Switch>\n            <Route path=\"/privacy-policy\" exact component={PrivacyPolicy} />\n            <Route path=\"/sample\" exact={true} render={this.renderSampleFile} />\n            <Route path=\"/sign_in\" exact={true} component={SyncServiceSignIn} />\n            <Route path=\"/\" exact={true} component={Landing} />\n            <Redirect to=\"/\" />\n          </Switch>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state, props) => {\n  return {\n    loadingMessage: state.base.get('loadingMessage'),\n    isAuthenticated: state.syncBackend.get('isAuthenticated'),\n    fontSize: state.base.get('fontSize'),\n    lastSeenChangelogHash: state.base.get('lastSeenChangelogHash'),\n    activeModalPage: state.base.get('modalPageStack', List()).last(),\n    pendingCapture: state.org.present.get('pendingCapture'),\n    isDirty: state.org.present.get('isDirty'),\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    syncBackend: bindActionCreators(syncBackendActions, dispatch),\n    org: bindActionCreators(orgActions, dispatch),\n    base: bindActionCreators(baseActions, dispatch),\n  };\n};\n\nexport default withRouter(connect(mapStateToProps, mapDispatchToProps)(Entry));\n","import React, { PureComponent } from 'react';\nimport { Provider } from 'react-redux';\nimport Store from './store';\nimport {\n  readInitialState,\n  loadSettingsFromConfigFile,\n  subscribeToChanges,\n  persistField,\n  getPersistedField,\n} from './util/settings_persister';\nimport runAllMigrations from './migrations';\nimport parseQueryString from './util/parse_query_string';\nimport { BrowserRouter as Router } from 'react-router-dom';\n\nimport { DragDropContext } from 'react-beautiful-dnd';\n\nimport { reorderCaptureTemplate } from './actions/capture';\nimport { reorderTags, reorderPropertyList } from './actions/org';\nimport { signOut } from './actions/sync_backend';\nimport { setDisappearingLoadingMessage } from './actions/base';\n\nimport createDropboxSyncBackendClient from './sync_backend_clients/dropbox_sync_backend_client';\nimport createGoogleDriveSyncBackendClient from './sync_backend_clients/google_drive_sync_backend_client';\nimport createWebDAVSyncBackendClient from './sync_backend_clients/webdav_sync_backend_client';\n\nimport './base.css';\n\nimport Entry from './components/Entry';\n\nimport _ from 'lodash';\nimport { Map } from 'immutable';\n\nexport default class App extends PureComponent {\n  constructor(props) {\n    super(props);\n\n    runAllMigrations();\n\n    const initialState = readInitialState();\n\n    window.initialHash = window.location.hash.substring(0);\n    const hashContents = parseQueryString(window.location.hash);\n    const authenticatedSyncService = getPersistedField('authenticatedSyncService', true);\n    let client = null;\n\n    if (!!authenticatedSyncService) {\n      switch (authenticatedSyncService) {\n        case 'Dropbox':\n          const dropboxAccessToken = hashContents.access_token;\n          if (dropboxAccessToken) {\n            client = createDropboxSyncBackendClient(dropboxAccessToken);\n            initialState.syncBackend = Map({\n              isAuthenticated: true,\n              client,\n            });\n            persistField('dropboxAccessToken', dropboxAccessToken);\n            window.location.hash = '';\n          } else {\n            const persistedDropboxAccessToken = getPersistedField('dropboxAccessToken', true);\n            if (!!persistedDropboxAccessToken) {\n              client = createDropboxSyncBackendClient(persistedDropboxAccessToken);\n              initialState.syncBackend = Map({\n                isAuthenticated: true,\n                client,\n              });\n            }\n          }\n          break;\n        case 'Google Drive':\n          client = createGoogleDriveSyncBackendClient();\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        case 'WebDAV':\n          client = createWebDAVSyncBackendClient(\n            getPersistedField('webdavEndpoint'),\n            getPersistedField('webdavUsername'),\n            getPersistedField('webdavPassword')\n          );\n          initialState.syncBackend = Map({\n            isAuthenticated: true,\n            client,\n          });\n          break;\n        default:\n      }\n    }\n\n    const queryStringContents = parseQueryString(window.location.search);\n    const { captureFile, captureTemplateName, captureContent } = queryStringContents;\n    if (!!captureFile && !!captureTemplateName) {\n      const capturePath = captureFile.startsWith('/') ? captureFile : `/${captureFile}`;\n      const customCaptureVariables = Map(\n        Object.entries(queryStringContents)\n          .map(([key, value]) => {\n            const CUSTOM_VARIABLE_PREFIX = 'captureVariable_';\n            if (key.startsWith(CUSTOM_VARIABLE_PREFIX)) {\n              return [key.substring(CUSTOM_VARIABLE_PREFIX.length), value];\n            }\n\n            return null;\n          })\n          .filter(item => !!item)\n      );\n      initialState.org.present = initialState.org.present.set(\n        'pendingCapture',\n        Map({\n          capturePath,\n          captureTemplateName,\n          captureContent,\n          customCaptureVariables,\n        })\n      );\n    }\n\n    this.store = Store(initialState);\n    this.store.subscribe(subscribeToChanges(this.store));\n\n    if (!!client) {\n      client.isSignedIn().then(isSignedIn => {\n        if (isSignedIn) {\n          loadSettingsFromConfigFile(this.store.dispatch, this.store.getState);\n        } else {\n          this.store.dispatch(signOut());\n        }\n      });\n    } else {\n      if (!!this.store.getState().org.present.get('pendingCapture')) {\n        this.store.dispatch(\n          setDisappearingLoadingMessage(\n            `You need to sign in before you can use capture templates`,\n            5000\n          )\n        );\n      }\n    }\n\n    _.bindAll(this, ['handleDragEnd']);\n  }\n\n  handleDragEnd(result) {\n    if (!result.destination) {\n      return;\n    }\n\n    if (result.type === 'CAPTURE-TEMPLATE') {\n      this.store.dispatch(reorderCaptureTemplate(result.source.index, result.destination.index));\n    } else if (result.type === 'TAG') {\n      this.store.dispatch(reorderTags(result.source.index, result.destination.index));\n    } else if (result.type === 'PROPERTY-LIST') {\n      this.store.dispatch(reorderPropertyList(result.source.index, result.destination.index));\n    }\n  }\n\n  render() {\n    return (\n      <DragDropContext onDragEnd={this.handleDragEnd}>\n        <Router>\n          <Provider store={this.store}>\n            <div className=\"App\">\n              <Entry />\n            </div>\n          </Provider>\n        </Router>\n      </DragDropContext>\n    );\n  }\n}\n","import { fromJS } from 'immutable';\nimport { createClient } from 'webdav';\nimport { isEmpty } from 'lodash';\n\n/**\n * Gets a directory listing ready to be rendered by organice.\n *  - Filters files from `listing` down to org files.\n *  - Sorts folders atop of files.\n *  - Sorts both folders and files alphabetically.\n * @param {Array} listing\n */\nexport const filterAndSortDirectoryListing = listing => {\n  return listing\n    .filter(file => {\n      // Show all folders\n      if (file.type === 'directory') return true;\n      // And only file with the 'org' extension\n      return file.basename.match(/org$|org_archive$/);\n    })\n    .sort((a, b) => {\n      // Folders before files\n      if (a.type === 'directory' && b.type !== 'directory') {\n        return -1;\n      } else {\n        return a.basename > b.basename ? 1 : -1;\n      }\n    });\n};\n\nexport default (url, login, password) => {\n  const webdavClient = createClient(url, { username: login, password: password });\n  const isSignedIn = () =>\n    new Promise(resolve => {\n      // There's no direct API to know if the login worked. So, let's\n      // check if the root folder contents can be accessed.\n      getDirectoryListing('/')\n        .then(() => {\n          resolve(true);\n        })\n        .catch(error => {\n          console.log(\"Login didn't work\");\n          resolve(false);\n        });\n    });\n\n  const transformDirectoryListing = listing => {\n    const sortedListing = filterAndSortDirectoryListing(listing);\n    return fromJS(\n      sortedListing.map(entry => ({\n        id: entry.filename,\n        name: entry.basename,\n        isDirectory: entry.type === 'directory',\n        path: entry.filename,\n      }))\n    );\n  };\n\n  const getDirectoryListing = path =>\n    new Promise((resolve, reject) => {\n      webdavClient\n        .getDirectoryContents(path)\n        .then(response =>\n          resolve({\n            listing: transformDirectoryListing(response),\n          })\n        )\n        .catch(reject);\n    });\n\n  const getMoreDirectoryListing = additionalSyncBackendState => {\n    // TODO\n    return new Promise((resolve, reject) => resolve());\n  };\n\n  const uploadFile = (path, contents) =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .putFileContents(path, contents, { overwrite: true })\n        .then(resolve)\n        .catch(reject)\n    );\n\n  const updateFile = uploadFile;\n  const createFile = uploadFile;\n\n  const getFileContentsAndMetadata = path =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .stat(path)\n        .then(stat => {\n          webdavClient\n            .getFileContents(path, { format: 'text' })\n            .then(response => {\n              resolve({\n                contents: response,\n                lastModifiedAt: new Date(Date.parse(stat.lastmod)).toISOString(),\n              });\n            })\n            .catch(error => {\n              console.error(path, ': get file failed', error);\n              reject();\n            });\n        })\n        .catch(error => {\n          if (error && error.response && [401, 403].indexOf(error.response.status) !== -1)\n            alert(login + '@' + url + ': ' + error.response.statusText);\n          console.error(path, ': get stat failed', error);\n          reject();\n        })\n    );\n\n  const getFileContents = path => {\n    if (isEmpty(path)) return Promise.reject('No path given');\n    return new Promise((resolve, reject) =>\n      getFileContentsAndMetadata(path)\n        .then(({ contents }) => resolve(contents))\n        .catch(reject)\n    );\n  };\n\n  const deleteFile = path =>\n    new Promise((resolve, reject) =>\n      webdavClient\n        .deleteFile(path)\n        .then(resolve)\n        .catch(error => {\n          if (error && error.response && error.response.status === 404) return;\n          console.error(path, ': delete failed', error);\n          reject();\n        })\n    );\n\n  return {\n    type: 'WebDAV',\n    isSignedIn,\n    getDirectoryListing,\n    getMoreDirectoryListing,\n    updateFile,\n    createFile,\n    getFileContentsAndMetadata,\n    getFileContents,\n    deleteFile,\n  };\n};\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\nregisterServiceWorker();\n","module.exports = __webpack_public_path__ + \"static/media/organice.11553f69.svg\";"],"sourceRoot":""}