(this.webpackJsonporganice=this.webpackJsonporganice||[]).push([[0],{224:function(e,t,n){"use strict";function a(e,t,n,r){this.message=e,this.expected=t,this.found=n,this.location=r,this.name="SyntaxError","function"===typeof Error.captureStackTrace&&Error.captureStackTrace(this,a)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(a,Error),a.buildMessage=function(e,t){var n={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}return"Expected "+function(e){var t,a,r,i=new Array(e.length);for(t=0;t<e.length;t++)i[t]=(r=e[t],n[r.type](r));if(i.sort(),i.length>0){for(t=1,a=1;t<i.length;t++)i[t-1]!==i[t]&&(i[a]=i[t],a++);i.length=a}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:a,parse:function(e,t){t=void 0!==t?t:{};var n,r={},i={Expression:Q},o=Q,s=J("filter expression"),c=J("filter term"),l=z("-",!1),u=J("text filter term"),d=J("tag filter term"),h=z(":",!1),p=J("property filter term"),g=J("alternatives"),m=z("|",!1),f=function(e,t){return t.reduce((function(e,t){return e.push(t[1]),e}),[e])},b=J("tag alternatives"),y=J("string"),v=/^[^: \t|'"]/,E=Y([":"," ","\t","|","'",'"'],!0,!1),T=function(){return G()},k=z("'",!1),w=/^[^']/,_=Y(["'"],!0,!1),S=function(e){return e.join("")},I=z('"',!1),O=/^[^"]/,C=Y(['"'],!0,!1),D=J("property name"),A=/^[^: \t]/,N=Y([":"," ","\t"],!0,!1),P=J("tag name"),L=/^[a-zA-Z0-9_@]/,R=Y([["a","z"],["A","Z"],["0","9"],"_","@"],!1,!1),j=J("whitespace"),x=/^[ \t]/,M=Y([" ","\t"],!1,!1),H=0,F=0,B=[{line:1,column:1}],U=0,V=[],W=0;if("startRule"in t){if(!(t.startRule in i))throw new Error("Can't start parsing from rule \""+t.startRule+'".');o=i[t.startRule]}function G(){return e.substring(F,H)}function K(){return q(F,H)}function z(e,t){return{type:"literal",text:e,ignoreCase:t}}function Y(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function J(e){return{type:"other",description:e}}function X(t){var n,a=B[t];if(a)return a;for(n=t-1;!B[n];)n--;for(a={line:(a=B[n]).line,column:a.column};n<t;)10===e.charCodeAt(n)?(a.line++,a.column=1):a.column++,n++;return B[t]=a,a}function q(e,t){var n=X(e),a=X(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}}}function $(e){H<U||(H>U&&(U=H,V=[]),V.push(e))}function Z(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}function Q(){var e,t,n,a,i,o,c,l;for(W++,e=H,t=[],n=ie();n!==r;)t.push(n),n=ie();if(t!==r)if((n=ee())!==r){if(a=[],i=H,o=[],(c=ie())!==r)for(;c!==r;)o.push(c),c=ie();else o=r;for(o!==r&&(c=ee())!==r?i=o=[o,c]:(H=i,i=r);i!==r;){if(a.push(i),i=H,o=[],(c=ie())!==r)for(;c!==r;)o.push(c),c=ie();else o=r;o!==r&&(c=ee())!==r?i=o=[o,c]:(H=i,i=r)}if(a!==r){for(i=[],o=ie();o!==r;)i.push(o),o=ie();i!==r?(F=e,l=n,e=t=a.reduce((function(e,t){return e.push(t[1]),e}),[l])):(H=e,e=r)}else H=e,e=r}else H=e,e=r;else H=e,e=r;if(e===r){for(e=H,t=[],n=ie();n!==r;)t.push(n),n=ie();t!==r&&(F=e,t=[]),e=t}return W--,e===r&&(t=r,0===W&&$(s)),e}function ee(){var t,n,a;return t=H,(n=function(){var t,n,a;W++,t=H,45===e.charCodeAt(H)?(n="-",H++):(n=r,0===W&&$(l));n!==r&&(a=te())!==r?(F=t,(i=a).exclude=!0,t=n=i):(H=t,t=r);var i;t===r&&(t=H,(n=te())!==r&&(F=t,n=function(e){return e.exclude=!1,e}(n)),t=n);W--,t===r&&(n=r,0===W&&$(c));return t}())!==r&&(F=t,(a=n).offset=K().start.offset,a.endOffset=K().end.offset,n=a),t=n}function te(){var t;return(t=function(){var e,t;W++,e=H,(t=ne())!==r&&(F=e,t=function(e){var t="ignore-case";return G().match(/[A-Z]/)&&(t="case-sensitive"),{type:t,words:e}}(t));W--,(e=t)===r&&(t=r,0===W&&$(u));return e}())===r&&(t=function(){var t,n,a,i,o;W++,t=H,58===e.charCodeAt(H)?(n=":",H++):(n=r,0===W&&$(h));n!==r&&(a=function(){var t,n,a;W++,t=H,n=[],A.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(N));if(a!==r)for(;a!==r;)n.push(a),A.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(N));else n=r;n!==r&&(F=t,n=T());W--,(t=n)===r&&(n=r,0===W&&$(D));return t}())!==r?(58===e.charCodeAt(H)?(i=":",H++):(i=r,0===W&&$(h)),i!==r?((o=ne())===r&&(o=null),o!==r?(F=t,t=n={type:"property",property:a,words:null===(s=o)?[""]:s}):(H=t,t=r)):(H=t,t=r)):(H=t,t=r);var s;W--,t===r&&(n=r,0===W&&$(p));return t}())===r&&(t=function(){var t,n,a;W++,t=H,58===e.charCodeAt(H)?(n=":",H++):(n=r,0===W&&$(h));n!==r&&(a=function(){var t,n,a,i,o,s;if(W++,t=H,(n=re())!==r){for(a=[],i=H,124===e.charCodeAt(H)?(o="|",H++):(o=r,0===W&&$(m)),o!==r&&(s=re())!==r?i=o=[o,s]:(H=i,i=r);i!==r;)a.push(i),i=H,124===e.charCodeAt(H)?(o="|",H++):(o=r,0===W&&$(m)),o!==r&&(s=re())!==r?i=o=[o,s]:(H=i,i=r);a!==r?(F=t,n=f(n,a),t=n):(H=t,t=r)}else H=t,t=r;W--,t===r&&(n=r,0===W&&$(b));return t}())!==r?(F=t,t=n={type:"tag",words:a}):(H=t,t=r);W--,t===r&&(n=r,0===W&&$(d));return t}()),t}function ne(){var t,n,a,i,o,s;if(W++,t=H,(n=ae())!==r){for(a=[],i=H,124===e.charCodeAt(H)?(o="|",H++):(o=r,0===W&&$(m)),o!==r&&(s=ae())!==r?i=o=[o,s]:(H=i,i=r);i!==r;)a.push(i),i=H,124===e.charCodeAt(H)?(o="|",H++):(o=r,0===W&&$(m)),o!==r&&(s=ae())!==r?i=o=[o,s]:(H=i,i=r);a!==r?(F=t,t=n=f(n,a)):(H=t,t=r)}else H=t,t=r;return W--,t===r&&(n=r,0===W&&$(g)),t}function ae(){var t,n,a,i;if(W++,t=H,n=[],v.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(E)),a!==r)for(;a!==r;)n.push(a),v.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(E));else n=r;if(n!==r&&(F=t,n=T()),(t=n)===r){if(t=H,39===e.charCodeAt(H)?(n="'",H++):(n=r,0===W&&$(k)),n!==r){if(a=[],w.test(e.charAt(H))?(i=e.charAt(H),H++):(i=r,0===W&&$(_)),i!==r)for(;i!==r;)a.push(i),w.test(e.charAt(H))?(i=e.charAt(H),H++):(i=r,0===W&&$(_));else a=r;a!==r?(39===e.charCodeAt(H)?(i="'",H++):(i=r,0===W&&$(k)),i!==r?(F=t,t=n=S(a)):(H=t,t=r)):(H=t,t=r)}else H=t,t=r;if(t===r)if(t=H,34===e.charCodeAt(H)?(n='"',H++):(n=r,0===W&&$(I)),n!==r){if(a=[],O.test(e.charAt(H))?(i=e.charAt(H),H++):(i=r,0===W&&$(C)),i!==r)for(;i!==r;)a.push(i),O.test(e.charAt(H))?(i=e.charAt(H),H++):(i=r,0===W&&$(C));else a=r;a!==r?(34===e.charCodeAt(H)?(i='"',H++):(i=r,0===W&&$(I)),i!==r?(F=t,t=n=S(a)):(H=t,t=r)):(H=t,t=r)}else H=t,t=r}return W--,t===r&&(n=r,0===W&&$(y)),t}function re(){var t,n,a;if(W++,t=H,n=[],L.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(R)),a!==r)for(;a!==r;)n.push(a),L.test(e.charAt(H))?(a=e.charAt(H),H++):(a=r,0===W&&$(R));else n=r;return n!==r&&(F=t,n=T()),W--,(t=n)===r&&(n=r,0===W&&$(P)),t}function ie(){var t;return W++,x.test(e.charAt(H))?(t=e.charAt(H),H++):(t=r,0===W&&$(M)),W--,t===r&&(r,0===W&&$(j)),t}if((n=o())!==r&&H===e.length)return n;throw n!==r&&H<e.length&&$({type:"end"}),Z(V,U<e.length?e.charAt(U):null,U<e.length?q(U,U+1):q(U,U))}}},233:function(e,t,n){e.exports=n.p+"static/media/dropbox.b53eaec4.svg"},234:function(e,t,n){e.exports=n.p+"static/media/google_drive.f5fd3e02.png"},235:function(e,t,n){e.exports=n(482)},240:function(e,t,n){},279:function(e,t){},281:function(e,t){},313:function(e,t){},314:function(e,t){},393:function(e,t,n){},394:function(e,t,n){},395:function(e,t,n){},396:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},407:function(e,t,n){},409:function(e,t,n){},410:function(e,t,n){},412:function(e,t,n){},413:function(e,t,n){},414:function(e,t,n){},415:function(e,t,n){},416:function(e,t,n){},417:function(e,t,n){},418:function(e,t,n){},419:function(e,t,n){},420:function(e,t,n){},421:function(e,t,n){},422:function(e,t,n){},423:function(e,t,n){},424:function(e,t,n){},425:function(e,t,n){},426:function(e,t,n){},427:function(e,t,n){},428:function(e,t,n){},429:function(e,t,n){},430:function(e,t,n){},431:function(e,t,n){},466:function(e,t,n){},467:function(e,t,n){},468:function(e,t,n){},469:function(e,t,n){},470:function(e,t,n){},471:function(e,t,n){},472:function(e,t,n){},473:function(e,t,n){},474:function(e,t,n){},475:function(e,t,n){},476:function(e,t,n){},477:function(e,t,n){},478:function(e,t,n){},479:function(e,t,n){},480:function(e,t,n){},481:function(e,t,n){},482:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"setLoadingMessage",(function(){return S})),n.d(a,"hideLoadingMessage",(function(){return I})),n.d(a,"setIsLoading",(function(){return O})),n.d(a,"setDisappearingLoadingMessage",(function(){return C})),n.d(a,"setLastViewedFile",(function(){return D})),n.d(a,"loadStaticFile",(function(){return A})),n.d(a,"unloadStaticFile",(function(){return N})),n.d(a,"setFontSize",(function(){return P})),n.d(a,"setBulletStyle",(function(){return L})),n.d(a,"setShouldTapTodoToAdvance",(function(){return R})),n.d(a,"setAgendaDefaultDeadlineDelayUnit",(function(){return j})),n.d(a,"setAgendaDefaultDeadlineDelayValue",(function(){return x})),n.d(a,"setShouldLiveSync",(function(){return M})),n.d(a,"setShouldSyncOnBecomingVisibile",(function(){return H})),n.d(a,"setShouldShowTitleInOrgFile",(function(){return F})),n.d(a,"setShouldStoreSettingsInSyncBackend",(function(){return B})),n.d(a,"setHasUnseenChangelog",(function(){return U})),n.d(a,"setLastSeenChangelogHeader",(function(){return V})),n.d(a,"setCustomKeybinding",(function(){return W})),n.d(a,"restoreBaseSettings",(function(){return G})),n.d(a,"pushModalPage",(function(){return K})),n.d(a,"popModalPage",(function(){return z})),n.d(a,"clearModalStack",(function(){return Y})),n.d(a,"activatePopup",(function(){return J})),n.d(a,"closePopup",(function(){return X}));var r={};n.r(r),n.d(r,"displayFile",(function(){return $e})),n.d(r,"setLastSyncAt",(function(){return Ze})),n.d(r,"stopDisplayingFile",(function(){return Qe})),n.d(r,"sync",(function(){return tt})),n.d(r,"openHeader",(function(){return at})),n.d(r,"toggleHeaderOpened",(function(){return rt})),n.d(r,"selectHeader",(function(){return it})),n.d(r,"selectHeaderAndOpenParents",(function(){return ot})),n.d(r,"advanceTodoState",(function(){return st})),n.d(r,"enterEditMode",(function(){return ct})),n.d(r,"exitEditMode",(function(){return lt})),n.d(r,"updateHeaderTitle",(function(){return ut})),n.d(r,"updateHeaderDescription",(function(){return dt})),n.d(r,"addHeader",(function(){return ht})),n.d(r,"selectNextSiblingHeader",(function(){return pt})),n.d(r,"addHeaderAndEdit",(function(){return gt})),n.d(r,"selectNextVisibleHeader",(function(){return mt})),n.d(r,"selectPreviousVisibleHeader",(function(){return ft})),n.d(r,"removeHeader",(function(){return bt})),n.d(r,"moveHeaderUp",(function(){return yt})),n.d(r,"moveHeaderDown",(function(){return vt})),n.d(r,"moveHeaderLeft",(function(){return Et})),n.d(r,"moveHeaderRight",(function(){return Tt})),n.d(r,"moveSubtreeLeft",(function(){return kt})),n.d(r,"moveSubtreeRight",(function(){return wt})),n.d(r,"refileSubtree",(function(){return _t})),n.d(r,"focusHeader",(function(){return St})),n.d(r,"unfocusHeader",(function(){return It})),n.d(r,"applyOpennessState",(function(){return Ot})),n.d(r,"setDirty",(function(){return Ct})),n.d(r,"setSelectedTableCellId",(function(){return Dt})),n.d(r,"addNewTableRow",(function(){return At})),n.d(r,"removeTableRow",(function(){return Nt})),n.d(r,"addNewTableColumn",(function(){return Pt})),n.d(r,"removeTableColumn",(function(){return Lt})),n.d(r,"moveTableRowDown",(function(){return Rt})),n.d(r,"moveTableRowUp",(function(){return jt})),n.d(r,"moveTableColumnLeft",(function(){return xt})),n.d(r,"moveTableColumnRight",(function(){return Mt})),n.d(r,"updateTableCellValue",(function(){return Ht})),n.d(r,"insertCapture",(function(){return Ft})),n.d(r,"clearPendingCapture",(function(){return Bt})),n.d(r,"insertPendingCapture",(function(){return Ut})),n.d(r,"advanceCheckboxState",(function(){return Vt})),n.d(r,"setHeaderTags",(function(){return Wt})),n.d(r,"reorderTags",(function(){return Gt})),n.d(r,"reorderPropertyList",(function(){return Kt})),n.d(r,"updateTimestampWithId",(function(){return zt})),n.d(r,"updatePlanningItemTimestamp",(function(){return Yt})),n.d(r,"addNewPlanningItem",(function(){return Jt})),n.d(r,"removePlanningItem",(function(){return Xt})),n.d(r,"updatePropertyListItems",(function(){return qt})),n.d(r,"setOrgFileErrorMessage",(function(){return $t})),n.d(r,"setLogEntryStop",(function(){return Zt})),n.d(r,"createLogEntryStart",(function(){return Qt})),n.d(r,"updateLogEntryTime",(function(){return en})),n.d(r,"setSearchFilterInformation",(function(){return tn}));var i={};n.r(i),n.d(i,"addNewEmptyCaptureTemplate",(function(){return on})),n.d(i,"updateTemplateFieldPathValue",(function(){return sn})),n.d(i,"addNewTemplateOrgFileAvailability",(function(){return cn})),n.d(i,"removeTemplateOrgFileAvailability",(function(){return ln})),n.d(i,"addNewTemplateHeaderPath",(function(){return un})),n.d(i,"removeTemplateHeaderPath",(function(){return dn})),n.d(i,"deleteTemplate",(function(){return hn})),n.d(i,"restoreCaptureSettings",(function(){return pn})),n.d(i,"reorderCaptureTemplate",(function(){return gn}));var o={};n.r(o),n.d(o,"signOut",(function(){return xr})),n.d(o,"setCurrentFileBrowserDirectoryListing",(function(){return Mr})),n.d(o,"setIsLoadingMoreDirectoryListing",(function(){return Hr})),n.d(o,"getDirectoryListing",(function(){return Fr})),n.d(o,"loadMoreDirectoryListing",(function(){return Br})),n.d(o,"pushBackup",(function(){return Ur})),n.d(o,"downloadFile",(function(){return Vr}));var s=n(0),c=n.n(s),l=n(61),u=n.n(l),d=(n(240),n(3)),h=n(12),p=n(13),g=n(16),m=n(14),f=n(18),b=n(15),y=n(9),v=n(7),E=n(219),T=n(28),k=n.n(T),w=n(4),_=n.n(w),S=function(e){return{type:"SET_LOADING_MESSAGE",loadingMessage:e}},I=function(){return{type:"HIDE_LOADING_MESSAGE"}},O=function(e){return{type:"SET_IS_LOADING",isLoading:e}},C=function(e,t){return function(n){n(S(e)),setTimeout((function(){return n(I())}),t)}},D=function(e,t){return{type:"SET_LAST_VIEWED_FILE",lastViewedPath:e,lastViewedContents:t}},A=function(e){return function(t,n){t(D(n().org.present.get("path"),n().org.present.get("contents"))),t($e(null,{changelog:"* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application get's pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n",sample:'#+TODO: TODO | DONE\n#+TODO: START INPROGRESS STALLED | FINISHED\n\n* This is an actual org file - feel free to play around with it! (Don\'t worry about messing it up - your changes won\'t be saved, so just refresh the page to reset it)\n* For starters, tap on the next header to open it\nThis header has some description text and a couple subheaders. Look through the next few top level headers to learn more about organice.\n** This is a subheader\n** This is a subheader too!\n* Actions\n** Editing headers\nWhen you select a header the "header action drawer" appears. The first two icons in this drawer edit the header and description respectively. Try editing this header.\n** All icons in the header action bar\n\n1. Pen: Edit header title\n2. Pen in square: Edit header description\n3. Tags: [[https://orgmode.org/manual/Tags.html][Modify tags]]\n4. Properties: [[https://orgmode.org/manual/Properties-and-columns.html][Modify properties]]\n5. Expand: [[https://orgmode.org/manual/Structure-editing.html][Narrow to subtree]] (Focus on this header)\n6. Plus: Create new header below\n7. Mail: Share this header via email\n8. Calendar 1: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set deadline datetime]]\n9. Calendar 2: [[https://orgmode.org/manual/Deadlines-and-scheduling.html][Set scheduled datetime]]\n10. Hourglass: [[https://orgmode.org/manual/Clocking-commands.html][Clock in and out (Start and stop the clock)]]\n11. File Export: [[https://orgmode.org/manual/Refile-and-copy.html][Refile this header to another header]]\n\n** Todos [1/4] [25%]\nThis header has a few TODO items as subheaders.\n*** TODO Learn how to use TODOs in organice\nTo advance the todo state of a header, swipe right on it until the background turns green.\n\nTry advancing the todo state of this header a few times!\n**** There\'s also a setting once you\'re signed in to enable tapping on the TODO label itself to advance the todo state. Its off by default because I thought the behavior would be confusing unless explained, but I recommend turning it on!\n*** DONE Check out organice\n*** START Investigate custom TODO states\norganice also supports [[http://orgmode.org/manual/Workflow-states.html#Workflow-states][custom todo states]] (if declared at the top of the file). Swipe right on this header a few times.\n\nNote that when the cycle restarts, it defaults to the first set of todo states. Manually edit the header to get back to a different todo state cycle (more on editing headers below!)\n*** FINISHED See that custom TODO states are colored correctly\nCustom =org-todo-keywords= keyword sequences can have finish states. They are colored appropriately. You can see that TODO and START headlines are colored red whereas DONE and FINISHED headlines are colored green.\n** Tags\nThe next button in the header action drawer will bring up the tag editor.\n\nThis editor lets you add, modify, and reorder tags, as well as giving you easy access to all tags in the file.\n\nTry it out on these headers:\n*** Dogs\n**** Eloise                                        :cute:middleaged:tiny:dog:\n**** Clooney                                            :cute:young:tiny:dog:\n**** Murphy                                            :cute:young:small:dog:\n**** Starla                                             :cute:old:medium:dog:\n**** Rex                                                :cute:old:medium:dog:\n**** Maz                                          :cute:middleaged:large:dog:\n** Focusing\nThe next button in the header action drawer "focuses" on a header, hiding all others and promoting it to the top level. Press the button again to "unfocus".\n\nThis is purely visual - your org file isn\'t affected under the hood.\n\nI find this useful for focusing on my "Groceries" list when I go to the grocery store. Give it a shot on this grocery list:\n*** Groceries\n- [ ] Mangoes\n- [ ] Dark chocolate\n- [ ] Carrots\n** Adding and removing headers\nTo add a new header, press the + button in the header action drawer\n\nTo remove a header, swipe left on the header until the background turns red.\n** Moving headers\nTo move a header, click on the four-way arrows button at the bottom of the screen with a header selected. 6 buttons will appear for moving headers.\n\nThe center 4 move the header up, down, left, and right. The 2 outermost buttons move the header and its entire nested subtree.\n\nGive them a try on these nested headers to get a feel for how they operate:\n*** A few of my favorite things:\n**** Food\n***** Chocolate\n****** Dark chocolate\n****** Milk chocolate\n****** Crispy chocolate\n***** Mangoes\n**** Text editors\n***** Emacs\n**** Mountain bikes\n***** Santa Cruz\n***** Trek\n***** Giant\n***** Specialized\n**** Dogs\n***** Eloise\n***** Maz\n***** Starla\n***** Rex\n***** Clooney\n** Syncing\nThe "cloud" button in the lower left hand corner syncs changes to your\nchosen sync service (Dropbox, Google Drive or WebDAV).\n\nIf there\'s a newer version on the server and no local changes, it\'ll pull.\n\nIf there\'s no newer version on the server and there are local changes, it\'ll push.\n\nOtherwise, it\'ll ask what you want to do.\n\nThis button isn\'t enabled in this demo :)\n\nIf you\'d like to automatically push changes as you make them, you can enable "Live sync" in settings.\n** Undo / Redo\n   When you\'re signed in, you\'ll have =undo= and =redo= buttons in the\n   headerbar.\n* Tables\norganice has native support for viewing and editing tables.\n\nTry playing around with this one by first clicking on a cell:\n\n| Dog name | Age | Weight (in lbs) | Parent   | Score (1-10) |\n|----------+-----+-----------------+----------+--------------|\n| Eloise   |   3 |             5.1 | Erin     |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Starla   |  15 |              40 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Rex      |  15 |              45 | Sarah S  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Maz      |   1 |              55 | Brittany |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Clooney  | 0.1 |             4.8 | Sarah R  |           15 |\n|----------+-----+-----------------+----------+--------------|\n| Murphy   | 0.5 |              25 | Jordan   |           15 |\n\n** New action drawer items\nWhen a table cell is selected, a table-specific action drawer appears.\n\nThe leftmost icon allows you to edit a cell.\n\nOn the right side, the top two icons let you add and remove rows. The\nbottom two icons let you add and remove columns.\n\n** Moving rows and columns\nWhen a table cell is selected, the four-way arrow button at the bottom\nof the screen changes to manipulate tables.\n\nPress up and down to move rows, and left and right to move columns.\n* Lists and checkboxes\norganice has native support for displaying plain lists and checkboxes\n\nPlain:\n\n- plain list item 1\n- plain list item 2\n  - sub item 1\n- plain list item 3\n\nOrdered:\n\n1. Item 1\n2. Item 2\n20. [@20] Item 20\n21. Item 21\n\nCheckboxes:\n\n- [-] 1 [1/2]\n  - [ ] 1.1 [0%]\n    - [ ] 1.1.1\n  - [X] 1. 2\n- [X] 2\n\nCurrently, plain lists are mostly display only (except that you can check/uncheck checkboxes). If native support for manipulating plain lists is important to you, please let me know by upvoting [[https://github.com/200ok-ch/organice/issues/26][the issue]] on Github\n* Timestamps\norganice has native support for displaying and editing timestamps.\n\nTry tapping on the timestamps below to get a feel for the editor:\n\n<2018-09-17 Sun>\n\n[2018-09-17 Sun]\n\n[2018-09-17 Sun +1d]\n\n[2018-09-17 Sun 10:00-11:30]\n\n<2018-09-17 Sun>--<2018-09-25 Tue>\n* Property lists\norganice has native support for viewing and editing [[https://orgmode.org/guide/Properties.html][property lists]]. To bring up an editor, expand the ~PROPERTIES~ drawer below and tap on any of the properties.\n** Example\n:PROPERTIES:\n:callsign: Maverick\n:eyewear: Aviators\n:launch-date: [1986-05-16 Fri]\n:END:\n* Planning\norganice has native support for adding and editing DEADLINE and SCHEDULED items. It also supports [[https://orgmode.org/manual/Repeated-tasks.html][repeaters]] and [[https://orgmode.org/manual/Deadlines-and-scheduling.html#Deadlines-and-scheduling][delays]]. Check out these examples:\n** An item with a deadline\n   DEADLINE: <2018-10-03 Wed>\n** An item that is scheduled\n   SCHEDULED: <2018-10-18 Thu>\n** An item with both\n   DEADLINE: <2018-10-05 Fri> SCHEDULED: <2018-10-04 Thu>\n** TODO An item with a repeater - try swiping right to advance to the DONE state\n   DEADLINE: <2019-01-03 Thu ++1w>\n   :PROPERTIES:\n   :LAST_REPEAT: [2019-12-08 Sun 11:19]\n   :END:\n   - State "DONE"       from "TODO"       [2019-12-08 Sun 11:19]\n* Capture\norganice supports something like org-capture in the form of customizable, quickly accessible buttons for creating new headers.\n\nClick the button in the bottom right corner of the screen to see some examples. The first button, the lemon, will create a new entry in the "Groceries" list below this. The second button adds an entry to a more deeply nested header.\n\nOnce signed in, you can set up capture templates that specify header paths (and various other configurations). These capture templates can also sync between your devices (if you enable settings sync).\n** Groceries\n** Deeply\n*** Nested\n**** Headers\n***** Work\n****** Too!\n\n* Search / Task List\n\nBelow, there is a button to open up a generic search and a task list.\n\nTap a header in the view to jump to it.\n\nUsing the filter input, you can search for headlines. Specifically, you can search for headline text, TODO keywords, tags, and [[https://orgmode.org/guide/Properties.html][orgmode properties]]. It also supports alternatives, and you can exclude headlines by negating a filter.\n\n** Differences Search and Task List\n\n- In the task list, you can tap on the date to switch to a more readable relative date format.\n- The task list shows only tasks - i.e. headlines with a TODO keyword are displayed.\n  - The tasks will be sorted by state and then date.\n\n** Examples for the search syntax\n\nYou can simply search for\n\n=TODO check out organice|orgmode=\n\nto filter for tasks containing these words. The pipe symbol (|) is a logical /OR/. The filter is a smart-case search:\n\n- Lower-case words mean that the filter ignores the case.\n- If a word contains upper-case letters, the filter is case-sensitive.\n\nThe following example searches for headlines containing *START* or *FINISHED* keywords and the string "states are". You can also use single-quotes.\n\n=START|FINISHED "states are"=\n\nThe next example excludes *DONE* headlines but requires the tag *fun*.\n\n=-DONE  :fun=\n\nYou can exclude text strings, tags, and properties as well by prepending the minus sign (-).\n\nLast but not least, you can search for headlines with defined properties:\n\n=TODO :blocked_by:  :assignee:nobody|none=\n\nThis filters headlines having a property *blocked_by* (with any value) and a property *assignee* with a value containing =nobody= or =none=.\n\n** Auto-completion for filters\n\nYou probably noticed that organice provides suggestions for your filter. After space, =-=, =:=, and =|= you can tap on the completion \u2013 no need to type the tag, property, etc.\n\n** TODO Example with properties\t\t\t\t\t\t\t:fun:\n:PROPERTIES:\n:assignee: nobody\n:blocked_by: the others\n:END:\n\n* Agenda\norganice has a basic agenda view that you can access by tapping the calendar button at the bottom of the page.\n\nTap a header in this view to jump to it, and tap on the date to switch to a more readable relative date format.\n\nThese overdue items with deadlines should show up on today\'s entry:\n** TODO check out the organice agenda view\nDEADLINE: <2018-09-10 Mon>\n** TODO install organice to your phones homescreen\nSCHEDULED: <2018-09-17 Mon>\n* Syncing\norganice pulls down your org files from Dropbox, Google Drive or\nWebDAV. Click the "Sign in" button in the upper right hand corner to\nsign in with either of them and authenticate organice.\n\n** Backups\nThe first time you push changes from organice back up to your chosen\nsync service, organice will make a backup of the original file first.\nIt\'ll be named {your-file-name}.organice-bak. Dropbox and Google Drive\nalso both keep a full version history of your files for you, but this\nis an additional precaution in case something goes wrong pushing the\nfile back up.\n\nGenerally, when working with distributed Org files, we\'re recommending\nto put them under version control and to check for bugs and racing\nconditions between clients.\n* organice operates completely client side\nYou don\'t log in to organice directly because organice doesn\'t have a\nback end - it operates completely client side using Dropbox, Google\nDrive or WebDAV as back-ends.\n* Capture URL params and Siri support\norganice supports a flexible mechanism for capturing using URL parameters. This mechanism integrates very nicely with the new [[https://support.apple.com/guide/shortcuts/welcome/ios][Siri Shortcuts]] feature in iOS 12, allowing you to use Siri to execute capture templates.\n\nYou can use [[https://www.icloud.com/shortcuts/14f91f8cf8f547a183a0734396240984][this sample Shortcut]] to get started with this right away in iOS 12. Open the link on your iOS device and click "Get Shortcut". Then open up the Shortcuts app and edit the template by following the directions in the comments. Then record a Siri trigger and you\'re good to go!\n\nAlternatively, you can take advantage of the URL parameters yourself to build your own custom capture mechanism. You can find more details about this in [[https://github.com/200ok-ch/organice/#capture-params-and-siri-support][the README file]].\n'}[e]))}},N=function(){return function(e,t){e(Qe()),t().base.get("lastViewedPath")&&e($e(t().base.get("lastViewedPath"),t().base.get("lastViewedContents")))}},P=function(e){return{type:"SET_FONT_SIZE",newFontSize:e}},L=function(e){return{type:"SET_BULLET_STYLE",newBulletStyle:e}},R=function(e){return{type:"SET_SHOULD_TAP_TODO_TO_ADVANCE",newShouldTapTodoToAdvance:e}},j=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT",newAgendaDefaultDeadlineDelayUnit:e}},x=function(e){return{type:"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE",newAgendaDefaultDeadlineDelayValue:e}},M=function(e){return{type:"SET_SHOULD_LIVE_SYNC",shouldLiveSync:e}},H=function(e){return{type:"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE",shouldSyncOnBecomingVisibile:e}},F=function(e){return{type:"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE",shouldShowTitleInOrgFile:e}},B=function(e){return function(t,n){if(t({type:"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND",newShouldStoreSettingsInSyncBackend:e}),!e){var a=n().syncBackend.get("client");switch(a.type){case"Dropbox":case"WebDAV":a.deleteFile("/.organice-config.json").catch((function(e,t){return e?null:alert("There was an error trying to delete the .organice-config.json file: ".concat(t))}));break;case"Google Drive":a.deleteFileByNameAndParent(".organice-config.json","root")}window.previousSettingsFileContents=null}}},U=function(e){return{type:"SET_HAS_UNSEEN_CHANGELOG",newHasUnseenChangelog:e}},V=function(e){return{type:"SET_LAST_SEEN_CHANGELOG_HEADER",newLastSeenChangelogHash:e}},W=function(e,t){return{type:"SET_CUSTOM_KEYBINDING",keybindingName:e,keybinding:t}},G=function(e){return{type:"RESTORE_BASE_SETTINGS",newSettings:e}},K=function(e){return{type:"PUSH_MODAL_PAGE",modalPage:e}},z=function(){return{type:"POP_MODAL_PAGE"}},Y=function(){return{type:"CLEAR_MODAL_STACK"}},J=function(e,t){return{type:"ACTIVATE_POPUP",popupType:e,data:t}},X=function(){return{type:"CLOSE_POPUP"}},q=n(65),$=n(1),Z=n(24),Q=n(500),ee=n(220),te=n(94),ne=n(221),ae=n(95),re=n(223),ie=n(483),oe=n(484),se=n(485),ce=n(486),le=n(487),ue=n(488),de=n(489),he=function(e){var t=e.toJS(),n=t.isActive,a=t.year,r=t.month,i=t.day,o=t.dayName,s=t.startHour,c=t.startMinute,l=t.endHour,u=t.endMinute,d=t.repeaterType,h=t.repeaterValue,p=t.repeaterUnit,g=t.delayType,m=t.delayValue,f=t.delayUnit,b="";return b+=n?"<":"[",b+="".concat(a,"-").concat(r,"-").concat(i),b+=o?" ".concat(o):"",b+=s?" ".concat(s,":").concat(c):"",b+=l?"-".concat(l,":").concat(u):"",b+=d?" ".concat(d).concat(h).concat(p):"",b+=g?" ".concat(g).concat(m).concat(f):"",b+=n?">":"]"},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.isActive,n=void 0===t||t,a=e.withStartTime,r=void 0!==a&&a,i=new Date,o={isActive:n,year:Object(Z.a)(i,"yyyy"),month:Object(Z.a)(i,"MM"),day:Object(Z.a)(i,"dd"),dayName:Object(Z.a)(i,"eee"),startHour:null,startMinute:null,endHour:null,endMinute:null,repeaterType:null,repeaterValue:null,repeaterUnit:null,delayType:null,delayValue:null,delayUnit:null};return r&&(o.startHour=Object(Z.a)(i,"HH"),o.startMinute=Object(Z.a)(i,"mm")),o},ge=function(){return"<".concat(Object(Z.a)(new Date,"yyyy-MM-dd eee"),">")},me=function(e){var t=e.toJS(),n=t.year,a=t.month,r=t.day,i=t.startHour,o=t.startMinute,s="".concat(n,"-").concat(a,"-").concat(r);return s+=i&&o?" ".concat(i.padStart(2,"0"),":").concat(o):" 12:00",Object(Q.a)(s,"yyyy-MM-dd HH:mm",new Date)},fe=function(e,t,n){return{h:Object(ee.a)(e,t),d:Object(te.a)(e,t),w:Object(ne.a)(e,t),m:Object(ae.a)(e,t),y:Object(re.a)(e,t)}[n]},be=function(e,t){var n=[e,t].map(me),a=Object(d.a)(n,2),r=a[0],i=a[1],o=" ";if(r>i){o="-";var s=[i,r];r=s[0],i=s[1]}var c=Object(de.a)(i,r),l=Math.floor(c/60);l>=10&&(o="");var u=c%60,h=u>=10?u:"0".concat(u);return"".concat(o).concat(l,":").concat(h)},ye=function(e){return e.map((function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":return e.getIn(["contents","title"])?e.getIn(["contents","title"]):e.getIn(["contents","uri"]);case"table":default:return""}})).join("")},ve=function(e){if(!e)return"";var t=e.map((function(e){return e.get("type")})).unshift(null);return e.zip(t).map((function(e){var t,n=Object(d.a)(e,2),a=n[0],r=n[1],i="";switch(a.get("type")){case"text":i=a.get("contents");break;case"link":i=(t=a).getIn(["contents","title"])?"[[".concat(t.getIn(["contents","uri"]),"][").concat(t.getIn(["contents","title"]),"]]"):"[[".concat(t.getIn(["contents","uri"]),"]]");break;case"fraction-cookie":i="[".concat(a.getIn(["fraction",0])||"","/").concat(a.getIn(["fraction",1])||"","]");break;case"percentage-cookie":i="[".concat(a.get("percentage")||"","%]");break;case"table":i=function(e){var t=e.get("contents").map((function(e){return Math.max.apply(Math,Object(q.a)(e.get("contents").map((function(e){return(_.a.countBy(e.get("rawContents"))["\n"]||0)+1}))))})).toJS(),n=e.getIn(["contents",0,"contents"]).size,a=_.a.times(n).map((function(t){return Math.max.apply(Math,Object(q.a)(e.get("contents").map((function(e){var n=e.getIn(["contents",t,"contents"]),a=ye(n).split("\n").map((function(e){return e.trim().length}));return Math.max.apply(Math,Object(q.a)(a))}))))}));return _.a.dropRight(_.a.flatten(e.get("contents").map((function(e,n){var r=t[n],i=_.a.times(r).map((function(t){return e.get("contents").map((function(e,n){var r=e.get("contents"),i=ye(r).split("\n").map((function(e){return e.trim().length})),o=(e.get("rawContents").split("\n")[t]||"").trim(),s=a[n]-i[t];return o+" ".repeat(s)})).toJS().join(" | ")})).map((function(e){return"| ".concat(e," |")})),o="|"+a.map((function(e){return"-".repeat(e+2)})).join("+")+"|";return i.concat(o)})).toJS())).join("\n")}(a);break;case"list":i=function(e){var t=e.get("bulletCharacter"),n=0;return e.get("items").map((function(a){var r=e.get("isOrdered")||"*"!==t?"":" ",i=ve(a.get("titleLine")),o=ve(a.get("contents")),s=o.split("\n").map((function(e){return e.trim()?"".concat(r,"  ").concat(e):""})).join("\n"),c=null;if(e.get("isOrdered")){var l=++n,u=a.get("forceNumber");if(u&&(n=l=u),c="".concat(l).concat(e.get("numberTerminatorCharacter")),u&&(c+=" [@".concat(u,"]")),a.get("isCheckbox")){var d={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];c+=" [".concat(d,"]")}c+=" ".concat(i)}else{if(c="".concat(r).concat(t),a.get("isCheckbox")){var h={checked:"X",unchecked:" ",partial:"-"}[a.get("checkboxState")];c+=" [".concat(h,"]")}c+=" ".concat(i)}return o&&(c+="\n".concat(s)),c})).join("\n")}(a);break;case"timestamp":i=function(e){var t=he(e.get("firstTimestamp"));return e.get("secondTimestamp")&&(t+="--".concat(he(e.get("secondTimestamp")))),t}(a);break;case"url":case"www-url":case"e-mail":case"phone-number":i=a.get("content");break;default:console.error("Unknown attributed string part type in attributedStringToRawText: ".concat(a.get("type")))}return(["list","table"].includes(r)?"\n":"")+i})).join("")},Ee=function(e,t){var n="";return t&&(n+="*".repeat(e.nestingLevel)),e.titleLine.todoKeyword&&(n+=" ".concat(e.titleLine.todoKeyword)),n+=" ".concat(e.titleLine.rawTitle),e.titleLine.tags.length&&(n+=":".concat(e.titleLine.tags.filter((function(e){return!!e})).join(":"),":")),t||(n=n.substring(1)),n},Te=function(e,t,n,a){var r="";n.size>0&&(r=n.join("\n")+"\n"),t.get(0).get("default")||(r=r+t.map((function(e){return e.get("configLine")})).join("\n")+"\n"),a.size>0&&(r+=a.join("\n")),r.length>0&&(r+="\n");var i=e.toJS().map((function(e){var t=" ".repeat(e.nestingLevel+1),n=Ee(e,!0);if(e.planningItems.length){var a=e.planningItems.map((function(e){return"".concat(e.type,": ").concat(he(Object($.fromJS)(e.timestamp)))})).join(" ").trimRight();n+="\n".concat(t).concat(a)}if(e.propertyListItems.length){var r=e.propertyListItems.map((function(e){return"".concat(t,":").concat(e.property,": ").concat(ve(Object($.fromJS)(e.value)))})).join("\n");n+="\n".concat(t,":PROPERTIES:"),n+="\n".concat(r),n+="\n".concat(t,":END:\n")}if(e.logBookEntries.length){var i=e.logBookEntries.map((function(e){return void 0!==e.raw?e.raw?"".concat(t).concat(e.raw):"":null===e.end?"".concat(t,"CLOCK: ").concat(he(Object($.fromJS)(e.start))):"".concat(t,"CLOCK: ").concat(he(Object($.fromJS)(e.start)),"--").concat(he(Object($.fromJS)(e.end))," => ").concat(be(Object($.fromJS)(e.start),Object($.fromJS)(e.end)))})).join("\n").trimRight();n+="\n".concat(t,":LOGBOOK:"),n+="\n".concat(i),n+="\n".concat(t,":END:\n")}return e.description.length>0?(e.rawDescription.startsWith("\n")||0===e.rawDescription.length||(n+="\n"),n+=e.rawDescription):n=n.trimRight(),n})).join("\n");return r+i+(i.endsWith("\n")?"":"\n")},ke=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object($.Map)();if(!e)return["",null];var n={"%t":"<".concat(Object(Z.a)(new Date,"yyyy-MM-dd eee"),">"),"%T":"<".concat(Object(Z.a)(new Date,"yyyy-MM-dd eee HH:mm"),">"),"%u":"[".concat(Object(Z.a)(new Date,"yyyy-MM-dd eee"),"]"),"%U":"[".concat(Object(Z.a)(new Date,"yyyy-MM-dd eee HH:mm"),"]")};t.entrySeq().forEach((function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n["%".concat(a)]=r}));var a=e;_.a.entries(n).forEach((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return a=a.replace(RegExp(n,"g"),r)}));var r=a.includes("%?")?a.indexOf("%?"):null;return[a=a.replace(/%\?/,""),r]},we=n(499),_e=function(){var e=1;return function(){return e++}}();var Se=function(){return new Promise((function(e,t){var n;(n="* General\n\nAll user visible changes to organice will be documented in this file.\n\nWhen there are updates to the changelog, you will be notified and see a 'gift' icon appear on the top right corner.\n\n* [2020-02-09 Sun]\n\n** Added\n   - Comprehensive documentation: https://organice.200ok.ch/documentation.html\n     - You can find the link from the 'settings' screen or on top of\n       the readme.\n\n* [2020-01-27 Mon]\n\n** Fixed\n   - When editing a =:LOGBOOK:= drawer within a headers description,\n     the relevant logbook entries are updated (which might entail them\n     being deleted).\n\n* [2020-01-20 Mon]\n\n** Fixed\n   - When refiling a header, don't show subheaders in the refile drawer\n   - When doing a 'Search' or 'Refile', the action is reflected in the\n     name of the opening drawer.\n   - In the agenda view, fix relative time distance for future dates\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/240][PR]] \ud83d\ude4f\n\n* [2020-01-15 Wed]\n\n** Fixed\n   - Put Floating Action Button \"Move a header\" into the middle of the\n     screen, so that it has enough space to render all arrows on\n     mobile devices.\n\n* [2020-01-14 Tue]\n\n** Added\n   - Notify on changes for changelog\n     - This is done with a similar UX than other productivity apps\n       (like Slack) do it. The user will see a 'gift' icon whenever\n       there's a change to the changelog she has not seen, yet.\n\n* [2020-01-13 Mon]\n\n** Added\n   - \"Show Org filename in Header\" is configurable in settings and\n     off by default\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/229][PR]] \ud83d\ude4f\n\n** Fixed\n   - Show error message when using a capture template with a badly\n     configured header path\n\n* [2020-01-12 Sun]\n\n** Added\n   - Make HeaderBar sticky\n     - Making undo/redo, file browser and help always available\n       (before it was required to scroll all the way to the top)\n   - Deselect headline by clicking into the title (or empty space) in\n     the HeaderBar\n   - Show Org filename in Header\n\n** Fixed\n   - *Major synchronization improvements*\n     1. After undo/redo, synchronize Org file\n     2. Debounce Sync\n        1. When a user changes things quickly (which happens easily\n           when having 'live sync' enabled and using undo/redo for\n           example), multiple syncs ran in parallel. The back-ends\n           will either get confused or fail with errors (429 too many\n           write operations). In any case, likely the last written\n           state would not have been the state of the Org file in\n           organice.\n     3. Safeguard against concurrent sync requests to the back-end\n     4. In case of synchronization error, show the error to the user\n        and retry synchronization\n     5. Don't actually sync a whole Org file for an empty header.\n        When the user adds some data and triggers\n        UPDATE_HEADER_TITLE, then it makes sense to save it.\n\n* [2020-01-11 Sat]\n\n** Added\n   - All HeaderActionItems are undoable and redoable\n\n** Fixed\n   - Parsing planning items followed by a a checkbox\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/222/files][PR]] \ud83d\ude4f\n* [2020-01-07 Tue]\n\n** Added\n   - *Refile*\n     - When reviewing the captured data, you may want to refile or to\n       copy some of the entries into a different list, for example\n       into a project.\n   - Add button in HeaderActionBar to open property editor\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/195][PR]] \ud83d\ude4f\n\n** Changed\n   - All HeaderActionDrawer actions have icons. The icons are\n     documented in sample.org and have a mouseover title.\n\n* [2020-01-04 Sat]\n\n** Added\n   - Ability to search headlines\n     - It has the same syntax as the search field in the Task List\n       feature\n\n** Fixed\n   - Sort order in Task List\n     - Tasks were only ordered by their planning item dates. This\n       implied that tasks that were long DONE would be shown first.\n     - Now, tasks in the Task list are sorted by state and then date.\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/207][PR]] \ud83d\ude4f\n\n\n* [2020-01-02 Thu]\n\n** Added\n   - Place cursor after the TODO keyword when creating a new header\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/193][PR]] \ud83d\ude4f\n   - Highlight verbatim markup\n\n** Changes\n   - Highlight cookies and cookie percentages according to Solarized\n     color scheme\n\n** Fixed\n   - Don't update search results when using an invalid search filter\n   - On mobile: Styling of Search / Task List drawer when searching all\n     headlines\n   - On mobile: Ability to scroll Search / Task List\n   - Teach #+TODO parser to understand (..) suffix\n     - Thank you [[https://github.com/aspiers][aspiers]] for your [[https://github.com/200ok-ch/organice/pull/202][PR]] \ud83d\ude4f\n\n* [2020-01-01 Wed]\n\n** Added\n   - Support single- and double-quoted strings in the search filter\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/176][PR]] \ud83d\ude4f\n   - Trim whitespace for entered or updated headlines\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/177][PR]] \ud83d\ude4f\n\n** Fixed\n   - Capture templates in iOS 13.3 are positioned properly\n     - iOS 13 introduced a styling regression when setting focus\n       without user interaction. iOS 13.3 reverts to the way other\n       browsers do it.\n\n** Changed\n   - Revert \"Move HeaderActionDrawer before headline\"\n     - As per #188, the changes introduced in #100 didn't fare well\n       with the community. Hence, as a first step to improve UX,\n       we're reverting to the previous state.\n\n* [2019-12-31 Tue]\n\n** Added\n   - *Searching of headlines/todos with a composable query language*\n     - Thank you [[https://github.com/schoettl][@schoettl]] for the [[https://github.com/200ok-ch/organice/pull/154][PR]] \ud83d\ude4f\n   - Routing for Settings (/settings) and Sample (/sample)\n   - Routing for Agenda and TaskList\n\n** Changes\n   - The action for capture templates now uses a more idiomatic\n     'plus' icon instead of a 'list' icon\n\n* [2019-12-28 Sat]\n\n** Added\n   - Proper coloring of DONE todoKeywords from custom todo sequences\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/165][PR]]!\n   - Place TODO keyword of previous header in the new header\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/164][PR]]!\n\n** Changed\n   - Refactor current Org parser and regex\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/161][PR]]!\n\n* [2019-12-26 Thu]\n\n** Added\n\n   - \"Share\" button for headlines (sharing via email)\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/145][PR]]!\n   - Automatically render links for URLs with www prefix, but without\n     protocol\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/159][PR]]!\n\n* [2019-12-25 Wed]\n\n** Added\n\n   - Suggestion list for inputs in property editor\n     - To minimize typing and typos, add smart completion for property\n       names and values in the PropertyListEditorModal.\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/144][PR]]!\n\n* [2019-12-24 Tue]\n** Added\n\n   - *Automatically render links for URLs, e-mail addresses and phone\n     numbers*\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/147][PR]]!\n\n   - Suggestion list for inputs in tag editor\n     - Thank you [[https://github.com/schoettl][schoettl]] for your [[https://github.com/200ok-ch/organice/pull/149][PR]]!\n\n* [2019-12-17 Tue]\n** Changed\n   - Improve webdav url input\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/139][PR]]!\n** Fixed\n   - Make \"privacy policy\" sticky to the bottom of the landing page\n     - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/140][PR]]!\n\n* [2019-12-15 Sun]\n\n** Changed\n   - UX: Move Org header actions before selected headline\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/136][PR]]!\n\n** Fixed\n   - Android PWA implementation was broken (issue [[https://github.com/200ok-ch/organice/issues/134][#134]])\n     - It required two more icon sizes\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/135][PR]]!\n\n* [2019-12-10 Tue]\n\n** Added\n\n   - *Docker Support*\n   - The CI/CD workflow now also builds a Docker container which is\n     then published to\n     https://hub.docker.com/repository/docker/twohundredok/organice\n   - Thank you [[https://github.com/dotcs][dotcs]] for your [[https://github.com/200ok-ch/organice/pull/133][PR]]!\n\n* [2019-12-08 Sun]\n\n** Added\n\n   - As a user, when I'm on a headline with a planning item (schedule\n     or deadline), I want to be able to remove it.\n\n* [2019-11-29 Fri]\n\n** Fixed\n\n   - Clicking the Timestamp in a TODO within the agenda toggles from\n     the date to a human readable timespan\n\n* [2019-11-27 Wed]\n\n** Added\n\n   - Instructions on configuring Nextcloud+haproxy to allow WebDAV\n   - Documentation on how to share from Nextcloud using WebDAV\n   - Thank you [[https://github.com/runejuhl][runejuhl]] for your [[https://github.com/200ok-ch/organice/pull/122][PR]]!\n\n* [2019-11-25 Mon]\n\n** Added\n   - Honor the 'nologrepeat' option\n     - It can be set via =#+STARTUP:= or as a property\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/119][PR]]!\n\n* [2019-11-22 Fri]\n\n** Fixed\n\n   - Handle non-clock entries in =:LOGBOOK:= drawers\n     - Fixes [[https://github.com/200ok-ch/organice/issues/111][issue #111]], [[https://github.com/200ok-ch/organice/issues/108][issue #108]] and [[https://github.com/200ok-ch/organice/issues/110][issue #110]]\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/112][PR]]!\n\n* [2019-11-21 Thu]\n\n** Fixed\n\n   - Safeguard against potential Dropbox SDK Bug\n     - More information in [[https://github.com/200ok-ch/organice/issues/108][issue #108]]\n\n* [2019-11-19 Tue]\n\n** Changed\n\n   - Don't put newlines after headers with no content, add newline at EOF\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/106][PR]]!\n\n* [2019-11-14 Thu]\n\n** Added\n\n   - *Clocking work time*\n     - Org mode allows you to clock the time you spend on specific\n       tasks in a project:\n       https://orgmode.org/manual/Clocking-Work-Time.html#Clocking-Work-Time\n     - organice is compatible with logbook clocking, now\n     - You can 'clock in' and 'clock out' to a header\n     - Thank you [[https://github.com/jamesnvc][@jamesnvc]] for your [[https://github.com/200ok-ch/organice/pull/103][PR]]!\n\n* [2019-10-31 Thu]\n\n** Fixed\n   - Keep all in-file settings and content lines from top of file\n     - Thank you [[https://github.com/andersjohansson][@andersjohansson]] for your [[https://github.com/200ok-ch/organice/pull/90][PR]]!\n\n* [2019-10-29 Tue]\n\n** Added\n   - Show login options as clickable links with cursor pointer\n   - Also improve wording with regards to login options\n     - Thank you [[https://github.com/rodrigomaia17][@rodrigomaia17]] for your [[https://github.com/200ok-ch/organice/pull/88][PR]]!\n\n\n* [2019-10-26 Sat]\n\n** Added\n   - *WebDAV as a sync backend!*\n     - Thank you [[https://github.com/TristanCacqueray][@TristanCacqueray]] for your [[https://github.com/200ok-ch/organice/pull/82][PR]]!\n\n   - As a user, when I swipe a header, I want the icon to contrast\n     the background, so that better see the action taken\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/78][PR]]!\n\n   - As a user, when I hover a clickable element, I want my cursor to\n   change, so that I can see that it is clickable.\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/79][PR]]!\n\n** Fixed\n   - Do not throw an error when clearing a planning item\n     - Thank you [[https://github.com/ragone][@ragone]] for your [[https://github.com/200ok-ch/organice/pull/81][PR]]!\n\n* [2019-10-02 Wed]\n\n** Fixed\n\n- On iOS 13, fix the regression which made capture input fields hide\n  under the keyboard\n  - More information and screenshots in the ticket: https://github.com/200ok-ch/organice/issues/46\n  - Turns out this issue is non trivial to fix and requires specific\n    rules for every size of iPhone. I tested against the Xs and 6s. If\n    you have a different form factor and the capture template input\n    screen looks off to you, please send me a screenshot of what it\n    looks like and I'll add the dimensions for your form factor right\n    away!\n\n* [2019-09-28 Sat]\n\n** Added\n\n- Implemented a =redo= Button next to the =undo= button\n\n* [2019-09-21 Sat]\n\n** Fixed\n\n- Parser bug which would interpret *bold* statements in the beginning\n  of a line as a header.\n- Parser bug which would delete newlines between headers and items\n\n** Changed\n\n- @MTrost [[https://github.com/200ok-ch/organice/pull/45][introduced]] a new testing library called [[https://testing-library.com/docs/intro][React Testing\n  Library]] which greatly simplified writing interaction tests.\n\n* [2019-09-19 Thu]\n\n** Changed\n\n- Constraining to a max width and centering for tablets and bigger\n\n* [2019-09-15 Sun]\n\n** Fixed\n\n- The 'Sync on application becoming visible' feature works on iOS and\n  Safari\n  - If enabled, the current org file is pulled from the sync backend\n    when the browser tab becomes visible. This prevents you from\n    having a stale file before starting to make changes to it.\n\n* [2019-09-08 Sun]\n** Added\n\n- Documented how to use organice from a bookmarklet using the capture\n  template feature\n\n* [2019-09-06 Fri]\n** Fixed\n\n- Removed Google Analytics tracking, because it has no place here\n\n* [2019-09-02 Mon]\n\n** Added\n\n- Configure Google Drive for the free community version of organice at\n  https://organice.200ok.ch\n- Documented SPA routing for self-hosting\n- Wrote and publicized a Privacy Policy\n\n* [2019-08-27 Tue]\n\n** Changed\n\n- Color scheme has been ported to the popular [[https://ethanschoonover.com/solarized/][Solarized]] (light mode)\n  - Whilst doing so, CSS variables have been introduced, so that\n    there's not a whole lot of repetition of magic rgb values going on\n  - The logo has been adapted, too\n- The landing page and settings screens have been de-cluttered\n\n* [2019-08-26 Mon]\n\n** Added\n\n- Continuous deployment: Merging to =master= triggers a build on CI\n  and when successful, it triggers a deploy to https://org.200ok.ch\n- Add a new temporary\u2122 logo: [[file:public/organice.png][organice.png]]\n\n* [2019-08-25 Sun]\n\n** Added\n\n- Since we want organice to be a community driven project, we have added:\n  - [[file:CODE_OF_CONDUCT.org][Code of conduct]]\n  - [[file:CONTRIBUTING.org][Contributing guidelines]]\n\n- Add [[https://circleci.com/][CircleCI]] to run the tests on every commit\n  - They are also integrated as a check for PRs with the benefit that\n    contributors get automated feedback by running the regression test\n    suite.\n\n- Add [[https://greenkeeper.io][Greenkeeper]] for automated dependency management\n\n- Add [[https://codeclimate.com][Codeclimate]] for automated maintainability analysis\n\n** Changed\n\n- Upgraded to Node 12.9\n\n* [2019-08-12 Mon]\n\n** Changed\n\n- The default keybindings (when used from a desktop browser) are now\n  more in line with the defaults in Emacs itself\n\n** Fixed\n\n- The keybindings work on non-macOS operating systems\n\n* [2019-08-10 Sat]\n\n** Added\n\n- As a user, when in a directory listing, I want the folders and files\n  to be sorted alphabetically. Furthermore, I only want to see files\n  that organice can open (that is org and org archive files).\n- Note: This is only implemented for the Dropbox back-end at this time.\n\n** Changed\n\n- Filters files from a directory listing down to org files.\n- Sorts folders atop of files.\n- Sorts both folders and files alphabetically.\n\n\n* [2019-08-05 Mon]\n\n** Added\n\n- When the browser tab becomes visible, pull the latest version of the\n  Org file\n  - This is rather helpful when the app is used in production. Since\n    the production build supports loading the complete application and\n    org-file from cache, it can be open for a very long time. When the\n    org-file hasn't been pulled in a \"very long time\"\u2122, then chances\n    are non-nil that the file has been changed by another client in\n    the meantime.\n  - Without this change, when the user opens the app after a while,\n    makes changes to the file and wants to sync to the back-end, there\n    might be the message \"Since you last pulled, a newer version of\n    the file has been pushed to the server.\". Now the user has two\n    conflicting versions of the same file and can only chose to keep\n    one (Which in itself is great UX and great error handling for\n    cases in which we do encounter a merge conflict, of course!).\n  - This situation is mitigated with this change. Now the user has the\n    option to enable \"Sync on application becoming visible\" which acts\n    similarly to \"Live Sync\". When the user opts to use this feature,\n    whenever the application get's pulled from the background or\n    started through the service worker, the first thing that happens\n    it that a new version of the org-file is pulled from the server.\n    It's therefore much harder for the user to create conflicts.\n\n* [2019-08-04 Sun]\n\n** Fixed\n\n- Parser doesn't break indentation of existing files in fewer places\n- Planning Items are formatted as in Emacs Org mode\n- Properties are formatted as in Emacs Org mode\n- Tags are formatted as in Emacs Org mode\n\n\n* [2019-08-03 Sat]\n\n** Added\n\n- Documented deployment options\n  - People have been asking for tighter access restrictions.\n  - Imo the best answer to that request is to make it as easy as\n    possible to host organice.\n  - There's myriads of good options, of course. I picked to document\n    two that will (potentially) be cost-free to the users and which\n    are very easy and quick to set up: Ftp and Heroku.\n\n** Fixed\n\n- Tests on =master= were red\n  - Partly due to obsolete tests\n  - Partly because tests weren't updated according to changes in the code\n".split("").map((function(e){return e.charCodeAt(0)})),new Promise((function(e,t){crypto.subtle.digest({name:"SHA-256"},new Uint8Array(n)).then((function(t){e(_.a.values(new Uint8Array(t)).join(""))}))}))).then((function(t){e(t)}))}))},Ie=function(e,t){return e.findIndex((function(e){return e.get("id")===t}))},Oe=function(e,t){return e.get(Ie(e,t))},Ce=function(e,t){var n=Oe(e,t),a=Ie(e,t),r=e.slice(a+1),i=r.findIndex((function(e){return e.get("nestingLevel")<=n.get("nestingLevel")}));return-1===i?r:r.slice(0,i)},De=function(e,t){return Ce(e,t).size},Ae=function(e,t){var n=Oe(e,t),a=Ie(e,t),r=e.slice(0,a).reverse().find((function(e){return e.get("nestingLevel")<n.get("nestingLevel")}));return r?r.get("id"):null},Ne=function e(t,n){var a=Ae(t,n);if(!a)return!0;var r=Oe(t,a);return r.get("opened")&&e(t,r.get("id"))},Pe=function(e,t){var n=function(e,t){for(var n=Oe(e,t),a=Ie(e,t)-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")===n.get("nestingLevel")-1)return r.get("id");if(r.get("nestingLevel")<n.get("nestingLevel"))return null}return null}(e.get("headers"),t);if(null!==n){var a=Ie(e.get("headers"),n);e=e.setIn(["headers",a,"opened"],!0)}return e},Le=function e(t,n){if(0===n.size)return null;var a=t.find((function(e){return null===Ae(t,e.get("id"))&&e.getIn(["titleLine","rawTitle"]).trim()===n.first().trim()}));return a?1===n.size?a:e(Ce(t,a.get("id")),n.rest()):null},Re=function(e,t){return e.get("contents").some((function(e){return e.get("contents").some((function(e){return e.get("id")===t}))}))},je=function(e,t){return e.find((function(e){return function e(t,n){return t.filter((function(e){return["table","list"].includes(e.get("type"))})).some((function(t){return"table"===t.get("type")?Re(t,n):t.get("items").some((function(t){return e(t.get("contents"),n)}))}))}(e.get("description"),t)}))},xe=function e(t,n){return t.map((function(t,a){return"timestamp"===t.get("type")&&t.get("id")===n?{path:[a],timestampPart:t}:"list"===t.get("type")?t.get("items").map((function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.timestampPart;return{path:[a,"items",r,"contents"].concat(o),timestampPart:s}}var c=e(t.get("titleLine"),n);if(c){var l=c.path,u=c.timestampPart;return{path:[a,"items",r,"titleLine"].concat(l),timestampPart:u}}return null})).filter((function(e){return!!e})).first():"table"===t.get("type")?t.get("contents").map((function(t,r){return t.get("contents").map((function(t,i){var o=e(t.get("contents"),n);if(o){var s=o.path,c=o.timestampPart;return{path:[a,"contents",r,"contents",i,"contents"].concat(s),timestampPart:c}}return null})).filter((function(e){return!!e})).first()})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()},Me=function(e,t){return e.map((function(e,n){var a=function e(t,n){return t.map((function(t,a){return"table"===t.get("type")?Re(t,n)?{path:[a],tablePart:t}:null:"list"===t.get("type")?t.get("items").map((function(t,r){var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.tablePart;return{path:[a,"items",r,"contents"].concat(o),tablePart:s}}return null})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()}(e.get("description"),t);if(!a)return null;var r=a.path,i=a.tablePart;return{path:[n,"description"].concat(r),tablePart:i}})).filter((function(e){return!!e})).first()},He=function(e,t,n){var a=Me(e,t),r=a.path,i=a.tablePart,o=i.get("contents").findIndex((function(e){return e.get("contents").some((function(e){return e.get("id")===t}))})),s=i.getIn(["contents",o,"contents"]).findIndex((function(e){return e.get("id")===t}));return e.updateIn(r.concat(["contents"]),n(o,s))},Fe=function(e,t){if(!e)return null;var n=xe(e,t);return n?n.timestampPart:null},Be=function(e){return Object(we.a)(e,{addSuffix:!0})},Ue=function(e,t){return e.find((function(e){return e.get("keywords").contains(t)}))||e.first()},Ve=function(e){return e.flatMap((function(e){return e.getIn(["titleLine","tags"])})).toSet().sort()},We=function(e){return e.map((function(e){return e.get("propertyListItems").map((function(e){var t=e.get("property"),n=e.get("value");return[t,ve(n)]}))})).filter((function(e){return!e.isEmpty()})).flatten()},Ge=function(e){return e.map((function(e){return Object(d.a)(e,1)[0]})).toSet().sort()},Ke=function(e,t){return e.filter((function(e){return Object(d.a)(e,1)[0].toLowerCase()===t.toLowerCase()})).map((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).toSet().sort()},ze=function(e){return function(t){return e.some((function(e){return e.get("completedKeywords").includes(t)}))}},Ye=Object($.fromJS)([{description:"Groceries",headerPaths:["Capture","Groceries"],iconName:"lemon",id:_e(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!1,template:"* TODO %?",isSample:!0},{description:"Deeply nested header",headerPaths:["Capture","Deeply","Nested","Headers","Work","Too!"],iconName:"fighter-jet",id:_e(),isAvailableInAllOrgFiles:!1,letter:"",orgFilesWhereAvailable:[],shouldPrepend:!0,template:"* You can insert timestamps too! %T %?",isSample:!0}]),Je=n(491),Xe=n(492),qe=n(490),$e=function(e,t){return{type:"DISPLAY_FILE",path:e,contents:t}},Ze=function(e){return{type:"SET_LAST_SYNC_AT",lastSyncAt:e}},Qe=function(){return function(e,t){e({type:"STOP_DISPLAYING_FILE"}),e(T.ActionCreators.clearHistory()),e(It()),e(X()),e(Ze(null))}},et=Object(w.debounce)((function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return e(nt.apply(void 0,n))}),3e3,{leading:!0,trailing:!0}),tt=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return et.apply(void 0,[e].concat(t))}},nt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.forceAction,n=void 0===t?null:t,a=e.successMessage,r=void 0===a?"Changes pushed":a,i=e.shouldSuppressMessages,o=void 0!==i&&i;return function(e,t){var a=t().syncBackend.get("client"),i=t().org.present.get("path");i&&(t().base.get("isLoading")?e(tt({forceAction:"push"})):(o||e(S("Syncing...")),e(O(!0)),e($t(null)),a.getFileContentsAndMetadata(i).then((function(s){var c=s.contents,l=s.lastModifiedAt,u=t().org.present.get("isDirty"),d=Object(qe.a)(l),h=t().org.present.get("lastSyncAt");Object(Je.a)(h,d)||"push"===n?u?a.updateFile(i,Te(t().org.present.get("headers"),t().org.present.get("todoKeywordSets"),t().org.present.get("fileConfigLines"),t().org.present.get("linesBeforeHeadings"))).then((function(){o||e(C(r,2e3)),e(O(!1)),e(Ct(!1)),e(Ze(Object(Xe.a)(new Date,5)))})).catch((function(t){var n="There was an error pushing the file: ".concat(t.toString());console.error(n),e(C(n,5e3)),e(I()),e(O(!1)),e(tt())})):(o||e(C("Nothing to sync",2e3)),e(O(!1))):u&&"pull"!==n?(e(I()),e(O(!1)),e(J("sync-confirmation",{lastServerModifiedAt:d}))):(e($e(i,c)),e(Ot()),e(Ct(!1)),e(Ze(Object(Xe.a)(new Date,5))),o||e(C("Latest version pulled",2e3)),e(O(!1)))})).catch((function(){e(I()),e(O(!1)),e($t("File not found"))}))))}},at=function(e){return{type:"OPEN_HEADER",headerId:e}},rt=function(e){return{type:"TOGGLE_HEADER_OPENED",headerId:e}},it=function(e){return function(t){t({type:"SELECT_HEADER",headerId:e}),e&&t(Dt(null))}},ot=function(e){return function(t){t(it(e)),t({type:"OPEN_PARENTS_OF_HEADER",headerId:e})}},st=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{type:"ADVANCE_TODO_STATE",headerId:e,dirtying:!0}},ct=function(e){return{type:"ENTER_EDIT_MODE",editModeType:e}},lt=function(){return{type:"EXIT_EDIT_MODE"}},ut=function(e,t){return{type:"UPDATE_HEADER_TITLE",headerId:e,newRawTitle:t,dirtying:!0}},dt=function(e,t){return{type:"UPDATE_HEADER_DESCRIPTION",headerId:e,newRawDescription:t,dirtying:!0}},ht=function(e){return{type:"ADD_HEADER",headerId:e,dirtying:!1}},pt=function(e){return{type:"SELECT_NEXT_SIBLING_HEADER",headerId:e}},gt=function(e){return function(t){t(ht(e)),t(pt(e)),t(ct("title"))}},mt=function(e){return{type:"SELECT_NEXT_VISIBLE_HEADER",headerId:e}},ft=function(e){return{type:"SELECT_PREVIOUS_VISIBLE_HEADER",headerId:e}},bt=function(e){return{type:"REMOVE_HEADER",headerId:e,dirtying:!0}},yt=function(e){return{type:"MOVE_HEADER_UP",headerId:e,dirtying:!0}},vt=function(e){return{type:"MOVE_HEADER_DOWN",headerId:e,dirtying:!0}},Et=function(e){return{type:"MOVE_HEADER_LEFT",headerId:e,dirtying:!0}},Tt=function(e){return{type:"MOVE_HEADER_RIGHT",headerId:e,dirtying:!0}},kt=function(e){return{type:"MOVE_SUBTREE_LEFT",headerId:e,dirtying:!0}},wt=function(e){return{type:"MOVE_SUBTREE_RIGHT",headerId:e,dirtying:!0}},_t=function(e,t){return{type:"REFILE_SUBTREE",sourceHeaderId:e,targetHeaderId:t,dirtying:!0}},St=function(e){return{type:"FOCUS_HEADER",headerId:e}},It=function(){return{type:"UNFOCUS_HEADER"}},Ot=function(){return{type:"APPLY_OPENNESS_STATE"}},Ct=function(e){return{type:"SET_DIRTY",isDirty:e}},Dt=function(e){return function(t){t({type:"SET_SELECTED_TABLE_CELL_ID",cellId:e}),e&&t(it(null))}},At=function(){return{type:"ADD_NEW_TABLE_ROW",dirtying:!0}},Nt=function(){return{type:"REMOVE_TABLE_ROW",dirtying:!0}},Pt=function(){return{type:"ADD_NEW_TABLE_COLUMN",dirtying:!0}},Lt=function(){return{type:"REMOVE_TABLE_COLUMN",dirtying:!0}},Rt=function(){return{type:"MOVE_TABLE_ROW_DOWN",dirtying:!0}},jt=function(){return{type:"MOVE_TABLE_ROW_UP",dirtying:!0}},xt=function(){return{type:"MOVE_TABLE_COLUMN_LEFT",dirtying:!0}},Mt=function(){return{type:"MOVE_TABLE_COLUMN_RIGHT",dirtying:!0}},Ht=function(e,t){return{type:"UPDATE_TABLE_CELL_VALUE",cellId:e,newValue:t,dirtying:!0}},Ft=function(e,t,n){return function(a,r){a(X()),a({type:"INSERT_CAPTURE",template:r().capture.get("captureTemplates").concat(Ye).find((function(t){return t.get("id")===e})),content:t,shouldPrepend:n,dirtying:!0})}},Bt=function(){return{type:"CLEAR_PENDING_CAPTURE"}},Ut=function(){return function(e,t){var n=t().org.present.get("pendingCapture"),a=n.get("captureTemplateName"),r=n.get("captureContent"),i=n.get("customCaptureVariables");e(Bt()),window.history.pushState({},"",window.location.pathname);var o=t().capture.get("captureTemplates").filter((function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").includes(t().org.present.get("path"))})).find((function(e){return e.get("description").trim()===a.trim()}));if(o)if(Le(t().org.present.get("headers"),o.get("headerPaths"))){var s=ke(o.get("template"),i),c=Object(d.a)(s,2),l=c[0],u=c[1],h=u?"".concat(l.substring(0,u)).concat(r).concat(l.substring(u)):"".concat(l).concat(r);e(Ft(o.get("id"),h,o.get("shouldPrepend"))),e(tt({successMessage:"Item captured"}))}else e(C('Capture failed: "'.concat(o.get("description"),'" header path invalid in this file'),8e3));else e(C('Capture failed: "'.concat(a,'" template not found or not available in this file'),8e3))}},Vt=function(e){return{type:"ADVANCE_CHECKBOX_STATE",listItemId:e,dirtying:!0}},Wt=function(e,t){return{type:"SET_HEADER_TAGS",headerId:e,tags:t,dirtying:!0}},Gt=function(e,t){return{type:"REORDER_TAGS",fromIndex:e,toIndex:t,dirtying:!0}},Kt=function(e,t){return function(n,a){return n({type:"REORDER_PROPERTY_LIST",fromIndex:e,toIndex:t,headerId:a().base.getIn(["activePopup","data","headerId"]),dirtying:!0})}},zt=function(e,t){return{type:"UPDATE_TIMESTAMP_WITH_ID",timestampId:e,newTimestamp:t,dirtying:!0}},Yt=function(e,t,n){return{type:"UPDATE_PLANNING_ITEM_TIMESTAMP",headerId:e,planningItemIndex:t,newTimestamp:n,dirtying:!0}},Jt=function(e,t){return{type:"ADD_NEW_PLANNING_ITEM",headerId:e,planningType:t,dirtying:!0}},Xt=function(e,t){return{type:"REMOVE_PLANNING_ITEM",headerId:e,planningItemIndex:t,dirtying:!0}},qt=function(e,t){return{type:"UPDATE_PROPERTY_LIST_ITEMS",headerId:e,newPropertyListItems:t,dirtying:!0}},$t=function(e){return{type:"SET_ORG_FILE_ERROR_MESSAGE",message:e}},Zt=function(e,t,n){return{type:"SET_LOG_ENTRY_STOP",headerId:e,entryId:t,time:n,dirtying:!0}},Qt=function(e,t){return{type:"CREATE_LOG_ENTRY_START",headerId:e,time:t,dirtying:!0}},en=function(e,t,n,a){return{type:"UPDATE_LOG_ENTRY_TIME",headerId:e,entryIndex:t,entryType:n,newTime:a,dirtying:!0}},tn=function(e,t,n){return{type:"SET_SEARCH_FILTER_INFORMATION",searchFilter:e,cursorPosition:t,context:n}},nn=function(e){return function(t){return function(n){return n.dirtying&&e.getState().base.get("shouldLiveSync")&&e.dispatch(tt({shouldSuppressMessages:!0})),t(n)}}},an=Object(w.debounce)((function(e){return e.dispatch(tt({shouldSuppressMessages:!0}))}),1e3);var rn=function(e){return function(t){return function(n){var a=function(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++)if(e[t]+"Hidden"in document)return e[t]+"Hidden";return null}();if(a){var r=a.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(r,(function(){e.getState().syncBackend.get("client")&&e.getState().base.get("shouldSyncOnBecomingVisibile")&&an(e)}))}return t(n)}}},on=function(){return{type:"ADD_NEW_EMPTY_CAPTURE_TEMPLATE"}},sn=function(e,t,n){return{type:"UPDATE_TEMPLATE_FIELD_PATH_VALUE",templateId:e,fieldPath:t,newValue:n}},cn=function(e){return{type:"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e}},ln=function(e,t){return{type:"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY",templateId:e,orgFileAvailabilityIndex:t}},un=function(e){return{type:"ADD_NEW_TEMPLATE_HEADER_PATH",templateId:e}},dn=function(e,t){return{type:"REMOVE_TEMPLATE_HEADER_PATH",templateId:e,headerPathIndex:t}},hn=function(e){return{type:"DELETE_TEMPLATE",templateId:e}},pn=function(e){return{type:"RESTORE_CAPTURE_SETTINGS",newSettings:e}},gn=function(e,t){return{type:"REORDER_CAPTURE_TEMPLATE",fromIndex:e,toIndex:t}},mn=function(){try{return localStorage.setItem("test","test"),"test"===localStorage.getItem("test")}catch(e){return!1}},fn=_.a.debounce((function(e,t){switch(e.type){case"Dropbox":case"WebDAV":e.createFile("/.organice-config.json",t).catch((function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))}));break;case"Google Drive":e.createFile(".organice-config.json","root",t).catch((function(e){return alert("There was an error trying to push settings to your sync backend: ".concat(e))}))}}),1e3,{maxWait:3e3}),bn=[{category:"base",name:"fontSize",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"bulletStyle",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldTapTodoToAdvance",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayUnit",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"agendaDefaultDeadlineDelayValue",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"shouldStoreSettingsInSyncBackend",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"lastSeenChangelogHash",type:"nullable",shouldStoreInConfig:!0},{category:"base",name:"customKeybindings",type:"json",shouldStoreInConfig:!0},{category:"base",name:"shouldLiveSync",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"shouldSyncOnBecomingVisibile",type:"boolean",shouldStoreInConfig:!0},{category:"base",name:"shouldShowTitleInOrgFile",type:"boolean",shouldStoreInConfig:!0},{category:"capture",name:"captureTemplates",type:"json",shouldStoreInConfig:!0,default:Object($.List)()}],yn=function(e,t){return t.filter((function(e){return!e.depreacted})).filter((function(e){return"org"===e.category})).map((function(e){return e.name})).map((function(t){return[t,e.org.present.get(t)]})).concat(bn.filter((function(e){return"org"!==e.category})).map((function(t){return"json"===t.type?[t.name,JSON.stringify(e[t.category].get(t.name)||t.default||{})]:[t.name,e[t.category].get(t.name)]})))},vn=function(e){return JSON.stringify(_.a.fromPairs(e),null,2)},En=function(){if(mn()){var e={syncBackend:Object($.Map)(),org:{past:[],present:Object($.Map)({search:Object($.Map)({searchFilter:"",searchFilterExpr:[]})}),future:[]},base:Object($.Map)(),capture:Object($.Map)()};bn.forEach((function(t){var n=localStorage.getItem(t.name);"nullable"===t.type?"null"===n&&(n=null):"boolean"===t.type?n="true"===n:"json"===t.type&&(n=n?Object($.fromJS)(JSON.parse(n)):t.default||Object($.Map)()),"org"===t.category?e[t.category].present=e[t.category].present.set(t.name,n):e[t.category]=e[t.category].set(t.name,n)})),e.capture.get("captureTemplates")&&(e.capture=e.capture.update("captureTemplates",(function(e){return e.map((function(e){return e.set("id",_e())}))})));var t=function(){var e=localStorage.getItem("headerOpenness");return e?JSON.parse(e):null}();return t&&(e.org.present=e.org.present.set("opennessState",Object($.fromJS)(t))),window.previousSettingsFileContents=vn(yn(e,bn)),e}},Tn=function(e){return mn()?function(){var t=e.getState(),n=yn(t,bn);if(n.forEach((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return localStorage.setItem(n,a)})),t.base.get("shouldStoreSettingsInSyncBackend")){var a=vn(n);window.previousSettingsFileContents!==a&&fn(t.syncBackend.get("client"),a),window.previousSettingsFileContents=a}var r=t.org.present.get("path");if(r&&t.org.present.get("headers")){var i=function e(t){for(var n=[],a=function(a){var i=t.get(a);if(!i.get("opened"))return r=a,"continue";var o=i.getIn(["titleLine","rawTitle"]),s=Ce(t,i.get("id")),c=e(s);c.length>0?c.forEach((function(e){n.push([o].concat(e))})):n.push([o]),a+=s.size,r=a},r=0;r<t.size;++r)a(r);return n}(t.org.present.get("headers")),o={},s=localStorage.getItem("headerOpenness");s&&(o=JSON.parse(s)),o[r]=i,localStorage.setItem("headerOpenness",JSON.stringify(o))}}:function(){}},kn=function(e,t){mn()&&localStorage.setItem(e,t)},wn=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(mn()){var n=localStorage.getItem(e);return t&&"null"===n?null:n}return null},_n=function(e,t){return e.set("loadingMessage",t.loadingMessage)},Sn=function(e,t){return e.set("loadingMessage",null)},In=function(e,t){return e.set("fontSize",t.newFontSize)},On=function(e,t){return e.set("bulletStyle",t.newBulletStyle)},Cn=function(e,t){return e.set("shouldTapTodoToAdvance",t.newShouldTapTodoToAdvance)},Dn=function(e,t){return e.set("agendaDefaultDeadlineDelayUnit",t.newAgendaDefaultDeadlineDelayUnit)},An=function(e,t){return e.set("agendaDefaultDeadlineDelayValue",t.newAgendaDefaultDeadlineDelayValue)},Nn=function(e,t){return e.set("shouldStoreSettingsInSyncBackend",t.newShouldStoreSettingsInSyncBackend)},Pn=function(e,t){return e.set("shouldLiveSync",t.shouldLiveSync)},Ln=function(e,t){return e.set("shouldSyncOnBecomingVisibile",t.shouldSyncOnBecomingVisibile)},Rn=function(e,t){return e.set("shouldShowTitleInOrgFile",t.shouldShowTitleInOrgFile)},jn=function(e,t){return e.set("hasUnseenChangelog",t.newHasUnseenChangelog)},xn=function(e,t){return e.set("lastSeenChangelogHash",t.newLastSeenChangelogHash)},Mn=function(e,t){return e.set("lastViewedPath",t.lastViewedPath).set("lastViewedContents",t.lastViewedContents)},Hn=function(e,t){return e.get("customKeybindings")||(e=e.set("customKeybindings",Object($.Map)())),e.setIn(["customKeybindings",t.keybindingName],t.keybinding)},Fn=function(e,t){return t.newSettings?function(e,t,n){return bn.filter((function(e){return e.category===n})).filter((function(e){return e.shouldStoreInConfig})).forEach((function(n){e="json"===n.type?e.set(n.name,Object($.fromJS)(JSON.parse(t[n.name]))):e.set(n.name,t[n.name])})),e}(e,t.newSettings,"base"):e},Bn=function(e,t){return e.update("modalPageStack",(function(e){return e?e.push(t.modalPage):Object($.List)([t.modalPage])}))},Un=function(e){return e.update("modalPageStack",(function(e){return e?e.pop():e}))},Vn=function(e){return e.set("modalPageStack",Object($.List)())},Wn=function(e,t){var n=t.data,a=t.popupType;return["search","task-list","agenda"].includes(a)&&(window.location.hash=a),e.set("activePopup",Object($.fromJS)({type:a,data:n}))},Gn=function(e){return window.history.replaceState("",document.title,window.location.pathname+window.location.search),e.set("activePopup",null)},Kn=function(e,t){return e.set("isLoading",t.isLoading)},zn=function(e,t){return e.set("isAuthenticated",!1).set("client",null)},Yn=function(e,t){return e.set("currentFileBrowserDirectoryListing",Object($.Map)({listing:t.directoryListing,hasMore:t.hasMore,additionalSyncBackendState:t.additionalSyncBackendState}))},Jn=function(e,t){return e.update("currentFileBrowserDirectoryListing",(function(e){return e||Object($.Map)()})).setIn(["currentFileBrowserDirectoryListing","isLoadingMore"],t.isLoadingMore)},Xn=n(224),qn=n.n(Xn),$n=function(e,t,n){return function(a,r,i){return function(e,t,n){return function(a,r,i){var o=[].concat(t,Ge(Object($.fromJS)(n)).toJS().map((function(e){return e+":"}))),s=a?Qn(a,r,i):null,c=r.charAt(i-1),l=i>1?r.charAt(i-2):"";if(null===s);else{if(s===Zn)return e;if("case-sensitive"===s.type){if(c.match(/[A-Z]/)){var u=c,d=e.filter((function(e){return e.startsWith(u)})).map((function(e){return e.substring(u.length)}));if([" ","","|","-"].includes(l))return d}}else{if("ignore-case"===s.type)return"-"===c&&[" ",""].includes(l)?e:[];if("tag"===s.type){if(":"===c)return o}else if("property"===s.type&&":"===c){if(" "===l||""===l)return o;var h=r.substring(0,i-1).lastIndexOf(":"),p=r.substring(h+1,i-1);if(h>=0&&p.match(/^[^ ]+$/))return Ke(Object($.fromJS)(n),p).flatMap((function(e){return e.match(/ /)?e.match(/"/)?e.match(/'/)?[e.match(/^[^ ]*/)[0]]:["'".concat(e,"'")]:['"'.concat(e,'"')]:[e]})).toJS()}}}if(":"===c){if([" ","","-"].includes(l))return o}else if("|"===c){var g=r.substring(0,i).lastIndexOf(":"),m=r.substring(g+1,i-1);return g>-1&&!m.match(/ /)?t:e}return[]}}(e,t,n)(a,r,i).map((function(e){return r.substring(0,i)+e+r.substring(i)}))}},Zn=" ",Qn=function(e,t,n){if(0===e.length)return Zn;var a=function(e,t){return{value:e,elem:t}},r=e.reduce((function(e,t){var r=e.value,i=e.elem;return null===i?a(r,null):n>=t.offset&&n<=t.endOffset?a(t,null):n>i.endOffset&&n<t.offset?a(Zn,null):a(null,t)}),{value:null,elem:{offset:-1,endOffset:-1}}).value;return n>e[e.length-1].endOffset?Zn:r},ea=/(\[\[([^\]]*)\]\]|\[\[([^\]]*)\]\[([^\]]*)\]\])|(\[((\d*%)|(\d*\/\d*))\])|(([\s({'"]?)([*/~=_+])([^\s,'](.*)[^\s,'])\11([\s\-.,:;!?'")}]?))|(([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9\s]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?[>\]](?:--([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?[>\]])?)|(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_\\+.~#?&//=]*))|([a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?)|(\+\d{8,30})|(www(\.[-_a-zA-Z0-9]+){2,}(\/[-_a-zA-Z0-9]+)*)/g,ta=/([<[])(\d{4})-(\d{2})-(\d{2})(?: ([^0-9\s]{1,9}))?(?: ([012]?\d:[0-5]\d))?(?:-([012]?\d:[0-5]\d))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?(?: ((?:\+)|(?:\+\+)|(?:\.\+)|(?:-)|(?:--))(\d+)([hdwmy]))?[>\]]/,na=function(e,t){var n=t.map((function(t){return e[t]})),a=Object(d.a)(n,13),r=a[0],i=a[1],o=a[2],s=a[3],c=a[4],l=a[5],u=a[6],h=a[7],p=a[8],g=a[9],m=a[10],f=a[11],b=a[12];if(!i)return null;var y,v,E,T,k,w,_=l?l.split(":"):[],S=Object(d.a)(_,2),I=S[0],O=S[1],C=u?u.split(":"):[],D=Object(d.a)(C,2),A=D[0],N=D[1];return["+","++",".+"].includes(h)?(y=h,v=p,E=g):["-","--"].includes(h)&&(T=h,k=p,w=g),["+","++",".+"].includes(m)?(y=m,v=f,E=b):["-","--"].includes(m)&&(T=m,k=f,w=b),{isActive:"<"===r,year:i,month:o,day:s,dayName:c,startHour:I,startMinute:O,endHour:A,endMinute:N,repeaterType:y,repeaterValue:v,repeaterUnit:E,delayType:T,delayValue:k,delayUnit:w}},aa=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.shouldAppendNewline,a=void 0!==n&&n,r=(t.excludeCookies,[]),i=ea.exec(e);i;){if(i[2])r.push({type:"link",rawText:i[0],uri:i[2],index:i.index});else if(i[3]&&i[4])r.push({type:"link",rawText:i[0],uri:i[3],title:i[4],index:i.index});else if(i[7]){var o=i[7].match(/(\d*)%/);r.push({type:"percentage-cookie",rawText:i[0],percentage:o[1],index:i.index})}else if(i[8]){var s=i[8].match(/(\d*)\/(\d*)/);r.push({type:"fraction-cookie",rawText:i[0],fraction:[s[1],s[2]],index:i.index})}else if(i[11]){var c={"~":"inline-code","*":"bold","/":"italic","+":"strikethrough",_:"underline","=":"verbatim"}[i[11]],l=i[10].length;r.push({type:"inline-markup",rawText:i[0].substring(l,i[12].length+2+l),index:i.index+l,content:i[12],markupType:c})}else if(i[15]){var u=na(i,_.a.range(16,29)),d=na(i,_.a.range(29,42));r.push({type:"timestamp",rawText:i[0],index:i.index,firstTimestamp:u,secondTimestamp:d})}else i[42]?r.push({type:"url",rawText:i[0],index:i.index}):i[45]?r.push({type:"e-mail",rawText:i[0],index:i.index}):i[46]?r.push({type:"phone-number",rawText:i[0],index:i.index}):i[47]&&r.push({type:"www-url",rawText:i[0],index:i.index});i=ea.exec(e)}var h=[],p=0;if(r.forEach((function(t){var n=t.index;if(n!==p){var a=e.substring(p,n);h.push({type:"text",contents:a})}var r=ra(e,t);h.push(r),p=t.index+t.rawText.length})),p!==e.length||a){var g=e.substring(p,e.length)+(a?"\n":"");h.push({type:"text",contents:g})}return h},ra=function(e,t){switch(t.type){case"link":var n={id:_e(),type:"link",contents:{uri:t.uri}};return t.title&&(n.contents.title=t.title),n;case"percentage-cookie":return{id:_e(),type:"percentage-cookie",percentage:t.percentage};case"fraction-cookie":return{id:_e(),type:"fraction-cookie",fraction:t.fraction};case"inline-markup":return{id:_e(),type:"inline-markup",content:t.content,markupType:t.markupType};case"timestamp":return{id:_e(),type:"timestamp",firstTimestamp:t.firstTimestamp,secondTimestamp:t.secondTimestamp};case"url":case"www-url":case"e-mail":case"phone-number":return{id:_e(),type:t.type,content:t.rawText};default:throw Error("The regex parser parsed something but it is not converted to proper data structure.")}},ia=function(e){var t={id:_e(),type:"table",contents:[[]],columnProperties:[]};e.map((function(e){return e.trim()})).forEach((function(e){if(e.startsWith("|-"))t.contents.push([]);else{var n=_.a.last(t.contents),a=e.substr(1,e.length-2).split("|");0===n.length?a.forEach((function(e){return n.push(e)})):a.forEach((function(e,t){n[t]+="\n".concat(e)}))}})),t.contents=t.contents.map((function(e){return{id:_e(),contents:e.map((function(e){return{id:_e(),contents:aa(e,{excludeCookies:!0}),rawContents:e}}))}})),0===_.a.last(t.contents).contents.length&&(t.contents=t.contents.slice(0,t.contents.length-1));var n=Math.max.apply(Math,Object(q.a)(t.contents.map((function(e){return e.contents.length}))));return t.contents.forEach((function(e){e.contents.length<n&&_.a.times(n-e.contents.length,(function(){e.contents.push({id:_e(),contents:[],rawContents:""})}))})),t},oa=function e(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=n.excludeContentElements,r=void 0!==a&&a,i=t.split("\n"),o=/^\s*([-+*]|(\d+(\.|\)))) (.*)/,s=null,c=_.a.flatten(i.map((function(e,t){var n=e.match(/^( *)/)[0].length;return null!==s&&(n>s||!e.trim())?[{type:"raw-list-content",line:e}]:(s=null,e.match(o)&&!r?(s=n,[{type:"raw-list-header",line:e}]):e.trim().startsWith("|")&&!r?[{type:"raw-table",line:e}]:aa(e,{shouldAppendNewline:t!==i.length-1,excludeCookies:!0}))}))),l=[],u=0;u<c.length;++u){var d=c[u];if("raw-table"===d.type){var h=_.a.takeWhile(c.slice(u),(function(e){return"raw-table"===e.type})).map((function(e){return e.line}));l.push(ia(h)),u+=h.length-1}else"raw-list-header"===d.type?function(){var t=d.line.match(/^( *)/)[0].length,n=_.a.takeWhile(c.slice(u+1),(function(e){return"raw-list-content"===e.type})).map((function(e){return e.line})).map((function(e){return e.startsWith(" ".repeat(t+2))?e.substr(t+2):e.substr(t+1)}));""===n[n.length-1]&&(n[n.length-1]=" ");var a=e(n.join("\n")).toJS();u+=n.length;var r=!!d.line.match(/^\s*\d+[.)]/),i=d.line.match(o)[4],s=null;i.match(/^\s*\[@\d+\]/)&&(s=i.match(/^\s*\[@(\d+)\]/)[1],i=i.replace(/^\s*\[@\d+\]\s*/,""));var h=null,p=!!i.match(/^\s*\[[ X-]\]/);p&&(h={" ":"unchecked",X:"checked","-":"partial"}[i.match(/^\s*\[([ X-])\]/)[1]],i=i.replace(/^\s*\[[ X-]\]\s*/,""));var g={id:_e(),titleLine:aa(i),contents:a,forceNumber:s,isCheckbox:p,checkboxState:h},m=l.length-1;m>=0&&"list"===l[m].type?l[m].items.push(g):l.push({type:"list",id:_e(),items:[g],bulletCharacter:d.line.trim()[0],numberTerminatorCharacter:r?d.line.match(/\s*\d+([.)])/)[1]:null,isOrdered:r})}():l.push(d)}return Object($.fromJS)(l)},sa=function(e){var t=function(e){var t=ha(/(DEADLINE|SCHEDULED|CLOSED):\s*/,ta),n=RegExp("("+t.toString().substring(1,t.toString().length-1)+")?"),a=ha(/^\s*/,n,/\s*/,n,/\s*/,n,/\s*/),r=e.match(a),i=Object($.fromJS)([2,17,32].map((function(e){var t=r[e];return t?{type:t,timestamp:na(r,_.a.range(e+1,e+1+13)),id:_e()}:null})).filter((function(e){return!!e})));return i.size>0?{planningItems:i,strippedDescription:e.split("\n").filter((function(e){return!e.includes(r[0].trim())})).join("\n")}:{planningItems:Object($.fromJS)([]),strippedDescription:e}}(e),n=function(e){var t=e.split("\n"),n=t.findIndex((function(e){return":PROPERTIES:"===e.trim()})),a=t.findIndex((function(e){return":END:"===e.trim()}));return-1!==n&&-1!==a&&e.trim().startsWith(":PROPERTIES:")?{propertyListItems:Object($.fromJS)(t.slice(n+1,a).map((function(e){var t=e.match(/:([^\s]*):(?: (.*))?/);if(!t)return null;var n=t[2]?aa(t[2]):null;return{property:t[1],value:n,id:_e()}})).filter((function(e){return!!e}))),strippedDescription:t.slice(a+1).join("\n")}:{propertyListItems:Object($.List)(),strippedDescription:e}}(t.strippedDescription),a=function(e){var t=e.split("\n"),n=t.findIndex((function(e){return":LOGBOOK:"===e.trim()})),a=t.findIndex((function(e){return":END:"===e.trim()}));if(-1===n||-1===a||!e.trim().startsWith(":LOGBOOK:"))return{logBookEntries:Object($.List)(),strippedDescription:e};var r=ha(/^CLOCK: /,ta,/$/),i=ha(/^CLOCK: /,ta,"/--/",ta,/\s*=>\s*\S+$/);return{logBookEntries:Object($.fromJS)(t.slice(n+1,a).map((function(e){var t=e.trim().match(i);if(t)return{start:na(t,_.a.range(1,14)),end:na(t,_.a.range(14,31)),id:_e()};var n=e.trim().match(r);return n?{start:na(n,_.a.range(1,14)),end:null,id:_e()}:{raw:e.trimLeft(),id:_e()}}))),strippedDescription:t.slice(a+1).join("\n")}}(n.strippedDescription);return{planningItems:t.planningItems,propertyListItems:n.propertyListItems,strippedDescription:a.strippedDescription,logBookEntries:a.logBookEntries}};function ca(e,t){var n=sa(t),a=n.planningItems,r=n.propertyListItems,i=n.strippedDescription,o=n.logBookEntries;return e.set("rawDescription",i).set("description",oa(i)).set("planningItems",a).set("propertyListItems",r).set("logBookEntries",o)}var la=Object($.fromJS)([{keywords:["TODO","DONE"],completedKeywords:["DONE"],default:!0}]),ua=function(e,t){var n=t.flatMap((function(e){return e.get("keywords")})).filter((function(t){return e.startsWith(t+" ")})).first(),a=e;n&&(a=a.substr(n.length+1));var r=[];if(a.trimRight().endsWith(":")){var i=a.trimRight().split(" "),o=i[i.length-1];/^:[^\s]+:$/.test(o)&&(a=a.substr(0,a.length-o.length),r=o.split(":").filter((function(e){return""!==e})))}var s=aa(a);return Object($.fromJS)({title:s,rawTitle:a,todoKeyword:n,tags:r})},da=function(e,t,n){0===n.size&&(n=la);var a=ua(e,n);return Object($.fromJS)({titleLine:a,rawDescription:"",description:[],opened:!1,id:_e(),nestingLevel:t,planningItems:[],propertyListItems:[],logBookEntries:[]})},ha=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return RegExp(e.toString().substring(1,e.toString().length-1)+t.toString().substring(1,t.toString().length-1))}))},pa=function(e){var t=Object($.List)(),n=e.split("\n"),a=Object($.List)(),r=Object($.List)(),i=Object($.List)();return n.forEach((function(e){if(e.match(/^\*+\ /)){var n=e.indexOf(" ");-1===n&&(n=e.length);var o=e.substr(n+1);t=t.push(da(o,n,a))}else if(0===t.size){var s=function(e){if(!e.startsWith("#+TODO: ")&&!e.startsWith("#+TYP_TODO: "))return null;var t=e.substr(e.indexOf(":")+2).split(/\s/),n=t.filter((function(e){return"|"!==e})).map((function(e){return e.replace(/\(.[!@]?(\/[!@])?\)$/,"")})),a=t.indexOf("|"),r=a>=0?n.slice(a):[];return Object($.fromJS)({keywords:n,completedKeywords:r,configLine:e,default:!1})}(e);s?a=a.push(s):e.startsWith("#+")?r=r.push(e):i=i.push(e)}else t=t.updateIn([t.size-1,"rawDescription"],(function(t){return e||t?0===t.length?e:t+"\n"+e:"\n"}))})),0===a.size&&(a=la),t=t.map((function(e){var t=e.get("rawDescription");return ca(e,t)})),Object($.fromJS)({headers:t,todoKeywordSets:a,fileConfigLines:r,linesBeforeHeadings:i})},ga=function(e,t){var n=pa(t.contents);return e.set("path",t.path).set("contents",t.contents).set("headers",n.get("headers")).set("todoKeywordSets",n.get("todoKeywordSets")).set("fileConfigLines",n.get("fileConfigLines")).set("linesBeforeHeadings",n.get("linesBeforeHeadings"))},ma=function(e){return e.set("path",null).set("contents",null).set("headers",null).set("filteredHeaders",null).set("todoKeywordSets",null).set("fileConfigLines",null).set("linesBeforeHeadings",null)},fa=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId);return e.setIn(["headers",a,"opened"],!0)},ba=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=Oe(n,t.headerId).get("opened");if(r&&e.get("focusedHeaderId")===t.headerId)return e;r&&Ce(n,t.headerId).forEach((function(t){e=e.setIn(["headers",a+t+1,"opened"],!1)}));return e.setIn(["headers",a,"opened"],!r)},ya=function(e,t){return e.set("selectedHeaderId",t.headerId)},va=function(e,t){for(var n=e.get("headers"),a=t.headerId,r=Ae(n,a);r;){var i=Ie(n,r);n=n.setIn([i,"opened"],!0),r=Ae(n,r)}return e.set("headers",n)},Ea=function(e,t){var n=t.filter((function(e){return e})).length,a=t.length;return e.map((function(e){switch(e.get("type")){case"fraction-cookie":return e.set("fraction",Object($.List)([n,a]));case"percentage-cookie":return e.set("percentage",Math.floor(n/a*100));default:return e}}))},Ta=function(e,t){for(var n=e.get("headers"),a=Ie(n,t),r=Ce(n,t),i=[],o=0;o<r.size;++o){var s=r.get(o);i.push(s),o+=Ce(n,s.get("id")).size}var c=i.map((function(e){return e.getIn(["titleLine","todoKeyword"])})).filter((function(e){return!!e})).map((function(t){return Ue(e.get("todoKeywordSets"),t).get("completedKeywords").contains(t)}));return 0===c.length&&(c=n.get(a).get("description").filter((function(e){return"list"===e.get("type")})).flatMap((function(e){return e.get("items")})).filter((function(e){return e.get("isCheckbox")})).map((function(e){return"checked"===e.get("checkboxState")})).toJS()),e.updateIn(["headers",a,"titleLine","title"],(function(e){return Ea(e,c)})).updateIn(["headers",a,"titleLine"],(function(e){return e.set("rawTitle",ve(e.get("title")))}))},ka=function(e,t){var n=Ae(e.get("headers"),t);return n?Ta(e,n):e},wa=function(e,t){var n=t.headerId||e.get("selectedHeaderId");if(!n)return e;var a=e.get("headers"),r=Oe(a,n),i=Ie(a,n),o=r.getIn(["titleLine","todoKeyword"]),s=Ue(e.get("todoKeywordSets"),o),c=s.get("keywords").indexOf(o)+1,l=s.get("keywords").get(c)||"";return e=function(e,t,n,a,r,i){a=e.get("completedKeywords").includes(t)&&n.size>0?function(e,t,n,a,r,i){if(e.forEach((function(e){var a=Object(d.a)(e,2),r=a[0],i=a[1];t=t.setIn(["headers",n,"planningItems",i,"timestamp"],function(e,t){if(!e.get("repeaterType"))return e;var n=null;switch(e.get("repeaterType")){case"+":n=fe(me(e),e.get("repeaterValue"),e.get("repeaterUnit"));break;case"++":for(n=fe(me(e),e.get("repeaterValue"),e.get("repeaterUnit"));Object(ue.a)(n,t);)n=fe(n,e.get("repeaterValue"),e.get("repeaterUnit"));break;case".+":n=fe(new Date,e.get("repeaterValue"),e.get("repeaterUnit"));break;default:return console.error("Unrecognized timestamp repeater type: ".concat(e.get("repeaterType"))),e}return void 0!==(e=e.set("day",Object(Z.a)(n,"dd")).set("dayName",Object(Z.a)(n,"eee")).set("month",Object(Z.a)(n,"MM")).set("year",Object(Z.a)(n,"yyyy"))).get("startHour")&&null!==e.get("startHour")&&(e=e.set("startHour",Object(Z.a)(n,"HH")).set("startMinute",Object(Z.a)(n,"mm"))),e}(r.get("timestamp"),new Date))})),!function(e){var t=e.state,n=e.headerIndex,a=t.get("fileConfigLines").some((function(e){return e.match(/^#\+STARTUP:.*nologrepeat.*/)})),r=function e(t,n,a){var r=t.getIn([n,"propertyListItems"]).find((function(e){return e.get("property")===a}));if(r)return r.get("value");var i=Ae(t,t.getIn([n,"id"]));return i?e(t,Ie(t,i),a):null}(t.get("headers"),n,"LOGGING");return!!(a||r&&r.some((function(e){return"text"===e.get("type")&&e.get("contents").match(/\s*nologrepeat\s*/)})))}({state:t=t.setIn(["headers",n,"titleLine","todoKeyword"],a.get("keywords").first()),headerIndex:n})){var o=pe({isActive:!1,withStartTime:!0}),s=[{type:"timestamp",id:_e(),firstTimestamp:o,secondTimestamp:null}];t=(t=t.updateIn(["headers",n,"propertyListItems"],(function(e){return e.some((function(e){return"LAST_REPEAT"===e.get("property")}))?e.map((function(e){return"LAST_REPEAT"===e.get("property")?e.set("value",Object($.fromJS)(s)):e})):e.push(Object($.fromJS)({property:"LAST_REPEAT",value:s,id:_e()}))}))).updateIn(["headers",n],(function(e){var t=e.get("rawDescription");return t.startsWith("\n")&&(t=t.slice(1)),t='\n- State "'.concat(r,'"       from "').concat(i,'"       ').concat(he(Object($.fromJS)(o)),"\n")+t,e.set("rawDescription",t).set("description",oa(t))}))}return t}(n,a,r,e,t,i):a.setIn(["headers",r,"titleLine","todoKeyword"],t);return a}(s,l,r.get("planningItems").map((function(e,t){return[e,t]})).filter((function(e){return!!Object(d.a)(e,1)[0].getIn(["timestamp","repeaterType"])})),e,i,o),e=ka(e,n)},_a=function(e,t){return e.set("editMode",t.editModeType)},Sa=function(e){return e.set("editMode",null)},Ia=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=ua(t.newRawTitle.trim(),e.get("todoKeywordSets"));return e=e.setIn(["headers",a,"titleLine"],r),ka(e,t.headerId)},Oa=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId);return e.updateIn(["headers",a],(function(e){var n=sa(t.newRawDescription),a=n.planningItems,r=n.propertyListItems,i=n.strippedDescription,o=n.logBookEntries;return e.set("rawDescription",i).set("description",oa(i)).set("planningItems",a).set("propertyListItems",r).set("logBookEntries",o)}))},Ca=function(e,t){var n=e.get("headers"),a=Oe(n,t.headerId),r=Ie(n,t.headerId),i=Ce(n,t.headerId),o=a.getIn(["titleLine","todoKeyword"]),s=da(o?o+" ":"",a.get("nestingLevel"),e.get("todoKeywordSets"));return t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e.update("headers",(function(e){return e.insert(r+i.size+1,s)}))},Da=function(e,t){var n=e.get("headers"),a=Oe(n,t.headerId),r=Ie(n,t.headerId),i=Ce(n,t.headerId),o=n.get(r+i.size+1);return o&&o.get("nestingLevel")===a.get("nestingLevel")?e.set("selectedHeaderId",o.get("id")):e},Aa=function(e){var t=e.get("headers");if(void 0===e.get("selectedHeaderId"))return e.set("selectedHeaderId",t.getIn([0,"id"]));var n=function(e,t){return e.slice(t+1).find((function(t){return Ne(e,t.get("id"))}))}(t,Ie(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},Na=function(e){var t=e.get("headers"),n=function(e,t){return e.slice(0,t).reverse().find((function(t){return Ne(e,t.get("id"))}))}(t,Ie(t,e.get("selectedHeaderId")));return n?e.set("selectedHeaderId",n.get("id")):e},Pa=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=1+Ce(n,t.headerId).size,i=Ae(n,t.headerId);return _.a.times(r).forEach((function(){n=n.delete(a)})),t.headerId===e.get("focusedHeaderId")&&(e=e.set("focusedHeaderId",null)),e=e.set("headers",n),i&&(e=Ta(e,i)),e},La=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=function(e,t){for(var n=e.getIn([t,"nestingLevel"]),a=t-1;a>=0;--a){var r=e.get(a);if(r.get("nestingLevel")<n)return null;if(r.get("nestingLevel")===n)return a}return null}(n,a);if(null===r)return e;var i=Ce(n,t.headerId);return _.a.times(1+i.size).forEach((function(){n=(n=n.insert(r,n.get(a+i.size))).delete(a+i.size+1)})),e.set("headers",n)},Ra=function(e,t){var n=e.get("headers"),a=Oe(n,t.headerId),r=Ie(n,t.headerId),i=Ce(n,t.headerId),o=r+i.size+1,s=n.get(o);if(s.get("nestingLevel")<a.get("nestingLevel"))return e;var c=Ce(n,s.get("id"));return _.a.times(1+c.size).forEach((function(){n=(n=n.insert(r,n.get(o+c.size))).delete(o+c.size+1)})),e.set("headers",n)},ja=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=Ae(n,t.headerId);return e=yr(e=vr({state:e,headerIndex:a},"-"),r,t)},xa=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=Ae(n,t.headerId);return e=vr({state:e,headerIndex:a},"+"),e=yr(e=Pe(e,t.headerId),r,t)},Ma=function(e,t){var n=e.get("headers"),a=Oe(n,t.headerId),r=Ie(n,t.headerId),i=Ae(n,t.headerId);return 1===a.get("nestingLevel")?e:e=yr(e=vr({state:e,headerIndex:r,subheaders:Ce(n,t.headerId)},"-"),i,t)},Ha=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId),r=Ae(n,t.headerId);return e=yr(e=vr({state:e,headerIndex:a,subheaders:Ce(n,t.headerId)},"+"),r,t),Pe(e,t.headerId)},Fa=function(e,t){function n(e){var t=e.list,n=e.fromIndex,a=e.toIndex,r=e.item,i=t.get(a),o=(t=t.delete(n)).indexOf(i);return t.insert(o+1,r)}var a=t.sourceHeaderId,r=t.targetHeaderId,i=e.get("headers"),o=Oe(i,a),s=Ie(i,a),c=Ie(i,r);if(s===c)return e;var l=Ce(i,a),u=e.getIn(["headers",s,"nestingLevel"]),d=e.getIn(["headers",c,"nestingLevel"]);return o=o.set("nestingLevel",d+1),i=n({list:i,fromIndex:s,toIndex:c,item:o}),l.forEach((function(e,t){e=e.set("nestingLevel",e.get("nestingLevel")-u+d+1);var a=Ie(i,e.get("id"));c=Ie(i,r),i=n({list:i,fromIndex:a,toIndex:c+t+1,item:e})})),e=yr(e,a,t),e=(e=yr(e,r,t)).set("headers",i)},Ba=function(e,t){return e.set("focusedHeaderId",t.headerId)},Ua=function(e){return e.set("focusedHeaderId",null)},Va=function(e){var t=e.get("opennessState");if(!t)return e;var n=t.get(e.get("path"));if(!n||0===n.size)return e;var a=e.get("headers");return n.forEach((function(e){a=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(0===n.size)return t;var r=n.first(),i=t.findIndex((function(e){var t=e.getIn(["titleLine","rawTitle"]),n=e.get("nestingLevel");return t===r&&n<=a}));if(-1===i)return t;t=t.update(i,(function(e){return e.set("opened",!0)}));var o=Ce(t,t.getIn([i,"id"]));return o=e(o,n.rest(),a+1),t=t.take(i+1).concat(o).concat(t.takeLast(t.size-(i+1+o.size)))}(a,e)})),e.set("headers",a)},Wa=function(e,t){return e.set("isDirty",t.isDirty)},Ga=function(e,t){return e.set("selectedTableCellId",t.cellId)},Ka=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=e.get("headers");n||(n=je(a,t));var r=Ie(a,n.get("id"));return e.updateIn(["headers",r],(function(e){return e.set("rawDescription",ve(e.get("description")))}))},za=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e){return function(t){return t.insert(e+1,function(e){return e.get(0).set("id",_e()).update("contents",(function(e){return e.map((function(e){return e.set("id",_e()).set("contents",Object($.List)()).set("rawContents","")}))}))}(t))}}))})),Ka(e,t)):e},Ya=function(e){var t=e.get("selectedTableCellId");if(!t)return e;var n=je(e.get("headers"),t);return e=(e=e.update("headers",(function(e){return He(e,t,(function(e){return function(t){return t.delete(e)}}))}))).set("selectedTableCellId",null),Ka(e,t,n)},Ja=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e,t){return function(e){return e.map((function(e){return e.update("contents",(function(e){return e.insert(t+1,Object($.fromJS)({id:_e(),contents:[],rawContents:""}))}))}))}}))})),Ka(e,t)):e},Xa=function(e){var t=e.get("selectedTableCellId");if(!t)return e;var n=je(e.get("headers"),t);return e=(e=e.update("headers",(function(e){return He(e,t,(function(e,t){return function(e){return e.map((function(e){return e.update("contents",(function(e){return e.delete(t)}))}))}}))}))).set("selectedTableCellId",null),Ka(e,t,n)},qa=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e){return function(t){return e+1===t.size?t:t.insert(e,t.get(e+1)).delete(e+2)}}))})),Ka(e,t)):e},$a=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e){return function(t){return 0===e?t:t.insert(e-1,t.get(e)).delete(e+1)}}))})),Ka(e,t)):e},Za=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e,t){return function(e){return 0===t?e:e.map((function(e){return e.update("contents",(function(e){return 0===e.size?e:e.insert(t-1,e.get(t)).delete(t+1)}))}))}}))})),Ka(e,t)):e},Qa=function(e){var t=e.get("selectedTableCellId");return t?(e=e.update("headers",(function(e){return He(e,t,(function(e,t){return function(e){return t+1>=e.getIn([0,"contents"]).size?e:e.map((function(e){return e.update("contents",(function(e){return 0===e.size?e:e.insert(t,e.get(t+1)).delete(t+2)}))}))}}))})),Ka(e,t)):e},er=function(e,t){return e=e.update("headers",(function(e){return He(e,t.cellId,(function(e,n){return function(a){return a.updateIn([e,"contents",n],(function(e){return e.set("rawContents",t.newValue).set("contents",Object($.fromJS)(aa(t.newValue,{excludeCookies:!0})))}))}}))})),Ka(e,t.cellId)},tr=function(e,t){var n=e.get("headers"),a=t.template,r=t.content,i=t.shouldPrepend,o=Le(n,a.get("headerPaths"));if(!o)return e;var s=function(e,t){var n=e.split("\n")[0].replace(/^\**\s*|\s*$/g,""),a=e.split("\n").slice(1).join("\n");return ca(da(n,1,t),a)}(r,e.get("todoKeywordSets")).set("nestingLevel",o.get("nestingLevel")+1),c=Ie(n,o.get("id")),l=De(n,o.get("id")),u=c+1+(i?0:l);return e=e.update("headers",(function(e){return e.insert(u,s)})),e=Ta(e,o.get("id"))},nr=function(e){return e.set("pendingCapture",null)},ar=function(e,t){var n,a,r=(n=e.get("headers"),a=t.listItemId,n.map((function(e,t){var n=function e(t,n){return t.map((function(t,a){return"list"===t.get("type")?t.get("items").map((function(t,r){if(t.get("id")===n)return{path:[a,"items",r],listItemPart:t};var i=e(t.get("contents"),n);if(i){var o=i.path,s=i.listItemPart;return{path:[a,"items",r,"contents"].concat(o),listItemPart:s}}return null})).filter((function(e){return!!e})).first():null})).filter((function(e){return!!e})).first()}(e.get("description"),a);if(!n)return null;var r=n.path,i=n.listItemPart;return{path:[t,"description"].concat(r),listItemPart:i}})).filter((function(e){return!!e})).first()),i=r.path,o=r.listItemPart;if(o.get("contents").filter((function(e){return"list"===e.get("type")})).some((function(e){return e.get("items").some((function(e){return e.get("isCheckbox")}))})))return e;var s={checked:"unchecked",unchecked:"checked",partial:"unchecked"}[o.get("checkboxState")];e=function e(t,n){var a=n.slice(0,n.length-4),r=t.getIn(a);if(!r.has("checkboxState"))return t;var i=r.get("contents").filter((function(e){return"list"===e.get("type")})).flatMap((function(e){return e.get("items").filter((function(e){return e.get("isCheckbox")})).map((function(e){return e.get("checkboxState")}))}));t=i.every((function(e){return"checked"===e}))?t.setIn(a.concat(["checkboxState"]),"checked"):i.every((function(e){return"unchecked"===e}))?t.setIn(a.concat(["checkboxState"]),"unchecked"):t.setIn(a.concat(["checkboxState"]),"partial");var o=i.map((function(e){switch(e){case"checked":return!0;case"unchecked":case"partial":default:return!1}})).toJS();return t=t.updateIn(a.concat("titleLine"),(function(e){return Ea(e,o)})),r.get("isCheckbox")?e(t,a):t}(e=e.setIn(["headers"].concat(i).concat(["checkboxState"]),s),["headers"].concat(i));var c=i[0];return e=(e=Ta(e,e.getIn(["headers",c,"id"]))).updateIn(["headers",c],(function(e){return e.set("rawDescription",ve(e.get("description")))}))},rr=function(e,t){return e.set("lastSyncAt",t.lastSyncAt)},ir=function(e,t){var n=e.get("headers"),a=Ie(n,t.headerId);return-1===a?e:e.setIn(["headers",a,"titleLine","tags"],t.tags)},or=function(e,t){var n=e.get("selectedHeaderId");if(!n)return e;var a=Ie(e.get("headers"),n);return e.updateIn(["headers",a,"titleLine","tags"],(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))},sr=function(e,t){var n=t.headerId;if(!n)return e;var a=Ie(e.get("headers"),n);return e.updateIn(["headers",a,"propertyListItems"],(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))},cr=function(e,t){var n,a,r=(n=e.get("headers"),a=t.timestampId,n.map((function(e,t){var n=xe(e.getIn(["titleLine","title"]),a);if(n){var r=n,i=r.path,o=r.timestampPart;return{path:[t,"titleLine","title"].concat(i),timestampPart:o}}if(n=xe(e.get("description"),a)){var s=n,c=s.path,l=s.timestampPart;return{path:[t,"description"].concat(c),timestampPart:l}}return(n=e.get("propertyListItems").map((function(e,n){if(!e.get("value"))return null;var r=xe(e.get("value"),a);if(r){var i=r.path,o=r.timestampPart;return{path:[t,"propertyListItems",n,"value"].concat(i),timestampPart:o}}return null})).filter((function(e){return!!e})).first())||null})).filter((function(e){return!!e})).first());if(!r)return e;var i=r.path,o=i[0];return e.setIn(["headers"].concat(i),t.newTimestamp).updateIn(["headers",o],(function(e){return e.set("rawDescription",ve(e.get("description")))})).updateIn(["headers",o],(function(e){return e.setIn(["titleLine","rawTitle"],ve(e.getIn(["titleLine","title"])))}))},lr=function(e,t){var n=t.headerId,a=t.planningItemIndex,r=t.newTimestamp,i=Ie(e.get("headers"),n);return e.setIn(["headers",i,"planningItems",a,"timestamp"],r)},ur=function(e,t){var n=Ie(e.get("headers"),t.headerId),a=Object($.fromJS)({id:_e(),type:t.planningType,timestamp:pe()});return e.updateIn(["headers",n,"planningItems"],(function(e){return e?e.push(a):Object($.List)([a])}))},dr=function(e,t){var n=Ie(e.get("headers"),t.headerId),a=t.planningItemIndex;return e.removeIn(["headers",n,"planningItems",a])},hr=function(e,t){var n=Ie(e.get("headers"),t.headerId);return e.setIn(["headers",n,"propertyListItems"],t.newPropertyListItems)},pr=function(e,t){var n=t.headerId,a=t.entryId,r=t.time,i=Ie(e.get("headers"),n),o=e.getIn(["headers",i,"logBookEntries"]).findIndex((function(e){return e.get("id")===a}));return e.setIn(["headers",i,"logBookEntries",o,"end"],Object($.fromJS)(r))},gr=function(e,t){var n=t.headerId,a=t.time,r=Ie(e.get("headers"),n),i=Object($.fromJS)({id:_e(),start:a,end:null});return e.updateIn(["headers",r,"logBookEntries"],(function(e){return e?e.unshift(i):Object($.List)([i])}))},mr=function(e,t){var n=t.headerId,a=t.entryIndex,r=t.entryType,i=t.newTime,o=Ie(e.get("headers"),n);return e.setIn(["headers",o,"logBookEntries",a,r],Object($.fromJS)(i))},fr=function(e,t){var n=t.searchFilter,a=t.cursorPosition,r=t.context,i=e.get("headers");e=e.asMutable();var o,s,c=!0;try{o=qn.a.parse(n),e.setIn(["search","searchFilterExpr"],o)}catch(b){c=!1}if(e.setIn(["search","searchFilterValid"],c),c){var l=i.filter((s=o,function(e){var t=e.get("titleLine"),n=t.get("tags"),a=t.get("todoKeyword"),r=t.get("rawTitle"),i=a?"".concat(a," ").concat(r):r,o=e.get("propertyListItems").map((function(e){return[e.get("property"),ve(e.get("value"))]})),c=function(e,t){return function(n){return n.type===e&&n.exclude===t}},l=function(e){return e.words},u=function(e){return e.words.map((function(e){return e.toLowerCase()}))},h=s.filter(c("tag",!1)).map(l),p=s.filter(c("case-sensitive",!1)).map(l),g=s.filter(c("ignore-case",!1)).map(u),m=s.filter(c("property",!1)).map((function(e){return[e.property,e.words]})),f=s.filter(c("tag",!0)).map(l),b=s.filter(c("case-sensitive",!0)).map(l),y=s.filter(c("ignore-case",!0)).map(u),v=s.filter(c("property",!0)).map((function(e){return[e.property,e.words]})),E=function(e){return function(t){return t.some((function(t){return e.includes(t)}))}},T=function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return!o.filter((function(e){var t=Object(d.a)(e,2),r=t[0],i=t[1],o=r.toLowerCase()===n.toLowerCase(),s=a.some((function(e){return i.includes(e)}));return o&&s})).isEmpty()};return h.every(E(n))&&p.every(E(i))&&g.every(E(i.toLowerCase()))&&m.every(T)&&!f.some(E(n))&&!b.some(E(i))&&!y.some(E(i.toLowerCase()))&&!v.some(T)}));if("refile"===r){var u=e.get("selectedHeaderId"),h=Ce(i,u).map((function(e){return e.get("id")})).toJS();h.push(u),l=l.filter((function(e){return!h.includes(e.get("id"))}))}e.setIn(["search","filteredHeaders"],l)}e.setIn(["search","searchFilter"],n);var p=[];if(_.a.isEmpty(n))p=["TODO organice","-organice :medium","-DONE doc|man :assignee:none"];else{var g=function(e){return e.get("todoKeywordSets").flatMap((function(e){return e.get("keywords")})).toSet().toJS()}(e),m=Ve(i).toJS(),f=We(i).toJS();p=$n(g,m,f)(o,n,a)}return e.setIn(["search","searchFilterSuggestions"],p),e.asImmutable()},br=function(e,t){return e.set("orgFileErrorMessage",t.message)};function yr(e,t,n){return e=Ta(e,t),e=ka(e,n.headerId)}function vr(e){var t=e.state,n=e.headerIndex,a=e.subheaders,r=void 0===a?[]:a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"-";return t=t.updateIn(["headers",n,"nestingLevel"],o()),r.forEach((function(e,a){t=t.updateIn(["headers",n+a+1,"nestingLevel"],o())})),t;function o(){return function(e){return"-"===i?Math.max(e-1,1):e+1}}}var Er=function(e,t){return e.findIndex((function(e){return e.get("id")===t}))},Tr=function(e){return e.get("captureTemplates")||(e=e.set("captureTemplates",Object($.List)())),e.update("captureTemplates",(function(e){return e.push(Object($.fromJS)({id:_e(),description:"",letter:"",iconName:"",isAvailableInAllOrgFiles:!0,orgFilesWhereAvailable:[""],headerPaths:[""],shouldPrepend:!1,template:""}))}))},kr=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.setIn(["captureTemplates",n].concat(t.fieldPath),t.newValue)},wr=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(function(e){return e.push("")}))},_r=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"orgFilesWhereAvailable"],(function(e){return e.delete(t.orgFileAvailabilityIndex)}))},Sr=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(function(e){return e.push("")}))},Ir=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.updateIn(["captureTemplates",n,"headerPaths"],(function(e){return e.delete(t.headerPathIndex)}))},Or=function(e,t){var n=Er(e.get("captureTemplates"),t.templateId);return e.update("captureTemplates",(function(e){return e.delete(n)}))},Cr=function(e,t){return t.newSettings?function(e,t){var n=Object($.fromJS)(JSON.parse(t.captureTemplates)).map((function(e){return e.set("id",_e())}));return e.set("captureTemplates",n)}(e,t.newSettings):e},Dr=function(e,t){return e.update("captureTemplates",(function(e){return e.splice(t.fromIndex,1).splice(t.toIndex,0,e.get(t.fromIndex))}))};T.ActionCreators.undo=function(){return function(e){e({type:T.ActionTypes.UNDO}),e(Ct(!0)),e(tt({forceAction:"push"}))}},T.ActionCreators.redo=function(){return function(e){e({type:T.ActionTypes.REDO}),e(Ct(!0)),e(tt({forceAction:"push"}))}};var Ar=Object(v.c)({base:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_LOADING_MESSAGE":return _n(e,t);case"HIDE_LOADING_MESSAGE":return Sn(e);case"SET_FONT_SIZE":return In(e,t);case"SET_BULLET_STYLE":return On(e,t);case"SET_SHOULD_TAP_TODO_TO_ADVANCE":return Cn(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_UNIT":return Dn(e,t);case"SET_AGENDA_DEFAULT_DEADLINE_DELAY_VALUE":return An(e,t);case"SET_SHOULD_STORE_SETTINGS_IN_SYNC_BACKEND":return Nn(e,t);case"SET_SHOULD_LIVE_SYNC":return Pn(e,t);case"SET_SHOULD_SYNC_ON_BECOMING_VISIBLE":return Ln(e,t);case"SET_SHOULD_SHOW_TITLE_IN_ORG_FILE":return Rn(e,t);case"SET_HAS_UNSEEN_CHANGELOG":return jn(e,t);case"SET_LAST_SEEN_CHANGELOG_HEADER":return xn(e,t);case"SET_LAST_VIEWED_FILE":return Mn(e,t);case"SET_CUSTOM_KEYBINDING":return Hn(e,t);case"RESTORE_BASE_SETTINGS":return Fn(e,t);case"PUSH_MODAL_PAGE":return Bn(e,t);case"POP_MODAL_PAGE":return Un(e);case"CLEAR_MODAL_STACK":return Vn(e);case"ACTIVATE_POPUP":return Wn(e,t);case"CLOSE_POPUP":return Gn(e);case"SET_IS_LOADING":return Kn(e,t);default:return e}},syncBackend:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_OUT":return zn(e);case"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING":return Yn(e,t);case"SET_IS_LOADING_MORE_DIRECTORY_LISTING":return Jn(e,t);default:return e}},org:k()((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.dirtying&&(e=e.set("isDirty",!0)),t.type){case"DISPLAY_FILE":return ga(e,t);case"STOP_DISPLAYING_FILE":return ma(e);case"TOGGLE_HEADER_OPENED":return ba(e,t);case"OPEN_HEADER":return fa(e,t);case"SELECT_HEADER":return ya(e,t);case"OPEN_PARENTS_OF_HEADER":return va(e,t);case"ADVANCE_TODO_STATE":return wa(e,t);case"ENTER_EDIT_MODE":return _a(e,t);case"EXIT_EDIT_MODE":return Sa(e);case"UPDATE_HEADER_TITLE":return Ia(e,t);case"UPDATE_HEADER_DESCRIPTION":return Oa(e,t);case"ADD_HEADER":return Ca(e,t);case"SELECT_NEXT_SIBLING_HEADER":return Da(e,t);case"SELECT_NEXT_VISIBLE_HEADER":return Aa(e);case"SELECT_PREVIOUS_VISIBLE_HEADER":return Na(e);case"REMOVE_HEADER":return Pa(e,t);case"MOVE_HEADER_UP":return La(e,t);case"MOVE_HEADER_DOWN":return Ra(e,t);case"MOVE_HEADER_LEFT":return ja(e,t);case"MOVE_HEADER_RIGHT":return xa(e,t);case"MOVE_SUBTREE_LEFT":return Ma(e,t);case"MOVE_SUBTREE_RIGHT":return Ha(e,t);case"REFILE_SUBTREE":return Fa(e,t);case"APPLY_OPENNESS_STATE":return Va(e);case"SET_DIRTY":return Wa(e,t);case"FOCUS_HEADER":return Ba(e,t);case"UNFOCUS_HEADER":return Ua(e);case"SET_SELECTED_TABLE_CELL_ID":return Ga(e,t);case"ADD_NEW_TABLE_ROW":return za(e);case"REMOVE_TABLE_ROW":return Ya(e);case"ADD_NEW_TABLE_COLUMN":return Ja(e);case"REMOVE_TABLE_COLUMN":return Xa(e);case"MOVE_TABLE_ROW_DOWN":return qa(e);case"MOVE_TABLE_ROW_UP":return $a(e);case"MOVE_TABLE_COLUMN_LEFT":return Za(e);case"MOVE_TABLE_COLUMN_RIGHT":return Qa(e);case"UPDATE_TABLE_CELL_VALUE":return er(e,t);case"INSERT_CAPTURE":return tr(e,t);case"CLEAR_PENDING_CAPTURE":return nr(e);case"ADVANCE_CHECKBOX_STATE":return ar(e,t);case"SET_LAST_SYNC_AT":return rr(e,t);case"SET_HEADER_TAGS":return ir(e,t);case"REORDER_TAGS":return or(e,t);case"REORDER_PROPERTY_LIST":return sr(e,t);case"UPDATE_TIMESTAMP_WITH_ID":return cr(e,t);case"UPDATE_PLANNING_ITEM_TIMESTAMP":return lr(e,t);case"ADD_NEW_PLANNING_ITEM":return ur(e,t);case"REMOVE_PLANNING_ITEM":return dr(e,t);case"UPDATE_PROPERTY_LIST_ITEMS":return hr(e,t);case"SET_ORG_FILE_ERROR_MESSAGE":return br(e,t);case"SET_LOG_ENTRY_STOP":return pr(e,t);case"CREATE_LOG_ENTRY_START":return gr(e,t);case"UPDATE_LOG_ENTRY_TIME":return mr(e,t);case"SET_SEARCH_FILTER_INFORMATION":return fr(e,t);default:return e}}),{filter:Object(T.includeAction)(["ADD_HEADER","REMOVE_HEADER","MOVE_HEADER_UP","MOVE_HEADER_DOWN","MOVE_HEADER_LEFT","MOVE_HEADER_RIGHT","MOVE_SUBTREE_LEFT","MOVE_SUBTREE_RIGHT","ADVANCE_TODO_STATE","UPDATE_HEADER_TITLE","UPDATE_HEADER_DESCRIPTION","ADD_NEW_TABLE_ROW","ADD_NEW_TABLE_COLUMN","MOVE_TABLE_ROW_DOWN","MOVE_TABLE_ROW_UP","MOVE_TABLE_COLUMN_LEFT","MOVE_TABLE_COLUMN_RIGHT","INSERT_CAPTURE","REFILE_SUBTREE","SET_HEADER_TAGS","UPDATE_PROPERTY_LIST_ITEMS","ADD_NEW_PLANNING_ITEM","REMOVE_PLANNING_ITEM","CREATE_LOG_ENTRY_START","SET_LOG_ENTRY_STOP"])}),capture:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Object($.Map)(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_NEW_EMPTY_CAPTURE_TEMPLATE":return Tr(e);case"UPDATE_TEMPLATE_FIELD_PATH_VALUE":return kr(e,t);case"ADD_NEW_TEMPLATE_ORG_FILE_AVAILABILITY":return wr(e,t);case"REMOVE_TEMPLATE_ORG_FILE_AVAILABILITY":return _r(e,t);case"ADD_NEW_TEMPLATE_HEADER_PATH":return Sr(e,t);case"REMOVE_TEMPLATE_HEADER_PATH":return Ir(e,t);case"DELETE_TEMPLATE":return Or(e,t);case"RESTORE_CAPTURE_SETTINGS":return Cr(e,t);case"REORDER_CAPTURE_TEMPLATE":return Dr(e,t);default:return e}}}),Nr=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||v.d,Pr=function(){!function(){if(mn){var e=localStorage.getItem("accessToken");e&&(localStorage.setItem("dropboxAccessToken",e),localStorage.removeItem("accessToken"))}}(),function(){if(mn){var e=localStorage.getItem("shouldStoreSettingsInDropbox");e&&(localStorage.setItem("shouldStoreSettingsInSyncBackend",e),localStorage.removeItem("shouldStoreSettingsInDropbox"))}}()},Lr=function(e){var t=Object.create(null);return"string"!==typeof e?t:(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var n=e.replace(/\+/g," ").split("="),a=n.shift(),r=n.length>0?n.join("="):void 0;a=decodeURIComponent(a),r=void 0===r?null:decodeURIComponent(r),void 0===t[a]?t[a]=r:Array.isArray(t[a])?t[a].push(r):t[a]=[t[a],r]})),t):t},Rr=n(21),jr=n(36),xr=function(){return function(e,t){switch(t().syncBackend.get("client",{}).type){case"WebDAV":["Endpoint","Username","Password"].forEach((function(e){kn("webdav"+e,null)}));break;case"Dropbox":kn("dropboxAccessToken",null);break;case"Google Drive":gapi.auth2.getAuthInstance().signOut()}kn("authenticatedSyncService",null),e({type:"SIGN_OUT"}),e(Y()),e(I())}},Mr=function(e,t,n){return{type:"SET_CURRENT_FILE_BROWSER_DIRECTORY_LISTING",directoryListing:e,hasMore:t,additionalSyncBackendState:n}},Hr=function(e){return{type:"SET_IS_LOADING_MORE_DIRECTORY_LISTING",isLoadingMore:e}},Fr=function(e){return function(t,n){t(S("Getting listing...")),n().syncBackend.get("client").getDirectoryListing(e).then((function(e){var n=e.listing,a=e.hasMore,r=e.additionalSyncBackendState;t(Mr(n,a,r)),t(I())})).catch((function(e){alert("There was an error retrieving files!"),console.error(e),t(I())}))}},Br=function(){return function(e,t){e(Hr(!0));var n=t().syncBackend.get("client"),a=t().syncBackend.get("currentFileBrowserDirectoryListing");n.getMoreDirectoryListing(a.get("additionalSyncBackendState")).then((function(t){var n=t.listing,r=t.hasMore,i=t.additionalSyncBackendState,o=a.get("listing").concat(n);e(Mr(o,r,i)),e(Hr(!1))}))}},Ur=function(e,t){return function(n,a){var r=a().syncBackend.get("client");switch(r.type){case"Dropbox":case"WebDAV":r.createFile("".concat(e,".organice-bak"),t);break;case"Google Drive":e=e.startsWith("/")?e.substr(1):e,r.duplicateFile(e,(function(e){return"".concat(e,".organice-bak")}))}}},Vr=function(e){return function(t,n){t(S("Downloading file...")),n().syncBackend.get("client").getFileContents(e).then((function(n){t(Ct(!1)),t(I()),t(Ur(e,n)),t(Ze(Object(Xe.a)(new Date,5))),t($e(e,n)),t(Ot()),t(T.ActionCreators.clearHistory())})).catch((function(){t(I()),t(O(!1)),t($t("File not found"))}))}},Wr=n(97),Gr=function(e){var t=new Wr.Dropbox({accessToken:e,fetch:fetch}),n=function(e){var t=function(e){return e.filter((function(e){return"folder"===e[".tag"]||e.name.match(/org$|org_archive$/)})).sort((function(e,t){return"folder"===e[".tag"]&&"file"===t[".tag"]?-1:e.name>t.name?1:-1}))}(e);return Object($.fromJS)(t.map((function(e){return{id:e.id,name:e.name,isDirectory:"folder"===e[".tag"],path:e.path_display}})))},a=function(e,n){return new Promise((function(a,r){return t.filesUpload({path:e,contents:n,mode:{".tag":"overwrite"},autorename:!0}).then(a).catch(r)}))},r=function(e){return new Promise((function(n,a){return t.filesDownload({path:e}).then((function(e){var t=new FileReader;t.addEventListener("loadend",(function(){return n({contents:t.result,lastModifiedAt:e.server_modified})})),t.readAsText(e.fileBlob)})).catch((function(e){var t=function(){try{return"not_found"===JSON.parse(e.error).error.path[".tag"]}catch(t){return!1}}();("string"===typeof e&&e.match(/missing required field 'path'/)||t)&&a()}))}))};return{type:"Dropbox",isSignedIn:function(){return new Promise((function(e){return e(!0)}))},getDirectoryListing:function(e){return new Promise((function(a,r){t.filesListFolder({path:e}).then((function(e){return a({listing:n(e.entries),hasMore:e.has_more,additionalSyncBackendState:Object($.Map)({cursor:e.cursor})})})).catch(r)}))},getMoreDirectoryListing:function(e){var a=e.get("cursor");return new Promise((function(e,r){return t.filesListFolderContinue({cursor:a}).then((function(t){return e({listing:n(t.entries),hasMore:t.has_more,additionalSyncBackendState:Object($.Map)({cursor:t.cursor})})}))}))},updateFile:a,createFile:a,getFileContentsAndMetadata:r,getFileContents:function(e){return Object(w.isEmpty)(e)?Promise.reject("No path given"):new Promise((function(t,n){return r(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))},deleteFile:function(e){return new Promise((function(n,a){return t.filesDelete({path:e}).then(n).catch((function(e){return a("path_lookup"===e.error.error[".tag"],e)}))}))}}},Kr=function(){var e=function(){var e=!1,t=!1,n=[];return function(){return new Promise((function(a,r){e?a(window.gapi):window.gapi&&!t?(t=!0,new Promise((function(e,t){return window.gapi.load("client:auth2",(function(){window.location.hash=window.initialHash,window.gapi.client.init({client_id:"744091668516-pb0nf1k8kjfoml3d84pr4q4csh86r7ar.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive.file"}).then(e)}))})).then((function(){e=!0,n.forEach((function(e){return e(window.gapi)})),a(window.gapi)}))):n.push(a)}))}}();window.gapi?e():window.handleGoogleDriveClientLoad=e;var t=function(e){return Object($.fromJS)(e.map((function(e){return{id:e.id,name:e.name,isDirectory:"application/vnd.google-apps.folder"===e.mimeType,path:"/".concat(e.id)}})))},n=function(n){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=new Promise((function(r,i){e().then((function(e){e.client.drive.files.list({pageSize:30,fields:"nextPageToken, files(id, name, mimeType, parents)",q:"'".concat(""===n?"root":n,"' in parents and trashed = false"),pageToken:a}).then((function(e){r({listing:t(e.result.files),hasMore:!!e.result.nextPageToken,additionalSyncBackendState:Object($.Map)({currentDirectoryId:n,nextPageToken:e.result.nextPageToken})})})).catch(i)}))})),i=new Promise((function(t,a){""===n?t(null):e().then((function(e){return e.client.drive.files.get({fileId:n,fields:"parents"})})).then((function(e){e.result.parents?t(e.result.parents[0]):t(null)})).catch(a)})),o=new Promise((function(t,n){window.rootFolderId?t(window.rootFolderId):e().then((function(e){return e.client.drive.files.get({fileId:"root",fields:"id"})})).then((function(e){window.rootFolderId=e.result.id,t(e.result.id)})).catch(n)}));return new Promise((function(e,t){Promise.all([r,i,o]).then((function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=r===n[2]?"":r;a.additionalSyncBackendState=a.additionalSyncBackendState.set("parentId",i),e(a)}))}))},a=function(t,n){return new Promise((function(a,r){e().then((function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")})})).then((function(e){return a(e.result.files.length>0?e.result.files[0].id:null)})).catch(r)}))},r=function(t,n){return t=t.startsWith("/")?t.substr(1):t,e().then((function(e){fetch("https://www.googleapis.com/upload/drive/v3/files/".concat(t,"?uploadType=media"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(e.auth.getToken().access_token)},body:n})}))},i=function(t){return new Promise((function(n,a){if(!t)return a();e().then((function(e){t=t.startsWith("/")?t.substr(1):t;var r=new Promise((function(n){e.client.drive.files.get({fileId:t,alt:"media"}).then((function(e){return n(decodeURIComponent(escape(e.body)))})).catch((function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()}))})),i=new Promise((function(n){e.client.drive.files.get({fileId:t,fields:"modifiedTime"}).then((function(e){n(e.result.modifiedTime)})).catch((function(e){e.body&&"notFound"===JSON.parse(e.body).error.errors[0].reason&&a()}))}));Promise.all([r,i]).then((function(e){var t=Object(d.a)(e,2),a=t[0],r=t[1];n({contents:a,lastModifiedAt:r})}))}))}))},o=function(e){return new Promise((function(t,n){return i(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))};return{type:"Google Drive",isSignedIn:function(){return new Promise((function(t,n){return e().then((function(e){return t(e.auth2.getAuthInstance().isSignedIn.get())}))}))},getDirectoryListing:function(e){return n(e.startsWith("/")?e.substr(1):e)},getMoreDirectoryListing:function(e){var t=e.get("currentDirectoryId"),a=e.get("nextPageToken");return n(t,a)},updateFile:r,createFile:function(t,n,i){return new Promise((function(o,s){a(t,n).then((function(a){return a?r(a,i).then(o).catch(s):e().then((function(e){e.client.drive.files.create({name:t,parents:n}).then((function(e){return r(e.result.id,i)})).then(o).catch(s)}))})).catch(s)}))},duplicateFile:function(t,n){return new Promise((function(r,i){e().then((function(e){e.client.drive.files.get({fileId:t,fields:"name, parents"}).then((function(o){if(o.result.name){var s=n(o.result.name),c=o.result.parents[0];a(s,c).then((function(n){var a=function(){e.client.drive.files.copy({fileId:t,parents:c,name:s}).then((function(e){r()})).catch(i)};n?e.client.drive.files.delete({fileId:n}).then(a).catch(i):a()}))}else i()}))}))}))},getFileContentsAndMetadata:i,getFileContents:o,getFileContentsByNameAndParent:function(e,t){return new Promise((function(n,r){return a(e,t).then((function(e){e?o(e).then(n):r()}))}))},deleteFileByNameAndParent:function(t,n){return new Promise((function(a,r){e().then((function(e){return e.client.drive.files.list({pageSize:1,fields:"files(id)",q:"'".concat(n,"' in parents and trashed = false and name = '").concat(t,"'")}).then((function(t){t.result.files.length>0?e.client.drive.files.delete({fileId:t.result.files[0].id}).then(a).catch(r):a()}))}))}))}}},zr=n(225),Yr=(n(393),n(51)),Jr=(n(394),n(8)),Xr=n.n(Jr),qr=(n(395),function(){return c.a.createElement("div",{className:"privacy-policy-container"},c.a.createElement("h1",null,"Privacy Policy"),c.a.createElement("p",null,"Last updated: September 6nd, 2019"),c.a.createElement("p",null,c.a.createElement("a",{href:"https://200ok.ch/"},"200ok llc")," operates the https://organice.200ok.ch website and mobile apps."),c.a.createElement("p",null,"This page is used to inform website visitors regarding our policies with the collection, use, and disclosure of Personal Information if anyone decided to use our Service."),c.a.createElement("p",null,"If you choose to use our Service, then you agree to the collection and use of information in relation with this policy. The Personal Information that we collect are used for providing and improving the Service. We will not use or share your information with anyone except as described in this Privacy Policy."),c.a.createElement("p",null,c.a.createElement("strong",null,"Information Collection and Use")),c.a.createElement("p",null,"For a better experience while using our Service, we may require you to provide us with certain personally identifiable information, including but not limited to your name, phone number, and postal address. The information that we collect will be used to contact or identify you."),c.a.createElement("p",null,c.a.createElement("strong",null,"Log Data")),c.a.createElement("p",null,"We want to inform you that whenever you visit our Service, we collect information that your browser sends to us that is called Log Data. This Log Data may include information such as your computer\u2019s Internet Protocol (\u201cIP\u201d) address, browser version, pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics."),c.a.createElement("p",null,c.a.createElement("strong",null,"Cookies")),c.a.createElement("p",null,"Cookies are files with small amount of data that is commonly used an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer\u2019s hard drive."),c.a.createElement("p",null,"Our website uses these \u201ccookies\u201d to collection information and to improve our Service. You have the option to either accept or refuse these cookies, and know when a cookie is being sent to your computer. If you choose to refuse our cookies, you may not be able to use some portions of our Service."),c.a.createElement("p",null,c.a.createElement("strong",null,"Service Providers")),c.a.createElement("p",null,"We may employ third-party companies and individuals due to the following reasons:"),c.a.createElement("ul",null,c.a.createElement("li",null,"To facilitate our Service;"),c.a.createElement("li",null,"To provide the Service on our behalf;"),c.a.createElement("li",null,"To perform Service-related services; or"),c.a.createElement("li",null,"To assist us in analyzing how our Service is used.")),c.a.createElement("p",null,"We want to inform our Service users that these third parties have access to your Personal Information. The reason is to perform the tasks assigned to them on our behalf. However, they are obligated not to disclose or use the information for any other purpose."),c.a.createElement("p",null,c.a.createElement("strong",null,"Security")),c.a.createElement("p",null,"We value your trust in providing us your Personal Information, thus we are striving to use commercially acceptable means of protecting it. But remember that no method of transmission over the internet, or method of electronic storage is 100% secure and reliable, and we cannot guarantee its absolute security."),c.a.createElement("p",null,c.a.createElement("strong",null,"Links to Other Sites")),c.a.createElement("p",null,"Our Service may contain links to other sites. If you click on a third-party link, you will be directed to that site. Note that these external sites are not operated by us. Therefore, we strongly advise you to review the Privacy Policy of these websites. We have no control over, and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services."),c.a.createElement("p",null,c.a.createElement("strong",null,"Children\u2019s Privacy")),c.a.createElement("p",null,"Our Services do not address anyone under the age of 13. We do not knowingly collect personal identifiable information from children under 13. In the case we discover that a child under 13 has provided us with personal information, we immediately delete this from our servers. If you are a parent or guardian and you are aware that your child has provided us with personal information, please contact us so that we will be able to do necessary actions."),c.a.createElement("p",null,c.a.createElement("strong",null,"Changes to This Privacy Policy")),c.a.createElement("p",null,"We may update our Privacy Policy from time to time. Thus, we advise you to review this page periodically for any changes. We will notify you of any changes by posting the new Privacy Policy on this page. These changes are effective immediately, after they are posted on this page."),c.a.createElement("p",null,c.a.createElement("strong",null,"Contact us")),c.a.createElement("p",null,"If you have any questions about this Privacy Policy, please"," ",c.a.createElement("a",{href:"mailto:info@200ok.ch"},"contact us"),"."))}),$r=n(98),Zr=n.n($r),Qr=(n(396),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleChangelogClick","handleModalPageDoneClick","handleHeaderBarTitleClick","handleSettingsSubPageBackClick","handleUndoClick","handleRedoClick","handleHelpClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"getPathRoot",value:function(){return this.props.location.pathname.split("/")[1]}},{key:"getFilename",value:function(){var e=this.props.location.pathname;return e.includes(".org")?e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")):""}},{key:"renderFileBrowserBackButton",value:function(){var e=this.props,t=e.location.pathname;if("Google Drive"===e.syncBackendType)return c.a.createElement("div",null);var n=t.substr("/files".length);if(n.endsWith("/")&&(n=n.substring(0,n.length-1)),""===n)return c.a.createElement("div",null);var a=n.split("/"),r=a[a.length-2],i=a.slice(0,a.length-1).join("/");return c.a.createElement(Rr.b,{to:"/files".concat(i),className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},r,"/"))}},{key:"renderOrgFileBackButton",value:function(){var e=this.props.location.pathname.substr("/file".length);e.endsWith("/")&&(e=e.substring(0,e.length-1));var t=e.split("/"),n=t.slice(0,t.length-1).join("/");return c.a.createElement(Rr.b,{to:"/files".concat(n),className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"File browser"))}},{key:"renderLogo",value:function(){return c.a.createElement("div",{className:"header-bar__logo-container"},c.a.createElement("img",{className:"header-bar__logo",src:Zr.a,alt:"Logo",width:"30",height:"30"}),c.a.createElement("h2",{className:"header-bar__app-name"},"organice"))}},{key:"renderSampleFileBackButton",value:function(){return c.a.createElement(Rr.b,{to:"/",className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"renderSignInBackButton",value:function(){return c.a.createElement(Rr.b,{to:"/",className:"header-bar__back-button"},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Home"))}},{key:"handleSettingsSubPageBackClick",value:function(){this.props.base.popModalPage()}},{key:"renderSettingsSubPageBackButton",value:function(){return c.a.createElement("div",{className:"header-bar__back-button",onClick:this.handleSettingsSubPageBackClick},c.a.createElement("i",{className:"fas fa-chevron-left"}),c.a.createElement("span",{className:"header-bar__back-button__directory-path"},"Settings"))}},{key:"renderBackButton",value:function(){switch(this.props.activeModalPage){case"changelog":case"keyboard_shortcuts_editor":case"capture_templates_editor":case"sample":return this.renderSettingsSubPageBackButton();case"settings":return c.a.createElement("div",null)}switch(this.getPathRoot()){case"":return this.renderLogo();case"files":return this.renderFileBrowserBackButton();case"file":return this.renderOrgFileBackButton();case"sample":return this.renderSampleFileBackButton();case"sign_in":return this.renderSignInBackButton();default:return c.a.createElement("div",null)}}},{key:"renderTitle",value:function(){var e=this,t=function(t){return c.a.createElement("div",{className:"header-bar__title",onClick:e.handleHeaderBarTitleClick},t)};switch(this.props.activeModalPage){case"changelog":return t("Changelog");case"settings":return t("Settings");case"keyboard_shortcuts_editor":return t("Shortcuts");case"capture_templates_editor":return t("Capture");case"sample":return t("Sample")}switch(this.getPathRoot()){case"sample":return t("Sample");case"sign_in":return t("Sign in")}return t(this.props.shouldShowTitleInOrgFile?this.getFilename():"")}},{key:"handleChangelogClick",value:function(){this.props.base.pushModalPage("changelog")}},{key:"handleModalPageDoneClick",value:function(){this.props.base.clearModalStack()}},{key:"handleHeaderBarTitleClick",value:function(){this.props.org.selectHeader(null)}},{key:"handleUndoClick",value:function(){this.props.isUndoEnabled&&this.props.undo.undo()}},{key:"handleRedoClick",value:function(){this.props.isRedoEnabled&&this.props.undo.redo()}},{key:"handleHelpClick",value:function(){this.props.base.pushModalPage("settings"),this.props.base.pushModalPage("sample")}},{key:"renderActions",value:function(){var e=this.props,t=e.isAuthenticated,n=e.hasUnseenChangelog,a=e.activeModalPage,r=e.path,i=e.isUndoEnabled,o=e.isRedoEnabled;if(a)return c.a.createElement("div",{className:"header-bar__actions",onClick:this.handleModalPageDoneClick},"Done");var l=Xr()("fas fa-undo header-bar__actions__item",{"header-bar__actions__item--disabled":!i}),u=Xr()("fas fa-redo header-bar__actions__item",{"header-bar__actions__item--disabled":!o}),d=Xr()("fas fa-cogs header-bar__actions__item");return c.a.createElement("div",{className:"header-bar__actions"},!t&&"sign_in"!==this.getPathRoot()&&c.a.createElement(Rr.b,{to:"/sign_in"},c.a.createElement("div",{className:"header-bar__actions__item",title:"Sign in"},"Sign in")),!t&&c.a.createElement("a",{href:"https://github.com/200ok-ch/organice",target:"_blank",rel:"noopener noreferrer"},c.a.createElement("i",{className:"fab fa-github header-bar__actions__item"})),t&&!a&&!!r&&c.a.createElement(s.Fragment,null,c.a.createElement("i",{className:l,onClick:this.handleUndoClick,title:"Undo"}),c.a.createElement("i",{className:u,onClick:this.handleRedoClick,title:"Redo"}),c.a.createElement("i",{className:"fas fa-question-circle header-bar__actions__item",onClick:this.handleHelpClick,title:"Help"})),t&&c.a.createElement("div",null,n&&c.a.createElement("i",{className:"changelog-icon--has-unseen-changelog header-bar__actions__item fas fa-gift",onClick:this.handleChangelogClick}),c.a.createElement(Rr.b,{to:"/settings"},c.a.createElement("i",{className:d,title:"Settings"}))))}},{key:"render",value:function(){var e=Xr()("header-bar",{"header-bar--with-logo":""===this.getPathRoot()});return c.a.createElement("div",{className:e},this.renderBackButton(),this.renderTitle(),this.renderActions())}}]),t}(s.PureComponent)),ei=Object(Yr.h)(Object(y.b)((function(e,t){return{isAuthenticated:e.syncBackend.get("isAuthenticated"),hasUnseenChangelog:e.base.get("hasUnseenChangelog"),activeModalPage:e.base.get("modalPageStack",Object($.List)()).last(),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),path:e.org.present.get("path"),isUndoEnabled:e.org.past.length>0,isRedoEnabled:e.org.future.length>0,syncBackendType:e.syncBackend.get("client")&&e.syncBackend.get("client").type}}),(function(e){return{base:Object(v.b)(a,e),org:Object(v.b)(r,e),undo:Object(v.b)(T.ActionCreators,e)}}))(Qr)),ti=(n(398),function(){return c.a.createElement("main",{className:"landing-container-wrapper"},c.a.createElement("div",{className:"landing-container"},c.a.createElement("h1",{className:"landing-app-name"},"organice"),c.a.createElement("img",{className:"landing-logo",src:Zr.a,alt:"Logo"}),c.a.createElement("h2",{className:"landing-tagline"},"organice organizes Org files nicely!"),c.a.createElement("h2",{className:"landing-tagline"},"Syncs with Dropbox,",c.a.createElement("br",null)," Google Drive and WebDAV."),c.a.createElement(Rr.b,{to:"/sample"},c.a.createElement("div",{className:"btn landing-button view-sample-button"},"View sample")),c.a.createElement(Rr.b,{to:"/sign_in"},c.a.createElement("div",{className:"btn landing-button"},"Sign in"))),c.a.createElement("footer",null,c.a.createElement(Rr.b,{to:"/privacy-policy"},"Privacy Policy")))}),ni=(n(399),Object(y.b)((function(e,t){var n=e.syncBackend.get("currentFileBrowserDirectoryListing");return{syncBackendType:e.syncBackend.get("client").type,listing:n?n.get("listing"):null,hasMore:!!n&&n.get("hasMore"),isLoadingMore:!!n&&n.get("isLoadingMore"),additionalSyncBackendState:!!n&&n.get("additionalSyncBackendState")}}),(function(e){return{syncBackend:Object(v.b)(o,e)}}))((function(e){var t=e.path,n=e.listing,a=e.hasMore,r=e.isLoadingMore,i=e.syncBackendType,o=e.syncBackend,l=e.additionalSyncBackendState;Object(s.useEffect)((function(){return o.getDirectoryListing(t)}),[o,t]);var u=""===t;return c.a.createElement("div",{className:"file-browser-container"},"Dropbox"===i&&c.a.createElement("h3",{className:"file-browser__header"},"Directory: ",u?"/":t),c.a.createElement("ul",{className:"file-browser__file-list"},!u&&c.a.createElement(Rr.b,{to:"/files".concat(function(){switch(i){case"Dropbox":case"WebDAV":var e=t.split("/");return e.slice(0,e.length-1).join("/");case"Google Drive":return l.get("parentId")?"/"+l.get("parentId"):null;default:return null}}())},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:"fas fa-folder file-browser__file-list__icon--directory"})," ..")),(n||[]).map((function(e){var t=e.get("isDirectory"),n=e.get("name").endsWith(".organice-bak"),a=e.get("name").endsWith(".org"),r=".organice-config.json"===e.get("name"),i=Xr()("file-browser__file-list__icon fas",{"fa-folder":t,"file-browser__file-list__icon--directory":t,"fa-file":!t&&!n&&!r,"file-browser__file-list__icon--not-org":!a,"fa-copy":n,"fa-cogs":r});return e.get("isDirectory")?c.a.createElement(Rr.b,{to:"/files".concat(e.get("path")),key:e.get("id")},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:i})," ",e.get("name"),"/")):c.a.createElement(Rr.b,{to:"/file".concat(e.get("path")),key:e.get("id")},c.a.createElement("li",{className:"file-browser__file-list__element"},c.a.createElement("i",{className:i})," ",e.get("name")))})),a&&(r?c.a.createElement("li",{className:"file-browser__file-list__loading-more-container"},c.a.createElement("i",{className:"fas fa-spinner fa-lg fa-spin"})):c.a.createElement("li",{className:"file-browser__file-list__element file-browser__file-list__element--load-more-row",onClick:function(){return o.loadMoreDirectoryListing()}},"Load more..."))))}))),ai=n(19),ri=(n(407),function(e){var t=e.message,n=Object(s.useState)(!0),a=Object(d.a)(n,2),r=a[0],i=a[1],o=Object(s.useState)(t),l=Object(d.a)(o,2),u=l[0],h=l[1];Object(s.useEffect)((function(){t&&(h(t),i(!0))}),[t]);var p=function(){return i(!1)};if(!r)return null;var g={opacity:Object(ai.spring)(t?.9:0,{stiffness:300})};return c.a.createElement(ai.Motion,{style:g,onRest:function(){t||(i(!1),h(null))}},(function(e){return c.a.createElement("div",{className:"loading-indicator",style:e,onClick:p},u)}))}),ii=n(227),oi=(n(409),n(410),n(228)),si=n(53),ci=(n(412),n(413),n(414),n(415),n(416),function(e){var t=e.subPartDataAndHandlers,n=t.onEnterTableEditMode,a=t.onAddNewTableRow,r=t.onRemoveTableRow,i=t.onAddNewTableColumn,o=t.onRemoveTableColumn;return c.a.createElement("div",{className:"table-action-drawer-container"},c.a.createElement("div",{className:" table-action-drawer__edit-icon-container",onClick:n},c.a.createElement("i",{className:"fas fa-pencil-alt fa-lg"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:a},c.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:r},c.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon table-action-drawer__sub-icon--rotated"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:i},c.a.createElement("i",{className:"fas fa-plus fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})),c.a.createElement("div",{className:"table-action-drawer__sub-icon-container",onClick:o},c.a.createElement("i",{className:"fas fa-times fa-lg table-action-drawer__main-icon"}),c.a.createElement("i",{className:"fas fa-columns fa-sm table-action-drawer__sub-icon"})))}),li=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleCellSelect","handleTextareaBlur","handleCellChange","handleInsertTimestamp","handleTextareaRef"]),n.state={rawCellValues:n.generateCellValueMap(e.table),shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=this.props.subPartDataAndHandlers,n=t.onTableCellValueUpdate,a=t.selectedTableCellId,r=t.inTableEditMode,i=this.state.rawCellValues;e.subPartDataAndHandlers.inTableEditMode&&!r&&i.has(a)&&n(a,i.get(a)),this.props.table!==e.table&&this.setState({rawCellValues:this.generateCellValueMap(this.props.table)})}},{key:"generateCellValueMap",value:function(e){return Object($.Map)(e.get("contents").map((function(e){return e.get("contents").map((function(e){return[e.get("id"),e.get("rawContents")]}))})).flatten())}},{key:"handleCellSelect",value:function(e){var t=this;return function(){return t.props.subPartDataAndHandlers.onTableCellSelect(e)}}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout((function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.subPartDataAndHandlers.onExitTableEditMode()}),0)}},{key:"handleCellChange",value:function(e){var t=this.state.rawCellValues,n=this.props.subPartDataAndHandlers.selectedTableCellId;this.setState({rawCellValues:t.set(n,e.target.value)})}},{key:"handleInsertTimestamp",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.rawCellValues,t=this.props.subPartDataAndHandlers.selectedTableCellId,n=e.get(t),a=this.textarea.selectionStart;this.setState({rawCellValues:e.set(t,n.substring(0,a)+ge()+n.substring(this.textarea.selectionEnd||a))}),this.textarea.focus()}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"render",value:function(){var e=this,t=this.props,n=t.table,a=t.subPartDataAndHandlers,r=a.selectedTableCellId,i=a.inTableEditMode,o=a.shouldDisableActions,l=this.state.rawCellValues,u=n.get("contents").some((function(e){return e.get("contents").some((function(e){return e.get("id")===r}))}));return c.a.createElement(s.Fragment,null,c.a.createElement("table",{className:"table-part"},c.a.createElement("tbody",null,n.get("contents").map((function(t){return c.a.createElement("tr",{key:t.get("id")},t.get("contents").map((function(t){var n=t.get("id")===r,a=Xr()("table-part__cell",{"table-part__cell--selected":n});return c.a.createElement("td",{className:a,key:t.get("id"),onClick:e.handleCellSelect(t.get("id"))},n&&i?c.a.createElement("div",{className:"table-cell__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"3",value:l.get(t.get("id")),onBlur:e.handleTextareaBlur,onChange:e.handleCellChange,ref:e.handleTextareaRef}),c.a.createElement("div",{className:"table-cell__insert-timestamp-button",onClick:e.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):t.get("contents").size>0?c.a.createElement(fi,{parts:t.get("contents"),subPartDataAndHandlers:e.props.subPartDataAndHandlers}):"   ")})))})))),c.a.createElement(si.UnmountClosed,{isOpened:u&&!o},c.a.createElement(ci,{subPartDataAndHandlers:this.props.subPartDataAndHandlers})))}}]),t}(s.PureComponent),ui=(n(417),function(e,t,n){return{r:parseInt((t.r-e.r)*n+e.r,10),g:parseInt((t.g-e.g)*n+e.g,10),b:parseInt((t.b-e.b)*n+e.b,10),a:(t.a-e.a)*n+e.a}}),di=function(e,t,n,a){return{r:e,g:t,b:n,a:a}},hi=function(e){return"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(e.a,")")},pi=(n(418),function(e){var t=e.state,n=e.onClick,a=di(255,255,255,1),r=di(238,232,213,1),i={colorFactor:Object(ai.spring)({checked:1,partial:1,unchecked:0}[t],{stiffness:300})};return c.a.createElement(ai.Motion,{style:i},(function(e){var i=hi(ui(a,r,e.colorFactor));return c.a.createElement("div",{className:"checkbox",onClick:n,style:{backgroundColor:i}},c.a.createElement("div",{className:"checkbox__inner-container"},"checked"===t&&c.a.createElement("i",{className:"fas fa-check"}),"partial"===t&&c.a.createElement("i",{className:"fas fa-minus"})))}))}),gi=function(e){var t=e.part,n=e.subPartDataAndHandlers,a=function(){return t.get("items").map((function(e){var t,a=Xr()({"list-part__checkbox-container":e.get("isCheckbox")});return c.a.createElement("li",{key:e.get("id"),value:e.get("forceNumber")},c.a.createElement("span",{className:a,onClick:e.get("isCheckbox")?(t=e.get("id"),function(){return n.onCheckboxClick(t)}):null},e.get("isCheckbox")&&c.a.createElement(pi,{state:e.get("checkboxState")}),c.a.createElement(fi,{parts:e.get("titleLine"),subPartDataAndHandlers:n})),c.a.createElement("br",null),c.a.createElement(fi,{parts:e.get("contents"),subPartDataAndHandlers:n}))}))};return t.get("isOrdered")?c.a.createElement("ol",{className:"attributed-string__list-part attributed-string__list-part--ordered"},a()):c.a.createElement("ul",{className:"attributed-string__list-part"},a())},mi=(n(419),function(e){var t=e.part,n=e.subPartDataAndHandlers,a=n.onTimestampClick,r=n.shouldDisableActions,i=t.get("firstTimestamp"),o=t.get("secondTimestamp");return c.a.createElement("span",{className:"attributed-string__timestamp-part",onClick:function(){return r?void 0:a(t.get("id"))}},!!i&&he(i),!!o&&c.a.createElement(s.Fragment,null,"--",he(o)))}),fi=function(e){var t,n=e.parts,a=e.subPartDataAndHandlers;return c.a.createElement("span",null,n.map((function(e){switch(e.get("type")){case"text":return e.get("contents");case"link":var n=e.getIn(["contents","uri"]),r=e.getIn(["contents","title"])||n;return c.a.createElement("a",{key:e.get("id"),href:n,target:"_blank",rel:"noopener noreferrer"},r);case"percentage-cookie":return t=Xr()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":100===parseInt(e.get("percentage"),10)}),c.a.createElement("span",{key:e.get("id"),className:t},"[",e.get("percentage"),"%]");case"fraction-cookie":return t=Xr()("attributed-string__cookie-part",{"attributed-string__cookie-part--complete":""!==e.getIn(["fraction",0])&&e.getIn(["fraction",0])===e.getIn(["fraction",1])}),c.a.createElement("span",{key:e.get("id"),className:t},"[",e.getIn(["fraction",0]),"/",e.getIn(["fraction",1]),"]");case"table":return c.a.createElement(li,{key:e.get("id"),table:e,subPartDataAndHandlers:a});case"list":return c.a.createElement(gi,{key:e.get("id"),part:e,subPartDataAndHandlers:a});case"inline-markup":return t=Xr()("attributed-string__inline-markup","attributed-string__inline-markup--".concat(e.get("markupType"))),c.a.createElement("span",{key:e.get("id"),className:t},e.get("content"));case"timestamp":return c.a.createElement(mi,{key:e.get("id"),part:e,subPartDataAndHandlers:a});case"url":return c.a.createElement("a",{href:e.get("content"),key:e.get("id"),target:"_blank",rel:"noopener noreferrer"},e.get("content"));case"www-url":return c.a.createElement("a",{href:"https://".concat(e.get("content")),key:e.get("id"),target:"_blank",rel:"noopener noreferrer"},e.get("content"));case"e-mail":return c.a.createElement("a",{href:"mailto:".concat(e.get("content")),key:e.get("id")},e.get("content"));case"phone-number":return c.a.createElement("a",{href:"tel:".concat(e.get("content")),key:e.get("id")},e.get("content"));default:return console.error("Unrecognized attributed string part type! ".concat(e.get("type"))),""}})))},bi=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleRef","handleTitleSpanRef","handleTextareaRef","handleTitleClick","handleTextareaBlur","handleTextareaFocus","handleTitleChange","handleTitleFieldClick","handleTodoClick","handleTimestampClick","handleInsertTimestamp","handleTitleDoubleClick"]),n.state={titleValue:n.calculateRawTitle(e.header),containerWidth:null,shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderTitle(n.get("id"),this.state.titleValue),e.header!==this.props.header&&this.setState({titleValue:this.calculateRawTitle(this.props.header)},(function(){return t.storeContainerWidth()}))}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleTitleSpanRef",value:function(e){this.titleSpan=e}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"calculateRawTitle",value:function(e){return Ee(e.toJS(),!1)}},{key:"handleTitleClick",value:function(e){var t=this.props,n=t.header,a=t.hasContent,r=t.isSelected,i=t.onClick;i?i():(!a||n.get("opened")&&!r||this.props.org.toggleHeaderOpened(n.get("id")),this.props.org.selectHeader(n.get("id")))}},{key:"handleTitleDoubleClick",value:function(){console.log("handling edit title click"),this.props.org.enterEditMode("title")}},{key:"handleTodoClick",value:function(e){var t=this.props,n=t.header,a=t.shouldTapTodoToAdvance,r=t.onClick;r?(r(),e.stopPropagation()):(this.props.org.selectHeader(n.get("id")),a&&this.props.org.advanceTodoState())}},{key:"handleTextareaBlur",value:function(e){var t=this;setTimeout((function(){t.state.shouldIgnoreBlur?t.setState({shouldIgnoreBlur:!1}):t.props.org.exitEditMode()}),0)}},{key:"handleTextareaFocus",value:function(e){var t=this.props.header.getIn(["titleLine","rawTitle"]);if(console.log("handling text area focus targeet",e.target),""===t){var n=e.target.value;e.target.selectionStart=n.length,e.target.selectionEnd=n.length}else e.target.select()}},{key:"handleTitleChange",value:function(e){var t=e.target.value,n=t[t.length-1];this.state.titleValue!==t.substring(0,t.length-1)||"\n"!==n?this.setState({titleValue:t}):this.props.org.exitEditMode()}},{key:"handleTitleFieldClick",value:function(e){e.stopPropagation()}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleInsertTimestamp",value:function(e){this.setState({shouldIgnoreBlur:!0});var t=this.state.titleValue,n=this.textarea.selectionStart;this.setState({titleValue:t.substring(0,n)+ge()+t.substring(this.textarea.selectionEnd||n)}),this.textarea.focus(),e.stopPropagation()}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.color,a=e.hasContent,r=e.inEditMode,i=e.shouldDisableActions,o=e.shouldDisableExplicitWidth,s=e.todoKeywordSets,l=this.state.containerWidth,u=ze(s),d=t.getIn(["titleLine","todoKeyword"]),h={color:n,wordBreak:"break-word"};return c.a.createElement("div",{className:"title-line",onClick:this.handleTitleClick,onDoubleClick:this.handleTitleDoubleClick,ref:this.handleRef,style:{width:o?"":l}},!r&&d?c.a.createElement("span",{className:Xr()("todo-keyword",u(d)?"todo-keyword--done-state":null),onClick:this.handleTodoClick},d):"",r?c.a.createElement("div",{className:"title-line__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea","data-testid":"titleLineInput",rows:"3",ref:this.handleTextareaRef,value:this.state.titleValue,onBlur:this.handleTextareaBlur,onFocus:this.handleTextareaFocus,onChange:this.handleTitleChange,onClick:this.handleTitleFieldClick}),c.a.createElement("div",{className:"title-line__insert-timestamp-button",onClick:this.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):c.a.createElement("div",null,c.a.createElement("span",{style:h,ref:this.handleTitleSpanRef},c.a.createElement(fi,{parts:t.getIn(["titleLine","title"]),subPartDataAndHandlers:{onTimestampClick:this.handleTimestampClick,shouldDisableActions:i}}),!t.get("opened")&&a?"...":""),t.getIn(["titleLine","tags"]).size>0&&c.a.createElement("div",null,t.getIn(["titleLine","tags"]).toSet().toList().filter((function(e){return!!e})).map((function(e){return c.a.createElement("div",{className:"header-tag",key:e},e)})))))}}]),t}(s.PureComponent),yi=Object(y.b)((function(e,t){return{inEditMode:"title"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id"),todoKeywordSets:e.org.present.get("todoKeywordSets")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(bi),vi=(n(420),n(421),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleTimestampClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleTimestampClick",value:function(e){var t=this;return function(){return t.props.onClick(e)}}},{key:"render",value:function(){var e=this,t=this.props.planningItems;return 0===t.size?null:c.a.createElement("div",null,t.map((function(t,n){return c.a.createElement("div",{key:t.get("id"),className:"planning-items__item-container"},c.a.createElement("div",{className:"planning-item__type"},t.get("type"),": "),c.a.createElement("div",{className:"planning-item__timestamp",onClick:e.handleTimestampClick(n)},he(t.get("timestamp"))))})))}}]),t}(s.PureComponent)),Ei=(n(422),function(e){var t=e.propertyListItems,n=e.shouldDisableActions,a=e.onTimestampClick,r=e.onEdit,i=Object(s.useState)(!0),o=Object(d.a)(i,2),l=o[0],u=o[1];return 0===t.size?null:c.a.createElement("div",{className:"property-list-container"},c.a.createElement("div",{className:"property-list__property",onClick:function(){return u(!l)}},":PROPERTIES:",l?"...":""),!l&&c.a.createElement(s.Fragment,null,t.map((function(e){return c.a.createElement("div",{className:"property-list__item-container",key:e.get("id")},c.a.createElement("div",{className:"property-list__property",onClick:n?null:r},":",e.get("property"),":"),c.a.createElement("div",{className:"property-list__value"},c.a.createElement(fi,{parts:e.get("value")||[],subPartDataAndHandlers:{onTimestampClick:a,shouldDisableActions:n}})))})),c.a.createElement("div",{className:"property-list__property",onClick:r},":END:")))}),Ti=(n(423),function(e){var t=e.logBookEntries,n=e.onTimestampClick,a=e.shouldDisableActions,r=Object(s.useState)(!0),i=Object(d.a)(r,2),o=i[0],l=i[1],u=function(e,t){return function(){return a?void 0:n(e,t)}};return 0===t.size?null:c.a.createElement("div",{className:"logbook-entries-container"},c.a.createElement("div",{className:"logbook-entries__logbook",onClick:function(){return l(!o)}},":LOGBOOK:",o?"...":""),!o&&c.a.createElement(s.Fragment,null,t.map((function(e,t){return void 0!==e.get("raw")?c.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},e.get("raw")||" "):c.a.createElement("div",{className:"logbook-entries__item-container",key:e.get("id")},c.a.createElement("span",{className:"logbook-entries__item-clock"},"CLOCK:"),c.a.createElement("span",{className:"logbook-entries__item-start",onClick:u(t,"start")},he(e.get("start"))),null===e.get("end")?"":c.a.createElement(s.Fragment,null,"--",c.a.createElement("span",{className:"logbook-entries__item-end",onClick:u(t,"end")},he(e.get("end"))),c.a.createElement("span",{className:"logbook-entries__item-duration"},"=> ",be(e.get("start"),e.get("end")))))})),c.a.createElement("div",{className:"logbook-entries__logbook"},":END:")))}),ki=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleRef","handleTextareaRef","handleDescriptionChange","handleTextareaBlur","handleTableCellSelect","handleExitTableEditMode","handleTableCellValueUpdate","handleEnterTableEditMode","handleAddNewTableRow","handleRemoveTableRow","handleAddNewTableColumn","handleRemoveTableColumn","handleCheckboxClick","handleTimestampClick","handleLogEntryTimestampClick","handleInsertTimestamp","handlePlanningItemTimestampClick","handlePropertyListEdit","handleDoubleClick"]),n.state={descriptionValue:n.calculateRawDescription(e.header),containerWidth:null,shouldIgnoreBlur:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"storeContainerWidth",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"componentDidMount",value:function(){this.storeContainerWidth()}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.header;e.inEditMode&&!this.props.inEditMode&&this.props.org.updateHeaderDescription(n.get("id"),this.state.descriptionValue),e.header!==this.props.header&&this.setState({descriptionValue:this.calculateRawDescription(this.props.header)},(function(){return t.storeContainerWidth()}))}},{key:"calculateRawDescription",value:function(e){var t=e.get("planningItems"),n=e.get("propertyListItems"),a=e.get("logBookEntries"),r=t.map((function(e){return"".concat(e.get("type"),": ").concat(he(e.get("timestamp")))})).join(" "),i="";n.size>0&&(i+=":PROPERTIES:\n",i+=n.map((function(e){return":".concat(e.get("property"),": ").concat(ve(e.get("value")))})).join("\n"),i+="\n:END:");var o="";a.size>0&&(o+=":LOGBOOK:\n",o+=a.map((function(e){return void 0!==e.get("raw")?e.get("raw"):null===e.get("end")?"CLOCK: ".concat(he(e.get("start"))):"CLOCK: ".concat(he(e.get("start")),"--").concat(he(e.get("end")))})).join("\n"),o+="\n:END:");var s=[r,i,o].filter((function(e){return 0!==e.length})).join("\n");return s+(0===s.length?"":"\n")+e.get("rawDescription")}},{key:"handleTextareaRef",value:function(e){this.textarea=e}},{key:"handleRef",value:function(e){this.containerDiv=e}},{key:"handleDescriptionChange",value:function(e){this.setState({descriptionValue:e.target.value})}},{key:"handleTextareaBlur",value:function(){var e=this;setTimeout((function(){e.state.shouldIgnoreBlur?e.setState({shouldIgnoreBlur:!1}):e.props.org.exitEditMode()}),0)}},{key:"handleTableCellSelect",value:function(e){this.props.org.setSelectedTableCellId(e)}},{key:"handleExitTableEditMode",value:function(){this.props.org.exitEditMode()}},{key:"handleTableCellValueUpdate",value:function(e,t){this.props.org.updateTableCellValue(e,t)}},{key:"handleEnterTableEditMode",value:function(){this.props.org.enterEditMode("table")}},{key:"handleAddNewTableRow",value:function(){this.props.org.addNewTableRow()}},{key:"handleRemoveTableRow",value:function(){this.props.org.removeTableRow()}},{key:"handleAddNewTableColumn",value:function(){this.props.org.addNewTableColumn()}},{key:"handleRemoveTableColumn",value:function(){this.props.org.removeTableColumn()}},{key:"handleCheckboxClick",value:function(e){this.props.org.advanceCheckboxState(e)}},{key:"handleTimestampClick",value:function(e){this.props.base.activatePopup("timestamp-editor",{timestampId:e})}},{key:"handleLogEntryTimestampClick",value:function(e){var t=this;return function(n,a){return t.props.base.activatePopup("timestamp-editor",{headerId:e,logEntryIndex:n,entryType:a})}}},{key:"handleInsertTimestamp",value:function(){this.setState({shouldIgnoreBlur:!0});var e=this.state.descriptionValue,t=this.textarea.selectionStart;this.setState({descriptionValue:e.substring(0,t)+ge()+e.substring(this.textarea.selectionEnd||t)}),this.textarea.focus()}},{key:"handlePlanningItemTimestampClick",value:function(e){var t=this;return function(n){return t.props.base.activatePopup("timestamp-editor",{headerId:e,planningItemIndex:n})}}},{key:"handlePropertyListEdit",value:function(){var e=this.props.header;this.props.base.activatePopup("property-list-editor",{headerId:e.get("id")})}},{key:"handleDoubleClick",value:function(){this.props.org.openHeader(this.props.header.get("id")),this.props.org.enterEditMode("description")}},{key:"render",value:function(){var e=this.props,t=e.header,n=e.inEditMode,a=e.selectedTableCellId,r=e.inTableEditMode,i=e.shouldDisableActions,o=this.state.containerWidth;return t.get("opened")?c.a.createElement("div",{className:"header-content-container nice-scroll",ref:this.handleRef,onDoubleClick:this.handleDoubleClick,style:{width:o}},n?c.a.createElement("div",{className:"header-content__edit-container"},c.a.createElement("textarea",{autoFocus:!0,className:"textarea",rows:"8",ref:this.handleTextareaRef,value:this.state.descriptionValue,onBlur:this.handleTextareaBlur,onChange:this.handleDescriptionChange}),c.a.createElement("div",{className:"header-content__insert-timestamp-button",onClick:this.handleInsertTimestamp},c.a.createElement("i",{className:"fas fa-plus insert-timestamp-icon"}),"Insert timestamp")):c.a.createElement(s.Fragment,null,c.a.createElement(vi,{planningItems:t.get("planningItems"),onClick:this.handlePlanningItemTimestampClick(t.get("id"))}),c.a.createElement(Ei,{propertyListItems:t.get("propertyListItems"),onTimestampClick:this.handleTimestampClick,shouldDisableActions:i,onEdit:this.handlePropertyListEdit}),c.a.createElement(Ti,{logBookEntries:t.get("logBookEntries"),onTimestampClick:this.handleLogEntryTimestampClick(t.get("id")),shouldDisableActions:i}),c.a.createElement(fi,{parts:t.get("description"),subPartDataAndHandlers:{onTableCellSelect:this.handleTableCellSelect,selectedTableCellId:a,inTableEditMode:r,onExitTableEditMode:this.handleExitTableEditMode,onTableCellValueUpdate:this.handleTableCellValueUpdate,onEnterTableEditMode:this.handleEnterTableEditMode,onAddNewTableRow:this.handleAddNewTableRow,onRemoveTableRow:this.handleRemoveTableRow,onAddNewTableColumn:this.handleAddNewTableColumn,onRemoveTableColumn:this.handleRemoveTableColumn,onCheckboxClick:this.handleCheckboxClick,onTimestampClick:this.handleTimestampClick,shouldDisableActions:i}}))):c.a.createElement("div",null)}}]),t}(s.PureComponent),wi=Object(y.b)((function(e,t){return{inEditMode:"description"===e.org.present.get("editMode")&&e.org.present.get("selectedHeaderId")===t.header.get("id"),isSelected:e.org.present.get("selectedHeaderId")===t.header.get("id"),selectedTableCellId:e.org.present.get("selectedTableCellId"),inTableEditMode:"table"===e.org.present.get("editMode")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(ki),_i=(n(424),function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(p.a)(t,[{key:"iconWithFFClickCatcher",value:function(e){var t=e.className,n=e.onClick,a=e.title,r=e.testId,i=void 0===r?"":r;return c.a.createElement("div",{title:a,onClick:n,className:"header-action-drawer__ff-click-catcher-container"},c.a.createElement("div",{className:"header-action-drawer__ff-click-catcher"}),c.a.createElement("i",{className:t,"data-testid":i}))}},{key:"render",value:function(){var e=this.props,t=e.onEnterTitleEditMode,n=e.onEnterDescriptionEditMode,a=e.onTagsClick,r=e.onPropertiesClick,i=e.isFocused,o=e.onFocus,s=e.onUnfocus,l=e.onAddNewHeader,u=e.onDeadlineClick,d=e.onClockInOutClick,h=e.onScheduledClick,p=e.hasActiveClock,g=e.onShareHeader,m=e.onRefileHeader,f=e.onRemoveHeader;return c.a.createElement("div",{className:"header-action-drawer-container"},c.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-pencil-alt fa-lg",onClick:t,title:"Edit header title"}),this.iconWithFFClickCatcher({className:"fas fa-edit fa-lg",onClick:n,title:"Edit header description",testId:"edit-header-title"}),this.iconWithFFClickCatcher({className:"fas fa-tags fa-lg",onClick:a,title:"Modify tags"}),this.iconWithFFClickCatcher({className:"fas fa-list fa-lg",onClick:r,title:"Modify properties"}),i?this.iconWithFFClickCatcher({className:"fas fa-expand fa-lg",onClick:s,title:"Narrow to subtree (Focus on this header)"}):this.iconWithFFClickCatcher({className:"fas fa-compress fa-lg",onClick:o,title:"Widen (Unfocus from this header)"}),this.iconWithFFClickCatcher({className:"fas fa-plus fa-lg",onClick:l,testId:"header-action-plus",title:"Create new header below"})),c.a.createElement("div",{className:"header-action-drawer__row"},this.iconWithFFClickCatcher({className:"fas fa-envelope fa-lg",onClick:g,testId:"share",title:"Share this header via email"}),this.iconWithFFClickCatcher({className:"fas fa-calendar-check fa-lg",onClick:u,title:"Set deadline datetime"}),this.iconWithFFClickCatcher({className:"far fa-calendar-check fa-lg",onClick:h,title:"Set scheduled datetime"}),p?this.iconWithFFClickCatcher({className:"fas fa-hourglass-end fa-lg",onClick:d,testId:"org-clock-out",title:"Clock out (Stop the clock)"}):this.iconWithFFClickCatcher({className:"fas fa-hourglass-start fa-lg",onClick:d,testId:"org-clock-in",title:"Clock in (Start the clock)"}),this.iconWithFFClickCatcher({className:"fas fa-file-export fa-lg",onClick:m,testId:"org-refile",title:"Refile this header to another header"}),this.iconWithFFClickCatcher({className:"fas fa-trash fa-lg",onClick:f,testId:"org-remove",title:"Delete this header"})))}}]),t}(s.PureComponent)),Si=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e))).SWIPE_ACTION_ACTIVATION_DISTANCE=80,n.FREE_DRAG_ACTIVATION_DISTANCE=10,_.a.bindAll(Object(f.a)(n),["handleRef","handleMouseDown","handleMouseMove","handleMouseUp","handleMouseOut","handleTouchMove","handleTouchStart","handleTouchEnd","handleTouchCancel","handleHeaderClick","handleEnterTitleEditMode","handleEnterDescriptionEditMode","handleShowTagsModal","handleShowPropertyListEditorModal","handleFocus","handleUnfocus","handleAddNewHeader","handleRest","handleDeadlineClick","handleClockInOutClick","handleScheduledClick","handleShareHeaderClick","handleRefileHeaderRequest","handleRemoveHeader"]),n.state={isDraggingFreely:!1,dragStartX:null,dragStartY:null,currentDragX:null,containerWidth:null,isPlayingRemoveAnimation:!1,heightBeforeRemove:null},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.containerDiv&&this.setState({containerWidth:this.containerDiv.offsetWidth})}},{key:"handleRef",value:function(e){this.containerDiv=e,this.props.onRef(e)}},{key:"handleDragStart",value:function(e,t,n){this.props.shouldDisableActions||this.props.inEditMode||e.target.closest(".table-part")||this.setState({dragStartX:t,dragStartY:n})}},{key:"handleDragMove",value:function(e,t){var n=this.state,a=n.dragStartX,r=n.dragStartY;null!==a&&(this.state.isDraggingFreely||Math.abs(e-a)>=this.FREE_DRAG_ACTIVATION_DISTANCE&&this.setState({isDraggingFreely:!0}),Math.abs(t-r)>=this.SWIPE_ACTION_ACTIVATION_DISTANCE/2?this.setState({dragStartX:null}):this.setState({currentDragX:e}))}},{key:"handleDragEnd",value:function(){var e=this.state,t=e.dragStartX,n=e.currentDragX;if(t&&n){var a=n-t;a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.props.org.advanceTodoState(this.props.header.get("id")),-1*a>=this.SWIPE_ACTION_ACTIVATION_DISTANCE&&this.setState({isPlayingRemoveAnimation:!0,heightBeforeRemove:this.containerDiv.offsetHeight})}this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleDragCancel",value:function(){this.setState({dragStartX:null,currentDragX:null,isDraggingFreely:!1})}},{key:"handleMouseDown",value:function(e){this.handleDragStart(e,e.clientX,e.clientY)}},{key:"handleMouseMove",value:function(e){this.handleDragMove(e.clientX,e.clientY)}},{key:"handleMouseUp",value:function(){this.handleDragEnd()}},{key:"handleMouseOut",value:function(){this.handleDragCancel()}},{key:"handleTouchStart",value:function(e){this.handleDragStart(e,e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchMove",value:function(e){this.handleDragMove(e.changedTouches[0].clientX,e.changedTouches[0].clientY)}},{key:"handleTouchEnd",value:function(){this.handleDragEnd()}},{key:"handleTouchCancel",value:function(){this.handleDragCancel()}},{key:"handleHeaderClick",value:function(e){var t=e.target.classList;if(t.contains("header")||t.contains("header__bullet")){var n=this.props,a=n.header,r=n.hasContent,i=n.isSelected;!r||a.get("opened")&&!i||this.props.org.toggleHeaderOpened(a.get("id")),this.props.org.selectHeader(a.get("id"))}}},{key:"handleEnterTitleEditMode",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEnterDescriptionEditMode",value:function(){this.props.org.openHeader(this.props.header.get("id")),this.props.org.enterEditMode("description")}},{key:"handleShowTagsModal",value:function(){this.props.base.activatePopup("tags-editor")}},{key:"handleShowPropertyListEditorModal",value:function(){this.props.base.activatePopup("property-list-editor")}},{key:"handleFocus",value:function(){this.props.org.focusHeader(this.props.header.get("id"))}},{key:"handleUnfocus",value:function(){this.props.org.unfocusHeader()}},{key:"handleAddNewHeader",value:function(){this.props.org.addHeaderAndEdit(this.props.header.get("id"))}},{key:"handleRest",value:function(){this.state.isPlayingRemoveAnimation&&this.props.org.removeHeader(this.props.header.get("id"))}},{key:"handleDeadlineAndScheduledClick",value:function(e){var t=this.props.header,n=t.get("planningItems",[]).findIndex((function(t){return t.get("type")===e}));-1===n?(this.props.org.addNewPlanningItem(t.get("id"),e),this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:t.get("planningItems").size})):this.props.base.activatePopup("timestamp-editor",{headerId:t.get("id"),planningItemIndex:n}),this.props.org.openHeader(t.get("id"))}},{key:"handleDeadlineClick",value:function(){this.handleDeadlineAndScheduledClick("DEADLINE")}},{key:"handleClockInOutClick",value:function(){var e=this.props.header,t=e.get("logBookEntries",[]),n=t.findIndex((function(e){return null===e.get("end")})),a=pe({isActive:!1,withStartTime:!0});-1!==n?this.props.org.setLogEntryStop(e.get("id"),t.getIn([n,"id"]),a):this.props.org.createLogEntryStart(e.get("id"),a)}},{key:"handleScheduledClick",value:function(){this.handleDeadlineAndScheduledClick("SCHEDULED")}},{key:"handleShareHeaderClick",value:function(){var e=this.props.header,t=e.get("titleLine"),n=t.get("todoKeyword"),a=t.get("tags"),r=t.get("rawTitle").trim(),i=n?"".concat(n," ").concat(r):r,o="\n".concat(a.isEmpty()?"":"Tags: ".concat(a.join(" "),"\n"),"\n").concat(e.get("rawDescription"),"\n"),s="mailto:?subject=".concat(encodeURIComponent(i),"&body=").concat(encodeURIComponent(o));window.open(s)}},{key:"handlePopupClose",value:function(){this.props.base.closePopup()}},{key:"handleRefileHeaderRequest",value:function(){this.props.base.activatePopup("refile")}},{key:"handleRemoveHeader",value:function(){this.props.org.removeHeader(this.props.header.get("id"))}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.color,r=t.hasContent,i=t.isSelected,o=t.bulletStyle,s=t.focusedHeader,l=t.isFocused,u=t.shouldDisableActions,d=s?n.get("nestingLevel")-s.get("nestingLevel")+1:n.get("nestingLevel"),h=this.state,p=h.dragStartX,g=h.currentDragX,m=h.isDraggingFreely,f=h.isPlayingRemoveAnimation,b=h.containerWidth,y={paddingLeft:20*d,marginLeft:p&&g&&m?g-p:f?Object(ai.spring)(-1*b,{stiffness:300}):Object(ai.spring)(0,{stiffness:300}),heightFactor:f?Object(ai.spring)(0,{stiffness:300}):1},v=Xr()("header",{"header--selected":i,"header--removing":f}),E=n.get("logBookEntries").filter((function(e){return void 0===e.get("raw")})),T=0!==E.size&&0!==E.filter((function(e){return!e.get("end")})).size;return c.a.createElement(ai.Motion,{style:y,onRest:this.handleRest},(function(t){var s=t.marginLeft,d=s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,h=-1*s>=e.SWIPE_ACTION_ACTIVATION_DISTANCE,p=di(211,211,211,1),g=di(0,128,0,1),m=di(255,0,0,1),b=di(0,0,0,1),y=di(255,255,255,1),E={width:t.marginLeft,backgroundColorFactor:Object(ai.spring)(d?1:0,{stiffness:300})},k={width:-1*t.marginLeft,backgroundColorFactor:Object(ai.spring)(h?1:0,{stiffness:300})},w=t.heightFactor,_=Object(oi.a)(t,["heightFactor"]);return f&&(_.height=e.state.heightBeforeRemove*w),c.a.createElement("div",{className:v,style:_,ref:e.handleRef,onClick:e.handleHeaderClick,onMouseDown:e.handleMouseDown,onMouseMove:e.handleMouseMove,onMouseUp:e.handleMouseUp,onMouseOut:e.handleMouseOut,onTouchStart:e.handleTouchStart,onTouchMove:e.handleTouchMove,onTouchEnd:e.handleTouchEnd,onTouchCancel:e.handleTouchCancel},c.a.createElement(ai.Motion,{style:E},(function(e){var t={width:e.width,backgroundColor:hi(ui(p,g,e.backgroundColorFactor))},n={display:s>30?"":"none",color:hi(ui(b,y,e.backgroundColorFactor))};return c.a.createElement("div",{className:"left-swipe-action-container",style:t},c.a.createElement("i",{className:"fas fa-check swipe-action-container__icon swipe-action-container__icon--left",style:n}))})),c.a.createElement(ai.Motion,{style:k},(function(e){var t={width:e.width,backgroundColor:hi(ui(p,m,e.backgroundColorFactor))},n={display:-1*s>30?"":"none",color:hi(ui(b,y,e.backgroundColorFactor))};return c.a.createElement("div",{className:"right-swipe-action-container",style:t},c.a.createElement("i",{className:"fas fa-times swipe-action-container__icon swipe-action-container__icon--right",style:n}))})),c.a.createElement("div",{style:{marginLeft:-16,color:a},className:"header__bullet"},"Fancy"===o?"\u25cf":"*"),c.a.createElement(yi,{header:n,color:a,hasContent:r,isSelected:i,shouldDisableActions:u}),c.a.createElement(si.UnmountClosed,{isOpened:i&&!u,springConfig:{stiffness:300},style:{marginRight:k.width}},c.a.createElement(_i,{onEnterTitleEditMode:e.handleEnterTitleEditMode,onEnterDescriptionEditMode:e.handleEnterDescriptionEditMode,isFocused:l,onTagsClick:e.handleShowTagsModal,onPropertiesClick:e.handleShowPropertyListEditorModal,onFocus:e.handleFocus,onUnfocus:e.handleUnfocus,onAddNewHeader:e.handleAddNewHeader,onDeadlineClick:e.handleDeadlineClick,onClockInOutClick:e.handleClockInOutClick,onScheduledClick:e.handleScheduledClick,hasActiveClock:T,onShareHeader:e.handleShareHeaderClick,onRefileHeader:e.handleRefileHeaderRequest,onRemoveHeader:e.handleRemoveHeader})),c.a.createElement(wi,{header:n,onEnterDescriptionEditMode:e.handleEnterDescriptionEditMode,shouldDisableActions:u}))}))}}]),t}(s.PureComponent),Ii=Object(y.b)((function(e,t){var n=e.org.present.get("focusedHeaderId")?Oe(e.org.present.get("headers"),e.org.present.get("focusedHeaderId")):null;return{bulletStyle:e.base.get("bulletStyle"),focusedHeader:n,isFocused:!!n&&n.get("id")===t.header.get("id"),inEditMode:!!e.org.present.get("editMode")}}),(function(e){return{org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(Si),Oi=function(e){function t(e){var n;return Object(h.a)(this,t),(n=Object(g.a)(this,Object(m.a)(t).call(this,e))).headerRefs={},_.a.bindAll(Object(f.a)(n),["handleHeaderRef"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){if(e.selectedHeaderId!==this.props.selectedHeaderId){var t=this.headerRefs[this.props.selectedHeaderId];if(t){var n=t.getBoundingClientRect(),a=document.documentElement.clientHeight;(n.top>.9*a||n.bottom<0)&&t.scrollIntoView()}}}},{key:"handleHeaderRef",value:function(e){var t=this;return function(n){return t.headerRefs[e]=n}}},{key:"render",value:function(){var e=this,t=this.props,n=t.headers,a=t.selectedHeaderId,r=t.focusedHeaderId,i=t.shouldDisableActions,o=n.map((function(e){return{header:e,displayed:!1,hasContent:!!e.get("rawDescription")||0!==e.get("planningItems").size||0!==e.get("propertyListItems").size||0!==e.get("logBookEntries").size}})).toArray();if(o.forEach((function(e,t){var n=e.header.get("nestingLevel");o.slice(0,t).every((function(e){return e.header.get("nestingLevel")>=n}))&&(e.displayed=!0);for(var a=o.slice(t+1),r=0;r<a.length;++r){var i=a[r];if(i.header.get("nestingLevel")<=n)break;e.hasContent=!0,i.displayed=e.header.get("opened")&&e.displayed}})),r){var s=o.findIndex((function(e){return e.header.get("id")===r}));o.slice(0,s).forEach((function(e){return e.displayed=!1}));var l=De(n,r);o.slice(s+l+1).forEach((function(e){return e.displayed=!1}))}var u=["var(--blue)","var(--green)","var(--cyan)","var(--yellow)","var(--blue)","var(--green)","var(--cyan)","var(--yellow)"],d=o.filter((function(e){return e.displayed})),h=Xr()("header-list-container",{"header-list-container--focused":!!r});return c.a.createElement("div",{className:h},d.map((function(t,n){var r=t.header,o=u[(r.get("nestingLevel")-1)%u.length];return c.a.createElement(Ii,{key:r.get("id"),header:r,color:o,hasContent:t.hasContent,isSelected:r.get("id")===a,onRef:e.handleHeaderRef(r.get("id")),shouldDisableActions:i})})))}}]),t}(s.PureComponent),Ci=Object(y.b)((function(e,t){return{headers:e.org.present.get("headers"),selectedHeaderId:e.org.present.get("selectedHeaderId"),focusedHeaderId:e.org.present.get("focusedHeaderId")}}),(function(e){return{}}))(Oi),Di=n(45),Ai=(n(425),n(54)),Ni=(n(426),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleClick",value:function(){var e=this.props,t=e.onClick;e.isDisabled||t()}},{key:"render",value:function(){var e,t=this.props,n=t.iconName,a=t.subIconName,r=t.isDisabled,i=t.shouldRotateSubIcon,o=t.letter,s=t.additionalClassName,l=t.style,u=t.tooltip,d=t.shouldSpinSubIcon,h=t.onRef,p=Xr()("btn","btn--circle","action-drawer__btn",s||"",(e={fas:!o,"fa-lg":!o},Object(Ai.a)(e,"fa-".concat(n),!o),Object(Ai.a)(e,"action-drawer__btn--with-sub-icon",!!a),Object(Ai.a)(e,"btn--disabled",r),Object(Ai.a)(e,"action-drawer__btn--letter",!!o),e)),g=Xr()("fas","fa-xs","fa-".concat(a),"action-drawer__btn__sub-icon",{"action-drawer__btn__sub-icon--rotated":i,"fa-spin":d});return c.a.createElement("button",{className:p,onClick:this.handleClick,style:l,title:u,ref:h},!!o&&o,!!a&&c.a.createElement("i",{className:g}))}}]),t}(s.PureComponent)),Pi=Object(y.b)((function(e,t){return{inEditMode:!!e.org.present.get("editMode"),selectedHeaderId:e.org.present.get("selectedHeaderId"),isDirty:e.org.present.get("isDirty"),isFocusedHeaderActive:!!e.org.present.get("focusedHeaderId"),selectedTableCellId:e.org.present.get("selectedTableCellId"),captureTemplates:e.capture.get("captureTemplates",Object($.List)()),path:e.org.present.get("path"),isLoading:e.base.get("isLoading")}}),(function(e){return{org:Object(v.b)(r,e),capture:Object(v.b)(i,e),base:Object(v.b)(a,e)}}))((function(e){var t=e.org,n=e.selectedHeaderId,a=e.base,r=e.staticFile,i=e.captureTemplates,o=e.path,l=e.selectedTableCellId,u=e.inEditMode,h=e.isLoading,p=e.shouldDisableSyncButtons,g=Object(s.useState)(!1),m=Object(d.a)(g,2),f=m[0],b=m[1],y=Object(s.useState)(!1),v=Object(d.a)(y,2),E=v[0],T=v[1],k=Object(s.useState)(!1),w=Object(d.a)(k,2),_=w[0],S=w[1];Object(s.useEffect)((function(){return document.querySelector("html").style.paddingBottom="90px",function(){return document.querySelector("html").style.paddingBottom="0px"}}));var I=Object(s.useRef)(null),O=Object(s.useMemo)((function(){return I.current?I.current.getBoundingClientRect():null}),[I]),C=function(){return n?t.moveHeaderUp(n):t.moveTableRowUp()},D=function(){return n?t.moveHeaderDown(n):t.moveTableRowDown()},A=function(){return n?t.moveHeaderLeft(n):t.moveTableColumnLeft()},N=function(){return n?t.moveHeaderRight(n):t.moveTableColumnRight()},P=function(){return t.moveSubtreeLeft(n)},L=function(){return t.moveSubtreeRight(n)},R=function(){return"sample"===r?Ye:i.filter((function(e){return e.get("isAvailableInAllOrgFiles")||e.get("orgFilesWhereAvailable").map((function(e){return e.trim().startsWith("/")?e.trim():"/"+e.trim()})).includes((o||"").trim())}))},j=function(){return b(!f)},x=function(){S(!_)},M=function(){E||0!==R().size?T(!E):alert("You don't have any capture templates set up for this file! Add some in Settings > Capture Templates")},H=function(){S(!1),a.activatePopup("task-list")},F=function(){S(!1),a.activatePopup("search")};return c.a.createElement("div",{className:"action-drawer-container nice-scroll"},u?c.a.createElement("button",{className:"btn action-drawer__done-btn",onClick:function(){return t.exitEditMode()}},"Done"):c.a.createElement(s.Fragment,null,c.a.createElement(Ni,{iconName:"cloud",subIconName:"sync-alt",shouldSpinSubIcon:h,isDisabled:p,onClick:function(){return t.sync()},style:{opacity:f||E||_?0:1},tooltip:"Sync changes"}),c.a.createElement(Ni,{iconName:"calendar-alt",shouldSpinSubIcon:h,isDisabled:!1,onClick:function(){return a.activatePopup("agenda")},style:{opacity:f||E||_?0:1},tooltip:"Show agenda"}),function(){var e={opacity:E||_?0:1};f||(e.boxShadow="none");var t=0;O&&(t=window.screen.width/2-(O.x+O.width/2));var n={centerXOffset:Object(ai.spring)(f?t:0,{stiffness:300}),topRowYOffset:Object(ai.spring)(f?150:0,{stiffness:300}),bottomRowYOffset:Object(ai.spring)(f?80:0,{stiffness:300}),firstColumnXOffset:Object(ai.spring)(f?70:0,{stiffness:300}),secondColumnXOffset:Object(ai.spring)(f?140:0,{stiffness:300})};return c.a.createElement(ai.Motion,{style:n},(function(t){return c.a.createElement("div",{className:"action-drawer__arrow-buttons-container",style:{left:t.centerXOffset}},c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-up",subIconName:l?"table":null,isDisabled:!1,onClick:C,style:Object(Di.a)({},e,{bottom:t.topRowYOffset}),tooltip:l?"Move row up":"Move header up"}),c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-down",subIconName:l?"table":null,isDisabled:!1,onClick:D,style:Object(Di.a)({},e,{bottom:t.bottomRowYOffset}),tooltip:l?"Move row down":"Move header down"}),c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-left",subIconName:l?"table":null,isDisabled:!1,onClick:A,style:Object(Di.a)({},e,{bottom:t.bottomRowYOffset,right:t.firstColumnXOffset}),tooltip:l?"Move column left":"Move header left"}),c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"arrow-right",subIconName:l?"table":null,isDisabled:!1,onClick:N,style:Object(Di.a)({},e,{bottom:t.bottomRowYOffset,left:t.firstColumnXOffset}),tooltip:l?"Move column right":"Move header right"}),!l&&c.a.createElement(s.Fragment,null,c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-left",isDisabled:!1,onClick:P,style:Object(Di.a)({},e,{bottom:t.bottomRowYOffset,right:t.secondColumnXOffset}),tooltip:"Move entire subtree left"}),c.a.createElement(Ni,{additionalClassName:"action-drawer__arrow-button",iconName:"chevron-right",isDisabled:!1,onClick:L,style:Object(Di.a)({},e,{bottom:t.bottomRowYOffset,left:t.secondColumnXOffset}),tooltip:"Move entire subtree right"})),c.a.createElement(Ni,{iconName:f?"times":"arrows-alt",subIconName:l?"table":null,additionalClassName:"action-drawer__main-arrow-button",isDisabled:!1,onClick:j,style:{opacity:E||_?0:1},tooltip:f?"Hide movement buttons":"Show movement buttons",onRef:I}))}))}(),function(){var e={position:"absolute",zIndex:0,left:0,opacity:f||E?0:1};_||(e.boxShadow="none");var t={opacity:f||E?0:1,position:"relative",zIndex:1},n={bottom:Object(ai.spring)(_?70:0,{stiffness:300})};return c.a.createElement(ai.Motion,{style:n},(function(n){return c.a.createElement("div",{className:"action-drawer__capture-buttons-container"},c.a.createElement(Ni,{iconName:_?"times":"search",isDisabled:!1,onClick:x,style:t,tooltip:_?"Hide Search / Task List":"Show Search / Task List"}),c.a.createElement(Ni,{iconName:"search",isDisabled:!1,onClick:F,style:Object(Di.a)({},e,{bottom:1*n.bottom}),tooltip:"Show search"}),c.a.createElement(Ni,{iconName:"tasks",isDisabled:!1,onClick:H,style:Object(Di.a)({},e,{bottom:2*n.bottom}),tooltip:"Show task list"}))}))}(),function(){var e=R(),t={position:"absolute",zIndex:0,left:0,opacity:f||_?0:1};E||(t.boxShadow="none");var n={opacity:f||_?0:1,position:"relative",zIndex:1},r={bottom:Object(ai.spring)(E?70:0,{stiffness:300})};return c.a.createElement(ai.Motion,{style:r},(function(r){return c.a.createElement("div",{className:"action-drawer__capture-buttons-container"},c.a.createElement(Ni,{iconName:E?"times":"plus",isDisabled:!1,onClick:M,style:n,tooltip:E?"Hide capture templates":"Show capture templates"}),e.map((function(e,n){return c.a.createElement(Ni,{key:e.get("id"),letter:e.get("letter"),iconName:e.get("iconName"),isDisabled:!1,onClick:(i=e.get("id"),function(){T(!1),a.activatePopup("capture",{templateId:i})}),style:Object(Di.a)({},t,{bottom:r.bottom*(n+1)}),tooltip:'Activate "'.concat(e.get("description"),'" capture template')});var i})))}))}()))})),Li=n(229),Ri=n.n(Li).a.getParser(window.navigator.userAgent),ji=Ri.satisfies({mobile:{safari:">=13"}})&&Ri.satisfies({mobile:{safari:"<13.0.4"}}),xi=Ri.satisfies({mobile:{safari:">=6","android browser":">3"}}),Mi=!!window.matchMedia&&window.matchMedia("(max-device-width: 812px) and (-webkit-device-pixel-ratio : 3)").matches,Hi=!!window.matchMedia&&window.matchMedia("(min-device-width: 375px) and (-webkit-device-pixel-ratio : 2)").matches,Fi="standalone"in window.navigator&&window.navigator.standalone;function Bi(){return[90,-90].includes(window.orientation)}n(427),n(428);var Ui=function(e){var t=e.isEnabled,n=e.onToggle,a=di(255,255,255,1),r=di(238,232,213,1),i={colorFactor:Object(ai.spring)(t?1:0,{stiffness:300})},o={marginLeft:Object(ai.spring)(t?42:0,{stiffness:300})};return c.a.createElement(ai.Motion,{style:i},(function(e){var t=hi(ui(a,r,e.colorFactor));return c.a.createElement("div",{className:"switch",style:{backgroundColor:t},onClick:n},c.a.createElement(ai.Motion,{style:o},(function(e){return c.a.createElement("div",{className:"switch__grabber",style:e})})))}))},Vi=(n(429),function(e){var t=e.children,n=e.shouldIncludeCloseButton,a=e.onClose,r=e.maxSize,i=void 0!==r&&r,o=Object(s.useState)(!1),l=Object(d.a)(o,2),u=l[0],h=l[1],p=Object(s.useState)(null),g=Object(d.a)(p,2),m=g[0],f=g[1];Object(s.useLayoutEffect)((function(){h(!0)}),[]);var b=Object(s.useRef)(),y=Object(s.useRef)(),v=Object(s.useRef)();Object(s.useLayoutEffect)((function(){v.current=y.current.offsetHeight}));var E=function(e){return e.stopPropagation()},T=function(){return h(!1)},k=function(e){return b.current=e.targetTouches[0].clientY},w=function(e){if(!e.target.classList.contains("drag-handle")){var t=b.current>e.targetTouches[0].clientY;t&&y.current.scrollHeight-y.current.scrollTop<=y.current.clientHeight?e.preventDefault():t||0!==y.current.scrollTop||(e.preventDefault(),f(e.targetTouches[0].clientY-b.current))}};Object(s.useEffect)((function(){var e=function(e){return h(m<=.3*v.current),void f(null)};if(y.current){y.current.addEventListener("touchstart",k),y.current.addEventListener("touchmove",w),y.current.addEventListener("touchend",e),y.current.addEventListener("touchcancel",e);var t=y.current;return function(){t.removeEventListener("touchstart",k),t.removeEventListener("touchmove",w),t.removeEventListener("touchend",e),t.removeEventListener("touchcancel",e)}}return null}),[y,m]);var _=Xr()("drawer-outer-container",{"drawer-outer-container--visible":u}),S={offsetY:m||Object(ai.spring)(u?0:v.current||window.innerHeight,{stiffness:300})};return c.a.createElement(ai.Motion,{style:S,onRest:function(){return!u&&a?a():void 0}},(function(e){var r={transform:"translateY(".concat(e.offsetY,"px)")};return i&&(r.height="92%",r.overflow="none"),c.a.createElement("div",{className:_,onClick:a?T:null},c.a.createElement("div",{onClick:E,className:"drawer-inner-container nice-scroll","data-testid":"drawer",ref:y,style:r},c.a.createElement("div",{className:"drawer__grabber"}),n&&c.a.createElement("button",{className:"fas fa-times fa-lg drawer__close-button",onClick:T}),t))}))}),Wi=function(e){var t=e.template,n=e.onCapture,a=e.headers,r=e.onClose,i=Object(s.useMemo)((function(){return ke(t.get("template"))}),[t]),o=Object(d.a)(i,2),l=o[0],u=o[1],h=Object(s.useMemo)((function(){return Le(a,t.get("headerPaths"))}),[a,t]),p=Object(s.useState)(l),g=Object(d.a)(p,2),m=g[0],f=g[1],b=Object(s.useState)(t.get("shouldPrepend")),y=Object(d.a)(b,2),v=y[0],E=y[1],T=Object(s.useRef)(null);Object(s.useEffect)((function(){T.current&&(T.current.focus(),T.current.setSelectionRange(u,u))}),[T,u]);return c.a.createElement(Vi,{onClose:r},c.a.createElement("div",{className:"capture-modal-header"},c.a.createElement(Ni,{letter:t.get("letter"),iconName:t.get("iconName"),isDisabled:!1,onClick:function(){},style:{marginRight:20}}),c.a.createElement("span",null,t.get("description"))),c.a.createElement("div",{className:"capture-modal-header-path"},t.get("headerPaths").join(" > ")),h?c.a.createElement(s.Fragment,null,c.a.createElement("textarea",{className:"textarea capture-modal-textarea",rows:"4",value:m,onChange:function(e){return f(e.target.value)},autoFocus:!0,ref:T}),c.a.createElement("div",{className:"capture-modal-button-container"},c.a.createElement("div",{className:"capture-modal-prepend-container"},c.a.createElement("span",{className:"capture-modal-prepend-label"},"Prepend:"),c.a.createElement(Ui,{isEnabled:v,onToggle:function(){return E(!v)}})),c.a.createElement("button",{className:"btn capture-modal-button",onClick:function(){return n(t.get("id"),m,v)}},"Capture")),ji&&c.a.createElement("div",{style:{minHeight:ji?Fi?Bi()?"9em":Mi?"23em":Hi?"19em":"auto":Bi()?"9em":Mi?"18em":Hi?"18em":"auto":"auto"}})):c.a.createElement("div",{className:"capture-modal-error-message"},"The specified header path doesn't exist in this org file!"),c.a.createElement("br",null))},Gi=(n(430),function(e){var t=e.lastServerModifiedAt,n=e.onPull,a=e.onPush,r=e.onCancel;return c.a.createElement(Vi,null,c.a.createElement("h2",{className:"sync-confirmation-modal__header"},"Sync conflict"),"Since you last pulled, a newer version of the file has been pushed to the server. The newer version is from:",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"sync-confirmation-modal__last-sync-time"},Object(Z.a)(t,"MMMM do, yyyy [at] h:mm:ss a"),c.a.createElement("br",null),"(",Be(t),")"),c.a.createElement("div",{className:"sync-confirmation-modal__buttons-container"},c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:n},"Pull latest version from server"),c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:a},"Overwrite server version"),c.a.createElement("button",{className:"btn sync-confirmation-modal__button",onClick:r},"Cancel sync")),c.a.createElement("br",null))}),Ki=(n(431),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleRemoveTag","handleAddNewTag","handleTagChange"]),n.state={allTags:e.allTags},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.header.getIn(["titleLine","tags"]),n=this.props.header.getIn(["titleLine","tags"]);t.size===n.size-1&&""===n.last()&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handleTagChange",value:function(e){var t=this;return function(n){var a=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(a.set(e,n.target.value.replace(/(\s+|:)/g,"")))}}},{key:"handleRemoveTag",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);t.props.onChange(n.delete(e))}}},{key:"handleAddNewTag",value:function(){var e=this.props.header.getIn(["titleLine","tags"]);this.props.onChange(e.push(""))}},{key:"handleExistingTagClick",value:function(e){var t=this;return function(){var n=t.props.header.getIn(["titleLine","tags"]);n.includes(e)?t.props.onChange(n.filter((function(t){return t!==e}))):t.props.onChange(n.push(e))}}},{key:"render",value:function(){var e=this,t=this.props,n=t.header,a=t.onClose,r=this.state.allTags,i=n.getIn(["titleLine","tags"]);return c.a.createElement(Vi,{onClose:a},c.a.createElement("h2",{className:"drawer-modal__title"},"Edit tags"),c.a.createElement("datalist",{id:"drawer-modal__datalist-tag-names"},r.map((function(e,t){return c.a.createElement("option",{key:t,value:e})}))),0===i.size?c.a.createElement("div",{className:"no-tags-message"},"This header doesn't have any tags.",c.a.createElement("br",null),c.a.createElement("br",null),"Click the ",c.a.createElement("i",{className:"fas fa-plus"})," button to add a new one, or choose from the list of all of your tags below."):c.a.createElement(jr.c,{droppableId:"tags-editor-droppable",type:"TAG"},(function(t,n){return c.a.createElement("div",Object.assign({className:"tags-container",ref:t.innerRef},t.droppableProps),c.a.createElement(s.Fragment,null,i.map((function(t,n){return c.a.createElement(jr.b,{draggableId:"tag--".concat(n),index:n,key:n},(function(a,r){return c.a.createElement("div",Object.assign({className:Xr()("tag-container",{"tag-container--dragging":r.isDragging}),ref:a.innerRef},a.draggableProps),c.a.createElement("input",{type:"text",className:"textfield tag-container__textfield",value:t,onChange:e.handleTagChange(n),ref:function(t){return e.lastTextfield=t},list:"drawer-modal__datalist-tag-names"}),c.a.createElement("div",{className:"tag-container__actions-container"},c.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveTag(n)}),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg tag-container__drag-handle drag-handle"},a.dragHandleProps))))}))})),t.placeholder))})),c.a.createElement("div",{className:"tags-editor__add-new-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewTag})),c.a.createElement("hr",{className:"tags-editor__separator"}),c.a.createElement("h2",{className:"tags-editor__title"},"All tags"),c.a.createElement("div",{className:"all-tags-container"},r.filter((function(e){return!!e})).map((function(t){var n=Xr()("all-tags__tag",{"all-tags__tag--in-use":i.includes(t)});return c.a.createElement("div",{className:n,key:t,onClick:e.handleExistingTagClick(t)},t)}))))}}]),t}(s.PureComponent)),zi=(n(466),n(467),n(468),function(e){var t=e.buttons,n=e.selectedButton,a=e.useEqualWidthTabs,r=e.onSelect,i=function(e){return function(){return r(e)}},o=Xr()("tab-buttons",{"tab-buttons--equal-width-tabs":a}),s={gridTemplateColumns:a?"repeat(".concat(t.length,", 1fr)"):null};return c.a.createElement("div",{className:o,style:s},t.map((function(e){var t=Xr()("tab-buttons__btn",{"tab-buttons__btn--selected":e===n});return c.a.createElement("div",{key:e,className:t,onClick:i(e)},e)})))}),Yi=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleActiveToggle","handleDateChange","handleAddRepeater","handleRemoveRepeater","handleRepeaterTypeChange","handleRepeaterValueChange","handleRepeaterUnitChange","handleAddDelay","handleRemoveDelay","handleDelayTypeChange","handleDelayValueChange","handleDelayUnitChange"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleActiveToggle",value:function(){this.props.onChange(this.props.timestamp.update("isActive",(function(e){return!e})))}},{key:"handleDateChange",value:function(e,t){if(_.a.isEmpty(e.target.value))_.a.isNumber(t)&&this.props.org.removePlanningItem(this.props.selectedHeaderId,t),this.props.onClose();else{var n=this.props,a=n.onChange,r=n.timestamp,i=Object(Z.a)(Object(qe.a)(e.target.value),"yyyy MM dd eee").split(" "),o=Object(d.a)(i,4),s=o[0],c=o[1],l=o[2],u=o[3];a(r.set("year",s).set("month",c).set("day",l).set("dayName",u))}}},{key:"handleAddTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],c=o[1],l=Object(Z.a)(new Date,"HH:mm").split(":"),u=Object(d.a)(l,2),h=u[0],p=u[1];a(r.set(s,h).set(c,p))}}},{key:"handleRemoveTime",value:function(e){var t=this;return function(){var n=t.props,a=n.onChange,r=n.timestamp,i="start"===e?["startHour","startMinute"]:["endHour","endMinute"],o=Object(d.a)(i,2),s=o[0],c=o[1];a(r.set(s,null).set(c,null))}}},{key:"handleTimeChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.onChange,i=a.timestamp,o="start"===e?["startHour","startMinute"]:["endHour","endMinute"],s=Object(d.a)(o,2),c=s[0],l=s[1],u=n.target.value.split(":"),h=Object(d.a)(u,2),p=h[0],g=h[1];p=p.startsWith("0")?p.substring(1):p,r(i.set(c,p).set(l,g))}}},{key:"handleAddRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType","+").set("repeaterValue",1).set("repeaterUnit","h"))}},{key:"handleRemoveRepeater",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("repeaterType",null).set("repeaterValue",null).set("repeaterUnit",null))}},{key:"handleRepeaterTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterType",e))}},{key:"handleRepeaterValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterValue",e.target.value))}},{key:"handleRepeaterUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("repeaterUnit",e))}},{key:"handleAddDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType","-").set("delayValue",1).set("delayUnit","h"))}},{key:"handleRemoveDelay",value:function(){var e=this.props;(0,e.onChange)(e.timestamp.set("delayType",null).set("delayValue",null).set("delayUnit",null))}},{key:"handleDelayTypeChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayType",e))}},{key:"handleDelayValueChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayValue",e.target.value))}},{key:"handleDelayUnitChange",value:function(e){var t=this.props;(0,t.onChange)(t.timestamp.set("delayUnit",e))}},{key:"renderTimeField",value:function(e,t,n,a){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},e),c.a.createElement("div",{className:"timestamp-editor__field"},n?c.a.createElement(s.Fragment,null,c.a.createElement("input",{type:"time",className:"timestamp-editor__time-input",value:"".concat(n.padStart(2,"0"),":").concat(a.padStart(2,"0")),onChange:this.handleTimeChange(t)}),r&&c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveTime(t)})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddTime(t)})))}},{key:"renderRepeater",value:function(){var e=this.props.timestamp.toJS(),t=e.repeaterType,n=e.repeaterValue,a=e.repeaterUnit;return c.a.createElement("div",{className:"timestamp-editor__field-container"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Repeater"),c.a.createElement("div",{className:"timestamp-editor__field timestamp-editor__field--delay-repeater"},t?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},c.a.createElement(zi,{buttons:["+","++",".+"],selectedButton:t||"+",onSelect:this.handleRepeaterTypeChange})),c.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleRepeaterValueChange}),c.a.createElement("div",null,c.a.createElement(zi,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleRepeaterUnitChange})),c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveRepeater})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddRepeater})))}},{key:"renderDelay",value:function(){var e=this.props.timestamp.toJS(),t=e.delayType,n=e.delayValue,a=e.delayUnit;return c.a.createElement("div",{className:"timestamp-editor__field-container"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Delay"),c.a.createElement("div",{className:"timestamp-editor__field"},t?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__delay-repeater-type"},c.a.createElement(zi,{buttons:["-","--"],selectedButton:t||"-",onSelect:this.handleDelayTypeChange})),c.a.createElement("input",{type:"number",min:"1",className:"textfield delay-repeater-value-input",value:n||1,onChange:this.handleDelayValueChange}),c.a.createElement("div",null,c.a.createElement(zi,{buttons:"hdwmy".split(""),selectedButton:a||"h",onSelect:this.handleDelayUnitChange})),c.a.createElement("i",{className:"fas fa-times fa-lg timestamp-editor__icon timestamp-editor__icon--remove",onClick:this.handleRemoveDelay})):c.a.createElement("i",{className:"fas fa-plus timestamp-editor__icon timestamp-editor__icon--add",onClick:this.handleAddDelay})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.timestamp,a=t.planningItemIndex,r=n.toJS(),i=r.isActive,o=r.year,s=r.month,l=r.day,u=r.startHour,d=r.startMinute,h=r.endHour,p=r.endMinute;return c.a.createElement("div",null,c.a.createElement("div",{className:"timestamp-editor__render"},he(n)),c.a.createElement("div",{className:"timestamp-editor__date-time-fields-container"},c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Active"),c.a.createElement("div",{className:"timestamp-editor__field"},c.a.createElement(Ui,{isEnabled:i,onToggle:this.handleActiveToggle}))),c.a.createElement("div",{className:"timestamp-editor__field-container timestamp-editor__field-container--inline"},c.a.createElement("div",{className:"timestamp-editor__field-title"},"Date"),c.a.createElement("div",{className:"timestamp-editor__field"},c.a.createElement("input",{"data-testid":"timestamp-selector",type:"date",className:"timestamp-editor__date-input",onChange:function(t){return e.handleDateChange(t,a)},onFocus:function(e){return e.nativeEvent.target.defaultValue=""},value:"".concat(o,"-").concat(s,"-").concat(l)}))),this.renderTimeField("Start time","start",u,d,!h),!!u&&this.renderTimeField("End time","end",h,p)),this.renderRepeater(),this.renderDelay())}}]),t}(s.PureComponent),Ji=Object(y.b)((function(e){return{selectedHeaderId:e.org.present.get("selectedHeaderId")}}),(function(e){return{org:Object(v.b)(r,e)}}))(Yi),Xi=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleAddEndTimestamp","handleRemoveEndTimestamp"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleChange",value:function(e){var t=this;return function(n){return t.props.onChange(t.props.timestamp.set(e,n))}}},{key:"handleAddEndTimestamp",value:function(){var e=this.props.timestamp,t=Object(Z.a)(new Date,"yyyy MM dd eee").split(" "),n=Object(d.a)(t,4),a=n[0],r=n[1],i=n[2],o=n[3];this.props.onChange(e.set("secondTimestamp",Object($.Map)({year:a,month:r,day:i,dayName:o,isActive:e.getIn(["firstTimestamp","isActive"])})))}},{key:"handleRemoveEndTimestamp",value:function(){this.props.onChange(this.props.timestamp.set("secondTimestamp",null))}},{key:"render",value:function(){var e=this.props,t=e.timestamp,n=e.onClose,a=e.singleTimestampOnly,r=e.planningItemIndex;return c.a.createElement(Vi,{onClose:n},c.a.createElement("h2",{className:"timestamp-editor__title"},"Edit timestamp"),c.a.createElement(Ji,{timestamp:t.get("firstTimestamp"),planningItemIndex:r,onClose:n,onChange:this.handleChange("firstTimestamp")}),!a&&(t.get("secondTimestamp")?c.a.createElement(s.Fragment,null,c.a.createElement("div",{className:"timestamp-editor__separator"},c.a.createElement("div",{className:"timestamp-editor__separator__margin-line"}),"to",c.a.createElement("div",{className:"timestamp-editor__separator__margin-line"})),c.a.createElement(Ji,{timestamp:t.get("secondTimestamp"),onChange:this.handleChange("secondTimestamp")}),c.a.createElement("div",{className:"timestamp-editor__button-container"},c.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleRemoveEndTimestamp},"Remove end timestamp"))):c.a.createElement("div",{className:"timestamp-editor__button-container"},c.a.createElement("button",{className:"btn timestamp-editor__add-new-button",onClick:this.handleAddEndTimestamp},"Add end timestamp"))),c.a.createElement("br",null))}}]),t}(s.PureComponent),qi=(n(469),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleAddNewItem"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidUpdate",value:function(e){var t=e.propertyListItems,n=this.props.propertyListItems;t.size===n.size-1&&""===n.last().get("property")&&this.lastTextfield&&this.lastTextfield.focus()}},{key:"handlePropertyChange",value:function(e){var t=this;return function(n){var a=t.props.propertyListItems.findIndex((function(t){return t.get("id")===e}));t.props.onChange(t.props.propertyListItems.setIn([a,"property"],n.target.value))}}},{key:"handleValueChange",value:function(e){var t=this;return function(n){var a=t.props,r=a.propertyListItems,i=a.onChange,o=r.findIndex((function(t){return t.get("id")===e}));i(r.setIn([o,"value"],Object($.fromJS)(aa(n.target.value))))}}},{key:"handleRemoveItem",value:function(e){var t=this;return function(){return t.props.onChange(t.props.propertyListItems.filter((function(t){return t.get("id")!==e})))}}},{key:"handleAddNewItem",value:function(){this.props.onChange(this.props.propertyListItems.push(Object($.fromJS)({property:"",value:"",id:_e()})))}},{key:"render",value:function(){var e=this,t=this.props,n=t.onClose,a=t.propertyListItems,r=t.allOrgProperties,i=Ge(r),o=a.map((function(e){var t=e.get("property");return[e,Ke(r,t)]}));return c.a.createElement(Vi,{onClose:n},c.a.createElement("h2",{className:"drawer-modal__title"},"Edit property list"),c.a.createElement("datalist",{id:"drawer-modal__datalist-property-names"},i.map((function(e,t){return c.a.createElement("option",{key:t,value:e})}))),0===a.size?c.a.createElement("div",{className:"no-items-message"},"There are no items in this property list.",c.a.createElement("br",null),c.a.createElement("br",null),"Click the ",c.a.createElement("i",{className:"fas fa-plus"})," button to add a new one."):c.a.createElement(jr.c,{droppableId:"property-list-editor-droppable",type:"PROPERTY-LIST"},(function(t,n){return c.a.createElement("div",Object.assign({className:"property-list-editor__items-container",ref:t.innerRef},t.droppableProps),c.a.createElement(s.Fragment,null,o.map((function(t,n){var a=Object(d.a)(t,2),r=a[0],i=a[1];return c.a.createElement(jr.b,{draggableId:"property-list-item--".concat(n),index:n,key:r.get("id")},(function(t,a){return c.a.createElement("div",Object.assign({className:Xr()("property-list-editor__item-container",{"property-list-editor__item-container--dragging":a.isDragging}),ref:t.innerRef},t.draggableProps),c.a.createElement("div",{className:"item__textfields-container"},c.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:r.get("property"),onChange:e.handlePropertyChange(r.get("id")),ref:function(t){return e.lastTextfield=t},list:"drawer-modal__datalist-property-names"}),c.a.createElement("input",{type:"text",className:"textfield item-container__textfield",value:ve(r.get("value")),onChange:e.handleValueChange(r.get("id")),list:"drawer-modal__datalist-property-".concat(n,"-values")}),c.a.createElement("datalist",{id:"drawer-modal__datalist-property-".concat(n,"-values")},i.map((function(e,t){return c.a.createElement("option",{key:t,value:e})})))),c.a.createElement("div",{className:"item-container__actions-container"},c.a.createElement("i",{className:"fas fa-times fa-lg",onClick:e.handleRemoveItem(r.get("id"))}),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg item-container__drag-handle drag-handle"},t.dragHandleProps))))}))})),t.placeholder))})),c.a.createElement("div",{className:"property-list-editor__add-new-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:this.handleAddNewItem})))}}]),t}(s.PureComponent)),$i=(n(470),n(471),n(145)),Zi=n(493),Qi=n(501),eo=n(494),to=n(495),no=n(496),ao=function(e){function t(){return Object(h.a)(this,t),Object(g.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleHeaderClick",value:function(e){var t=this;return function(){return t.props.onHeaderClick(e)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.date,a=t.headers,r=t.todoKeywordSets,i=t.dateDisplayType,o=t.onToggleDateDisplayType,l=t.agendaDefaultDeadlineDelayValue,u=t.agendaDefaultDeadlineDelayUnit,h=Object($i.a)(n),p=Object(Zi.a)(n),g=this.getPlanningItemsAndHeaders({headers:a,todoKeywordSets:r,date:n,agendaDefaultDeadlineDelayValue:l,agendaDefaultDeadlineDelayUnit:u,dateStart:h,dateEnd:p});return c.a.createElement("div",{className:"agenda-day__container"},c.a.createElement("div",{className:"agenda-day__title"},Object(Qi.a)(n)&&c.a.createElement("div",{className:"agenda-day__today-indicator"}),c.a.createElement("div",{className:"agenda-day__title__day-name"},Object(Z.a)(n,"eeee")),c.a.createElement("div",{className:"agenda-day__title__date"},Object(Z.a)(n,"MMMM do, yyyy"))),c.a.createElement("div",{className:"agenda-day__headers-container"},g.map((function(t){var n=Object(d.a)(t,2),a=n[0],r=n[1],l=me(a.get("timestamp")),u=!!r.getIn(["titleLine","todoKeyword"]),h=Xr()("agenda-day__header-planning-date",{"agenda-day__header-planning-date--overdue":u&&Object(eo.a)(l)});return c.a.createElement("div",{key:a.get("id"),className:"agenda-day__header-container"},c.a.createElement("div",{className:"agenda-day__header__planning-item-container"},c.a.createElement("div",{className:"agenda-day__header-planning-type"},a.get("type")),c.a.createElement("div",{className:h,onClick:o},"absolute"===i?Object(Z.a)(l,"MM/dd"):Be(l),!!a.getIn(["timestamp","startHour"])&&c.a.createElement(s.Fragment,null,c.a.createElement("br",null),Object(Z.a)(l,"h:mma")))),c.a.createElement("div",{className:"agenda-day__header__header-container"},c.a.createElement(yi,{header:r,color:"black",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:e.handleHeaderClick(r.get("id"))})))}))))}},{key:"getPlanningItemsAndHeaders",value:function(e){var t=e.headers,n=e.todoKeywordSets,a=e.date,r=e.agendaDefaultDeadlineDelayValue,i=e.agendaDefaultDeadlineDelayUnit,o=e.dateStart,s=e.dateEnd;return t.flatMap((function(e){return e.get("planningItems").filter((function(t){var c=t.get("timestamp");if(!c.get("isActive"))return!1;var l=me(c);if(!!e.getIn(["titleLine","todoKeyword"])&&function(e,t){return Ue(e,t).get("completedKeywords").includes(t)}(n,e.getIn(["titleLine","todoKeyword"])))return!1;if("DEADLINE"===t.get("type")){if(Object(Qi.a)(a)){if(Object(ue.a)(l,new Date))return!0;var u=c.get("delayType")?[c.get("delayValue"),c.get("delayUnit")]:[r,i],h=Object(d.a)(u,2),p=function(e,t,n){return{h:Object(ie.a)(e,t),d:Object(oe.a)(e,t),w:Object(se.a)(e,t),m:Object(ce.a)(e,t),y:Object(le.a)(e,t)}[n]}(l,h[0],h[1]);return Object(Je.a)(a,p)||Object(to.a)(a,p)}return Object(no.a)(l,{start:o,end:s})}if("SCHEDULED"===t.get("type")){var g=l;if(c.get("delayType")){var m=e.get("propertyListItems").some((function(e){return"LAST_REPEAT"===e.get("property")}));"--"!==c.get("delayType")||m||(g=fe(l,c.get("delayValue"),c.get("delayUnit")))}return!(!Object(Qi.a)(a)||!Object(Je.a)(a,g))||Object(no.a)(g,{start:o,end:s})}return!1})).map((function(t){return[t,e]}))})).sortBy((function(e){var t=Object(d.a)(e,2),n=t[0],a=(t[1],n.get("timestamp").toJS()),r=a.startHour;return[r?0:1,r,a.startMinute,a.endHour,a.endMinute,a.month,a.day]}))}}]),t}(s.PureComponent),ro=n(497),io=n(498),oo=n(222);var so=Object(y.b)((function(e){return{todoKeywordSets:e.org.present.get("todoKeywordSets"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d"}}),(function(e){return{org:Object(v.b)(r,e)}}))((function(e){var t=Object(s.useState)(new Date),n=Object(d.a)(t,2),a=n[0],r=n[1],i=Object(s.useState)("Week"),o=Object(d.a)(i,2),l=o[0],u=o[1],h=Object(s.useState)("absolute"),p=Object(d.a)(h,2),g=p[0],m=p[1];function f(t){e.onClose(),e.org.selectHeaderAndOpenParents(t)}function b(){m("absolute"===g?"relative":"absolute")}var y=e.onClose,v=e.headers,E=e.todoKeywordSets,T=e.agendaDefaultDeadlineDelayValue,k=e.agendaDefaultDeadlineDelayUnit,w=[];switch(l){case"Day":w=[a];break;case"Week":var S=Object(ro.a)(a);w=_.a.range(7).map((function(e){return Object(te.a)(S,e)}));break;case"Month":var I=Object(io.a)(a);w=_.a.range(Object(oo.a)(a)).map((function(e){return Object(te.a)(I,e)}))}return c.a.createElement(Vi,{onClose:y,maxSize:!0},c.a.createElement("h2",{className:"agenda__title"},"Agenda"),c.a.createElement("div",{className:"agenda__tab-container"},c.a.createElement(zi,{buttons:["Day","Week","Month"],selectedButton:l,onSelect:function(e){u(e)},useEqualWidthTabs:!0})),c.a.createElement("div",{className:"agenda__timeframe-header-container"},c.a.createElement("i",{className:"fas fa-chevron-left fa-lg",onClick:function(){switch(l){case"Day":r(Object(oe.a)(a,1));break;case"Week":r(Object(se.a)(a,1));break;case"Month":r(Object(ce.a)(a,1));break;default:return""}}}),c.a.createElement("div",{className:"agenda__timeframe-header"},function(){switch(l){case"Day":return Object(Z.a)(a,"MMMM do");case"Week":var e=Object(ro.a)(a),t=Object(ne.a)(e,1);return"".concat(Object(Z.a)(e,"MMM do")," - ").concat(Object(Z.a)(t,"MMM do")," (W").concat(Object(Z.a)(e,"w"),")");case"Month":return Object(Z.a)(a,"MMMM");default:return""}}()),c.a.createElement("i",{className:"fas fa-chevron-right fa-lg",onClick:function(){switch(l){case"Day":r(Object(te.a)(a,1));break;case"Week":r(Object(ne.a)(a,1));break;case"Month":r(Object(ae.a)(a,1));break;default:return""}}})),c.a.createElement("div",{className:"agenda__days-container"},w.map((function(e){return c.a.createElement(ao,{key:Object(Z.a)(e,"yyyy MM dd"),date:e,headers:v,onHeaderClick:f,todoKeywordSets:E,dateDisplayType:g,onToggleDateDisplayType:b,agendaDefaultDeadlineDelayValue:T,agendaDefaultDeadlineDelayUnit:k})}))),c.a.createElement("br",null))}));n(472),n(473);var co=function(e){return me(e.get("timestamp")).getTime()},lo=Object(y.b)((function(e){return{todoKeywordSets:e.org.present.get("todoKeywordSets"),headers:e.org.present.getIn(["search","filteredHeaders"])||e.org.present.get("headers")}}),(function(e){return{}}))((function(e){var t=e.dateDisplayType,n=e.onToggleDateDisplayType,a=function(e){var t=e.headers,n=e.todoKeywordSets,a=ze(n);return t.filter((function(e){return e.getIn(["titleLine","todoKeyword"])})).map((function(e){return[e.get("planningItems").sortBy(co).first(),e]})).sortBy((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return[a(r.getIn(["titleLine","todoKeyword"])),n?co(n):Number.MAX_SAFE_INTEGER,r.getIn(["titleLine","rawTitle"])]}))}({headers:e.headers,todoKeywordSets:e.todoKeywordSets});return c.a.createElement("div",{className:"agenda-day__container"},c.a.createElement("div",{className:"agenda-day__headers-container"},a.map((function(a){var r,i=Object(d.a)(a,2),o=i[0],l=i[1],u=o?me(o.get("timestamp")):null,h=!!l.getIn(["titleLine","todoKeyword"]),p=Xr()("task-list__header-planning-date",{"task-list__header-planning-date--overdue":h&&o&&Object(eo.a)(u)}),g=c.a.createElement("div",null);return u&&(g=c.a.createElement("div",{className:"agenda-day__header__planning-item-container"},c.a.createElement("div",{className:"task-list__header-planning-type"},o.get("type")),c.a.createElement("div",{className:p,onClick:n},"absolute"===t?Object(Z.a)(u,"MM/dd"):Be(u),!!o.getIn(["timestamp","startHour"])&&c.a.createElement(s.Fragment,null,c.a.createElement("br",null),Object(Z.a)(u,"h:mma"))))),c.a.createElement("div",{key:l.get("id"),className:"agenda-day__header-container"},c.a.createElement("div",{className:"agenda-day__header__header-container"},c.a.createElement(yi,{header:l,color:"black",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:(r=l.get("id"),function(){return e.onHeaderClick(r)})}),g))}))))}));var uo=Object(y.b)((function(e){return{searchFilter:e.org.present.getIn(["search","searchFilter"])||"",searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[]}}),(function(e){return{org:Object(v.b)(r,e)}}))((function(e){var t=Object(s.useState)("absolute"),n=Object(d.a)(t,2),a=n[0],r=n[1],i=e.onClose,o=e.searchFilter,l=e.searchFilterValid,u=e.searchFilterSuggestions,h={overflow:xi?"none":"auto"};return c.a.createElement(Vi,{onClose:i,maxSize:!0},c.a.createElement("h2",{className:"agenda__title"},"Task list"),c.a.createElement("datalist",{id:"task-list__datalist-filter"},u.map((function(e,t){return c.a.createElement("option",{key:t,value:e})}))),c.a.createElement("div",{className:"task-list__input-container"},c.a.createElement("input",{type:"text",value:o,className:Xr()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!o&&!l}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart)}})),c.a.createElement("div",{className:"task-list__headers-container",style:h},c.a.createElement(lo,{onHeaderClick:function(t){e.onClose(),e.org.selectHeaderAndOpenParents(t)},dateDisplayType:a,onToggleDateDisplayType:function(){r("absolute"===a?"relative":"absolute")}})),c.a.createElement("br",null))}));n(474),n(475);var ho=Object(y.b)((function(e){return{headers:e.org.present.getIn(["search","filteredHeaders"])||e.org.present.get("headers")}}),(function(e){return{org:Object(v.b)(r,e)}}))((function(e){var t=e.context;Object(s.useEffect)((function(){e.org.setSearchFilterInformation("",0,t)}),[t,e.org]);var n=e.headers;return c.a.createElement("div",{className:"agenda-day__container"},c.a.createElement("div",{className:"agenda-day__headers-container"},n.map((function(t){return c.a.createElement("div",{key:t.get("id"),className:"agenda-day__header-container"},c.a.createElement("div",{className:"agenda-day__header__header-container"},c.a.createElement(yi,{header:t,color:"black",hasContent:!1,isSelected:!1,shouldDisableActions:!0,shouldDisableExplicitWidth:!0,onClick:(n=t.get("id"),function(){return e.onHeaderClick(n)})})));var n}))))}));var po=Object(y.b)((function(e){return{searchFilter:e.org.present.getIn(["search","searchFilter"])||"",searchFilterValid:e.org.present.getIn(["search","searchFilterValid"]),searchFilterSuggestions:e.org.present.getIn(["search","searchFilterSuggestions"])||[]}}),(function(e){return{org:Object(v.b)(r,e)}}))((function(e){var t=Object(s.useState)("absolute"),n=Object(d.a)(t,2),a=n[0],r=n[1],i=e.onClose,o=e.searchFilter,l=e.searchFilterValid,u=e.searchFilterSuggestions,h=e.context,p={overflow:xi?"none":"auto"};return c.a.createElement(Vi,{onClose:i,maxSize:!0},c.a.createElement("h2",{className:"agenda__title"},Object(w.capitalize)(h)),c.a.createElement("datalist",{id:"task-list__datalist-filter"},u.map((function(e,t){return c.a.createElement("option",{key:t,value:e})}))),c.a.createElement("div",{className:"task-list__input-container"},c.a.createElement("input",{type:"text",value:o,className:Xr()("textfield","task-list__filter-input",{"task-list__filter-input--invalid":!!o&&!l}),placeholder:"e.g. -DONE doc|man :simple|easy :assignee:nobody|none",list:"task-list__datalist-filter",onChange:function(t){e.org.setSearchFilterInformation(t.target.value,t.target.selectionStart,h)}})),c.a.createElement("div",{className:"task-list__headers-container",style:p},c.a.createElement(ho,{onHeaderClick:function(t){e.onClose(t)},dateDisplayType:a,onToggleDateDisplayType:function(){r("absolute"===a?"relative":"absolute")},context:h})),c.a.createElement("br",null))})),go=[["Select next header","selectNextVisibleHeader","ctrl+down"],["Select previous header","selectPreviousVisibleHeader","ctrl+up"],["Toggle header opened","toggleHeaderOpened","tab"],["Advance todo state","advanceTodo","alt+t"],["Edit title","editTitle","ctrl+h"],["Edit description","editDescription","ctrl+d"],["Exit edit mode","exitEditMode","alt+enter"],["Add header","addHeader","ctrl+enter"],["Remove header","removeHeader","backspace"],["Move header up","moveHeaderUp","alt+up"],["Move header down","moveHeaderDown","alt+down"],["Move header left","moveHeaderLeft","alt+shift+left"],["Move header right","moveHeaderRight","alt+shift+right"],["Undo","undo","ctrl+/"]],mo=function(e){return go.map((function(t){var n=Object(d.a)(t,3),a=n[0],r=(n[1],n[2]);return[a,e.get(a,r)]}))},fo=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleSelectNextVisibleHeaderHotKey","handleSelectPreviousVisibleHeaderHotKey","handleToggleHeaderOpenedHotKey","handleAdvanceTodoHotKey","handleEditTitleHotKey","handleEditDescriptionHotKey","handleExitEditModeHotKey","handleAddHeaderHotKey","handleRemoveHeaderHotKey","handleMoveHeaderUpHotKey","handleMoveHeaderDownHotKey","handleMoveHeaderLeftHotKey","handleMoveHeaderRightHotKey","handleUndoHotKey","handleContainerRef","handleCapture","handlePopupClose","handleSearchPopupClose","handleRefilePopupClose","handleSyncConfirmationPull","handleSyncConfirmationPush","handleSyncConfirmationCancel","handleTagsChange","handlePropertyListItemsChange"]),n.state={hasUncaughtError:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.staticFile,a=t.path,r=t.loadedPath;n?(this.props.base.loadStaticFile(n),"changelog"===n&&(this.props.base.setHasUnseenChangelog(!1),Se().then((function(t){e.props.base.setLastSeenChangelogHeader(t)}))),setTimeout((function(){return document.querySelector("html").scrollTop=0}),0)):_.a.isEmpty(a)||a===r||this.props.syncBackend.downloadFile(a),this.activatePopup()}},{key:"activatePopup",value:function(){var e=window.location.hash.substr(1);_.a.isEmpty(e)||this.props.base.activatePopup(e)}},{key:"componentWillUnmount",value:function(){this.props.staticFile?this.props.base.unloadStaticFile():this.props.org.stopDisplayingFile()}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.headers;e.pendingCapture&&t&&t.size>0&&this.props.org.insertPendingCapture()}},{key:"componentDidCatch",value:function(e){this.setState({hasUncaughtError:!0})}},{key:"handleSelectNextVisibleHeaderHotKey",value:function(){this.props.org.selectNextVisibleHeader()}},{key:"handleSelectPreviousVisibleHeaderHotKey",value:function(){this.props.org.selectPreviousVisibleHeader()}},{key:"handleToggleHeaderOpenedHotKey",value:function(){var e=this.props.selectedHeaderId;e&&this.props.org.toggleHeaderOpened(e)}},{key:"handleAdvanceTodoHotKey",value:function(){this.props.org.advanceTodoState()}},{key:"handleEditTitleHotKey",value:function(){this.props.org.enterEditMode("title")}},{key:"handleEditDescriptionHotKey",value:function(){this.props.org.openHeader(this.props.selectedHeaderId),this.props.org.enterEditMode("description")}},{key:"handleExitEditModeHotKey",value:function(){this.props.org.exitEditMode(),this.container.focus()}},{key:"handleAddHeaderHotKey",value:function(){this.props.org.addHeaderAndEdit(this.props.selectedHeaderId)}},{key:"handleRemoveHeaderHotKey",value:function(){var e=this.props.selectedHeaderId;this.props.org.selectNextSiblingHeader(e),this.props.org.removeHeader(e)}},{key:"handleMoveHeaderUpHotKey",value:function(){this.props.org.moveHeaderUp(this.props.selectedHeaderId)}},{key:"handleMoveHeaderDownHotKey",value:function(){this.props.org.moveHeaderDown(this.props.selectedHeaderId)}},{key:"handleMoveHeaderLeftHotKey",value:function(){this.props.org.moveHeaderLeft(this.props.selectedHeaderId)}},{key:"handleMoveHeaderRightHotKey",value:function(){this.props.org.moveHeaderRight(this.props.selectedHeaderId)}},{key:"handleUndoHotKey",value:function(){this.props.undo.undo()}},{key:"handleContainerRef",value:function(e){this.container=e,this.container&&this.container.focus()}},{key:"handleCapture",value:function(e,t,n){this.props.org.insertCapture(e,t,n)}},{key:"handlePopupClose",value:function(){this.props.base.closePopup()}},{key:"handleSearchPopupClose",value:function(e){this.props.base.closePopup(),this.props.org.selectHeaderAndOpenParents(e)}},{key:"handleRefilePopupClose",value:function(e){if(this.props.base.closePopup(),e){var t=this.props.selectedHeaderId;this.props.org.refileSubtree(t,e)}}},{key:"handleSyncConfirmationPull",value:function(){this.props.org.sync({forceAction:"pull"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationPush",value:function(){this.props.org.sync({forceAction:"push"}),this.props.base.closePopup()}},{key:"handleSyncConfirmationCancel",value:function(){this.props.base.closePopup()}},{key:"handleTagsChange",value:function(e){this.props.org.setHeaderTags(this.props.selectedHeaderId,e)}},{key:"handlePropertyListItemsChange",value:function(e){this.props.org.updatePropertyListItems(this.props.selectedHeaderId,e)}},{key:"handleTimestampChange",value:function(e){var t=this;return e.get("timestampId")?function(n){return t.props.org.updateTimestampWithId(e.get("timestampId"),n)}:void 0!==e.get("logEntryIndex")?function(n){return t.props.org.updateLogEntryTime(e.get("headerId"),e.get("logEntryIndex"),e.get("entryType"),n.get("firstTimestamp"))}:function(n){return t.props.org.updatePlanningItemTimestamp(e.get("headerId"),e.get("planningItemIndex"),n.get("firstTimestamp"))}}},{key:"renderActivePopup",value:function(){var e=this.props,t=e.activePopupType,n=e.activePopupData,a=e.captureTemplates,r=e.headers,i=e.selectedHeader;switch(t){case"sync-confirmation":return c.a.createElement(Gi,{lastServerModifiedAt:n.get("lastServerModifiedAt"),onPull:this.handleSyncConfirmationPull,onPush:this.handleSyncConfirmationPush,onCancel:this.handleSyncConfirmationCancel});case"capture":return c.a.createElement(Wi,{template:a.find((function(e){return e.get("id")===n.get("templateId")})),headers:r,onCapture:this.handleCapture,onClose:this.handlePopupClose});case"tags-editor":var o=Ve(r);return i?c.a.createElement(Ki,{header:i,allTags:o,onClose:this.handlePopupClose,onChange:this.handleTagsChange}):null;case"timestamp-editor":var s=null;return s=n.get("timestampId")?function(e,t){return e.map((function(e){return Fe(e.getIn(["titleLine","title"]),t)||Fe(e.get("description"),t)||e.get("propertyListItems").map((function(e){return Fe(e.get("value"),t)})).filter((function(e){return!!e})).first()})).find((function(e){return!!e}))}(r,n.get("timestampId")):void 0!==n.get("logEntryIndex")?Object($.fromJS)({firstTimestamp:Oe(r,n.get("headerId")).getIn(["logBookEntries",n.get("logEntryIndex"),n.get("entryType")])}):Object($.fromJS)({firstTimestamp:Oe(r,n.get("headerId")).getIn(["planningItems",n.get("planningItemIndex"),"timestamp"])}),c.a.createElement(Xi,{timestamp:s,planningItemIndex:n.get("planningItemIndex"),singleTimestampOnly:!n.get("timestampId"),onClose:this.handlePopupClose,onChange:this.handleTimestampChange(n)});case"property-list-editor":var l=We(r);return i?c.a.createElement(qi,{onClose:this.handlePopupClose,onChange:this.handlePropertyListItemsChange,propertyListItems:i.get("propertyListItems"),allOrgProperties:l}):null;case"agenda":return c.a.createElement(so,{onClose:this.handlePopupClose,headers:r});case"task-list":return c.a.createElement(uo,{onClose:this.handlePopupClose,headers:r});case"search":return c.a.createElement(po,{onClose:this.handleSearchPopupClose,context:"search"});case"refile":return c.a.createElement(po,{onClose:this.handleRefilePopupClose,context:"refile"});default:return null}}},{key:"render",value:function(){var e=this.props,t=e.headers,n=e.shouldDisableDirtyIndicator,a=e.shouldDisableSyncButtons,r=e.shouldDisableActions,i=e.isDirty,o=e.parsingErrorMessage,l=e.path,u=e.staticFile,h=e.customKeybindings,p=e.inEditMode,g=e.orgFileErrorMessage;if(!l&&!u)return c.a.createElement(Yr.b,{to:"/files"});if(this.state.hasUncaughtError)return c.a.createElement("div",{className:"error-message-container"},"Uh oh, you ran into a bug!",c.a.createElement("br",null),c.a.createElement("br",null),"This was probably the result of an error in attempting to parse your org file. It'd be super helpful if you could"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","(and include the org file if possible!)");if(g)return c.a.createElement("div",{className:"error-message-container"},g);if(!t)return c.a.createElement("div",null);var m=_.a.fromPairs(function(e){return go.map((function(t){var n=Object(d.a)(t,3),a=n[0],r=n[1],i=n[2];return[r,e.get(a,i)]}))}(h)),f=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n){t&&p||t&&["TEXTAREA","INPUT"].includes(document.activeElement.nodeName)||(n.preventDefault(),e(n))}},b={selectNextVisibleHeader:f(this.handleSelectNextVisibleHeaderHotKey),selectPreviousVisibleHeader:f(this.handleSelectPreviousVisibleHeaderHotKey),toggleHeaderOpened:f(this.handleToggleHeaderOpenedHotKey,!0),advanceTodo:f(this.handleAdvanceTodoHotKey),editTitle:f(this.handleEditTitleHotKey),editDescription:f(this.handleEditDescriptionHotKey),exitEditMode:f(this.handleExitEditModeHotKey),addHeader:f(this.handleAddHeaderHotKey),removeHeader:f(this.handleRemoveHeaderHotKey,!0),moveHeaderUp:f(this.handleMoveHeaderUpHotKey),moveHeaderDown:f(this.handleMoveHeaderDownHotKey),moveHeaderLeft:f(this.handleMoveHeaderLeftHotKey),moveHeaderRight:f(this.handleMoveHeaderRightHotKey),undo:f(this.handleUndoHotKey)};return c.a.createElement(ii.HotKeys,{keyMap:m,handlers:b},c.a.createElement("div",{className:"org-file-container",tabIndex:"-1",ref:this.handleContainerRef},0===t.size?c.a.createElement("div",{className:"org-file__parsing-error-message"},c.a.createElement("h3",null,"Couldn't parse file"),o?c.a.createElement(s.Fragment,null,o):c.a.createElement(s.Fragment,null,"If you think this is a bug, please"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/issues/new",target:"_blank",rel:"noopener noreferrer"},"create an issue")," ","and include the org file if possible!")):c.a.createElement(Ci,{shouldDisableActions:r}),i&&!n&&c.a.createElement("div",{className:"dirty-indicator"},"Unpushed changes"),!r&&c.a.createElement(Pi,{shouldDisableSyncButtons:a,staticFile:u}),this.renderActivePopup()))}}]),t}(s.PureComponent),bo=Object(y.b)((function(e,t){var n=e.org.present.get("headers"),a=e.org.present.get("selectedHeaderId"),r=e.base.get("activePopup");return{headers:n,selectedHeaderId:a,isDirty:e.org.present.get("isDirty"),loadedPath:e.org.present.get("path"),selectedHeader:n&&n.find((function(e){return e.get("id")===a})),customKeybindings:e.base.get("customKeybindings"),inEditMode:!!e.org.present.get("editMode"),activePopupType:r?r.get("type"):null,activePopupData:r?r.get("data"):null,captureTemplates:e.capture.get("captureTemplates").concat(Ye),pendingCapture:e.org.present.get("pendingCapture"),orgFileErrorMessage:e.org.present.get("orgFileErrorMessage")}}),(function(e){return{base:Object(v.b)(a,e),syncBackend:Object(v.b)(o,e),org:Object(v.b)(r,e),undo:Object(v.b)(T.ActionCreators,e),capture:Object(v.b)(i,e)}}))(fo),yo=(n(476),Object(Yr.h)(Object(y.b)((function(e,t){return{fontSize:e.base.get("fontSize")||"Regular",bulletStyle:e.base.get("bulletStyle")||"Classic",shouldTapTodoToAdvance:e.base.get("shouldTapTodoToAdvance"),agendaDefaultDeadlineDelayValue:e.base.get("agendaDefaultDeadlineDelayValue")||5,agendaDefaultDeadlineDelayUnit:e.base.get("agendaDefaultDeadlineDelayUnit")||"d",shouldStoreSettingsInSyncBackend:e.base.get("shouldStoreSettingsInSyncBackend"),shouldLiveSync:e.base.get("shouldLiveSync"),shouldSyncOnBecomingVisibile:e.base.get("shouldSyncOnBecomingVisibile"),shouldShowTitleInOrgFile:e.base.get("shouldShowTitleInOrgFile"),hasUnseenChangelog:e.base.get("hasUnseenChangelog")}}),(function(e){return{syncBackend:Object(v.b)(o,e),base:Object(v.b)(a,e)}}))((function(e){var t=e.fontSize,n=e.bulletStyle,a=e.shouldTapTodoToAdvance,r=e.shouldStoreSettingsInSyncBackend,i=e.shouldLiveSync,o=e.shouldSyncOnBecomingVisibile,s=e.shouldShowTitleInOrgFile,l=e.agendaDefaultDeadlineDelayValue,u=e.agendaDefaultDeadlineDelayUnit,d=e.hasUnseenChangelog,h=e.syncBackend,p=e.base;return c.a.createElement("div",{className:"settings-container"},c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Font size"),c.a.createElement(zi,{buttons:["Regular","Large"],selectedButton:t,onSelect:function(e){return p.setFontSize(e)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Bullet style"),c.a.createElement(zi,{buttons:["Classic","Fancy"],selectedButton:n,onSelect:function(e){return p.setBulletStyle(e)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Tap TODO to advance state"),c.a.createElement(Ui,{isEnabled:a,onToggle:function(){return p.setShouldTapTodoToAdvance(!a)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Live sync",c.a.createElement("div",{className:"setting-label__description"},"If enabled, changes are automatically pushed to the sync backend as you make them.")),c.a.createElement(Ui,{isEnabled:i,onToggle:function(){return p.setShouldLiveSync(!i)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Sync on application becoming visible",c.a.createElement("div",{className:"setting-label__description"},"If enabled, the current org file is pulled from the sync backend when the browser tab becomes visible. This prevents you from having a stale file before starting to make changes to it.")),c.a.createElement(Ui,{isEnabled:o,onToggle:function(){return p.setShouldSyncOnBecomingVisibile(!o)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Show Org filename as Title",c.a.createElement("div",{className:"setting-label__description"},"When in an Org file view, it shows the filename in the HeaderBar.")),c.a.createElement(Ui,{isEnabled:s,onToggle:function(){return p.setShouldShowTitleInOrgFile(!s)}})),c.a.createElement("div",{className:"setting-container"},c.a.createElement("div",{className:"setting-label"},"Store settings in sync backend",c.a.createElement("div",{className:"setting-label__description"},"Store settings and keyboard shortcuts in a .organice-config.json file in your sync backend to sync between multiple devices.")),c.a.createElement(Ui,{isEnabled:r,onToggle:function(){return p.setShouldStoreSettingsInSyncBackend(!r)}})),c.a.createElement("div",{className:"setting-container setting-container--vertical"},c.a.createElement("div",{className:"setting-label"},"Default DEADLINE warning period"),c.a.createElement("div",{className:"default-deadline-warning-container"},c.a.createElement("input",{type:"number",min:"0",className:"textfield default-deadline-value-textfield",value:l,onChange:function(e){return p.setAgendaDefaultDeadlineDelayValue(e.target.value)}}),c.a.createElement(zi,{buttons:"hdwmy".split(""),selectedButton:u,onSelect:function(e){return p.setAgendaDefaultDeadlineDelayUnit(e)}}))),c.a.createElement("div",{className:"settings-buttons-container"},c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("capture_templates_editor")}},"Capture templates"),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("keyboard_shortcuts_editor")}},"Keyboard shortcuts"),c.a.createElement("hr",{className:"settings-button-separator"}),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return p.pushModalPage("changelog")}},"Changelog",d&&c.a.createElement("div",{className:"changelog-badge-container"},c.a.createElement("i",{className:"fas fa-gift"}),"\xa0 What's New?")),c.a.createElement(Rr.b,{to:"/sample",className:"btn settings-btn"},"Help"),c.a.createElement("button",{className:"btn settings-btn"},c.a.createElement("a",{href:"https://organice.200ok.ch/documentation.html",target:"_blank",rel:"noopener noreferrer"},"Documentation ",c.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),c.a.createElement("button",{className:"btn settings-btn"},c.a.createElement("a",{href:"https://github.com/200ok-ch/organice",target:"_blank",rel:"noopener noreferrer"},"Github repo ",c.a.createElement("i",{className:"fas fa-external-link-alt fa-sm"}))),c.a.createElement("hr",{className:"settings-button-separator"}),c.a.createElement("button",{className:"btn settings-btn",onClick:function(){return window.confirm("Are you sure you want to sign out?")?h.signOut():void 0}},"Sign out")))})))),vo=(n(477),function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleRebindClick","handleKeyPress"]),n.state={isEditMode:!1},n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.rebindArea.addEventListener("blur",(function(){return e.setState({isEditMode:!1})}))}},{key:"handleRebindClick",value:function(){this.setState({isEditMode:!0}),document.addEventListener("keypress",this.handleKeyPress)}},{key:"handleKeyPress",value:function(e){this.setState({isEditMode:!1}),document.removeEventListener("keypress",this.handleKeyPress);var t=null;if(t=e.code.startsWith("Key")?e.code.substr(3).toLowerCase():e.code.startsWith("Digit")?e.code.substr(5):{Minus:"-",Equal:"=",Backspace:"backspace",Enter:"enter",Return:"return",Tab:"tab",BracketLeft:"[",BracketRight:"]",Semicolon:";",Quote:'"',Backslash:"\\",Comma:",",Period:".",Slash:"/"}[e.code]){var n=[["ctrlKey","ctrl"],["altKey","alt"],["metaKey","meta"],["shiftKey","shift"]].filter((function(t){var n=Object(d.a)(t,2),a=n[0];n[1];return e[a]})).map((function(e){var t=Object(d.a)(e,2);t[0];return t[1]})).join("+"),a="".concat(n).concat(n?"+":"").concat(t);this.props.onBindingChange(this.props.name,a)}}},{key:"symbolizeKeybinding",value:function(e){if(!e)return"";return[["ctrl","^"],["alt","\u2325"],["option","\u2325"],["command","\u2318"],["meta","\u2318"],["shift","\u21e7"],["backspace","\u232b"],["return","\u23ce"],["enter","\u23ce"],["left","\u2190"],["right","\u2192"],["up","\u2191"],["down","\u2193"]].reduce((function(e,t){var n=Object(d.a)(t,2),a=n[0],r=n[1];return e.replace(RegExp("".concat(a,"\\+?")),r)}),e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.binding,r=this.state.isEditMode,i=Xr()("keyboard-shortcut-container__shortcut-key",{"keyboard-shortcut-container__shortcut-key--edit-mode":r});return c.a.createElement("div",{className:"keyboard-shortcut-container"},c.a.createElement("div",{className:"keyboard-shortcut-container__shortcut-name"},n),c.a.createElement("div",{className:i,onClick:this.handleRebindClick,tabIndex:"-1",ref:function(t){return e.rebindArea=t}},r?"...":this.symbolizeKeybinding(a)))}}]),t}(s.PureComponent)),Eo=(n(478),Object(Yr.h)(Object(y.b)((function(e,t){return{customKeybindings:e.base.get("customKeybindings")||Object($.Map)()}}),(function(e){return{base:Object(v.b)(a,e)}}))((function(e){var t=e.customKeybindings,n=e.base,a=function(e,a){var r=mo(t).filter((function(e){var t=Object(d.a)(e,2);t[0];return t[1]===a}))[0];r?alert('That binding is already in use for "'.concat(r[0],'"')):n.setCustomKeybinding(e,a)};return c.a.createElement("div",{className:"keyboard-shortcuts-editor-container"},mo(t).map((function(e){var t=Object(d.a)(e,2),n=t[0],r=t[1];return c.a.createElement(vo,{key:n,name:n,binding:r,onBindingChange:a})})))})))),To=(n(479),n(480),function(e){var t=e.template,n=e.index,a=e.onFieldPathUpdate,r=e.onAddNewTemplateOrgFileAvailability,i=e.onRemoveTemplateOrgFileAvailability,o=e.onAddNewTemplateHeaderPath,l=e.onRemoveTemplateHeaderPath,u=e.onDeleteTemplate,h=e.syncBackendType,p=Object(s.useState)(!!t.get("description")),g=Object(d.a)(p,2),m=g[0],f=g[1],b=function(){return f(!m)},y=function(e){return function(n){return a(t.get("id"),[e],n.target.value)}},v=function(){return a(t.get("id"),["isAvailableInAllOrgFiles"],!t.get("isAvailableInAllOrgFiles"))},E=function(){return a(t.get("id"),["shouldPrepend"],!t.get("shouldPrepend"))},T=function(){r(t.get("id"))},k=function(e){return function(){return i(t.get("id"),e)}},w=function(e){return function(n){return a(t.get("id"),["orgFilesWhereAvailable",e],n.target.value)}},_=function(){return o(t.get("id"))},S=function(e){return function(){return l(t.get("id"),e)}},I=function(e){return function(n){return a(t.get("id"),["headerPaths",e],n.target.value)}},O=function(){window.confirm('Are you sure you want to delete the "'.concat(t.get("description"),'" template?'))&&u(t.get("id"))},C=Xr()("fas fa-2x fa-caret-right capture-template-container__header__caret",{"capture-template-container__header__caret--rotated":!m});return c.a.createElement(jr.b,{draggableId:"capture-template--".concat(t.get("id")),index:n},(function(e,n){return c.a.createElement("div",Object.assign({className:Xr()("capture-template-container",{"capture-template-container--dragging":n.isDragging}),ref:e.innerRef},e.draggableProps),c.a.createElement("div",{className:"capture-template-container__header",onClick:b},c.a.createElement("i",{className:C}),c.a.createElement(Ni,{iconName:t.get("iconName"),letter:t.get("letter"),onClick:function(){},style:{marginRight:20}}),c.a.createElement("span",{className:"capture-template-container__header__title"},t.get("description")),c.a.createElement("i",Object.assign({className:"fas fa-bars fa-lg capture-template-container__header__drag-handle"},e.dragHandleProps))),c.a.createElement(si.UnmountClosed,{isOpened:!m,springConfig:{stiffness:300}},c.a.createElement("div",{className:"capture-template-container__content"},function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Description:"),c.a.createElement("input",{type:"text",className:"textfield",value:e.get("description",""),onChange:y("description")})))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Letter:"),c.a.createElement("input",{type:"text",className:"textfield capture-template__letter-textfield",maxLength:"1",value:e.get("letter",""),onChange:y("letter"),autoCapitalize:"none"})),c.a.createElement("div",{className:"capture-template__field__or-container"},c.a.createElement("div",{className:"capture-template__field__or-line"}),c.a.createElement("div",{className:"capture-template__field__or"},"or"),c.a.createElement("div",{className:"capture-template__field__or-line"})),c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Icon name:"),c.a.createElement("input",{type:"text",className:"textfield",value:e.get("iconName"),onChange:y("iconName"),autoCapitalize:"none",autoCorrect:"none"})),c.a.createElement("div",{className:"capture-template__help-text"},"Instead of a letter, you can specify the name of any free Font Awesome icon (like lemon or calendar-plus) to use as the capture icon. You can search the available icons"," ",c.a.createElement("a",{href:"https://fontawesome.com/icons?d=gallery&s=solid&m=free",target:"_blank",rel:"noopener noreferrer"},"here"),"."))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Available in all org files?"),c.a.createElement(Ui,{isEnabled:e.get("isAvailableInAllOrgFiles"),onToggle:v})),c.a.createElement("div",{className:"capture-template__help-text"},"You can make this capture template available in all org files, or just the ones you specify.","Dropbox"===h&&c.a.createElement(s.Fragment,null," ","Specify full paths starting from the root of your Dropbox, like"," ",c.a.createElement("code",null,"/org/todo.org")),"Google Drive"===h&&c.a.createElement(s.Fragment,null," ","Specify the file id of each file. You can find the file id in the URL of the file in organice (e.g.,"," ",c.a.createElement("code",null,"/file/","<file id>"),").")),c.a.createElement(si.UnmountClosed,{isOpened:!e.get("isAvailableInAllOrgFiles"),springConfig:{stiffness:300}},c.a.createElement("div",{className:"multi-textfields-container"},e.get("orgFilesWhereAvailable").map((function(e,t){return c.a.createElement("div",{key:"org-file-availability-".concat(t),className:"multi-textfield-container"},c.a.createElement("input",{type:"text",placeholder:"e.g., /org/todo.org",className:"textfield multi-textfield-field",value:e,onChange:w(t)}),c.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:k(t)}))}))),c.a.createElement("div",{className:"add-new-multi-textfield-button-container"},c.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:T}))))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},c.a.createElement("div",null,"Header path")),c.a.createElement("div",{className:"capture-template__help-text"},"Specify the path to the header under which the new header should be filed. One header per textfield."),c.a.createElement("div",{className:"multi-textfields-container"},e.get("headerPaths").map((function(e,t){return c.a.createElement("div",{key:"header-path-".concat(t),className:"multi-textfield-container"},c.a.createElement("input",{type:"text",placeholder:"e.g., Todos",className:"textfield multi-textfield-field",value:e,onChange:I(t)}),c.a.createElement("button",{className:"fas fa-times fa-lg remove-multi-textfield-button",onClick:S(t)}))}))),c.a.createElement("div",{className:"add-new-multi-textfield-button-container"},c.a.createElement("button",{className:"fas fa-plus add-new-multi-textfield-button",onClick:_})))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field"},c.a.createElement("div",null,"Prepend?"),c.a.createElement(Ui,{isEnabled:e.get("shouldPrepend"),onToggle:E})),c.a.createElement("div",{className:"capture-template__help-text"},"By default, new captured headers are appended to the specified header path. Enable this setting to prepend them instead."))}(t),function(e){return c.a.createElement("div",{className:"capture-template__field-container"},c.a.createElement("div",{className:"capture-template__field",style:{marginTop:7}},c.a.createElement("div",null,"Template")),c.a.createElement("textarea",{className:"textarea template-textarea",rows:"3",value:e.get("template"),onChange:y("template")}),c.a.createElement("div",{className:"capture-template__help-text"},"The template for creating the capture item. You can use the following template variables that will be expanded upon capture:",c.a.createElement("ul",null,c.a.createElement("li",null,c.a.createElement("code",null,"%?")," - Place the cursor here."),c.a.createElement("li",null,c.a.createElement("code",null,"%t")," - Timestamp, date only."),c.a.createElement("li",null,c.a.createElement("code",null,"%T")," - Timestamp, with date and time."),c.a.createElement("li",null,c.a.createElement("code",null,"%u")," - Inactive timestamp, date only."),c.a.createElement("li",null,c.a.createElement("code",null,"%U")," - Inactive timestamp, with date and time."),c.a.createElement("li",null,c.a.createElement("code",null,"%","<custom variable>")," - A custom variable from a URL param capture. See"," ",c.a.createElement("a",{href:"https://github.com/200ok-ch/organice/#capture-params-and-siri-support"},"the README file")," ","for more details."))))}(t),c.a.createElement("div",{className:"capture-template__field-container capture-template__delete-button-container"},c.a.createElement("button",{className:"btn settings-btn capture-template__delete-button",onClick:O},"Delete template")))))}))}),ko=Object(y.b)((function(e,t){return{captureTemplates:e.capture.get("captureTemplates",Object($.List)()),syncBackendType:e.syncBackend.get("client").type}}),(function(e){return{capture:Object(v.b)(i,e)}}))((function(e){var t=e.captureTemplates,n=e.syncBackendType,a=e.capture,r=function(e,t,n){return a.updateTemplateFieldPathValue(e,t,n)},i=function(e){return a.addNewTemplateOrgFileAvailability(e)},o=function(e,t){return a.removeTemplateOrgFileAvailability(e,t)},l=function(e){return a.addNewTemplateHeaderPath(e)},u=function(e,t){return a.removeTemplateHeaderPath(e,t)},d=function(e){return a.deleteTemplate(e)},h=function(e,t){return a.reorderCaptureTemplate(e,t)};return c.a.createElement("div",null,c.a.createElement(jr.c,{droppableId:"capture-templates-editor-droppable",type:"CAPTURE-TEMPLATE"},(function(e,a){return c.a.createElement("div",Object.assign({className:"capture-templates-container",ref:e.innerRef},e.droppableProps),0===t.size?c.a.createElement("div",{className:"no-capture-templates-message"},"You don't currently have any capture templates - add one by pressing the"," ",c.a.createElement("i",{className:"fas fa-plus"})," button.",c.a.createElement("br",null),c.a.createElement("br",null),"Capture templates show up in the action drawer and give you quick access to creating new headers (like org-capture)."):c.a.createElement(s.Fragment,null,t.map((function(e,t){return c.a.createElement(To,{key:e.get("id"),index:t,template:e,syncBackendType:n,onFieldPathUpdate:r,onAddNewTemplateOrgFileAvailability:i,onRemoveTemplateOrgFileAvailability:o,onAddNewTemplateHeaderPath:l,onRemoveTemplateHeaderPath:u,onDeleteTemplate:d,onReorder:h})})),e.placeholder))})),c.a.createElement("div",{className:"new-capture-template-button-container"},c.a.createElement("button",{className:"fas fa-plus fa-lg btn btn--circle",onClick:function(){return a.addNewEmptyCaptureTemplate()}})))})),wo=(n(481),n(233)),_o=n.n(wo),So=n(234),Io=n.n(So);function Oo(){var e=Object(s.useState)(!1),t=Object(d.a)(e,2),n=t[0],a=t[1],r=Object(s.useState)(""),i=Object(d.a)(r,2),o=i[0],l=i[1],u=Object(s.useState)(""),h=Object(d.a)(u,2),p=h[0],g=h[1],m=Object(s.useState)(""),f=Object(d.a)(m,2),b=f[0],y=f[1];return n?c.a.createElement("div",{id:"webdavLogin"},c.a.createElement("h2",null,"WebDAV"),c.a.createElement("form",{onSubmit:function(e){e.preventDefault(),kn("authenticatedSyncService","WebDAV"),kn("webdavEndpoint",o),kn("webdavUsername",p),kn("webdavPassword",b),window.location=window.location.origin+"/"}},c.a.createElement("p",null,c.a.createElement("label",null,"Url:"),c.a.createElement("input",{type:"url",value:o,className:"textfield",onChange:function(e){l(e.target.value)}})),c.a.createElement("p",null,c.a.createElement("label",null,"Username:"),c.a.createElement("input",{type:"text",className:"textfield",value:p,onChange:function(e){g(e.target.value)}})),c.a.createElement("p",null,c.a.createElement("label",null,"Password:"),c.a.createElement("input",{type:"password",className:"textfield",value:b,onChange:function(e){y(e.target.value)}})),c.a.createElement("input",{type:"submit",value:"Sign-in"}))):c.a.createElement("div",{id:"webdavLogin",onClick:function(){a(!0)}},c.a.createElement("h2",null,"WebDAV"))}var Co=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["handleDropboxClick","handleGoogleDriveClick"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleDropboxClick",value:function(){kn("authenticatedSyncService","Dropbox");var e=new Wr.Dropbox({clientId:"9mgtyjrvc0b1b2z",fetch:fetch}).getAuthenticationUrl(window.location.origin+"/");window.location=e}},{key:"handleGoogleDriveClick",value:function(){try{gapi.load("client:auth2",(function(){gapi.client.init({apiKey:"AIzaSyDG4BJbGdJBsH_3GoT_i-cN34Qbt7iMWJM",clientId:"744091668516-pb0nf1k8kjfoml3d84pr4q4csh86r7ar.apps.googleusercontent.com",discoveryDocs:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],scope:"https://www.googleapis.com/auth/drive"}).then((function(){kn("authenticatedSyncService","Google Drive"),gapi.auth2.getAuthInstance().signIn({ux_mode:"redirect",redirect_uri:window.location.origin})}))}))}catch(e){return void alert("The Google Drive API client isn't available - you might be blocking it with an ad blocker")}}},{key:"render",value:function(){return c.a.createElement("div",{className:"sync-service-sign-in-container"},c.a.createElement("p",{className:"sync-service-sign-in__help-text"},"organice syncs your files with Dropbox, Google Drive and WebDAV."),c.a.createElement("p",{className:"sync-service-sign-in__help-text"},"Click to sign in with:"),c.a.createElement("div",{className:"sync-service-container",onClick:this.handleDropboxClick},c.a.createElement("img",{src:_o.a,alt:"Dropbox logo",className:"dropbox-logo"})),c.a.createElement("div",{className:"sync-service-container",onClick:this.handleGoogleDriveClick},c.a.createElement("img",{src:Io.a,alt:"Google Drive logo",className:"google-drive-logo"})),c.a.createElement("div",{className:"sync-service-container"},c.a.createElement(Oo,null)))}}]),t}(s.PureComponent),Do=function(e){function t(e){var n;return Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),_.a.bindAll(Object(f.a)(n),["renderChangelogFile","renderSampleFile","renderFileBrowser","renderFile","setChangelogUnseenChanges"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.setChangelogUnseenChanges()}},{key:"setChangelogUnseenChanges",value:function(){var e=this,t=this.props,n=t.lastSeenChangelogHash,a=t.isAuthenticated;Se().then((function(t){var r=a&&n&&!_.a.isEqual(t,n);e.props.base.setHasUnseenChangelog(r)}))}},{key:"componentDidUpdate",value:function(){this.shouldPromptWhenLeaving()?window.onbeforeunload=function(){return!0}:window.onbeforeunload=void 0}},{key:"componentWillUnmount",value:function(){window.onbeforeunload=void 0}},{key:"renderChangelogFile",value:function(){return c.a.createElement(bo,{staticFile:"changelog",shouldDisableDirtyIndicator:!0,shouldDisableActions:!0,shouldDisableSyncButtons:!1,parsingErrorMessage:"The contents of changelog.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderSampleFile",value:function(){return c.a.createElement(bo,{staticFile:"sample",shouldDisableDirtyIndicator:!0,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!0,parsingErrorMessage:"The contents of sample.org couldn't be loaded. You probably forgot to set the environment variable - see the Development section of README.org for details!"})}},{key:"renderFileBrowser",value:function(e){var t=e.match.params.path,n=void 0===t?"":t;return n&&(n="/"+n),c.a.createElement(ni,{path:n})}},{key:"renderFile",value:function(e){var t=e.match.params.path;return t&&(t="/"+t),c.a.createElement(bo,{path:t,shouldDisableDirtyIndicator:!1,shouldDisableActionDrawer:!1,shouldDisableSyncButtons:!1})}},{key:"shouldPromptWhenLeaving",value:function(){return this.props.location.pathname.startsWith("/file/")&&this.props.isDirty}},{key:"render",value:function(){var e=this.props,t=e.isAuthenticated,n=e.loadingMessage,a=e.fontSize,r=e.activeModalPage,i=e.pendingCapture,o=e.location.pathname,l=!!i&&"/file".concat(i.get("capturePath")),u=l&&l!==o,d=Xr()("entry-container",{"entry-container--large-font":"Large"===a});return c.a.createElement("div",{className:d},c.a.createElement(ei,null),c.a.createElement(ri,{message:n}),c.a.createElement(Yr.a,{when:this.shouldPromptWhenLeaving(),message:function(){return"You have unpushed changes - are you sure you want to leave this page?"}}),"changelog"===r?this.renderChangelogFile():t?["keyboard_shortcuts_editor","settings","capture_templates_editor","sample"].includes(r)?c.a.createElement(s.Fragment,null,"keyboard_shortcuts_editor"===r&&c.a.createElement(Eo,null),"capture_templates_editor"===r&&c.a.createElement(ko,null),"sample"===r&&this.renderSampleFile()):c.a.createElement(Yr.e,null,u&&c.a.createElement(Yr.b,{to:l}),c.a.createElement(Yr.c,{path:"/privacy-policy",exact:!0,component:qr}),c.a.createElement(Yr.c,{path:"/file/:path+",render:this.renderFile}),c.a.createElement(Yr.c,{path:"/files/:path*",render:this.renderFileBrowser}),c.a.createElement(Yr.c,{path:"/sample",exact:!0,render:this.renderSampleFile}),c.a.createElement(Yr.c,{path:"/settings",exact:!0},c.a.createElement(yo,null)),c.a.createElement(Yr.b,{to:"/files"})):c.a.createElement(Yr.e,null,c.a.createElement(Yr.c,{path:"/privacy-policy",exact:!0,component:qr}),c.a.createElement(Yr.c,{path:"/sample",exact:!0,render:this.renderSampleFile}),c.a.createElement(Yr.c,{path:"/sign_in",exact:!0,component:Co}),c.a.createElement(Yr.c,{path:"/",exact:!0,component:ti}),c.a.createElement(Yr.b,{to:"/"})))}}]),t}(s.PureComponent),Ao=Object(Yr.h)(Object(y.b)((function(e,t){return{loadingMessage:e.base.get("loadingMessage"),isAuthenticated:e.syncBackend.get("isAuthenticated"),fontSize:e.base.get("fontSize"),lastSeenChangelogHash:e.base.get("lastSeenChangelogHash"),activeModalPage:e.base.get("modalPageStack",Object($.List)()).last(),pendingCapture:e.org.present.get("pendingCapture"),isDirty:e.org.present.get("isDirty")}}),(function(e){return{syncBackend:Object(v.b)(o,e),org:Object(v.b)(r,e),base:Object(v.b)(a,e)}}))(Do)),No=function(e){function t(e){var n;Object(h.a)(this,t),n=Object(g.a)(this,Object(m.a)(t).call(this,e)),Pr();var a=En();window.initialHash=window.location.hash.substring(0);var r=Lr(window.location.hash),i=wn("authenticatedSyncService",!0),o=null;if(i)switch(i){case"Dropbox":var s=r.access_token;if(s)o=Gr(s),a.syncBackend=Object($.Map)({isAuthenticated:!0,client:o}),kn("dropboxAccessToken",s),window.location.hash="";else{var c=wn("dropboxAccessToken",!0);c&&(o=Gr(c),a.syncBackend=Object($.Map)({isAuthenticated:!0,client:o}))}break;case"Google Drive":o=Kr(),a.syncBackend=Object($.Map)({isAuthenticated:!0,client:o});break;case"WebDAV":o=function(e,t,n){var a=Object(zr.createClient)(e,{username:t,password:n}),r=function(e){var t=function(e){return e.filter((function(e){return"directory"===e.type||e.basename.match(/org$|org_archive$/)})).sort((function(e,t){return"directory"===e.type&&"directory"!==t.type?-1:e.basename>t.basename?1:-1}))}(e);return Object($.fromJS)(t.map((function(e){return{id:e.filename,name:e.basename,isDirectory:"directory"===e.type,path:e.filename}})))},i=function(e){return new Promise((function(t,n){a.getDirectoryContents(e).then((function(e){return t({listing:r(e)})})).catch(n)}))},o=function(e,t){return new Promise((function(n,r){return a.putFileContents(e,t,{overwrite:!0}).then(n).catch(r)}))},s=function(n){return new Promise((function(r,i){return a.stat(n).then((function(e){a.getFileContents(n,{format:"text"}).then((function(t){r({contents:t,lastModifiedAt:new Date(Date.parse(e.lastmod)).toISOString()})})).catch((function(e){console.error(n,": get file failed",e),i()}))})).catch((function(a){a&&a.response&&-1!==[401,403].indexOf(a.response.status)&&alert(t+"@"+e+": "+a.response.statusText),console.error(n,": get stat failed",a),i()}))}))};return{type:"WebDAV",isSignedIn:function(){return new Promise((function(e){i("/").then((function(){e(!0)})).catch((function(t){console.log("Login didn't work"),e(!1)}))}))},getDirectoryListing:i,getMoreDirectoryListing:function(e){return new Promise((function(e,t){return e()}))},updateFile:o,createFile:o,getFileContentsAndMetadata:s,getFileContents:function(e){return Object(w.isEmpty)(e)?Promise.reject("No path given"):new Promise((function(t,n){return s(e).then((function(e){var n=e.contents;return t(n)})).catch(n)}))},deleteFile:function(e){return new Promise((function(t,n){return a.deleteFile(e).then(t).catch((function(t){t&&t.response&&404===t.response.status||(console.error(e,": delete failed",t),n())}))}))}}}(wn("webdavEndpoint"),wn("webdavUsername"),wn("webdavPassword")),a.syncBackend=Object($.Map)({isAuthenticated:!0,client:o})}var l=Lr(window.location.search),u=l.captureFile,p=l.captureTemplateName,b=l.captureContent;if(u&&p){var y=u.startsWith("/")?u:"/".concat(u),T=Object($.Map)(Object.entries(l).map((function(e){var t=Object(d.a)(e,2),n=t[0],a=t[1];return n.startsWith("captureVariable_")?[n.substring("captureVariable_".length),a]:null})).filter((function(e){return!!e})));a.org.present=a.org.present.set("pendingCapture",Object($.Map)({capturePath:y,captureTemplateName:p,captureContent:b,customCaptureVariables:T}))}return n.store=function(e){return Object(v.e)(Ar,e,Nr(Object(v.a)(E.a,nn,rn)))}(a),n.store.subscribe(Tn(n.store)),o?o.isSignedIn().then((function(e){e?function(e,t){var n=t().syncBackend.get("client");if(n){var a=null;switch(n.type){case"Dropbox":case"WebDAV":a=n.getFileContents("/.organice-config.json");break;case"Google Drive":a=n.getFileContentsByNameAndParent(".organice-config.json","root")}a.then((function(t){try{var n=JSON.parse(t);e(G(n)),e(pn(n))}catch(a){}})).catch((function(){}))}}(n.store.dispatch,n.store.getState):n.store.dispatch(xr())})):n.store.getState().org.present.get("pendingCapture")&&n.store.dispatch(C("You need to sign in before you can use capture templates",5e3)),_.a.bindAll(Object(f.a)(n),["handleDragEnd"]),n}return Object(b.a)(t,e),Object(p.a)(t,[{key:"handleDragEnd",value:function(e){e.destination&&("CAPTURE-TEMPLATE"===e.type?this.store.dispatch(gn(e.source.index,e.destination.index)):"TAG"===e.type?this.store.dispatch(Gt(e.source.index,e.destination.index)):"PROPERTY-LIST"===e.type&&this.store.dispatch(Kt(e.source.index,e.destination.index)))}},{key:"render",value:function(){return c.a.createElement(jr.a,{onDragEnd:this.handleDragEnd},c.a.createElement(Rr.a,null,c.a.createElement(y.a,{store:this.store},c.a.createElement("div",{className:"App"},c.a.createElement(Ao,null)))))}}]),t}(s.PureComponent),Po=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Lo(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}u.a.render(c.a.createElement(No,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");Po?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Lo(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):Lo(e)}))}}()},98:function(e,t,n){e.exports=n.p+"static/media/organice.11553f69.svg"}},[[235,1,2]]]);
//# sourceMappingURL=main.ccc0325c.chunk.js.map